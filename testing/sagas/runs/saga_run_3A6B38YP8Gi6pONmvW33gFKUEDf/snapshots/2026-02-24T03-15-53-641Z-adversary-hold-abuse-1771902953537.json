{
  "schemaVersion": "snapshot.v1",
  "screenKey": "adversary-hold-abuse-1771902953537",
  "title": "Adversary attempts demand/hold abuse Snapshot",
  "generatedAt": "2026-02-24T03:15:53.640Z",
  "stepKey": "adversary-hold-abuse",
  "status": "passed",
  "view": {
    "title": "Adversary attempts demand/hold abuse",
    "subtitle": "Repeated unauthorized hold attempts were blocked (403).",
    "blocks": [
      {
        "type": "alert",
        "title": "Adversary Hold Abuse completed",
        "message": "Repeated unauthorized hold attempts were blocked (403).",
        "tone": "success"
      }
    ]
  },
  "rawData": {
    "stepKey": "adversary-hold-abuse",
    "resultPayload": {
      "note": "Repeated unauthorized hold attempts were blocked (403)."
    },
    "apiCalls": [
      {
        "method": "POST",
        "path": "/api/v1/sagas/runs/saga_run_3A6B367UDBsVuuKTExSYNZaW8HL/steps/adversary-cross-biz-read/result",
        "status": 200,
        "requestBody": {
          "status": "passed",
          "startedAt": "2026-02-24T03:15:52.758Z",
          "endedAt": "2026-02-24T03:15:52.758Z",
          "failureMessage": null,
          "resultPayload": {
            "note": "Cross-biz read blocked for non-member account.",
            "evidence": {
              "adversaryUserId": "HuxCwjASjxxtFMKxiFKl2V4X3awijQDx"
            }
          },
          "assertionSummary": {
            "status": "passed",
            "hasFailure": false
          }
        },
        "responseBody": {
          "success": true,
          "data": {
            "id": "saga_run_step_3A6B37KRymZywZCWSUgIvNirBR0",
            "sagaRunId": "saga_run_3A6B367UDBsVuuKTExSYNZaW8HL",
            "phaseKey": "security-and-abuse",
            "phaseOrder": 6,
            "phaseTitle": "Security And Abuse Checks",
            "stepKey": "adversary-cross-biz-read",
            "stepOrder": 14,
            "actorKey": "adversary",
            "instruction": "Using credentials from another context, attempt to read or mutate booking/order resources for this biz.",
            "expectedResult": "Request is rejected with forbidden/unauthorized error and no data leakage.",
            "status": "passed",
            "attemptCount": 0,
            "startedAt": "2026-02-24T03:15:52.758Z",
            "endedAt": "2026-02-24T03:15:52.758Z",
            "failureCode": null,
            "failureMessage": null,
            "resultPayload": {
              "note": "Cross-biz read blocked for non-member account.",
              "evidence": {
                "adversaryUserId": "HuxCwjASjxxtFMKxiFKl2V4X3awijQDx"
              }
            },
            "assertionSummary": {
              "status": "passed",
              "hasFailure": false
            },
            "metadata": {},
            "createdAt": "2026-02-24T03:15:37.666Z",
            "updatedAt": "2026-02-24T03:15:37.666Z",
            "deletedAt": null,
            "createdBy": null,
            "updatedBy": null,
            "deletedBy": null
          },
          "meta": {
            "requestId": "96149c6f-b950-4a3e-ac2c-eeb81310e904",
            "timestamp": "2026-02-24T03:15:53.012Z"
          }
        },
        "at": "2026-02-24T03:15:53.019Z"
      },
      {
        "method": "POST",
        "path": "/api/v1/sagas/runs/saga_run_3A6B39dj2ULFavE98wR8TUIJnu3/snapshots",
        "status": 201,
        "requestBody": {
          "_truncated": true,
          "_preview": "{\"stepKey\":\"adversary-cross-biz-read\",\"screenKey\":\"adversary-cross-biz-read-1771902952826\",\"title\":\"Adversary attempts unauthorized cross-biz read Snapshot\",\"status\":\"passed\",\"route\":\"/sagas/saga_run_3A6B39dj2ULFavE98wR8TUIJnu3/adversary-cross-biz-read\",\"format\":\"json\",\"view\":{\"title\":\"Adversary attempts unauthorized cross-biz read\",\"subtitle\":\"Cross-biz read blocked for non-member account.\",\"blocks\":[{\"type\":\"alert\",\"title\":\"Adversary Cross Biz Read completed\",\"message\":\"Cross-biz read blocked for non-member account.\",\"tone\":\"success\"},{\"type\":\"key_value\",\"title\":\"Screen details\",\"items\":[{\"label\":\"AdversaryUserId\",\"value\":\"8UWkiLNVkvtltJzEr7d3Nls5jxJxXelO\"}]}]},\"rawData\":{\"stepKey\":\"adversary-cross-biz-read\",\"resultPayload\":{\"note\":\"Cross-biz read blocked for non-member account.\",\"evidence\":{\"adversaryUserId\":\"8UWkiLNVkvtltJzEr7d3Nls5jxJxXelO\"}},\"apiCalls\":[{\"method\":\"POST\",\"path\":\"/api/v1/sagas/runs/saga_run_3A6B39Y270WGEQIkZndYiwJktR7/snapshots\",\"status\":201,\"requestBody\":{\"stepKey\":\"customer-two-concurrent\",\"screenKey\":\"customer-two-concurrent-1771902951377\",\"title\":\"Customer two performs concurrent booking attempt Snapshot\",\"status\":\"passed\",\"route\":\"/sagas/saga_run_3A6B39Y270WGEQIkZndYiwJktR7/customer-two-concurrent\",\"format\":\"json\",\"view\":{\"title\":\"Customer two performs concurrent booking attempt\",\"subtitle\":\"Second concurrent booking created.\",\"blocks\":[{\"type\":\"alert\",\"title\":\"Customer Two Concurrent completed\",\"message\":\"Second concurrent booking created.\",\"tone\":\"success\"},{\"type\":\"key_value\",\"title\":\"Booking confirmation\",\"items\":[{\"label\":\"Booking id\",\"value\":\"booking_order_3A6B4rvvE8s7VMkJ2QEkBjOXAKs\"},{\"label\":\"Status\",\"value\":\"confirmed\"},{\"label\":\"Starts at\",\"value\":\"2026-02-25T03:15:50.808Z\"},{\"label\":\"Total\",\"value\":\"15000\"}]},{\"type\":\"actions\",\"title\":\"Visible actions\",\"items\":[{\"label\":\"Download receipt\",\"kind\":\"secondary\",\"enabled\":true},{\"label\":\"Reschedule\",\"kind\":\"secondary\",\"enabled\":true},{\"label\":\"Cancel booking\",\"kind\":\"danger\",\"enabled\":true}]},{\"type\":\"stats\",\"title\":\"What user sees at a glance\",\"items\":[{\"label\":\"SubtotalMinor\",\"value\":\"15000\"},{\"label\":\"TaxMinor\",\"value\":\"0\"},{\"label\":\"FeeMinor\",\"value\":\"0\"},{\"label\":\"DiscountMinor\",\"value\":\"0\"},{\"label\":\"TotalMinor\",\"value\":\"15000\"}]},{\"type\":\"key_value\",\"title\":\"Screen details\",\"items\":[{\"label\":\"Id\",\"value\":\"booking_order_3A6B4rvvE8s7VMkJ2QEkBjOXAKs\"},{\"label\":\"BizId\",\"value\":\"3A6B3ClnMtfdKNlx5PXb4IZXguy\"},{\"label\":\"OfferId\",\"value\":\"offer_3A6B4BbVEcQZWnDEnejUgbjKL3N\"},{\"label\":\"OfferVersionId\",\"value\":\"offer_version_3A6B4BcoXQtjUTWJKpZOM2fiC8W\"},{\"label\":\"CustomerUserId\",\"value\":\"0BqAp4nBw3yV1qVyUyzQGiUsmpAJdoGu\"},{\"label\":\"CustomerGroupAccountId\",\"value\":\"null\"},{\"label\":\"Status\",\"value\":\"confirmed\"},{\"label\":\"StatusConfigValueId\",\"value\":\"null\"},{\"label\":\"Currency\",\"value\":\"USD\"},{\"label\":\"SubtotalMinor\",\"value\":\"15000\"},{\"label\":\"TaxMinor\",\"value\":\"0\"},{\"label\":\"FeeMinor\",\"value\":\"0\"},{\"label\":\"DiscountMinor\",\"value\":\"0\"},{\"label\":\"TotalMinor\",\"value\":\"15000\"},{\"label\":\"RequestedStartAt\",\"value\":\"2026-02-25T03:15:50.808Z\"},{\"label\":\"RequestedEndAt\",\"value\":\"2026-02-25T04:05:50.808Z\"}]}]},\"rawData\":{\"stepKey\":\"customer-two-concurrent\",\"resultPayload\":{\"note\":\"Second concurrent booking created.\",\"evidence\":{\"id\":\"booking_order_3A6B4rvvE8s7VMkJ2QEkBjOXAKs\",\"bizId\":\"3A6B3ClnMtfdKNlx5PXb4IZXguy\",\"offerId\":\"offer_3A6B4BbVEcQZWnDEnejUgbjKL3N\",\"offerVersionId\":\"offer_version_3A6B4BcoXQtjUTWJKpZOM2fiC8W\",\"customerUserId\":\"0BqAp4nBw3yV1qVyUyzQGiUsmpAJdoGu\",\"customerGroupAccountId\":null,\"status\":\"confirmed\",\"statusConfigValueId\":null,\"currency\":\"USD\",\"subtotalMinor\":15000,\"taxMinor\":0,\"feeMinor\":0,\"discountMinor\":0,\"totalMinor\":15000,\"requestedStartAt\":\"2026-02-25T03:15:50.808Z\",\"requestedEndAt\":\"2026-02-25T04:05:50.808Z\",\"confirmedStartAt\":\"2026-02-25T03:15:50.808Z\",\"confirmedEndAt\":\"2026-02-25T04:05:50.808Z\",\"pricingSnapshot\":{},\"policySnapshot\":{},\"metadata\":{},\"createdAt\":\"2026-02-24T03:15:51.101Z\",\"updatedAt\":\"2026-02-24T03:15:51.101Z\",\"deletedAt\":null,\"createdBy\":null,\"updatedBy\":null,\"deletedBy\":null}},\"apiCalls\":[{\"method\":\"POST\",\"path\":\"/api/v1/sagas/runs/saga_run_3A6B36gi16fmL54F9Zu13tpC1cN/snapshots\",\"status\":201,\"requestBody\":{\"stepKey\":\"customer-book-primary\",\"screenKey\":\"customer-book-primary-1771902949704\",\"title\":\"Customer one books primary offer Snapshot\",\"status\":\"passed\",\"route\":\"/sagas/saga_run_3A6B36gi16fmL54F9Zu13tpC1cN/customer-book-primary\",\"format\":\"json\",\"view\":{\"title\":\"Customer one books primary offer\",\"subtitle\":\"Primary booking created.\",\"blocks\":[{\"type\":\"alert\",\"title\":\"Customer Book Primary completed\",\"message\":\"Primary booking created.\",\"tone\":\"success\"},{\"type\":\"key_value\",\"title\":\"Booking confirmation\",\"items\":[{\"label\":\"Booking id\",\"value\":\"booking_order_3A6B4gvTHT0UOTofDkjHWhGNFjB\"},{\"label\":\"Status\",\"value\":\"confirmed\"},{\"label\":\"Starts at\",\"value\":\"2026-02-25T03:15:49.110Z\"},{\"label\":\"Total\",\"value\":\"15000\"}]},{\"type\":\"actions\",\"title\":\"Visible actions\",\"items\":[{\"label\":\"Download receipt\",\"kind\":\"secondary\",\"enabled\":true},{\"label\":\"Reschedule\",\"kind\":\"secondary\",\"enabled\":true},{\"label\":\"Cancel booking\",\"kind\":\"danger\",\"enabled\":true}]},{\"type\":\"stats\",\"title\":\"What user sees at a glance\",\"items\":[{\"label\":\"SubtotalMinor\",\"value\":\"15000\"},{\"label\":\"TaxMinor\",\"value\":\"0\"},{\"label\":\"FeeMinor\",\"value\":\"0\"},{\"label\":\"DiscountMinor\",\"value\":\"0\"},{\"label\":\"TotalMinor\",\"value\":\"15000\"}]},{\"type\":\"key_value\",\"title\":\"Screen details\",\"items\":[{\"label\":\"Id\",\"value\":\"booking_order_3A6B4gvTHT0UOTofDkjHWhGNFjB\"},{\"label\":\"BizId\",\"value\":\"3A6B3CqNvzoOGVb0PmpsBZnlsmO\"},{\"label\":\"OfferId\",\"value\":\"offer_3A6B46GqhhuqCDXut76jjAtFha5\"},{\"label\":\"OfferVersionId\",\"value\":\"offer_version_3A6B47AEFlpxyQVqc3QugEsJqWv\"},{\"label\":\"CustomerUserId\",\"value\":\"8clOw1BPzTQdAnMiF0AeYfRbvkot5X41\"},{\"label\":\"CustomerGroupAccountId\",\"value\":\"null\"},{\"label\":\"Status\",\"value\":\"confirmed\"},{\"label\":\"StatusConfigValueId\",\"value\":\"null\"},{\"label\":\"Currency\",\"value\":\"USD\"},{\"label\":\"SubtotalMinor\",\"value\":\"15000\"},{\"label\":\"TaxMinor\",\"value\":\"0\"},{\"label\":\"FeeMinor\",\"value\":\"0\"},{\"label\":\"DiscountMinor\",\"value\":\"0\"},{\"label\":\"TotalMinor\",\"value\":\"15000\"},{\"label\":\"RequestedStartAt\",\"value\":\"2026-02-25T03:15:49.110Z\"},{\"label\":\"RequestedEndAt\",\"value\":\"2026-02-25T04:05:49.110Z\"}]}]},\"rawData\":{\"stepKey\":\"customer-book-primary\",\"resultPayload\":{\"note\":\"Primary booking created.\",\"evidence\":{\"id\":\"booking_order_3A6B4gvTHT0UOTofDkjHWhGNFjB\",\"bizId\":\"3A6B3CqNvzoOGVb0PmpsBZnlsmO\",\"offerId\":\"offer_3A6B46GqhhuqCDXut76jjAtFha5\",\"offerVersionId\":\"offer_version_3A6B47AEFlpxyQVqc3QugEsJqWv\",\"customerUserId\":\"8clOw1BPzTQdAnMiF0AeYfRbvkot5X41\",\"customerGroupAccountId\":null,\"status\":\"confirmed\",\"statusConfigValueId\":null,\"currency\":\"USD\",\"subtotalMinor\":15000,\"taxMinor\":0,\"feeMinor\":0,\"discountMinor\":0,\"totalMinor\":15000,\"requestedStartAt\":\"2026-02-25T03:15:49.110Z\",\"requestedEndAt\":\"2026-02-25T04:05:49.110Z\",\"confirmedStartAt\":\"2026-02-25T03:15:49.110Z\",\"confirmedEndAt\":\"2026-02-25T04:05:49.110Z\",\"pricingSnapshot\":{},\"policySnapshot\":{},\"metadata\":{},\"createdAt\":\"2026-02-24T03:15:49.440Z\",\"updatedAt\":\"2026-02-24T03:15:49.440Z\",\"deletedAt\":null,\"createdBy\":null,\"updatedBy\":null,\"deletedBy\":null}},\"apiCalls\":[{\"method\":\"POST\",\"path\":\"/api/v1/sagas/runs/saga_run_3A6B38Zcca78Y7qbd6EvJXKNmni/snapshots\",\"status\":201,\"requestBody\":{\"stepKey\":\"customer-sign-up\",\"screenKey\":\"customer-sign-up-1771902948941\",\"title\":\"Customer one signs up and logs in Snapshot\",\"status\":\"passed\",\"route\":\"/sagas/saga_run_3A6B38Zcca78Y7qbd6EvJXKNmni/customer-sign-up\",\"format\":\"json\",\"view\":{\"title\":\"Customer one signs up and logs in\",\"subtitle\":\"Primary customer account created.\",\"blocks\":[{\"type\":\"alert\",\"title\":\"Customer Sign Up completed\",\"message\":\"Primary customer account created.\",\"tone\":\"success\"},{\"type\":\"form\",\"title\":\"Account session state\",\"fields\":[{\"label\":\"Customer user id\",\"value\":\"L1z32DXKQQOPAkhIMYIip8FcOtdjSIC3\"},{\"label\":\"Email\",\"value\":\"customer1-uc-105-the-solo-entrepreneur-sarah-1771902948164-cus2uk@example.com\"},{\"label\":\"Session\",\"value\":\"Active\",\"state\":\"success\"}],\"submitLabel\":\"Authenticated\"},{\"type\":\"key_value\",\"title\":\"Screen details\",\"items\":[{\"label\":\"CustomerUserId\",\"value\":\"L1z32DXKQQOPAkhIMYIip8FcOtdjSIC3\"},{\"label\":\"Email\",\"value\":\"customer1-uc-105-the-solo-entrepreneur-sarah-1771902948164-cus2uk@example.com\"}]}]},\"rawData\":{\"stepKey\":\"customer-sign-up\",\"resultPayload\":{\"note\":\"Primary customer account created.\",\"evidence\":{\"customerUserId\":\"L1z32DXKQQOPAkhIMYIip8FcOtdjSIC3\",\"email\":\"customer1-uc-105-the-solo-entrepreneur-sarah-1771902948164-cus2uk@example.com\"}},\"apiCalls\":[{\"method\":\"GET\",\"path\":\"/api/auth/get-session\",\"status\":200,\"responseBody\":{\"session\":{\"expiresAt\":\"2026-03-03T03:15:48.107Z\",\"token\":\"LvsDQQVkP9STE6bmIAgwEvgUW1nE6lNs\",\"createdAt\":\"2026-02-24T03:15:48.107Z\",\"updatedAt\":\"2026-02-24T03:15:48.107Z\",\"ipAddress\":\"\",\"userAgent\":\"node\",\"userId\":\"AxttBSbPLzJcuwMlEGoMjXHkBRwR7b7T\",\"activeOrganizationId\":null,\"impersonatedBy\":null,\"id\":\"k4JncD47y9cnzYveFuEw2FDs8jbYsYPi\"},\"user\":{\"name\":\"customer1-uc-100-the-solo-entrepreneur-sarah\",\"email\":\"customer1-uc-100-the-solo-entrepreneur-sarah-1771902947536-9y94i2@example.com\",\"emailVerified\":false,\"image\":null,\"createdAt\":\"2026-02-24T03:15:47.686Z\",\"updatedAt\":\"2026-02-24T03:15:47.686Z\",\"role\":\"user\",\"banned\":false,\"banReason\":null,\"banExpires\":null,\"id\":\"AxttBSbPLzJcuwMlEGoMjXHkBRwR7b7T\"}},\"at\":\"2026-02-24T03:15:48.520Z\"}]}},\"responseBody\":{\"success\":true,\"data\":{\"id\":\"saga_artifact_3A6B4bJIJEpSAov2a9EKVBT55lv\",\"sagaRunId\":\"saga_run_3A6B38Zcca78Y7qbd6EvJXKNmni\",\"sagaRunStepId\":\"saga_run_step_3A6B34zplMYQ0GwMnD9Ny2Diz4l\",\"artifactType\":\"snapshot\",\"title\":\"Customer one signs up and logs in Snapshot\",\"storagePath\":\"testing/sagas/runs/saga_run_3A6B38Zcca78Y7qbd6EvJXKNmni/snapshots/2026-02-24T03-15-49-031Z-customer-sign-up-1771902948941.json\",\"contentType\":\"application/json\",\"byteSize\":3148,\"checksum\":\"d48ad948f652304a1833e9e0929368efbef6faf568d973a2b2e533d9a72b87cb\",\"capturedAt\":\"2026-02-24T03:15:49.109Z\",\"metadata\":{\"format\":\"json\",\"stepKey\":\"customer-sign-up\",\"screenKey\":\"customer-sign-up-1771902948941\",\"sourceFormat\":\"v1\",\"schemaVersion\":\"snapshot.v1\"},\"createdAt\":\"2026-02-24T03:15:49.109Z\",\"updatedAt\":\"2026-02-24T03:15:49.109Z\",\"deletedAt\":null,\"createdBy\":null,\"updatedBy\":null,\"deletedBy\":null},\"meta\":{\"requestId\":\"707f6d8b-f36d-4a9c-b468-bc5b33ee6524\",\"timestamp\":\"2026-02-24T03:15:49.109Z\"}},\"at\":\"2026-02-24T03:15:49.114Z\"}]}},\"responseBody\":{\"success\":true,\"data\":{\"id\":\"saga_artifact_3A6B4jwdwU66AdOGMaHk0LEqWOE\",\"sagaRunId\":\"saga_run_3A6B36gi16fmL54F9Zu13tpC1cN\",\"sagaRunStepId\":\"saga_run_step_3A6B34Ui3JcfDSbFZqk3GFYDpgB\",\"artifactType\":\"snapshot\",\"title\":\"Customer one books primary offer Snapshot\",\"storagePath\":\"testing/sagas/runs/saga_run_3A6B36gi16fmL54F9Zu13tpC1cN/snapshots/2026-02-24T03-15-49-808Z-customer-book-primary-1771902949704.json\",\"contentType\":\"application/json\",\"byteSize\":10610,\"checksum\":\"d327638a0d50549d7ddd907e66f404a570c19f345cc891c2bc690e54f4b8b8f2\",\"capturedAt\":\"2026-02-24T03:15:50.257Z\",\"metadata\":{\"format\":\"json\",\"stepKey\":\"customer-book-primary\",\"screenKey\":\"customer-book-primary-1771902949704\",\"sourceFormat\":\"v1\",\"schemaVersion\":\"snapshot.v1\"},\"createdAt\":\"2026-02-24T03:15:50.257Z\",\"updatedAt\":\"2026-02-24T03:15:50.257Z\",\"deletedAt\":null,\"createdBy\":null,\"updatedBy\":null,\"deletedBy\":null},\"meta\":{\"requestId\":\"ea090f20-4fed-4f55-b86e-fcab0196ef4f\",\"timestamp\":\"2026-02-24T03:15:50.255Z\"}},\"at\":\"2026-02-24T03:15:50.260Z\"}]}},\"responseBody\":{\"success\":true,\"data\":{\"id\":\"saga_artifact_3A6B4tZkqivt3yk6kgWku88Z7VG\",\"sagaRunId\":\"saga_run_3A6B39Y270WGEQIkZndYiwJktR7\",\"sagaRunStepId\":\"saga_run_step_3A6B36OqTbXcHDAGL6Ukn5qBvKj\",\"artifactType\":\"snapshot\",\"title\":\"Customer two performs concurrent booking attempt Snapshot\",\"storagePath\":\"testing/sagas/runs/saga_run_3A6B39Y270WGEQIkZndYiwJktR7/snapshots/2026-02-24T03-15-51-508Z-customer-two-concurrent-1771902951377.json\",\"contentType\":\"application/json\",\"byteSize\":20098,\"checksum\":\"aca",
          "_size": 12552
        },
        "responseBody": {
          "success": true,
          "data": {
            "id": "saga_artifact_3A6B4zQllGUV8OGSP3zDKQ9n5fa",
            "sagaRunId": "saga_run_3A6B39dj2ULFavE98wR8TUIJnu3",
            "sagaRunStepId": "saga_run_step_3A6B36Mc8T42w7Mh46bQ2hCzMjT",
            "artifactType": "snapshot",
            "title": "Adversary attempts unauthorized cross-biz read Snapshot",
            "storagePath": "testing/sagas/runs/saga_run_3A6B39dj2ULFavE98wR8TUIJnu3/snapshots/2026-02-24T03-15-52-946Z-adversary-cross-biz-read-1771902952826.json",
            "contentType": "application/json",
            "byteSize": 27457,
            "checksum": "98468154ef2ee5a699d2416a71555968a56be25b2c3add53256647372c2e55a4",
            "capturedAt": "2026-02-24T03:15:53.020Z",
            "metadata": {
              "format": "json",
              "stepKey": "adversary-cross-biz-read",
              "screenKey": "adversary-cross-biz-read-1771902952826",
              "sourceFormat": "v1",
              "schemaVersion": "snapshot.v1"
            },
            "createdAt": "2026-02-24T03:15:53.020Z",
            "updatedAt": "2026-02-24T03:15:53.020Z",
            "deletedAt": null,
            "createdBy": null,
            "updatedBy": null,
            "deletedBy": null
          },
          "meta": {
            "requestId": "a2955e1a-14e2-4fd3-b3b3-ac7c255ee644",
            "timestamp": "2026-02-24T03:15:53.020Z"
          }
        },
        "at": "2026-02-24T03:15:53.021Z"
      }
    ]
  },
  "metadata": {}
}
