{
  "stepKey": "owner-validate-compliance-controls",
  "callCount": 6,
  "calls": [
    {
      "method": "POST",
      "path": "/api/v1/sagas/runs/saga_run_3AAOl5HGlVRjXoZTtnRZBG39uOk/steps/persona-scenario-validate-4/result",
      "status": 200,
      "requestBody": {
        "status": "in_progress",
        "startedAt": "2026-02-25T15:07:51.285Z",
        "resultPayload": {
          "note": "Started persona-scenario-validate-4"
        },
        "assertionSummary": {
          "status": "in_progress"
        }
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "saga_run_step_3AAOl1R0zKRkztLiVME3ZlMhDf9",
          "sagaRunId": "saga_run_3AAOl5HGlVRjXoZTtnRZBG39uOk",
          "phaseKey": "reporting-and-closeout",
          "phaseOrder": 8,
          "phaseTitle": "Reporting And Closeout",
          "stepKey": "persona-scenario-validate-4",
          "stepOrder": 26,
          "actorKey": "customer_1",
          "instruction": "Simulate this persona scenario and validate outcome deterministically: \"Break-glass access logging and review\". Capture traces and snapshots so coverage can be audited later.",
          "expectedResult": "Scenario behavior is either confirmed as supported or produces a clear, actionable failure report.",
          "delayMode": "none",
          "delayMs": null,
          "delayConditionKey": null,
          "delayTimeoutMs": null,
          "delayPollMs": null,
          "delayJitterMs": 0,
          "status": "in_progress",
          "attemptCount": 1,
          "startedAt": "2026-02-25T15:07:51.285Z",
          "endedAt": null,
          "failureCode": null,
          "failureMessage": null,
          "resultPayload": {
            "note": "Started persona-scenario-validate-4"
          },
          "assertionSummary": {
            "status": "in_progress"
          },
          "metadata": {},
          "createdAt": "2026-02-25T15:07:35.132Z",
          "updatedAt": "2026-02-25T15:07:35.132Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "13a8cd63-397c-4e13-8848-d01735981022",
          "timestamp": "2026-02-25T15:07:51.361Z"
        }
      },
      "at": "2026-02-25T15:07:51.361Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/sagas/runs/saga_run_3AAOksgKmKetXzDVHvjYEgXeJKF/steps/uc-need-validate-3/result",
      "status": 200,
      "requestBody": {
        "status": "in_progress",
        "startedAt": "2026-02-25T15:07:51.263Z",
        "resultPayload": {
          "note": "Started uc-need-validate-3"
        },
        "assertionSummary": {
          "status": "in_progress"
        }
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "saga_run_step_3AAOkvA3g2rnNlihTaqug8WoUD6",
          "sagaRunId": "saga_run_3AAOksgKmKetXzDVHvjYEgXeJKF",
          "phaseKey": "reporting-and-closeout",
          "phaseOrder": 8,
          "phaseTitle": "Reporting And Closeout",
          "stepKey": "uc-need-validate-3",
          "stepOrder": 22,
          "actorKey": "biz_owner",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Selector types (specific record, credential type, fact requirement)\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "delayMode": "none",
          "delayMs": null,
          "delayConditionKey": null,
          "delayTimeoutMs": null,
          "delayPollMs": null,
          "delayJitterMs": 0,
          "status": "in_progress",
          "attemptCount": 1,
          "startedAt": "2026-02-25T15:07:51.263Z",
          "endedAt": null,
          "failureCode": null,
          "failureMessage": null,
          "resultPayload": {
            "note": "Started uc-need-validate-3"
          },
          "assertionSummary": {
            "status": "in_progress"
          },
          "metadata": {},
          "createdAt": "2026-02-25T15:07:34.323Z",
          "updatedAt": "2026-02-25T15:07:34.323Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "0cb15747-0667-4a27-9d76-2860d9ea9464",
          "timestamp": "2026-02-25T15:07:51.363Z"
        }
      },
      "at": "2026-02-25T15:07:51.363Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/sagas/runs/saga_run_3AAOmtkOQPEvQJgtvTHVlj1bW4T/steps/owner-sign-up/result",
      "status": 200,
      "requestBody": {
        "status": "in_progress",
        "startedAt": "2026-02-25T15:07:51.302Z",
        "resultPayload": {
          "note": "Started owner-sign-up"
        },
        "assertionSummary": {
          "status": "in_progress"
        }
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "saga_run_step_3AAOmy2yeycY2vuGkhYrQ3bOzo2",
          "sagaRunId": "saga_run_3AAOmtkOQPEvQJgtvTHVlj1bW4T",
          "phaseKey": "owner-onboarding",
          "phaseOrder": 1,
          "phaseTitle": "Owner Onboarding",
          "stepKey": "owner-sign-up",
          "stepOrder": 1,
          "actorKey": "biz_owner",
          "instruction": "Create or login the owner account through Better Auth endpoints, then verify session context can call authenticated API routes.",
          "expectedResult": "Owner session exists and authenticated routes return success for this user.",
          "delayMode": "none",
          "delayMs": null,
          "delayConditionKey": null,
          "delayTimeoutMs": null,
          "delayPollMs": null,
          "delayJitterMs": 0,
          "status": "in_progress",
          "attemptCount": 1,
          "startedAt": "2026-02-25T15:07:51.302Z",
          "endedAt": null,
          "failureCode": null,
          "failureMessage": null,
          "resultPayload": {
            "note": "Started owner-sign-up"
          },
          "assertionSummary": {
            "status": "in_progress"
          },
          "metadata": {},
          "createdAt": "2026-02-25T15:07:50.331Z",
          "updatedAt": "2026-02-25T15:07:50.331Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "082afddc-87f8-49c0-b4c8-d296aa1426eb",
          "timestamp": "2026-02-25T15:07:51.380Z"
        }
      },
      "at": "2026-02-25T15:07:51.380Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/sagas/runs/saga_run_3AAOmgVrCPV3OHzySMIzCbcIBD9/steps/owner-create-location/result",
      "status": 200,
      "requestBody": {
        "status": "passed",
        "startedAt": "2026-02-25T15:07:51.170Z",
        "endedAt": "2026-02-25T15:07:51.170Z",
        "failureMessage": null,
        "resultPayload": {
          "note": "Location created.",
          "evidence": {
            "id": "3AAOn3OzD58hxRnUASRmu8cX4k4",
            "bizId": "3AAOmvcyCEjZ9pfzUDTO7HFCcTb",
            "name": "Primary Location",
            "slug": "loc-01eb771m",
            "type": "physical",
            "timezone": "UTC",
            "address": {},
            "operatingHours": {},
            "configOverride": {},
            "serviceArea": {},
            "status": "active",
            "isDefault": false,
            "metadata": {},
            "createdAt": "2026-02-25T15:07:51.038Z",
            "updatedAt": "2026-02-25T15:07:51.038Z",
            "deletedAt": null
          }
        },
        "assertionSummary": {
          "status": "passed",
          "hasFailure": false,
          "assertionsPassed": 1
        }
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "saga_run_step_3AAOmjmdWTaVHnWYnHZugLJYL0b",
          "sagaRunId": "saga_run_3AAOmgVrCPV3OHzySMIzCbcIBD9",
          "phaseKey": "owner-onboarding",
          "phaseOrder": 1,
          "phaseTitle": "Owner Onboarding",
          "stepKey": "owner-create-location",
          "stepOrder": 3,
          "actorKey": "biz_owner",
          "instruction": "Create a primary location for the biz and set timezone aligned with scenario context.",
          "expectedResult": "Location exists and is associated with the new biz.",
          "delayMode": "none",
          "delayMs": null,
          "delayConditionKey": null,
          "delayTimeoutMs": null,
          "delayPollMs": null,
          "delayJitterMs": 0,
          "status": "passed",
          "attemptCount": 1,
          "startedAt": "2026-02-25T15:07:51.170Z",
          "endedAt": "2026-02-25T15:07:51.170Z",
          "failureCode": null,
          "failureMessage": null,
          "resultPayload": {
            "note": "Location created.",
            "evidence": {
              "id": "3AAOn3OzD58hxRnUASRmu8cX4k4",
              "name": "Primary Location",
              "slug": "loc-01eb771m",
              "type": "physical",
              "bizId": "3AAOmvcyCEjZ9pfzUDTO7HFCcTb",
              "status": "active",
              "address": {},
              "metadata": {},
              "timezone": "UTC",
              "createdAt": "2026-02-25T15:07:51.038Z",
              "deletedAt": null,
              "isDefault": false,
              "updatedAt": "2026-02-25T15:07:51.038Z",
              "serviceArea": {},
              "configOverride": {},
              "operatingHours": {}
            }
          },
          "assertionSummary": {
            "status": "passed",
            "hasFailure": false,
            "assertionsPassed": 1
          },
          "metadata": {},
          "createdAt": "2026-02-25T15:07:48.979Z",
          "updatedAt": "2026-02-25T15:07:48.979Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "e745672b-74b5-4ea3-b7c6-13e71cd01714",
          "timestamp": "2026-02-25T15:07:51.404Z"
        }
      },
      "at": "2026-02-25T15:07:51.404Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/sagas/runs/saga_run_3AAOlT3Gk6XC81eWtiyXSecuQhD/steps/owner-validate-compliance-controls/result",
      "status": 200,
      "requestBody": {
        "status": "passed",
        "startedAt": "2026-02-25T15:07:51.243Z",
        "endedAt": "2026-02-25T15:07:51.243Z",
        "failureMessage": null,
        "resultPayload": {
          "note": "Compliance controls verified through canonical API endpoint.",
          "evidence": {
            "permissionCheckCount": 5,
            "credentialTotals": {
              "totalCredentials": 0,
              "activeCredentials": 0,
              "revokedCredentials": 0,
              "expiredCredentials": 0,
              "samples": []
            },
            "auditControls": {
              "auditStreamsCount": 0,
              "auditEventsCount": 0,
              "auditIntegrityRunsCount": 0
            },
            "warnings": []
          }
        },
        "assertionSummary": {
          "status": "passed",
          "hasFailure": false,
          "assertionsPassed": 1
        }
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "saga_run_step_3AAOlTvT0JBGkTB6q0cs9UDHbE8",
          "sagaRunId": "saga_run_3AAOlT3Gk6XC81eWtiyXSecuQhD",
          "phaseKey": "operations-and-follow-up",
          "phaseOrder": 7,
          "phaseTitle": "Operations And Follow-up",
          "stepKey": "owner-validate-compliance-controls",
          "stepOrder": 19,
          "actorKey": "biz_owner",
          "instruction": "Run compliance workflow checks (credential sharing/access control/privacy constraints) for this scenario.",
          "expectedResult": "Access is scoped correctly and compliance workflow state is traceable in operational records.",
          "delayMode": "none",
          "delayMs": null,
          "delayConditionKey": null,
          "delayTimeoutMs": null,
          "delayPollMs": null,
          "delayJitterMs": 0,
          "status": "passed",
          "attemptCount": 1,
          "startedAt": "2026-02-25T15:07:51.243Z",
          "endedAt": "2026-02-25T15:07:51.243Z",
          "failureCode": null,
          "failureMessage": null,
          "resultPayload": {
            "note": "Compliance controls verified through canonical API endpoint.",
            "evidence": {
              "warnings": [],
              "auditControls": {
                "auditEventsCount": 0,
                "auditStreamsCount": 0,
                "auditIntegrityRunsCount": 0
              },
              "credentialTotals": {
                "samples": [],
                "totalCredentials": 0,
                "activeCredentials": 0,
                "expiredCredentials": 0,
                "revokedCredentials": 0
              },
              "permissionCheckCount": 5
            }
          },
          "assertionSummary": {
            "status": "passed",
            "hasFailure": false,
            "assertionsPassed": 1
          },
          "metadata": {},
          "createdAt": "2026-02-25T15:07:38.818Z",
          "updatedAt": "2026-02-25T15:07:38.818Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "e8391fa6-980c-4cce-9c1d-6c9b0b68cc67",
          "timestamp": "2026-02-25T15:07:51.411Z"
        }
      },
      "at": "2026-02-25T15:07:51.411Z"
    },
    {
      "method": "GET",
      "path": "/api/v1/bizes/3AAOle5zX5D1uiYQAawolEC8x12/compliance/controls",
      "status": 200,
      "responseBody": {
        "success": true,
        "data": {
          "bizId": "3AAOle5zX5D1uiYQAawolEC8x12",
          "evaluatedAt": "2026-02-25T15:07:51.412Z",
          "accessControls": {
            "actorUserId": "n1sZmxkoRU3I056ePPa62zeC77c08bew",
            "actorRole": "user",
            "sensitivePermissionChecks": [
              {
                "permissionKey": "booking_orders.read",
                "allowed": true,
                "reason": "allow at highest specificity",
                "scopeType": "platform"
              },
              {
                "permissionKey": "booking_orders.update",
                "allowed": true,
                "reason": "allow at highest specificity",
                "scopeType": "platform"
              },
              {
                "permissionKey": "members.read",
                "allowed": true,
                "reason": "allow at highest specificity",
                "scopeType": "platform"
              },
              {
                "permissionKey": "acl.read",
                "allowed": true,
                "reason": "allow at highest specificity",
                "scopeType": "platform"
              },
              {
                "permissionKey": "sagas.read",
                "allowed": true,
                "reason": "allow at highest specificity",
                "scopeType": "platform"
              }
            ]
          },
          "privacyControls": {
            "tenantScopeEnforced": true,
            "crossBizIsolationEnforced": true
          },
          "credentialControls": {
            "totalCredentials": 0,
            "activeCredentials": 0,
            "revokedCredentials": 0,
            "expiredCredentials": 0,
            "samples": []
          },
          "auditControls": {
            "auditStreamsCount": 0,
            "auditEventsCount": 0,
            "auditIntegrityRunsCount": 0
          },
          "warnings": []
        },
        "meta": {
          "requestId": "5864d98d-9939-40ec-ad47-1240ce239020",
          "timestamp": "2026-02-25T15:07:51.412Z"
        }
      },
      "at": "2026-02-25T15:07:51.412Z"
    }
  ]
}
