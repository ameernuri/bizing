{
  "stepKey": "adversary-hold-abuse",
  "callCount": 5,
  "calls": [
    {
      "method": "POST",
      "path": "/api/v1/bizes/3A6ILQjy8cIAjN2g9MXt4LdlISQ/booking-orders",
      "status": 403,
      "requestBody": {
        "offerId": "offer_3A6IMYS7IU5J6UA21yTZiFyLnQx",
        "offerVersionId": "offer_version_3A6IMcJbnIe2iKaRmh3WwxhDqJf",
        "status": "draft",
        "subtotalMinor": 1000,
        "taxMinor": 0,
        "feeMinor": 0,
        "discountMinor": 0,
        "totalMinor": 1000,
        "currency": "USD"
      },
      "responseBody": {
        "success": false,
        "error": {
          "code": "FORBIDDEN",
          "message": "You are not a member of this biz."
        },
        "meta": {
          "requestId": "32c7b1e2-546f-426d-915e-246b1aecee72",
          "timestamp": "2026-02-24T04:15:55.268Z"
        }
      },
      "at": "2026-02-24T04:15:55.269Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/sagas/runs/saga_run_3A6IKaWiVaZNZ0f5aHqEZeXvH0Q/steps/adversary-cross-biz-read/result",
      "status": 200,
      "requestBody": {
        "status": "passed",
        "startedAt": "2026-02-24T04:15:54.687Z",
        "endedAt": "2026-02-24T04:15:54.687Z",
        "failureMessage": null,
        "resultPayload": {
          "note": "Cross-biz read blocked for non-member account.",
          "evidence": {
            "adversaryUserId": "FoCoDIBs0kRNwlPjCLB9FBcowELAfTbj"
          }
        },
        "assertionSummary": {
          "status": "passed",
          "hasFailure": false,
          "assertionsPassed": 1
        }
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "saga_run_step_3A6IKURurDSRTIgFMNbKMhQuDR4",
          "sagaRunId": "saga_run_3A6IKaWiVaZNZ0f5aHqEZeXvH0Q",
          "phaseKey": "security-and-abuse",
          "phaseOrder": 6,
          "phaseTitle": "Security And Abuse Checks",
          "stepKey": "adversary-cross-biz-read",
          "stepOrder": 14,
          "actorKey": "adversary",
          "instruction": "Using credentials from another context, attempt to read or mutate booking/order resources for this biz.",
          "expectedResult": "Request is rejected with forbidden/unauthorized error and no data leakage.",
          "status": "passed",
          "attemptCount": 1,
          "startedAt": "2026-02-24T04:15:54.687Z",
          "endedAt": "2026-02-24T04:15:54.687Z",
          "failureCode": null,
          "failureMessage": null,
          "resultPayload": {
            "note": "Cross-biz read blocked for non-member account.",
            "evidence": {
              "adversaryUserId": "FoCoDIBs0kRNwlPjCLB9FBcowELAfTbj"
            }
          },
          "assertionSummary": {
            "status": "passed",
            "hasFailure": false,
            "assertionsPassed": 1
          },
          "metadata": {},
          "createdAt": "2026-02-24T04:15:29.481Z",
          "updatedAt": "2026-02-24T04:15:29.481Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "4259446a-8e32-448c-bc40-1cddcc6b52c3",
          "timestamp": "2026-02-24T04:15:55.285Z"
        }
      },
      "at": "2026-02-24T04:15:55.289Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/bizes/3A6ILOm0Hs5dNzSpVQ55hC3szYt/booking-orders",
      "status": 403,
      "requestBody": {
        "offerId": "offer_3A6IMZXCZFteLaU0w1Fi1YvFFLI",
        "offerVersionId": "offer_version_3A6IMcggpql3dkRHLiZ0y68unhl",
        "status": "draft",
        "subtotalMinor": 1000,
        "taxMinor": 0,
        "feeMinor": 0,
        "discountMinor": 0,
        "totalMinor": 1000,
        "currency": "USD"
      },
      "responseBody": {
        "success": false,
        "error": {
          "code": "FORBIDDEN",
          "message": "You are not a member of this biz."
        },
        "meta": {
          "requestId": "106922ff-9e71-4bba-9a17-36fa9d7d6bd4",
          "timestamp": "2026-02-24T04:15:55.311Z"
        }
      },
      "at": "2026-02-24T04:15:55.313Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/bizes/3A6ILQjy8cIAjN2g9MXt4LdlISQ/booking-orders",
      "status": 403,
      "requestBody": {
        "offerId": "offer_3A6IMYS7IU5J6UA21yTZiFyLnQx",
        "offerVersionId": "offer_version_3A6IMcJbnIe2iKaRmh3WwxhDqJf",
        "status": "draft",
        "subtotalMinor": 1000,
        "taxMinor": 0,
        "feeMinor": 0,
        "discountMinor": 0,
        "totalMinor": 1000,
        "currency": "USD"
      },
      "responseBody": {
        "success": false,
        "error": {
          "code": "FORBIDDEN",
          "message": "You are not a member of this biz."
        },
        "meta": {
          "requestId": "ec6cb7bd-966f-4f33-81d8-440ffe488dfc",
          "timestamp": "2026-02-24T04:15:55.355Z"
        }
      },
      "at": "2026-02-24T04:15:55.358Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/sagas/runs/saga_run_3A6IKZkEowpsWqNXJu6kvjLDMWa/snapshots",
      "status": 201,
      "requestBody": {
        "stepKey": "adversary-cross-biz-read",
        "screenKey": "adversary-cross-biz-read-1771906555207",
        "title": "Adversary attempts unauthorized cross-biz read Snapshot",
        "status": "passed",
        "route": "/sagas/saga_run_3A6IKZkEowpsWqNXJu6kvjLDMWa/adversary-cross-biz-read",
        "format": "json",
        "view": {
          "title": "Adversary attempts unauthorized cross-biz read",
          "subtitle": "Cross-biz read blocked for non-member account.",
          "blocks": [
            {
              "type": "alert",
              "title": "Adversary Cross Biz Read completed",
              "message": "Cross-biz read blocked for non-member account.",
              "tone": "success"
            },
            {
              "type": "key_value",
              "title": "Screen details",
              "items": [
                {
                  "label": "AdversaryUserId",
                  "value": "q3IubdOWEz1Egfb1eWoi2Xz4humcUfnf"
                }
              ]
            }
          ]
        },
        "rawData": {
          "stepKey": "adversary-cross-biz-read",
          "resultPayload": {
            "note": "Cross-biz read blocked for non-member account.",
            "evidence": {
              "adversaryUserId": "q3IubdOWEz1Egfb1eWoi2Xz4humcUfnf"
            }
          },
          "apiCalls": [
            {
              "method": "GET",
              "path": "/api/auth/get-session",
              "status": 200,
              "responseBody": {
                "session": {
                  "expiresAt": "2026-03-03T04:15:53.864Z",
                  "token": "lwboV66o8WhnfoFypqkeBDVUFZJOe6KC",
                  "createdAt": "2026-02-24T04:15:53.864Z",
                  "updatedAt": "2026-02-24T04:15:53.864Z",
                  "ipAddress": "",
                  "userAgent": "node",
                  "userId": "Yy3BdTZPyDPEvDwoMvg1j5VKklLYVNY8",
                  "activeOrganizationId": null,
                  "impersonatedBy": null,
                  "id": "YqKHfCMYsHM3rM1feiF4OAV2Qfj1CrRN"
                },
                "user": {
                  "name": "adversary-uc-113-the-solo-entrepreneur-sarah",
                  "email": "adversary-uc-113-the-solo-entrepreneur-sarah-1771906553575-4uv5io@example.com",
                  "emailVerified": false,
                  "image": null,
                  "createdAt": "2026-02-24T04:15:53.730Z",
                  "updatedAt": "2026-02-24T04:15:53.730Z",
                  "role": "user",
                  "banned": false,
                  "banReason": null,
                  "banExpires": null,
                  "id": "Yy3BdTZPyDPEvDwoMvg1j5VKklLYVNY8"
                }
              },
              "at": "2026-02-24T04:15:54.080Z"
            },
            {
              "method": "POST",
              "path": "/api/v1/sagas/runs/saga_run_3A6IKaWiVaZNZ0f5aHqEZeXvH0Q/snapshots",
              "status": 201,
              "requestBody": {
                "stepKey": "customer-two-concurrent",
                "screenKey": "customer-two-concurrent-1771906553733",
                "title": "Customer two performs concurrent booking attempt Snapshot",
                "status": "passed",
                "route": "/sagas/saga_run_3A6IKaWiVaZNZ0f5aHqEZeXvH0Q/customer-two-concurrent",
                "format": "json",
                "view": {
                  "title": "Customer two performs concurrent booking attempt",
                  "subtitle": "Second concurrent booking created.",
                  "blocks": [
                    {
                      "type": "alert",
                      "title": "Customer Two Concurrent completed",
                      "message": "Second concurrent booking created.",
                      "tone": "success"
                    },
                    {
                      "type": "key_value",
                      "title": "Booking confirmation",
                      "items": [
                        {
                          "label": "Booking id",
                          "value": "booking_order_3A6INQ9ueHJJDCk63XpVpnhvfUU"
                        },
                        {
                          "label": "Status",
                          "value": "confirmed"
                        },
                        {
                          "label": "Starts at",
                          "value": "2026-02-25T04:15:52.715Z"
                        },
                        {
                          "label": "Total",
                          "value": "15000"
                        }
                      ]
                    },
                    {
                      "type": "actions",
                      "title": "Visible actions",
                      "items": [
                        {
                          "label": "Download receipt",
                          "kind": "secondary",
                          "enabled": true
                        },
                        {
                          "label": "Reschedule",
                          "kind": "secondary",
                          "enabled": true
                        },
                        {
                          "label": "Cancel booking",
                          "kind": "danger",
                          "enabled": true
                        }
                      ]
                    },
                    {
                      "type": "stats",
                      "title": "What user sees at a glance",
                      "items": [
                        {
                          "label": "SubtotalMinor",
                          "value": "15000"
                        },
                        {
                          "label": "TaxMinor",
                          "value": "0"
                        },
                        {
                          "label": "FeeMinor",
                          "value": "0"
                        },
                        {
                          "label": "DiscountMinor",
                          "value": "0"
                        },
                        {
                          "label": "TotalMinor",
                          "value": "15000"
                        }
                      ]
                    },
                    {
                      "type": "key_value",
                      "title": "Screen details",
                      "items": [
                        {
                          "label": "Id",
                          "value": "booking_order_3A6INQ9ueHJJDCk63XpVpnhvfUU"
                        },
                        {
                          "label": "BizId",
                          "value": "3A6ILSOveOE0SYTCjIq5oodzMk0"
                        },
                        {
                          "label": "OfferId",
                          "value": "offer_3A6IMV8ZO2c7gD0Ac3F9khx8D11"
                        },
                        {
                          "label": "OfferVersionId",
                          "value": "offer_version_3A6IMmzt2B9ZLSXsnfA0xthXNet"
                        },
                        {
                          "label": "CustomerUserId",
                          "value": "tiQBia5Bl41Q6qftklK4mKHfIutIrMR8"
                        },
                        {
                          "label": "CustomerGroupAccountId",
                          "value": "null"
                        },
                        {
                          "label": "Status",
                          "value": "confirmed"
                        },
                        {
                          "label": "StatusConfigValueId",
                          "value": "null"
                        },
                        {
                          "label": "Currency",
                          "value": "USD"
                        },
                        {
                          "label": "SubtotalMinor",
                          "value": "15000"
                        },
                        {
                          "label": "TaxMinor",
                          "value": "0"
                        },
                        {
                          "label": "FeeMinor",
                          "value": "0"
                        },
                        {
                          "label": "DiscountMinor",
                          "value": "0"
                        },
                        {
                          "label": "TotalMinor",
                          "value": "15000"
                        },
                        {
                          "label": "RequestedStartAt",
                          "value": "2026-02-25T04:15:52.715Z"
                        },
                        {
                          "label": "RequestedEndAt",
                          "value": "2026-02-25T05:05:52.715Z"
                        }
                      ]
                    }
                  ]
                },
                "rawData": {
                  "stepKey": "customer-two-concurrent",
                  "resultPayload": {
                    "note": "Second concurrent booking created.",
                    "evidence": {
                      "id": "booking_order_3A6INQ9ueHJJDCk63XpVpnhvfUU",
                      "bizId": "3A6ILSOveOE0SYTCjIq5oodzMk0",
                      "offerId": "offer_3A6IMV8ZO2c7gD0Ac3F9khx8D11",
                      "offerVersionId": "offer_version_3A6IMmzt2B9ZLSXsnfA0xthXNet",
                      "customerUserId": "tiQBia5Bl41Q6qftklK4mKHfIutIrMR8",
                      "customerGroupAccountId": null,
                      "status": "confirmed",
                      "statusConfigValueId": null,
                      "currency": "USD",
                      "subtotalMinor": 15000,
                      "taxMinor": 0,
                      "feeMinor": 0,
                      "discountMinor": 0,
                      "totalMinor": 15000,
                      "requestedStartAt": "2026-02-25T04:15:52.715Z",
                      "requestedEndAt": "2026-02-25T05:05:52.715Z",
                      "confirmedStartAt": "2026-02-25T04:15:52.715Z",
                      "confirmedEndAt": "2026-02-25T05:05:52.715Z",
                      "pricingSnapshot": {},
                      "policySnapshot": {},
                      "metadata": {},
                      "createdAt": "2026-02-24T04:15:52.875Z",
                      "updatedAt": "2026-02-24T04:15:52.875Z",
                      "deletedAt": null,
                      "createdBy": null,
                      "updatedBy": null,
                      "deletedBy": null
                    }
                  },
                  "apiCalls": [
                    {
                      "method": "GET",
                      "path": "/api/auth/get-session",
                      "status": 200,
                      "responseBody": {
                        "session": {
                          "expiresAt": "2026-03-03T04:15:52.307Z",
                          "token": "jXho8AQ9IrrMQGT83LmDLkAtmEtJLhmq",
                          "createdAt": "2026-02-24T04:15:52.307Z",
                          "updatedAt": "2026-02-24T04:15:52.307Z",
                          "ipAddress": "",
                          "userAgent": "node",
                          "userId": "ACXDZQSzclXPm2ZbbveouIxhEUahmtzE",
                          "activeOrganizationId": null,
                          "impersonatedBy": null,
                          "id": "Tln7HVjdcaIOjrz6hC6QBmLaDh7Gb5w5"
                        },
                        "user": {
                          "name": "customer2-uc-114-the-solo-entrepreneur-sarah",
                          "email": "customer2-uc-114-the-solo-entrepreneur-sarah-1771906552026-dbia0s@example.com",
                          "emailVerified": false,
                          "image": null,
                          "createdAt": "2026-02-24T04:15:52.246Z",
                          "updatedAt": "2026-02-24T04:15:52.246Z",
                          "role": "user",
                          "banned": false,
                          "banReason": null,
                          "banExpires": null,
                          "id": "ACXDZQSzclXPm2ZbbveouIxhEUahmtzE"
                        }
                      },
                      "at": "2026-02-24T04:15:52.530Z"
                    },
                    {
                      "method": "POST",
                      "path": "/api/v1/public/bizes/3A6ILQjy8cIAjN2g9MXt4LdlISQ/booking-orders",
                      "status": 201,
                      "requestBody": {
                        "offerId": "offer_3A6IMYS7IU5J6UA21yTZiFyLnQx",
                        "offerVersionId": "offer_version_3A6IMcJbnIe2iKaRmh3WwxhDqJf",
                        "customerUserId": "5PcSPmpUF4IASCH2nTISOWN86cxqdZ0a",
                        "status": "confirmed",
                        "subtotalMinor": 15000,
                        "taxMinor": 0,
                        "feeMinor": 0,
                        "discountMinor": 0,
                        "totalMinor": 15000,
                        "currency": "USD",
                        "requestedStartAt": "2026-02-25T04:15:52.316Z",
                        "requestedEndAt": "2026-02-25T05:05:52.316Z",
                        "confirmedStartAt": "2026-02-25T04:15:52.316Z",
                        "confirmedEndAt": "2026-02-25T05:05:52.316Z"
                      },
                      "responseBody": {
                        "success": true,
                        "data": {
                          "id": "booking_order_3A6INPVjCp0dcUr8Uv9pbEMnjpw",
                          "bizId": "3A6ILQjy8cIAjN2g9MXt4LdlISQ",
                          "offerId": "offer_3A6IMYS7IU5J6UA21yTZiFyLnQx",
                          "offerVersionId": "offer_version_3A6IMcJbnIe2iKaRmh3WwxhDqJf",
                          "customerUserId": "5PcSPmpUF4IASCH2nTISOWN86cxqdZ0a",
                          "customerGroupAccountId": null,
                          "status": "confirmed",
                          "statusConfigValueId": null,
                          "currency": "USD",
                          "subtotalMinor": 15000,
                          "taxMinor": 0,
                          "feeMinor": 0,
                          "discountMinor": 0,
                          "totalMinor": 15000,
                          "requestedStartAt": "2026-02-25T04:15:52.316Z",
                          "requestedEndAt": "2026-02-25T05:05:52.316Z",
                          "confirmedStartAt": "2026-02-25T04:15:52.316Z",
                          "confirmedEndAt": "2026-02-25T05:05:52.316Z",
                          "pricingSnapshot": {},
                          "policySnapshot": {},
                          "metadata": {},
                          "createdAt": "2026-02-24T04:15:52.600Z",
                          "updatedAt": "2026-02-24T04:15:52.600Z",
                          "deletedAt": null,
                          "createdBy": null,
                          "updatedBy": null,
                          "deletedBy": null
                        },
                        "meta": {
                          "requestId": "cd7ecbf0-97e5-4158-8306-dbf6e1aaff75",
                          "timestamp": "2026-02-24T04:15:52.598Z"
                        }
                      },
                      "at": "2026-02-24T04:15:52.600Z"
                    }
                  ]
                }
              },
              "responseBody": {
                "success": true,
                "data": {
                  "id": "saga_artifact_3A6INjAFlIL001Eq1tQ4lF0ZTlL",
                  "sagaRunId": "saga_run_3A6IKaWiVaZNZ0f5aHqEZeXvH0Q",
                  "sagaRunStepId": "saga_run_step_3A6IKWKjlQnqwi28tS7N8JUYpiJ",
                  "artifactType": "snapshot",
                  "title": "Customer two performs concurrent booking attempt Snapshot",
                  "storagePath": "testing/sagas/runs/saga_run_3A6IKaWiVaZNZ0f5aHqEZeXvH0Q/snapshots/2026-02-24T04-15-53-935Z-customer-two-concurrent-1771906553733.json",
                  "contentType": "application/json",
                  "byteSize": 8690,
                  "checksum": "527cd8332150380b1dae595cf6e77807b9f4eb802f14753a00ee41657eb55d79",
                  "capturedAt": "2026-02-24T04:15:54.081Z",
                  "metadata": {
                    "format": "json",
                    "stepKey": "customer-two-concurrent",
                    "screenKey": "customer-two-concurrent-1771906553733",
                    "sourceFormat": "v1",
                    "schemaVersion": "snapshot.v1"
                  },
                  "createdAt": "2026-02-24T04:15:54.081Z",
                  "updatedAt": "2026-02-24T04:15:54.081Z",
                  "deletedAt": null,
                  "createdBy": null,
                  "updatedBy": null,
                  "deletedBy": null
                },
                "meta": {
                  "requestId": "f9e5f9e0-9971-43d6-84c0-9d807756bf12",
                  "timestamp": "2026-02-24T04:15:54.079Z"
                }
              },
              "at": "2026-02-24T04:15:54.082Z"
            }
          ]
        }
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "saga_artifact_3A6INl0JLn85fTwYCRn6nXO5duK",
          "sagaRunId": "saga_run_3A6IKZkEowpsWqNXJu6kvjLDMWa",
          "sagaRunStepId": "saga_run_step_3A6IKaqvxqUkDxFxLEP0Ez6hoeE",
          "artifactType": "snapshot",
          "title": "Adversary attempts unauthorized cross-biz read Snapshot",
          "storagePath": "testing/sagas/runs/saga_run_3A6IKZkEowpsWqNXJu6kvjLDMWa/snapshots/2026-02-24T04-15-55-308Z-adversary-cross-biz-read-1771906555207.json",
          "contentType": "application/json",
          "byteSize": 15039,
          "checksum": "3dce7aceffc737fabf00afe5f3ccb1a8d3965862994af5b040f7e0078858e8b2",
          "capturedAt": "2026-02-24T04:15:55.381Z",
          "metadata": {
            "format": "json",
            "stepKey": "adversary-cross-biz-read",
            "screenKey": "adversary-cross-biz-read-1771906555207",
            "sourceFormat": "v1",
            "schemaVersion": "snapshot.v1"
          },
          "createdAt": "2026-02-24T04:15:55.381Z",
          "updatedAt": "2026-02-24T04:15:55.381Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "f5aa75df-e66a-4953-9553-c7f1732f3d7a",
          "timestamp": "2026-02-24T04:15:55.384Z"
        }
      },
      "at": "2026-02-24T04:15:55.394Z"
    }
  ]
}
