{
  "schemaVersion": "snapshot.v1",
  "screenKey": "adversary-hold-abuse-1771905843866",
  "title": "Adversary attempts demand/hold abuse Snapshot",
  "generatedAt": "2026-02-24T04:04:03.959Z",
  "stepKey": "adversary-hold-abuse",
  "status": "passed",
  "view": {
    "title": "Adversary attempts demand/hold abuse",
    "subtitle": "Repeated unauthorized hold attempts were blocked (403).",
    "blocks": [
      {
        "type": "alert",
        "title": "Adversary Hold Abuse completed",
        "message": "Repeated unauthorized hold attempts were blocked (403).",
        "tone": "success"
      }
    ]
  },
  "rawData": {
    "stepKey": "adversary-hold-abuse",
    "resultPayload": {
      "note": "Repeated unauthorized hold attempts were blocked (403)."
    },
    "apiCalls": [
      {
        "method": "POST",
        "path": "/api/v1/bizes/3A6GuDB1PlQ1UWilh5OyIx3eqE4/booking-orders",
        "status": 403,
        "requestBody": {
          "offerId": "offer_3A6GvCvWkVoJDXc2z92tzZucwkZ",
          "offerVersionId": "offer_version_3A6GvGb07yr08XzFETzNwtsaDUS",
          "status": "draft",
          "subtotalMinor": 1000,
          "taxMinor": 0,
          "feeMinor": 0,
          "discountMinor": 0,
          "totalMinor": 1000,
          "currency": "USD"
        },
        "responseBody": {
          "success": false,
          "error": {
            "code": "FORBIDDEN",
            "message": "You are not a member of this biz."
          },
          "meta": {
            "requestId": "0ba8e44f-b6ff-491d-8664-dcd670b85caf",
            "timestamp": "2026-02-24T04:04:03.064Z"
          }
        },
        "at": "2026-02-24T04:04:03.066Z"
      },
      {
        "method": "POST",
        "path": "/api/v1/bizes/3A6GuAbkkxOrDBlFOahHQAjkFdE/booking-orders",
        "status": 403,
        "requestBody": {
          "offerId": "offer_3A6GvCaQAWdcmnbU2tY4q84HQbI",
          "offerVersionId": "offer_version_3A6GvHeTjzgHLzhT5FaJQrubeFv",
          "status": "draft",
          "subtotalMinor": 1000,
          "taxMinor": 0,
          "feeMinor": 0,
          "discountMinor": 0,
          "totalMinor": 1000,
          "currency": "USD"
        },
        "responseBody": {
          "success": false,
          "error": {
            "code": "FORBIDDEN",
            "message": "You are not a member of this biz."
          },
          "meta": {
            "requestId": "c9aa76f6-d3d3-4b68-bc33-ad4edfa8d8b7",
            "timestamp": "2026-02-24T04:04:03.082Z"
          }
        },
        "at": "2026-02-24T04:04:03.083Z"
      },
      {
        "method": "POST",
        "path": "/api/v1/bizes/3A6Gu8csqgCjAxeQmTh7ukNWHYK/booking-orders",
        "status": 403,
        "requestBody": {
          "offerId": "offer_3A6Gv89HgMcplGQgQrIiHodikXn",
          "offerVersionId": "offer_version_3A6GvNRDHcku3iAWvKwlS5fJead",
          "status": "draft",
          "subtotalMinor": 1000,
          "taxMinor": 0,
          "feeMinor": 0,
          "discountMinor": 0,
          "totalMinor": 1000,
          "currency": "USD"
        },
        "responseBody": {
          "success": false,
          "error": {
            "code": "FORBIDDEN",
            "message": "You are not a member of this biz."
          },
          "meta": {
            "requestId": "a546d636-d375-4bc7-a07a-c9454ad10efd",
            "timestamp": "2026-02-24T04:04:03.127Z"
          }
        },
        "at": "2026-02-24T04:04:03.127Z"
      },
      {
        "method": "POST",
        "path": "/api/v1/bizes/3A6Gu9M6p3LqZXYG45MselYfuMF/booking-orders",
        "status": 403,
        "requestBody": {
          "offerId": "offer_3A6GvBRXKlcwM98vtI3ISZclpqI",
          "offerVersionId": "offer_version_3A6GvGJMqxAPnhvlRvB6Z6cxw88",
          "status": "draft",
          "subtotalMinor": 1000,
          "taxMinor": 0,
          "feeMinor": 0,
          "discountMinor": 0,
          "totalMinor": 1000,
          "currency": "USD"
        },
        "responseBody": {
          "success": false,
          "error": {
            "code": "FORBIDDEN",
            "message": "You are not a member of this biz."
          },
          "meta": {
            "requestId": "b54db889-7b2c-4de6-aa50-3702df33be77",
            "timestamp": "2026-02-24T04:04:03.146Z"
          }
        },
        "at": "2026-02-24T04:04:03.147Z"
      },
      {
        "method": "POST",
        "path": "/api/v1/sagas/runs/saga_run_3A6Gtdie4siiklmhkYjeifO2yAn/steps/adversary-cross-biz-read/result",
        "status": 200,
        "requestBody": {
          "status": "passed",
          "startedAt": "2026-02-24T04:04:02.552Z",
          "endedAt": "2026-02-24T04:04:02.552Z",
          "failureMessage": null,
          "resultPayload": {
            "note": "Cross-biz read blocked for non-member account.",
            "evidence": {
              "adversaryUserId": "YzEl1cxT5HvN8zvmv89dRiROX95mdFfD"
            },
            "apiCalls": [
              {
                "method": "GET",
                "path": "/api/auth/get-session",
                "status": 200,
                "responseBody": {
                  "session": {
                    "expiresAt": "2026-03-03T04:04:01.950Z",
                    "token": "AJKLccR44BM4ucO0r3Q3sICMOSkFmQ0q",
                    "createdAt": "2026-02-24T04:04:01.950Z",
                    "updatedAt": "2026-02-24T04:04:01.950Z",
                    "ipAddress": "",
                    "userAgent": "node",
                    "userId": "9g8IwYAW7f5GanmvU9Zfsp9bpZOcvFmM",
                    "activeOrganizationId": null,
                    "impersonatedBy": null,
                    "id": "MmADxZctuxRUIBksyqp8i3RhUrlTa2BG"
                  },
                  "user": {
                    "name": "adversary-uc-101-the-solo-entrepreneur-sarah",
                    "email": "adversary-uc-101-the-solo-entrepreneur-sarah-1771905841482-87g2vw@example.com",
                    "emailVerified": false,
                    "image": null,
                    "createdAt": "2026-02-24T04:04:01.882Z",
                    "updatedAt": "2026-02-24T04:04:01.882Z",
                    "role": "user",
                    "banned": false,
                    "banReason": null,
                    "banExpires": null,
                    "id": "9g8IwYAW7f5GanmvU9Zfsp9bpZOcvFmM"
                  }
                },
                "at": "2026-02-24T04:04:02.101Z"
              },
              {
                "method": "GET",
                "path": "/api/v1/bizes/3A6Gu8csqgCjAxeQmTh7ukNWHYK/booking-orders",
                "status": 403,
                "responseBody": {
                  "success": false,
                  "error": {
                    "code": "FORBIDDEN",
                    "message": "You are not a member of this biz."
                  },
                  "meta": {
                    "requestId": "17c05a1b-794f-45cc-adcf-3fe95dfa9c75",
                    "timestamp": "2026-02-24T04:04:02.133Z"
                  }
                },
                "at": "2026-02-24T04:04:02.134Z"
              }
            ]
          },
          "assertionSummary": {
            "status": "passed",
            "hasFailure": false,
            "assertionsPassed": 1
          }
        },
        "responseBody": {
          "success": true,
          "data": {
            "id": "saga_run_step_3A6GtjUjdR2ituA2QPTKjuBiUUJ",
            "sagaRunId": "saga_run_3A6Gtdie4siiklmhkYjeifO2yAn",
            "phaseKey": "security-and-abuse",
            "phaseOrder": 6,
            "phaseTitle": "Security And Abuse Checks",
            "stepKey": "adversary-cross-biz-read",
            "stepOrder": 14,
            "actorKey": "adversary",
            "instruction": "Using credentials from another context, attempt to read or mutate booking/order resources for this biz.",
            "expectedResult": "Request is rejected with forbidden/unauthorized error and no data leakage.",
            "status": "passed",
            "attemptCount": 1,
            "startedAt": "2026-02-24T04:04:02.552Z",
            "endedAt": "2026-02-24T04:04:02.552Z",
            "failureCode": null,
            "failureMessage": null,
            "resultPayload": {
              "note": "Cross-biz read blocked for non-member account.",
              "apiCalls": [
                {
                  "at": "2026-02-24T04:04:02.101Z",
                  "path": "/api/auth/get-session",
                  "method": "GET",
                  "status": 200,
                  "responseBody": {
                    "user": {
                      "id": "9g8IwYAW7f5GanmvU9Zfsp9bpZOcvFmM",
                      "name": "adversary-uc-101-the-solo-entrepreneur-sarah",
                      "role": "user",
                      "email": "adversary-uc-101-the-solo-entrepreneur-sarah-1771905841482-87g2vw@example.com",
                      "image": null,
                      "banned": false,
                      "banReason": null,
                      "createdAt": "2026-02-24T04:04:01.882Z",
                      "updatedAt": "2026-02-24T04:04:01.882Z",
                      "banExpires": null,
                      "emailVerified": false
                    },
                    "session": {
                      "id": "MmADxZctuxRUIBksyqp8i3RhUrlTa2BG",
                      "token": "AJKLccR44BM4ucO0r3Q3sICMOSkFmQ0q",
                      "userId": "9g8IwYAW7f5GanmvU9Zfsp9bpZOcvFmM",
                      "createdAt": "2026-02-24T04:04:01.950Z",
                      "expiresAt": "2026-03-03T04:04:01.950Z",
                      "ipAddress": "",
                      "updatedAt": "2026-02-24T04:04:01.950Z",
                      "userAgent": "node",
                      "impersonatedBy": null,
                      "activeOrganizationId": null
                    }
                  }
                },
                {
                  "at": "2026-02-24T04:04:02.134Z",
                  "path": "/api/v1/bizes/3A6Gu8csqgCjAxeQmTh7ukNWHYK/booking-orders",
                  "method": "GET",
                  "status": 403,
                  "responseBody": {
                    "meta": {
                      "requestId": "17c05a1b-794f-45cc-adcf-3fe95dfa9c75",
                      "timestamp": "2026-02-24T04:04:02.133Z"
                    },
                    "error": {
                      "code": "FORBIDDEN",
                      "message": "You are not a member of this biz."
                    },
                    "success": false
                  }
                }
              ],
              "evidence": {
                "adversaryUserId": "YzEl1cxT5HvN8zvmv89dRiROX95mdFfD"
              }
            },
            "assertionSummary": {
              "status": "passed",
              "hasFailure": false,
              "assertionsPassed": 1
            },
            "metadata": {},
            "createdAt": "2026-02-24T04:03:42.676Z",
            "updatedAt": "2026-02-24T04:03:42.676Z",
            "deletedAt": null,
            "createdBy": null,
            "updatedBy": null,
            "deletedBy": null
          },
          "meta": {
            "requestId": "01afd21d-c0fd-4b1f-b923-e35ba3df8339",
            "timestamp": "2026-02-24T04:04:03.164Z"
          }
        },
        "at": "2026-02-24T04:04:03.165Z"
      },
      {
        "method": "POST",
        "path": "/api/v1/bizes/3A6GuDB1PlQ1UWilh5OyIx3eqE4/booking-orders",
        "status": 403,
        "requestBody": {
          "offerId": "offer_3A6GvCvWkVoJDXc2z92tzZucwkZ",
          "offerVersionId": "offer_version_3A6GvGb07yr08XzFETzNwtsaDUS",
          "status": "draft",
          "subtotalMinor": 1000,
          "taxMinor": 0,
          "feeMinor": 0,
          "discountMinor": 0,
          "totalMinor": 1000,
          "currency": "USD"
        },
        "responseBody": {
          "success": false,
          "error": {
            "code": "FORBIDDEN",
            "message": "You are not a member of this biz."
          },
          "meta": {
            "requestId": "302b0ef1-9d2c-421c-81de-61ce5d5e1c91",
            "timestamp": "2026-02-24T04:04:03.171Z"
          }
        },
        "at": "2026-02-24T04:04:03.172Z"
      },
      {
        "method": "POST",
        "path": "/api/v1/bizes/3A6GuAbkkxOrDBlFOahHQAjkFdE/booking-orders",
        "status": 403,
        "requestBody": {
          "offerId": "offer_3A6GvCaQAWdcmnbU2tY4q84HQbI",
          "offerVersionId": "offer_version_3A6GvHeTjzgHLzhT5FaJQrubeFv",
          "status": "draft",
          "subtotalMinor": 1000,
          "taxMinor": 0,
          "feeMinor": 0,
          "discountMinor": 0,
          "totalMinor": 1000,
          "currency": "USD"
        },
        "responseBody": {
          "success": false,
          "error": {
            "code": "FORBIDDEN",
            "message": "You are not a member of this biz."
          },
          "meta": {
            "requestId": "1bebafdb-a5d7-4386-8efc-d5ba21d4592e",
            "timestamp": "2026-02-24T04:04:03.182Z"
          }
        },
        "at": "2026-02-24T04:04:03.182Z"
      },
      {
        "method": "POST",
        "path": "/api/v1/bizes/3A6Gu8csqgCjAxeQmTh7ukNWHYK/booking-orders",
        "status": 403,
        "requestBody": {
          "offerId": "offer_3A6Gv89HgMcplGQgQrIiHodikXn",
          "offerVersionId": "offer_version_3A6GvNRDHcku3iAWvKwlS5fJead",
          "status": "draft",
          "subtotalMinor": 1000,
          "taxMinor": 0,
          "feeMinor": 0,
          "discountMinor": 0,
          "totalMinor": 1000,
          "currency": "USD"
        },
        "responseBody": {
          "success": false,
          "error": {
            "code": "FORBIDDEN",
            "message": "You are not a member of this biz."
          },
          "meta": {
            "requestId": "f465496c-937e-4954-9335-a362def1914c",
            "timestamp": "2026-02-24T04:04:03.221Z"
          }
        },
        "at": "2026-02-24T04:04:03.222Z"
      },
      {
        "method": "POST",
        "path": "/api/v1/bizes/3A6Gu9M6p3LqZXYG45MselYfuMF/booking-orders",
        "status": 403,
        "requestBody": {
          "offerId": "offer_3A6GvBRXKlcwM98vtI3ISZclpqI",
          "offerVersionId": "offer_version_3A6GvGJMqxAPnhvlRvB6Z6cxw88",
          "status": "draft",
          "subtotalMinor": 1000,
          "taxMinor": 0,
          "feeMinor": 0,
          "discountMinor": 0,
          "totalMinor": 1000,
          "currency": "USD"
        },
        "responseBody": {
          "success": false,
          "error": {
            "code": "FORBIDDEN",
            "message": "You are not a member of this biz."
          },
          "meta": {
            "requestId": "f118088d-6f3e-46e7-bfb1-5c94c2625ee7",
            "timestamp": "2026-02-24T04:04:03.244Z"
          }
        },
        "at": "2026-02-24T04:04:03.245Z"
      },
      {
        "method": "POST",
        "path": "/api/v1/bizes/3A6GuDB1PlQ1UWilh5OyIx3eqE4/booking-orders",
        "status": 403,
        "requestBody": {
          "offerId": "offer_3A6GvCvWkVoJDXc2z92tzZucwkZ",
          "offerVersionId": "offer_version_3A6GvGb07yr08XzFETzNwtsaDUS",
          "status": "draft",
          "subtotalMinor": 1000,
          "taxMinor": 0,
          "feeMinor": 0,
          "discountMinor": 0,
          "totalMinor": 1000,
          "currency": "USD"
        },
        "responseBody": {
          "success": false,
          "error": {
            "code": "FORBIDDEN",
            "message": "You are not a member of this biz."
          },
          "meta": {
            "requestId": "43fa72ce-d144-4b75-a83c-0aa07236af86",
            "timestamp": "2026-02-24T04:04:03.271Z"
          }
        },
        "at": "2026-02-24T04:04:03.271Z"
      }
    ]
  },
  "metadata": {}
}
