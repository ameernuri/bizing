{
  "stepKey": "adversary-hold-abuse",
  "callCount": 7,
  "calls": [
    {
      "method": "POST",
      "path": "/api/v1/sagas/runs/saga_run_3A7WvKijv6LtRXQDiltSZMJlIJL/steps/adversary-cross-biz-read/result",
      "status": 200,
      "requestBody": {
        "status": "passed",
        "startedAt": "2026-02-24T14:45:57.446Z",
        "endedAt": "2026-02-24T14:45:57.446Z",
        "failureMessage": null,
        "resultPayload": {
          "note": "Cross-biz read blocked for non-member account.",
          "evidence": {
            "adversaryUserId": "bDNMhcFykeLZijAWy5dpO1yTVueFah2A"
          }
        },
        "assertionSummary": {
          "status": "passed",
          "hasFailure": false,
          "assertionsPassed": 1
        }
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "saga_run_step_3A7WvLDOLMQ1AliW5THlKCO4WYk",
          "sagaRunId": "saga_run_3A7WvKijv6LtRXQDiltSZMJlIJL",
          "phaseKey": "security-and-abuse",
          "phaseOrder": 6,
          "phaseTitle": "Security And Abuse Checks",
          "stepKey": "adversary-cross-biz-read",
          "stepOrder": 14,
          "actorKey": "adversary",
          "instruction": "Using credentials from another context, attempt to read or mutate booking/order resources for this biz.",
          "expectedResult": "Request is rejected with forbidden/unauthorized error and no data leakage.",
          "status": "passed",
          "attemptCount": 1,
          "startedAt": "2026-02-24T14:45:57.446Z",
          "endedAt": "2026-02-24T14:45:57.446Z",
          "failureCode": null,
          "failureMessage": null,
          "resultPayload": {
            "note": "Cross-biz read blocked for non-member account.",
            "evidence": {
              "adversaryUserId": "bDNMhcFykeLZijAWy5dpO1yTVueFah2A"
            }
          },
          "assertionSummary": {
            "status": "passed",
            "hasFailure": false,
            "assertionsPassed": 1
          },
          "metadata": {},
          "createdAt": "2026-02-24T14:45:18.909Z",
          "updatedAt": "2026-02-24T14:45:18.909Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "afe5056a-2603-4428-ac4f-aa6981bfe8ab",
          "timestamp": "2026-02-24T14:45:58.384Z"
        }
      },
      "at": "2026-02-24T14:45:58.385Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/sagas/runs/saga_run_3A7WvQqgPRmFgzuklwjgGS2epgI/steps/adversary-cross-biz-read/result",
      "status": 200,
      "requestBody": {
        "status": "passed",
        "startedAt": "2026-02-24T14:45:57.416Z",
        "endedAt": "2026-02-24T14:45:57.416Z",
        "failureMessage": null,
        "resultPayload": {
          "note": "Cross-biz read blocked for non-member account.",
          "evidence": {
            "adversaryUserId": "vVQdh0fPYOJnASLVSgV4FUUrhH45ghjH"
          }
        },
        "assertionSummary": {
          "status": "passed",
          "hasFailure": false,
          "assertionsPassed": 1
        }
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "saga_run_step_3A7WvOBT28kzOOhPipcm4YUjMDI",
          "sagaRunId": "saga_run_3A7WvQqgPRmFgzuklwjgGS2epgI",
          "phaseKey": "security-and-abuse",
          "phaseOrder": 6,
          "phaseTitle": "Security And Abuse Checks",
          "stepKey": "adversary-cross-biz-read",
          "stepOrder": 14,
          "actorKey": "adversary",
          "instruction": "Using credentials from another context, attempt to read or mutate booking/order resources for this biz.",
          "expectedResult": "Request is rejected with forbidden/unauthorized error and no data leakage.",
          "status": "passed",
          "attemptCount": 1,
          "startedAt": "2026-02-24T14:45:57.416Z",
          "endedAt": "2026-02-24T14:45:57.416Z",
          "failureCode": null,
          "failureMessage": null,
          "resultPayload": {
            "note": "Cross-biz read blocked for non-member account.",
            "evidence": {
              "adversaryUserId": "vVQdh0fPYOJnASLVSgV4FUUrhH45ghjH"
            }
          },
          "assertionSummary": {
            "status": "passed",
            "hasFailure": false,
            "assertionsPassed": 1
          },
          "metadata": {},
          "createdAt": "2026-02-24T14:45:18.516Z",
          "updatedAt": "2026-02-24T14:45:18.516Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "00b6dcc9-e524-454a-8954-3c232a59bb95",
          "timestamp": "2026-02-24T14:45:58.413Z"
        }
      },
      "at": "2026-02-24T14:45:58.413Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/bizes/3A7Ww4cmicns4I9Ig54ugY3Ana7/booking-orders",
      "status": 403,
      "requestBody": {
        "offerId": "offer_3A7Wy2lvxdysKUbakDgLo6A3B3G",
        "offerVersionId": "offer_version_3A7WyGC1TWTMAGEdNb28tkmsMqS",
        "status": "draft",
        "subtotalMinor": 1000,
        "taxMinor": 0,
        "feeMinor": 0,
        "discountMinor": 0,
        "totalMinor": 1000,
        "currency": "USD"
      },
      "responseBody": {
        "success": false,
        "error": {
          "code": "FORBIDDEN",
          "message": "You are not a member of this biz."
        },
        "meta": {
          "requestId": "a0ca0b77-bed2-4ed6-9adf-262e3335d768",
          "timestamp": "2026-02-24T14:45:58.495Z"
        }
      },
      "at": "2026-02-24T14:45:58.496Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/sagas/runs/saga_run_3A7WvOs8vRoVye936Yu1g65csUe/traces",
      "status": 201,
      "requestBody": {
        "stepKey": "adversary-hold-abuse",
        "title": "Adversary attempts demand/hold abuse API Trace",
        "trace": {
          "stepKey": "adversary-hold-abuse",
          "callCount": 1,
          "calls": [
            {
              "method": "POST",
              "path": "/api/v1/bizes/3A7Ww6Rm0WzIwjr3H7ziPYULIxk/booking-orders",
              "status": 403,
              "requestBody": {
                "offerId": "offer_3A7WxtkMbzZYv1JP7hawG6srqCR",
                "offerVersionId": "offer_version_3A7Wy6qHTx1r4geFy1I3JTGrMyL",
                "status": "draft",
                "subtotalMinor": 1000,
                "taxMinor": 0,
                "feeMinor": 0,
                "discountMinor": 0,
                "totalMinor": 1000,
                "currency": "USD"
              },
              "responseBody": {
                "success": false,
                "error": {
                  "code": "FORBIDDEN",
                  "message": "You are not a member of this biz."
                },
                "meta": {
                  "requestId": "029fd2e4-0618-4345-b869-0096276ae6dd",
                  "timestamp": "2026-02-24T14:45:57.659Z"
                }
              },
              "at": "2026-02-24T14:45:57.659Z"
            }
          ]
        },
        "metadata": {
          "source": "rerun-sagas.ts"
        }
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "saga_artifact_3A7X0LxkKRfXs84FW1YpsDXpHzt",
          "sagaRunId": "saga_run_3A7WvOs8vRoVye936Yu1g65csUe",
          "sagaRunStepId": "saga_run_step_3A7WvKIgva6OeTvIDvl9oxnwr9T",
          "artifactType": "api_trace",
          "title": "Adversary attempts demand/hold abuse API Trace",
          "storagePath": "testing/sagas/runs/saga_run_3A7WvOs8vRoVye936Yu1g65csUe/artifacts/1771944358119-Adversary_attempts_demand_hold_abuse_API_Trace.json",
          "contentType": "application/json",
          "bodyText": "{\n  \"stepKey\": \"adversary-hold-abuse\",\n  \"callCount\": 1,\n  \"calls\": [\n    {\n      \"method\": \"POST\",\n      \"path\": \"/api/v1/bizes/3A7Ww6Rm0WzIwjr3H7ziPYULIxk/booking-orders\",\n      \"status\": 403,\n      \"requestBody\": {\n        \"offerId\": \"offer_3A7WxtkMbzZYv1JP7hawG6srqCR\",\n        \"offerVersionId\": \"offer_version_3A7Wy6qHTx1r4geFy1I3JTGrMyL\",\n        \"status\": \"draft\",\n        \"subtotalMinor\": 1000,\n        \"taxMinor\": 0,\n        \"feeMinor\": 0,\n        \"discountMinor\": 0,\n        \"totalMinor\": 1000,\n        \"currency\": \"USD\"\n      },\n      \"responseBody\": {\n        \"success\": false,\n        \"error\": {\n          \"code\": \"FORBIDDEN\",\n          \"message\": \"You are not a member of this biz.\"\n        },\n        \"meta\": {\n          \"requestId\": \"029fd2e4-0618-4345-b869-0096276ae6dd\",\n          \"timestamp\": \"2026-02-24T14:45:57.659Z\"\n        }\n      },\n      \"at\": \"2026-02-24T14:45:57.659Z\"\n    }\n  ]\n}\n",
          "byteSize": 909,
          "checksum": "e4789c38b0432831f0c8a6327b74a2e507a03d3c485af660c6f93338f3febcda",
          "capturedAt": "2026-02-24T14:45:58.203Z",
          "metadata": {
            "source": "rerun-sagas.ts"
          },
          "createdAt": "2026-02-24T14:45:58.203Z",
          "updatedAt": "2026-02-24T14:45:58.203Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "703dd77c-22f8-419b-be8e-9fed4e814b4b",
          "timestamp": "2026-02-24T14:45:58.513Z"
        }
      },
      "at": "2026-02-24T14:45:58.514Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/sagas/runs/saga_run_3A7Wv0Xc21YPvo4nhoX11NnntcX/steps/adversary-hold-abuse/result",
      "status": 200,
      "requestBody": {
        "status": "in_progress",
        "startedAt": "2026-02-24T14:45:58.097Z",
        "resultPayload": {
          "note": "Started adversary-hold-abuse"
        },
        "assertionSummary": {
          "status": "in_progress"
        }
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "saga_run_step_3A7WvABL7Vq7hYP5iKjgCInVOPg",
          "sagaRunId": "saga_run_3A7Wv0Xc21YPvo4nhoX11NnntcX",
          "phaseKey": "security-and-abuse",
          "phaseOrder": 6,
          "phaseTitle": "Security And Abuse Checks",
          "stepKey": "adversary-hold-abuse",
          "stepOrder": 16,
          "actorKey": "adversary",
          "instruction": "Trigger repeated booking/hold-like attempts to validate throttling, expiry, or non-blocking demand visibility behavior.",
          "expectedResult": "Abusive attempts are rate-limited or isolated without blocking legitimate customer flow.",
          "status": "in_progress",
          "attemptCount": 1,
          "startedAt": "2026-02-24T14:45:58.097Z",
          "endedAt": null,
          "failureCode": null,
          "failureMessage": null,
          "resultPayload": {
            "note": "Started adversary-hold-abuse"
          },
          "assertionSummary": {
            "status": "in_progress"
          },
          "metadata": {},
          "createdAt": "2026-02-24T14:45:16.058Z",
          "updatedAt": "2026-02-24T14:45:16.058Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "fb6cf41d-7c73-4d95-a957-b4ff5a9d497d",
          "timestamp": "2026-02-24T14:45:58.576Z"
        }
      },
      "at": "2026-02-24T14:45:58.577Z"
    },
    {
      "method": "POST",
      "path": "/api/v1/bizes/3A7Ww4cmicns4I9Ig54ugY3Ana7/booking-orders",
      "status": 403,
      "requestBody": {
        "offerId": "offer_3A7Wy2lvxdysKUbakDgLo6A3B3G",
        "offerVersionId": "offer_version_3A7WyGC1TWTMAGEdNb28tkmsMqS",
        "status": "draft",
        "subtotalMinor": 1000,
        "taxMinor": 0,
        "feeMinor": 0,
        "discountMinor": 0,
        "totalMinor": 1000,
        "currency": "USD"
      },
      "responseBody": {
        "success": false,
        "error": {
          "code": "FORBIDDEN",
          "message": "You are not a member of this biz."
        },
        "meta": {
          "requestId": "35523ae3-341d-42e8-84cd-0027eb8e87f9",
          "timestamp": "2026-02-24T14:45:58.595Z"
        }
      },
      "at": "2026-02-24T14:45:58.596Z"
    },
    {
      "method": "PATCH",
      "path": "/api/v1/bizes/3A7Ww9Ns02NNeKGFDfgPBKPXG0T/booking-orders/booking_order_3A7WzMVqrAsmHt2H6PzTmW0Z8em/status",
      "status": 200,
      "requestBody": {
        "status": "in_progress"
      },
      "responseBody": {
        "success": true,
        "data": {
          "id": "booking_order_3A7WzMVqrAsmHt2H6PzTmW0Z8em",
          "bizId": "3A7Ww9Ns02NNeKGFDfgPBKPXG0T",
          "offerId": "offer_3A7WxsSYQHbyfMUH1ioFRoSz8FE",
          "offerVersionId": "offer_version_3A7Wy57HWiwtijp314TslSDggPH",
          "customerUserId": "WIlroS72quBUm2MCN4m2nDdmpEQKgZRE",
          "customerGroupAccountId": null,
          "status": "in_progress",
          "statusConfigValueId": null,
          "currency": "USD",
          "subtotalMinor": 15000,
          "taxMinor": 0,
          "feeMinor": 0,
          "discountMinor": 0,
          "totalMinor": 15000,
          "requestedStartAt": "2026-02-25T14:45:50.172Z",
          "requestedEndAt": "2026-02-25T15:35:50.172Z",
          "confirmedStartAt": "2026-02-25T14:45:50.172Z",
          "confirmedEndAt": "2026-02-25T15:35:50.172Z",
          "pricingSnapshot": {},
          "policySnapshot": {},
          "metadata": {},
          "createdAt": "2026-02-24T14:45:50.352Z",
          "updatedAt": "2026-02-24T14:45:50.352Z",
          "deletedAt": null,
          "createdBy": null,
          "updatedBy": null,
          "deletedBy": null
        },
        "meta": {
          "requestId": "44e0cb4f-1805-4d41-90f2-a8b69f8b773c",
          "timestamp": "2026-02-24T14:45:58.625Z"
        }
      },
      "at": "2026-02-24T14:45:58.625Z"
    }
  ]
}
