{
  "schemaVersion": "saga.v0",
  "sagaKey": "uc-141-the-franchisee-priya",
  "title": "UC-141 • The Employee Timesheet with Clock-In/Clock-Out • The Franchisee (Priya)",
  "description": "Comprehensive lifecycle saga derived from UC-141 and persona P-6. Needs summary: Mobile clock-in/clock-out with GPS location capture; Geofencing (must be within X feet of job site to clock in); Photo verification (optional selfie for attendance proof); Automatic break deduction or explicit break tracking; Job code/task selection (which project/client); Shift notes (what was accomplished); Overtime calculation rules (after 8hrs daily, 40hrs weekly); Approval workflow (supervisor review and approval); Edit requests with reason (forgot to clock out); Multiple clock-ins per day (split shifts); Integration with payroll systems; Time-off and PTO tracking; Biometric integration (fingerprint, face scan for high-security); **Landscaping Crew:** Workers clock in at 7am via mobile app - GPS confirms at Client Site A. Select job code \"Lawn Maintenance - Oakwood Subdivision.\" Work until 12pm, clock out for lunch. Clock back in at 12:30pm, GPS now at Client Site B. Add note: \"Completed mulching at Oakwood, started hedge trimming at Riverside.\" 10-hour day = 2 hours overtime auto-calculated. Supervisor approves timesheet Friday with one-click, data flows to Gusto payroll.; **Retail Shift:** Employee clocks in via tablet at store - face recognition confirms identity. 15-min break auto-deducted. Clock out at end of shift. Manager gets alert if employee tries to clock in from parking lot (outside geofence).; **Forgot Clock-Out:** Employee realizes next morning they forgot to clock out. Submits edit request: \"Left at 5pm, forgot to clock out.\" Supervisor reviews GPS data showing they left site at 5:03pm, approves correction.",
  "tags": [
    "uc-derived",
    "persona-derived",
    "lifecycle",
    "api-first",
    "agents"
  ],
  "defaults": {
    "runMode": "dry_run",
    "continueOnFailure": false
  },
  "source": {
    "useCaseRef": "UC-141",
    "personaRef": "P-6",
    "useCaseFile": "/Users/ameer/bizing/mind/workspace/documentation/use-cases-comprehensive.md",
    "personaFile": "/Users/ameer/bizing/mind/workspace/documentation/tester-personas.md",
    "generatedAt": "2026-02-25T06:41:05.038Z"
  },
  "objectives": [
    "Validate UC-141 lifecycle end-to-end using persona The Franchisee (Priya).",
    "Exercise owner setup, team setup, catalog publishing, and customer journeys.",
    "Stress ACL/security edge cases and verify expected denials are enforced.",
    "Collect snapshots and report artifacts for every critical milestone."
  ],
  "actors": [
    {
      "actorKey": "biz_owner",
      "name": "The Franchisee (Priya)",
      "role": "owner",
      "description": "Owns 2 franchise locations, follows corporate rules",
      "personaRef": "P-6"
    },
    {
      "actorKey": "biz_member",
      "name": "Operations Team Member",
      "role": "manager",
      "description": "Business member invited by owner to assist with operations and booking flow."
    },
    {
      "actorKey": "customer_1",
      "name": "Customer One",
      "role": "customer",
      "description": "Primary customer exploring catalog, booking services, and purchasing products."
    },
    {
      "actorKey": "customer_2",
      "name": "Customer Two",
      "role": "customer",
      "description": "Concurrent customer used to simulate realistic demand and race conditions."
    },
    {
      "actorKey": "adversary",
      "name": "Adversarial User",
      "role": "malicious_actor",
      "description": "Actor intentionally attempting unauthorized or abusive actions."
    }
  ],
  "phases": [
    {
      "phaseKey": "owner-onboarding",
      "order": 1,
      "title": "Owner Onboarding",
      "description": "Business owner signs up, authenticates, and establishes tenant root.",
      "steps": [
        {
          "stepKey": "owner-sign-up",
          "order": 1,
          "title": "Owner signs up and authenticates",
          "actorKey": "biz_owner",
          "intent": "Establish authenticated owner identity for the lifecycle.",
          "instruction": "Create or login the owner account through Better Auth endpoints, then verify session context can call authenticated API routes.",
          "expectedResult": "Owner session exists and authenticated routes return success for this user.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "auth",
            "setup"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "owner-create-biz",
          "order": 2,
          "title": "Owner creates business tenant",
          "actorKey": "biz_owner",
          "intent": "Create the biz root for all subsequent configuration.",
          "instruction": "Using agents tools, create a biz representing The Employee Timesheet with Clock-In/Clock-Out. Use name/slug derived from saga context.",
          "expectedResult": "Biz is created, owner is auto-added as member with owner role, and biz id is captured.",
          "toolHints": [
            "bizing.bizes.create"
          ],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "biz",
            "setup"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "owner-create-location",
          "order": 3,
          "title": "Owner creates primary location",
          "actorKey": "biz_owner",
          "intent": "Establish operational location for services/resources.",
          "instruction": "Create a primary location for the biz and set timezone aligned with scenario context.",
          "expectedResult": "Location exists and is associated with the new biz.",
          "toolHints": [
            "bizing.locations.create"
          ],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "location",
            "setup"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        }
      ]
    },
    {
      "phaseKey": "business-configuration",
      "order": 2,
      "title": "Business Configuration",
      "description": "Owner configures scheduling, pricing baseline, and operational defaults.",
      "steps": [
        {
          "stepKey": "owner-configure-hours",
          "order": 4,
          "title": "Configure default hours and availability mode",
          "actorKey": "biz_owner",
          "intent": "Set baseline availability without forcing advanced complexity.",
          "instruction": "Create baseline availability and lead-time rules representing the UC default business hours and booking window behavior.",
          "expectedResult": "Availability defaults and rules are stored and can be referenced by calendars.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "availability",
            "policy"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "owner-configure-pricing",
          "order": 5,
          "title": "Configure default pricing rules",
          "actorKey": "biz_owner",
          "intent": "Set base pricing and optional manual demand overrides.",
          "instruction": "Configure pricing defaults for the offer lifecycle including call fees/manual surge if UC needs imply it.",
          "expectedResult": "Pricing model persists and future bookings can calculate totals deterministically.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "pricing"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        }
      ]
    },
    {
      "phaseKey": "supply-and-team-setup",
      "order": 3,
      "title": "Supply And Team Setup",
      "description": "Business owner sets up hosts/assets/venues/resources and invites members.",
      "steps": [
        {
          "stepKey": "owner-create-resources",
          "order": 6,
          "title": "Create resources representing hosts/assets/venues",
          "actorKey": "biz_owner",
          "intent": "Model real-world supply that bookings will consume.",
          "instruction": "Create at least one host resource and one non-host resource (asset or venue) suitable for the UC.",
          "expectedResult": "Resources are created with expected type, location, and buffers.",
          "toolHints": [
            "bizing.resources.create"
          ],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "resources"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "owner-invite-member",
          "order": 7,
          "title": "Invite and provision business member",
          "actorKey": "biz_owner",
          "intent": "Validate collaboration and role assignment.",
          "instruction": "Invite a biz member, assign an operational role, and verify that member can authenticate into the same biz.",
          "expectedResult": "Biz member account/session exists with scoped role permissions.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "team",
            "acl"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        }
      ]
    },
    {
      "phaseKey": "catalog-publish",
      "order": 4,
      "title": "Catalog And Publish",
      "description": "Owner creates services/offers/products and publishes sellable catalog entries.",
      "steps": [
        {
          "stepKey": "owner-create-offer",
          "order": 8,
          "title": "Create offer shell",
          "actorKey": "biz_owner",
          "intent": "Define sellable service/catalog entry.",
          "instruction": "Create an offer representing the UC primary service; choose execution mode matching the scenario.",
          "expectedResult": "Offer is created in draft state with captured id.",
          "toolHints": [
            "bizing.offers.create"
          ],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "offer",
            "catalog"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "owner-create-offer-version",
          "order": 9,
          "title": "Create and publish offer version",
          "actorKey": "biz_owner",
          "intent": "Freeze booking rules, duration, and price for customers.",
          "instruction": "Create a published offer version with realistic duration and base price for this UC.",
          "expectedResult": "Offer version exists and is ready for booking order references.",
          "toolHints": [
            "bizing.offers.createVersion"
          ],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "offer",
            "pricing"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "owner-publish-catalog",
          "order": 10,
          "title": "Publish catalog visibility",
          "actorKey": "biz_owner",
          "intent": "Expose offer to customer discovery flow.",
          "instruction": "Update offer publish/lifecycle flags so customer actors can discover it.",
          "expectedResult": "Offer appears as published/active and can be returned in customer-facing list queries.",
          "toolHints": [
            "bizing.offers.create",
            "bizing.offers.list"
          ],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "catalog",
            "publish"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        }
      ]
    },
    {
      "phaseKey": "customer-lifecycle",
      "order": 5,
      "title": "Customer Lifecycle",
      "description": "Customers sign up, discover offerings, book, and purchase in realistic order.",
      "steps": [
        {
          "stepKey": "customer-sign-up",
          "order": 11,
          "title": "Customer one signs up and logs in",
          "actorKey": "customer_1",
          "intent": "Establish customer identity for purchase/booking traceability.",
          "instruction": "Create customer account/session and verify customer can browse published offers.",
          "expectedResult": "Customer session established and offer discovery succeeds.",
          "toolHints": [
            "bizing.offers.list"
          ],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "auth",
            "customer"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "customer-book-primary",
          "order": 12,
          "title": "Customer one books primary offer",
          "actorKey": "customer_1",
          "intent": "Exercise booking order creation under normal path.",
          "instruction": "Create a booking order using the published offer version with realistic times and monetary totals.",
          "expectedResult": "Booking order is created and linked to offer/offer version with coherent totals.",
          "toolHints": [
            "bizing.bookingOrders.create"
          ],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "booking",
            "checkout"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "customer-two-concurrent",
          "order": 13,
          "title": "Customer two performs concurrent booking attempt",
          "actorKey": "customer_2",
          "intent": "Simulate real demand and potential scheduling conflicts.",
          "instruction": "Customer two attempts booking overlapping demand for the same offer/resource window.",
          "expectedResult": "System either books correctly under capacity rules or rejects with deterministic conflict response.",
          "toolHints": [
            "bizing.bookingOrders.create"
          ],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "concurrency",
            "booking"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "customer-advanced-payment-flow",
          "order": 14,
          "title": "Customer uses advanced payment instruments",
          "actorKey": "customer_1",
          "intent": "Validate mixed payment flows (split tender/tips/gifts/credits) from UC needs.",
          "instruction": "Execute advanced payment path (split tender and/or tip/gift/credit entitlement usage) and persist allocation evidence.",
          "expectedResult": "Payment trace clearly links payer, tender mix, and booking/order amounts with no ambiguity.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-specific",
            "payments",
            "entitlements"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        }
      ]
    },
    {
      "phaseKey": "security-and-abuse",
      "order": 6,
      "title": "Security And Abuse Checks",
      "description": "Adversarial actor attempts prohibited operations to validate access controls.",
      "steps": [
        {
          "stepKey": "adversary-cross-biz-read",
          "order": 15,
          "title": "Adversary attempts unauthorized cross-biz read",
          "actorKey": "adversary",
          "intent": "Validate tenant isolation against IDOR-like behavior.",
          "instruction": "Using credentials from another context, attempt to read or mutate booking/order resources for this biz.",
          "expectedResult": "Request is rejected with forbidden/unauthorized error and no data leakage.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [
            "Must not bypass membership checks",
            "No sensitive payload should be returned"
          ],
          "tags": [
            "security",
            "acl",
            "idor"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "adversary-hold-abuse",
          "order": 16,
          "title": "Adversary attempts demand/hold abuse",
          "actorKey": "adversary",
          "intent": "Stress anti-abuse controls around booking intent and capacity locks.",
          "instruction": "Trigger repeated booking/hold-like attempts to validate throttling, expiry, or non-blocking demand visibility behavior.",
          "expectedResult": "Abusive attempts are rate-limited or isolated without blocking legitimate customer flow.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "security",
            "abuse",
            "capacity"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        }
      ]
    },
    {
      "phaseKey": "operations-and-follow-up",
      "order": 7,
      "title": "Operations And Follow-up",
      "description": "Owner and members handle notifications, confirmations, and operational updates.",
      "steps": [
        {
          "stepKey": "member-review-bookings",
          "order": 17,
          "title": "Biz member reviews and updates booking status",
          "actorKey": "biz_member",
          "intent": "Validate role-based operational workflow.",
          "instruction": "As biz member, list bookings and progress one booking through operational status updates.",
          "expectedResult": "Authorized role can update status while preserving auditability and lifecycle consistency.",
          "toolHints": [
            "bizing.bookingOrders.list",
            "bizing.bookingOrders.updateStatus"
          ],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "operations",
            "acl"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "owner-calendar-review",
          "order": 18,
          "title": "Owner reviews consolidated calendar state",
          "actorKey": "biz_owner",
          "intent": "Verify availability, bookings, and resulting schedule are coherent.",
          "instruction": "Query and compare availability + bookings timeline for the entities involved in this scenario.",
          "expectedResult": "Calendar state reflects booked slots, blocks, and any conflict outcomes from previous steps.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "calendar",
            "validation"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "owner-configure-external-integration",
          "order": 19,
          "title": "Configure external channel/integration",
          "actorKey": "biz_owner",
          "intent": "Validate external connector and sync behavior required by UC.",
          "instruction": "Configure one external integration/channel and verify sync state + external id linkage is persisted.",
          "expectedResult": "Connector installation/configuration and sync status are queryable for operational debugging.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-specific",
            "integration",
            "channels"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "owner-review-route-dispatch-state",
          "order": 20,
          "title": "Review route/dispatch operational state",
          "actorKey": "biz_owner",
          "intent": "Validate transportation/mobile fulfillment state for this UC.",
          "instruction": "Inspect route/dispatch state after bookings and verify assignment/ETA/operational telemetry consistency.",
          "expectedResult": "Route/dispatch records align with bookings and can be used for operations decisions.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-specific",
            "transport",
            "operations"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        }
      ]
    },
    {
      "phaseKey": "reporting-and-closeout",
      "order": 8,
      "title": "Reporting And Closeout",
      "description": "Run collects evidence, computes pass/fail summary, and validates lifecycle traceability.",
      "steps": [
        {
          "stepKey": "owner-revenue-sanity",
          "order": 21,
          "title": "Owner validates financial/reporting outputs",
          "actorKey": "biz_owner",
          "intent": "Ensure lifecycle creates coherent business metrics.",
          "instruction": "Read reporting endpoints and verify booking totals, counts, and statuses align with saga actions.",
          "expectedResult": "Reported metrics match booking actions and highlight any discrepancies for schema/API iteration.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "reporting",
            "reconciliation"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-1",
          "order": 22,
          "title": "Validate explicit UC need #1",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Mobile clock-in/clock-out with GPS location capture",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Mobile clock-in/clock-out with GPS location capture\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-2",
          "order": 23,
          "title": "Validate explicit UC need #2",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Geofencing (must be within X feet of job site to clock in)",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Geofencing (must be within X feet of job site to clock in)\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-3",
          "order": 24,
          "title": "Validate explicit UC need #3",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Photo verification (optional selfie for attendance proof)",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Photo verification (optional selfie for attendance proof)\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-4",
          "order": 25,
          "title": "Validate explicit UC need #4",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Automatic break deduction or explicit break tracking",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Automatic break deduction or explicit break tracking\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-5",
          "order": 26,
          "title": "Validate explicit UC need #5",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Job code/task selection (which project/client)",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Job code/task selection (which project/client)\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-6",
          "order": 27,
          "title": "Validate explicit UC need #6",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Shift notes (what was accomplished)",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Shift notes (what was accomplished)\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-7",
          "order": 28,
          "title": "Validate explicit UC need #7",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Overtime calculation rules (after 8hrs daily, 40hrs weekly)",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Overtime calculation rules (after 8hrs daily, 40hrs weekly)\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-8",
          "order": 29,
          "title": "Validate explicit UC need #8",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Approval workflow (supervisor review and approval)",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Approval workflow (supervisor review and approval)\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-9",
          "order": 30,
          "title": "Validate explicit UC need #9",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Edit requests with reason (forgot to clock out)",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Edit requests with reason (forgot to clock out)\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-10",
          "order": 31,
          "title": "Validate explicit UC need #10",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Multiple clock-ins per day (split shifts)",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Multiple clock-ins per day (split shifts)\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-11",
          "order": 32,
          "title": "Validate explicit UC need #11",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Integration with payroll systems",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Integration with payroll systems\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "uc-need-validate-12",
          "order": 33,
          "title": "Validate explicit UC need #12",
          "actorKey": "biz_owner",
          "intent": "Prove this lifecycle covers explicit requirement: Time-off and PTO tracking",
          "instruction": "Using concrete API reads and persisted state checks, validate this requirement is satisfied: \"Time-off and PTO tracking\". If not satisfied, record exact gap and failing entities/endpoints.",
          "expectedResult": "Evidence either confirms requirement coverage or captures a precise, reproducible gap.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "uc-need",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "persona-scenario-validate-1",
          "order": 34,
          "title": "Validate persona scenario #1",
          "actorKey": "customer_1",
          "intent": "Exercise persona-specific behavior: Tries to override prohibited setting",
          "instruction": "Simulate this persona scenario and validate outcome deterministically: \"Tries to override prohibited setting\". Capture traces and snapshots so coverage can be audited later.",
          "expectedResult": "Scenario behavior is either confirmed as supported or produces a clear, actionable failure report.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "persona-scenario",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "persona-scenario-validate-2",
          "order": 35,
          "title": "Validate persona scenario #2",
          "actorKey": "customer_1",
          "intent": "Exercise persona-specific behavior: Requests exception through proper channel",
          "instruction": "Simulate this persona scenario and validate outcome deterministically: \"Requests exception through proper channel\". Capture traces and snapshots so coverage can be audited later.",
          "expectedResult": "Scenario behavior is either confirmed as supported or produces a clear, actionable failure report.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "persona-scenario",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "persona-scenario-validate-3",
          "order": 36,
          "title": "Validate persona scenario #3",
          "actorKey": "customer_1",
          "intent": "Exercise persona-specific behavior: Views corporate vs local reporting split",
          "instruction": "Simulate this persona scenario and validate outcome deterministically: \"Views corporate vs local reporting split\". Capture traces and snapshots so coverage can be audited later.",
          "expectedResult": "Scenario behavior is either confirmed as supported or produces a clear, actionable failure report.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "persona-scenario",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "persona-scenario-validate-4",
          "order": 37,
          "title": "Validate persona scenario #4",
          "actorKey": "customer_1",
          "intent": "Exercise persona-specific behavior: Onboards new staff with corporate template",
          "instruction": "Simulate this persona scenario and validate outcome deterministically: \"Onboards new staff with corporate template\". Capture traces and snapshots so coverage can be audited later.",
          "expectedResult": "Scenario behavior is either confirmed as supported or produces a clear, actionable failure report.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "persona-scenario",
            "validation",
            "coverage"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        },
        {
          "stepKey": "runner-submit-artifacts",
          "order": 38,
          "title": "Runner submits snapshots and final report",
          "actorKey": "biz_owner",
          "intent": "Close loop with machine-readable evidence and human-readable findings.",
          "instruction": "Upload snapshots for critical steps and submit final markdown report summarizing pass/fail and discovered gaps.",
          "expectedResult": "Run has persisted report + snapshots in project directory and indexed metadata in DB.",
          "toolHints": [],
          "assertions": [
            {
              "kind": "api_response",
              "description": "API call returns success and includes stable ids for created entities."
            },
            {
              "kind": "acl_guard",
              "description": "Actor permissions are honored for this step context."
            }
          ],
          "evidenceRequired": [
            {
              "kind": "api_trace",
              "label": "Request/response trace for this step"
            },
            {
              "kind": "snapshot",
              "label": "Structured snapshot.v1 screen blocks (what user saw) with real API-backed data"
            }
          ],
          "guardrails": [],
          "tags": [
            "evidence",
            "closeout"
          ],
          "delay": {
            "mode": "none",
            "jitterMs": 0
          }
        }
      ]
    }
  ],
  "metadata": {
    "ucScenario": "",
    "personaGoals": "Stay compliant, hit targets, local flexibility where allowed",
    "personaPainPoints": "Can't change corporate-mandated settings",
    "personaTestScenarios": [
      "Tries to override prohibited setting",
      "Requests exception through proper channel",
      "Views corporate vs local reporting split",
      "Onboards new staff with corporate template"
    ],
    "coverageTargets": [
      "customer-advanced-payment-flow",
      "owner-configure-external-integration",
      "owner-review-route-dispatch-state"
    ]
  }
}
