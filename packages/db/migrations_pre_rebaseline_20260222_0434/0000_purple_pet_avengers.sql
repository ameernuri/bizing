DO $$ BEGIN
 CREATE TYPE "access_action_outcome" AS ENUM('allowed', 'denied', 'expired', 'revoked', 'suspended', 'limit_exceeded', 'invalid', 'risk_blocked', 'not_found', 'error');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_action_token_event_type" AS ENUM('issued', 'validated', 'validation_failed', 'used', 'reissued', 'expired', 'revoked', 'consumed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_action_token_status" AS ENUM('active', 'used', 'expired', 'revoked', 'consumed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_action_token_type" AS ENUM('opaque_link', 'numeric_code', 'qr_code', 'one_time_password', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_action_type" AS ENUM('verify', 'view', 'download', 'redeem', 'transfer', 'support_override');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_artifact_event_type" AS ENUM('issued', 'activated', 'verified', 'verification_failed', 'consumed', 'usage_debited', 'usage_credited', 'suspended', 'unsuspended', 'revoked', 'expired', 'transferred_in', 'transferred_out', 'reissued', 'metadata_updated');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_artifact_link_type" AS ENUM('sellable', 'booking_order', 'booking_order_line', 'membership', 'entitlement_grant', 'payment_transaction', 'fulfillment_unit', 'custom_subject', 'external_reference');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_artifact_status" AS ENUM('draft', 'active', 'suspended', 'revoked', 'expired', 'consumed', 'transferred');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_artifact_type" AS ENUM('access_grant', 'license_key', 'download_entitlement', 'ticket_entitlement', 'content_gate', 'replay_access', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_delivery_link_channel" AS ENUM('web', 'email', 'sms', 'api', 'support');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_delivery_link_status" AS ENUM('active', 'expired', 'revoked', 'consumed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_resale_status" AS ENUM('draft', 'active', 'reserved', 'sold', 'expired', 'cancelled', 'removed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_security_decision_outcome" AS ENUM('allow', 'challenge', 'deny', 'manual_review', 'suspend_artifact', 'revoke_artifact');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_security_decision_status" AS ENUM('active', 'expired', 'reverted');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_security_signal_status" AS ENUM('open', 'acknowledged', 'resolved', 'dismissed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_security_signal_type" AS ENUM('ip_velocity', 'geo_anomaly', 'token_reuse', 'device_mismatch', 'download_burst', 'provider_risk', 'manual_flag', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_transfer_mode" AS ENUM('full_transfer', 'split_transfer', 'delegation');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_transfer_status" AS ENUM('requested', 'approved', 'rejected', 'cancelled', 'expired', 'completed', 'reversed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "access_usage_window_mode" AS ENUM('lifetime', 'rolling_window', 'calendar_day', 'fixed_window');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "allocation_source_type" AS ENUM('card', 'wallet', 'gift_card', 'cash', 'bank_transfer', 'credit');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "allocation_target_type" AS ENUM('service', 'product', 'fee', 'tax', 'deposit', 'tip');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "ar_invoice_status" AS ENUM('draft', 'issued', 'partially_paid', 'paid', 'overdue', 'voided', 'in_dispute', 'written_off');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "assessment_attempt_status" AS ENUM('started', 'submitted', 'graded', 'passed', 'failed', 'expired', 'cancelled', 'voided');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "assessment_evaluation_mode" AS ENUM('auto', 'manual', 'hybrid');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "assessment_item_type" AS ENUM('single_choice', 'multi_choice', 'text', 'numeric', 'boolean', 'file_upload', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "assessment_result_status" AS ENUM('pending', 'passed', 'failed', 'waived', 'invalidated');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "assessment_template_status" AS ENUM('draft', 'active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "async_deliverable_status" AS ENUM('queued', 'processing', 'ready', 'delivered', 'expired', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "async_deliverable_type" AS ENUM('document', 'media_bundle', 'analysis_result', 'message_response', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "auction_status" AS ENUM('scheduled', 'live', 'closed', 'cancelled', 'settled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "auction_target_type" AS ENUM('marketplace_listing', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "audit_actor_type" AS ENUM('user', 'system', 'api_key', 'integration');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "audit_event_type" AS ENUM('create', 'update', 'delete', 'read', 'state_transition', 'policy_decision', 'payment_event', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "audit_integrity_status" AS ENUM('valid', 'broken', 'unverified');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "availability_default_mode" AS ENUM('available_by_default', 'unavailable_by_default');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "availability_dependency_enforcement_mode" AS ENUM('hard_block', 'soft_gate', 'advisory');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "availability_dependency_evaluation_mode" AS ENUM('all', 'any', 'threshold');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "availability_dependency_target_type" AS ENUM('calendar', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "availability_exception_type" AS ENUM('closed', 'modified_hours', 'special_pricing', 'holiday');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "availability_gate_signal_type" AS ENUM('manual', 'queue_eta', 'capacity_pressure', 'dependency', 'external_event', 'plugin', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "availability_resolution_status" AS ENUM('available', 'unavailable', 'mixed', 'error');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "availability_rule_action" AS ENUM('available', 'unavailable', 'override_hours', 'special_pricing', 'capacity_adjustment');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "availability_rule_frequency" AS ENUM('none', 'daily', 'weekly', 'monthly', 'yearly', 'recurrence_rule');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "availability_rule_mode" AS ENUM('recurring', 'date_range', 'timestamp_range');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "availability_rule_outcome" AS ENUM('available', 'unavailable', 'override_hours', 'special_pricing');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "baa_party_type" AS ENUM('extension_install', 'vendor_org', 'subcontractor', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "baa_status" AS ENUM('draft', 'active', 'suspended', 'terminated', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "bid_status" AS ENUM('pending', 'winning', 'outbid', 'accepted', 'rejected', 'withdrawn', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "billing_account_status" AS ENUM('active', 'suspended', 'closed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "billing_account_type" AS ENUM('user', 'group_account', 'biz');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "biz_type" AS ENUM('individual', 'small_business', 'enterprise');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "booking_assignment_status" AS ENUM('pending', 'confirmed', 'declined', 'replaced');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "booking_order_line_type" AS ENUM('offer_base', 'seat', 'addon', 'fee', 'tip', 'tax', 'discount', 'refund_adjustment');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "booking_order_status" AS ENUM('draft', 'quoted', 'awaiting_payment', 'confirmed', 'in_progress', 'completed', 'cancelled', 'expired', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "booking_participant_status" AS ENUM('invited', 'confirmed', 'checked_in', 'cancelled', 'no_show');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "booking_segment_mode" AS ENUM('in_person', 'virtual', 'phone');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "booking_source" AS ENUM('web', 'mobile', 'admin', 'phone', 'api', 'import', 'marketplace', 'kiosk');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "booking_status" AS ENUM('draft', 'held', 'pending', 'pending_approval', 'confirmed', 'checked_in', 'in_progress', 'completed', 'cancelled', 'no_show', 'declined', 'waitlisted');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "breach_notification_recipient_type" AS ENUM('affected_individual', 'regulator', 'media', 'business_associate', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "breach_notification_status" AS ENUM('draft', 'scheduled', 'sent', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "break_glass_review_status" AS ENUM('pending', 'approved', 'rejected', 'escalated');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "bundle_component_price_mode" AS ENUM('included', 'fixed_override', 'surcharge', 'multiplier');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "bundle_component_target_type" AS ENUM('product', 'service_product', 'offer');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "bundle_pricing_mode" AS ENUM('fixed_bundle_price', 'sum_components', 'hybrid');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_access_grant_status" AS ENUM('granted', 'revoked', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_access_level" AS ENUM('free_busy', 'masked_details', 'full_details');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_conflict_resolution_mode" AS ENUM('priority_wins', 'unavailable_wins', 'available_wins', 'most_restrictive_wins');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_grant_scope" AS ENUM('all_sources', 'selected_sources');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_grant_source_type" AS ENUM('external_calendar', 'internal_user_calendar_binding');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_overlay_kind" AS ENUM('base', 'blackout', 'seasonal', 'maintenance', 'emergency', 'promo');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_owner_type" AS ENUM('biz', 'user', 'resource', 'service', 'service_product', 'offer', 'offer_version', 'location', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_rule_evaluation_order" AS ENUM('priority_asc', 'priority_desc', 'specificity_then_priority');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_status" AS ENUM('active', 'inactive');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_sync_connection_status" AS ENUM('active', 'reauth_required', 'paused', 'error', 'revoked');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_sync_provider" AS ENUM('google', 'microsoft', 'apple', 'ical', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_template_merge_mode" AS ENUM('append', 'template_precedence', 'template_only');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_timeline_event_source_type" AS ENUM('availability_rule', 'availability_gate', 'capacity_hold', 'maintenance_work_order', 'external_calendar_event', 'fulfillment', 'manual_entry', 'plugin', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_timeline_state" AS ENUM('available', 'unavailable', 'busy', 'tentative', 'blocked', 'unknown');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "calendar_timeline_visibility" AS ENUM('private', 'free_busy', 'masked_details', 'full_details');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "capacity_hold_status" AS ENUM('active', 'released', 'consumed', 'expired', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "capacity_hold_target_type" AS ENUM('calendar', 'capacity_pool', 'resource', 'offer_version', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "capacity_pool_member_type" AS ENUM('resource', 'offer_version', 'location', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "capacity_pool_status" AS ENUM('active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "certification_award_status" AS ENUM('awarded', 'revoked', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "channel_connection_status" AS ENUM('active', 'inactive', 'error', 'revoked');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "channel_object_type" AS ENUM('offer_version', 'availability', 'booking_order', 'customer', 'resource', 'class_session', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "channel_provider" AS ENUM('google_reserve', 'classpass', 'instagram', 'facebook', 'meta_messenger', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "channel_sync_direction" AS ENUM('inbound', 'outbound', 'bidirectional');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "channel_sync_item_status" AS ENUM('pending', 'succeeded', 'failed', 'skipped');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "channel_sync_job_status" AS ENUM('queued', 'running', 'succeeded', 'partial', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "channel_webhook_status" AS ENUM('received', 'processed', 'failed', 'ignored');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "checkout_channel" AS ENUM('web', 'mobile', 'pos', 'api', 'admin', 'external_channel');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "checkout_event_type" AS ENUM('started', 'item_added', 'item_updated', 'item_removed', 'coupon_applied', 'coupon_removed', 'payment_started', 'payment_failed', 'abandoned', 'recovery_sent', 'recovered', 'completed', 'expired', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "checkout_item_type" AS ENUM('sellable', 'custom_fee', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "checkout_recovery_channel" AS ENUM('email', 'sms', 'push', 'manual', 'link');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "checkout_recovery_status" AS ENUM('active', 'used', 'expired', 'revoked');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "checkout_session_status" AS ENUM('active', 'abandoned', 'recovery_sent', 'recovered', 'completed', 'expired', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "cohort_status" AS ENUM('planned', 'enrolling', 'in_progress', 'completed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "commitment_claim_event_type" AS ENUM('opened', 'note', 'evidence_added', 'amount_updated', 'escalated', 'resolution_proposed', 'resolved', 'reopened', 'closed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "commitment_claim_resolution_type" AS ENUM('release_funds', 'refund', 'forfeit', 'partial_settlement', 'rework_required', 'no_action', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "commitment_claim_status" AS ENUM('open', 'in_review', 'escalated', 'resolved', 'rejected', 'cancelled', 'closed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "commitment_claim_type" AS ENUM('non_delivery', 'quality_issue', 'damage', 'billing_dispute', 'fraud', 'sla_breach', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "commitment_contract_status" AS ENUM('draft', 'active', 'paused', 'completed', 'cancelled', 'defaulted', 'disputed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "commitment_contract_type" AS ENUM('escrow', 'retainage', 'service_commitment', 'payment_assurance', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "commitment_milestone_evaluation_mode" AS ENUM('all', 'any', 'threshold');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "commitment_milestone_release_mode" AS ENUM('manual', 'automatic');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "commitment_milestone_status" AS ENUM('pending', 'ready', 'released', 'skipped', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "commitment_obligation_status" AS ENUM('pending', 'in_progress', 'satisfied', 'waived', 'breached', 'cancelled', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "commitment_obligation_type" AS ENUM('payment', 'service_delivery', 'evidence_submission', 'inspection_pass', 'approval', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "communication_channel" AS ENUM('sms', 'email', 'push', 'whatsapp', 'postal', 'voice', 'webhook');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "communication_consent_source" AS ENUM('user_action', 'admin_override', 'import', 'system', 'legal_update');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "communication_consent_status" AS ENUM('opted_in', 'opted_out', 'suppressed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "communication_purpose" AS ENUM('transactional', 'marketing', 'operational', 'legal');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "compensation_calculation_mode" AS ENUM('flat_amount', 'percent_of_order_total', 'percent_of_order_subtotal', 'percent_of_line_total', 'hourly', 'base_plus_percent');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "compensation_ledger_entry_type" AS ENUM('accrual', 'adjustment', 'reversal', 'hold', 'release', 'payout', 'correction');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "compensation_pay_run_item_status" AS ENUM('pending', 'approved', 'withheld', 'paid', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "compensation_pay_run_status" AS ENUM('draft', 'calculating', 'review', 'approved', 'processing_payout', 'paid', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "compensation_plan_version_status" AS ENUM('draft', 'active', 'retired', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "compensation_rule_selector_type" AS ENUM('any', 'resource', 'resource_type', 'capability_template', 'location', 'service', 'service_product', 'offer_component');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "compliance_regime" AS ENUM('hipaa', 'gdpr', 'ccpa', 'ferpa', 'pci_dss', 'soc2', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "cross_biz_contract_status" AS ENUM('draft', 'active', 'suspended', 'terminated', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "cross_biz_order_status" AS ENUM('draft', 'pending', 'confirmed', 'fulfilled', 'settled', 'cancelled', 'disputed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "custom_field_data_type" AS ENUM('short_text', 'long_text', 'number', 'boolean', 'date', 'datetime', 'single_select', 'multi_select', 'currency', 'email', 'phone', 'url', 'json');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "custom_field_scope" AS ENUM('biz', 'location');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "custom_field_target_type" AS ENUM('biz', 'location', 'user', 'group_account', 'resource', 'service', 'service_product', 'offer', 'offer_version', 'product', 'sellable', 'booking_order', 'booking_order_line', 'fulfillment_unit', 'payment_intent', 'queue_entry', 'trip', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "custom_field_value_source" AS ENUM('user', 'system', 'extension', 'import', 'migration');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "custom_field_visibility" AS ENUM('public', 'internal', 'private', 'system');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "data_subject_request_status" AS ENUM('submitted', 'verifying', 'identity_verified', 'processing', 'fulfilled', 'denied', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "data_subject_request_type" AS ENUM('access', 'rectification', 'deletion', 'portability', 'restriction', 'objection');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "demand_pricing_evaluation_status" AS ENUM('applied', 'no_match', 'capped', 'blocked', 'error');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "demand_pricing_policy_status" AS ENUM('draft', 'active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "demand_pricing_scoring_mode" AS ENUM('weighted_sum', 'max_signal', 'manual_only');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "demand_pricing_target_type" AS ENUM('global', 'resource', 'service', 'service_product', 'offer', 'offer_version', 'location');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "demand_signal_aggregation_method" AS ENUM('sum', 'avg', 'min', 'max', 'p50', 'p90', 'p95', 'latest');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "demand_signal_kind" AS ENUM('quote_requests', 'checkout_starts', 'booking_conversions', 'waitlist_depth', 'search_views', 'cancellation_rate', 'no_show_rate', 'capacity_utilization', 'manual_index', 'external_index');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "demand_signal_source" AS ENUM('system', 'manual', 'import', 'forecast');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "disclosure_recipient_type" AS ENUM('provider', 'payer', 'business_associate', 'individual', 'legal_authority', 'public_health_authority', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "discount_campaign_status" AS ENUM('draft', 'active', 'paused', 'expired', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "discount_redemption_status" AS ENUM('reserved', 'applied', 'voided', 'reversed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "discount_scope" AS ENUM('order', 'line_item', 'sellable', 'service_product', 'offer_version');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "discount_stacking_mode" AS ENUM('exclusive', 'stackable', 'capped_stack');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "discount_type" AS ENUM('percentage', 'fixed_amount', 'free_item', 'free_service');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "dispatch_task_status" AS ENUM('queued', 'assigned', 'accepted', 'en_route', 'in_progress', 'done', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "dispute_status" AS ENUM('needs_response', 'under_review', 'won', 'lost', 'closed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "dsr_verification_method" AS ENUM('email_otp', 'document', 'manual', 'account_login');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "duration_mode" AS ENUM('fixed', 'flexible', 'multi_day');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "enrollment_status" AS ENUM('enrolled', 'waitlisted', 'dropped', 'completed', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "enterprise_contract_pack_binding_mode" AS ENUM('required', 'recommended', 'optional');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "enterprise_delegation_status" AS ENUM('active', 'revoked', 'expired', 'suspended');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "enterprise_directory_link_status" AS ENUM('active', 'disabled', 'error');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "enterprise_identity_provider_type" AS ENUM('oidc', 'saml', 'scim', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "enterprise_resolution_status" AS ENUM('ready', 'stale', 'error');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "enterprise_rollout_status" AS ENUM('draft', 'running', 'completed', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "enterprise_rollout_target_status" AS ENUM('pending', 'applied', 'skipped', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "enterprise_scim_sync_status" AS ENUM('pending', 'running', 'succeeded', 'partial', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "enterprise_scope_type" AS ENUM('network', 'biz', 'location', 'subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "entitlement_grant_type" AS ENUM('pass', 'credit', 'time_allowance', 'seat_pack', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "entitlement_ledger_entry_type" AS ENUM('grant', 'consume', 'expire', 'rollover', 'transfer_in', 'transfer_out', 'adjustment', 'reversal');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "entitlement_transfer_status" AS ENUM('requested', 'approved', 'rejected', 'completed', 'cancelled', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "eta_event_type" AS ENUM('predicted', 'updated', 'arrived', 'departed', 'delay_alert');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "extension_hook_delivery_mode" AS ENUM('internal_handler', 'webhook');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "extension_install_status" AS ENUM('active', 'disabled', 'suspended', 'uninstalled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "extension_permission_effect" AS ENUM('allow', 'deny');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "extension_runtime_type" AS ENUM('internal', 'webhook');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "extension_scope" AS ENUM('biz', 'location', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "extension_source_type" AS ENUM('first_party', 'partner', 'third_party', 'private');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "external_calendar_event_busy_status" AS ENUM('free', 'tentative', 'busy', 'out_of_office', 'unknown');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "external_calendar_event_status" AS ENUM('confirmed', 'tentative', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "external_calendar_sync_state" AS ENUM('pending', 'active', 'paused', 'error');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fact_refresh_status" AS ENUM('running', 'succeeded', 'partial', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fairness_window_unit" AS ENUM('day', 'week', 'month');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fee_status" AS ENUM('applied', 'waived', 'credited', 'refunded');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fee_trigger" AS ENUM('on_booking', 'on_confirmation', 'on_arrival', 'on_no_show', 'on_late_cancel', 'manual');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fee_type" AS ENUM('phone_booking', 'discovery_call', 'onsite_visit', 'after_hours', 'emergency_callout', 'late_cancel', 'no_show');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fulfillment_assignment_conflict_policy" AS ENUM('enforce_no_overlap', 'allow_overlap');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fulfillment_assignment_status" AS ENUM('proposed', 'reserved', 'confirmed', 'in_progress', 'completed', 'cancelled', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fulfillment_checkpoint_status" AS ENUM('pending', 'completed', 'skipped', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fulfillment_checkpoint_type" AS ENUM('arrival', 'check_in', 'start', 'pause', 'resume', 'pickup', 'dropoff', 'completion', 'no_access');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fulfillment_dependency_type" AS ENUM('must_follow', 'same_day', 'min_gap', 'max_gap', 'hard_block_if_missing');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fulfillment_unit_kind" AS ENUM('service_task', 'rental_segment', 'transport_leg', 'queue_service', 'async_review');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fulfillment_unit_status" AS ENUM('planned', 'ready', 'held', 'in_progress', 'completed', 'cancelled', 'blocked');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "fx_rate_source" AS ENUM('provider', 'manual', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "gift_expiration_reason" AS ENUM('scheduled_expiry', 'manual_expiry', 'policy_expiry');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "gift_instrument_source_type" AS ENUM('manual', 'purchase', 'promotion', 'compensation', 'transfer_split', 'migration', 'external');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "gift_instrument_status" AS ENUM('draft', 'active', 'partially_redeemed', 'redeemed', 'expired', 'voided');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "gift_ledger_entry_type" AS ENUM('issuance', 'redemption', 'redemption_reversal', 'transfer_out', 'transfer_in', 'expiration', 'void_adjustment', 'manual_adjustment');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "gift_redemption_status" AS ENUM('applied', 'reversed', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "gift_transfer_mode" AS ENUM('full_transfer', 'split_transfer');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "gift_transfer_status" AS ENUM('pending', 'completed', 'cancelled', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "grading_event_type" AS ENUM('attempt_started', 'attempt_submitted', 'auto_graded', 'manual_graded', 'regraded', 'waived', 'override_pass', 'override_fail', 'feedback_added');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "hipaa_authorization_status" AS ENUM('draft', 'signed', 'revoked', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "hipaa_purpose_of_use" AS ENUM('treatment', 'payment', 'operations', 'public_health', 'legal', 'research', 'individual_request', 'emergency', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "idempotency_status" AS ENUM('processing', 'completed', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "interaction_artifact_type" AS ENUM('file', 'image', 'video', 'audio', 'pdf', 'signature', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "interaction_assignment_status" AS ENUM('pending', 'in_progress', 'completed', 'expired', 'waived', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "interaction_requirement_mode" AS ENUM('required', 'optional');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "interaction_submission_status" AS ENUM('draft', 'submitted', 'accepted', 'rejected', 'withdrawn', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "interaction_template_type" AS ENUM('intake_form', 'waiver', 'release_form', 'checklist', 'survey', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "intercompany_account_type" AS ENUM('clearing', 'royalty', 'management_fee', 'cost_share', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "intercompany_entry_status" AS ENUM('pending', 'posted', 'reversed', 'voided');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "intercompany_entry_type" AS ENUM('accrual', 'adjustment', 'settlement', 'reversal');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "intercompany_settlement_run_status" AS ENUM('draft', 'running', 'completed', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "inventory_location_kind" AS ENUM('warehouse', 'storefront', 'vehicle', 'virtual', 'supplier', 'third_party', 'customer_site');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "inventory_movement_type" AS ENUM('opening_balance', 'receive', 'reserve', 'release', 'commit', 'adjustment_increase', 'adjustment_decrease', 'transfer_in', 'transfer_out', 'return_in', 'return_to_vendor', 'damage', 'shrinkage', 'cycle_count');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "inventory_reservation_status" AS ENUM('reserved', 'partially_committed', 'committed', 'released', 'expired', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "invoice_event_type" AS ENUM('created', 'issued', 'sent', 'viewed', 'payment_recorded', 'partial_payment', 'voided', 'disputed', 'resolved', 'note');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "leave_accrual_period" AS ENUM('per_hour_worked', 'weekly', 'biweekly', 'monthly', 'yearly', 'manual');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "leave_event_type" AS ENUM('grant', 'accrual', 'adjustment', 'request_approved', 'request_reversed', 'expiry', 'carryover');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "leave_request_status" AS ENUM('pending', 'approved', 'rejected', 'cancelled', 'withdrawn');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "leave_unit" AS ENUM('minutes', 'hours', 'days');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "legal_hold_scope" AS ENUM('tenant', 'offer', 'booking_order', 'payment', 'audit_log', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "legal_hold_status" AS ENUM('active', 'released', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "lifecycle_event_phase" AS ENUM('before', 'after');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "lifecycle_event_source" AS ENUM('api', 'system', 'workflow', 'integration', 'manual', 'migration');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "lifecycle_status" AS ENUM('draft', 'active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "location_type" AS ENUM('physical', 'virtual', 'mobile', 'hybrid');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "maintenance_action_type" AS ENUM('create_work_order', 'block_resource', 'warn_only', 'notify_only');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "maintenance_trigger_type" AS ENUM('usage_hours', 'usage_count', 'elapsed_days', 'calendar_date', 'manual');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "maintenance_work_order_status" AS ENUM('open', 'scheduled', 'in_progress', 'completed', 'cancelled', 'deferred');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "marketing_campaign_status" AS ENUM('draft', 'active', 'paused', 'completed', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "marketing_campaign_step_type" AS ENUM('delay', 'message', 'condition', 'exit');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "marketing_enrollment_status" AS ENUM('active', 'completed', 'exited', 'failed', 'paused');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "marketplace_listing_status" AS ENUM('draft', 'active', 'paused', 'closed', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "marketplace_listing_type" AS ENUM('offer_version', 'resource', 'package');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "membership_billing_interval_unit" AS ENUM('day', 'week', 'month', 'year', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "membership_plan_status" AS ENUM('draft', 'active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "membership_status" AS ENUM('trialing', 'active', 'paused', 'past_due', 'cancelled', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "membership_subscription_status" AS ENUM('trialing', 'active', 'paused', 'past_due', 'cancelled', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "message_delivery_status" AS ENUM('queued', 'processing', 'sent', 'delivered', 'failed', 'bounced', 'opened', 'clicked', 'replied', 'cancelled', 'suppressed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "message_event_type" AS ENUM('queued', 'sent', 'delivered', 'failed', 'bounced', 'opened', 'clicked', 'replied', 'complained', 'unsubscribed', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "note_status" AS ENUM('active', 'archived', 'deleted');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "note_target_type" AS ENUM('booking_order', 'fulfillment_unit', 'resource', 'offer', 'offer_version', 'customer', 'queue_entry', 'trip', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "note_visibility" AS ENUM('public', 'private', 'ai', 'system');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "requirement_mode" AS ENUM('required', 'optional');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "selector_match_mode" AS ENUM('any', 'all');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "resource_selector_type" AS ENUM('any', 'resource', 'resource_type', 'capability_template', 'location', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "resource_type" AS ENUM('host', 'company_host', 'asset', 'venue');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "offer_execution_mode" AS ENUM('slot', 'queue', 'request', 'auction', 'async', 'route_trip', 'open_access', 'itinerary');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "offer_seat_pricing_mode" AS ENUM('included', 'surcharge', 'multiplier');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "offer_status" AS ENUM('draft', 'active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "offer_version_status" AS ENUM('draft', 'published', 'superseded', 'retired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "offline_conflict_status" AS ENUM('open', 'resolved', 'ignored', 'escalated');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "offline_conflict_type" AS ENUM('version_mismatch', 'uniqueness_violation', 'dependency_missing', 'permission_denied', 'deleted_remote', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "offline_operation_kind" AS ENUM('create', 'update', 'delete', 'upsert', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "offline_operation_status" AS ENUM('pending', 'applied', 'conflict', 'rejected', 'failed', 'superseded');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "offline_resolution_action" AS ENUM('use_local', 'use_remote', 'manual_merge', 'replay_with_patch', 'cancel_operation');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "operational_assignment_source_type" AS ENUM('fulfillment_assignment', 'staffing_assignment', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "operational_demand_source_type" AS ENUM('fulfillment_unit', 'staffing_demand', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "org_membership_role" AS ENUM('owner', 'admin', 'manager', 'staff', 'host', 'customer');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "outbox_status" AS ENUM('pending', 'processing', 'published', 'failed', 'dead_letter');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "overtime_forecast_status" AS ENUM('projected', 'confirmed', 'mitigated', 'ignored');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "overtime_policy_scope" AS ENUM('biz', 'location', 'resource_type', 'resource');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "overtime_policy_status" AS ENUM('active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "package_wallet_status" AS ENUM('active', 'expired', 'depleted', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "participant_obligation_event_type" AS ENUM('created', 'updated', 'satisfied', 'waived', 'cancelled', 'reopened', 'payment_applied', 'note');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "participant_obligation_status" AS ENUM('pending', 'satisfied', 'waived', 'cancelled', 'overdue');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "participant_obligation_type" AS ENUM('payment_contribution', 'consent', 'identity_verification', 'attendance', 'document_submission', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "payment_dispute_status" AS ENUM('warning_needs_response', 'needs_response', 'under_review', 'won', 'lost', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "payment_intent_status" AS ENUM('requires_payment_method', 'requires_confirmation', 'requires_capture', 'processing', 'succeeded', 'partially_paid', 'failed', 'cancelled', 'refunded');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "payment_method_type" AS ENUM('card', 'cash', 'bank_transfer', 'wallet', 'gift_card', 'external_channel_credit', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "payment_status" AS ENUM('unpaid', 'pending', 'partial', 'paid', 'refunded', 'disputed', 'voided');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "payment_transaction_status" AS ENUM('pending', 'processing', 'succeeded', 'failed', 'cancelled', 'disputed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "payment_transaction_type" AS ENUM('authorization', 'capture', 'charge', 'refund', 'void', 'chargeback', 'chargeback_reversal', 'fee', 'adjustment', 'payout', 'transfer');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "payout_ledger_entry_type" AS ENUM('credit', 'debit', 'fee', 'adjustment', 'reversal');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "payout_status" AS ENUM('pending', 'in_transit', 'paid', 'failed', 'cancelled', 'reversed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "phi_access_action" AS ENUM('view', 'create', 'update', 'delete', 'export', 'print', 'disclose');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "phi_access_decision" AS ENUM('allowed', 'denied');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "physical_fulfillment_item_status" AS ENUM('pending', 'allocated', 'picked', 'packed', 'shipped', 'delivered', 'returned', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "physical_fulfillment_method" AS ENUM('shipment', 'pickup', 'onsite_handover', 'locker_pickup', 'third_party_delivery');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "physical_fulfillment_status" AS ENUM('draft', 'allocated', 'picking', 'packed', 'shipped', 'out_for_delivery', 'delivered', 'returned', 'cancelled', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "pii_sensitivity_level" AS ENUM('low', 'moderate', 'high', 'restricted');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "policy_binding_target_type" AS ENUM('biz', 'location', 'resource', 'service', 'service_product', 'offer', 'offer_version', 'queue', 'subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "policy_breach_detection_source" AS ENUM('auto_engine', 'manual_review', 'external_import', 'plugin');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "policy_breach_status" AS ENUM('open', 'acknowledged', 'in_review', 'resolved', 'waived', 'dismissed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "policy_consequence_status" AS ENUM('planned', 'applied', 'failed', 'reverted', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "policy_consequence_type" AS ENUM('warning', 'cooldown', 'suspension', 'compensation_adjustment', 'payment_adjustment', 'credit', 'debit', 'queue_review', 'workflow_trigger', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "policy_rule_aggregation_mode" AS ENUM('all', 'any', 'threshold');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "policy_rule_predicate_type" AS ENUM('expression', 'metric_threshold', 'schedule_window', 'event_pattern', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "policy_rule_severity" AS ENUM('low', 'medium', 'high', 'critical');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "pricing_adjustment_type" AS ENUM('set_price', 'fixed_amount', 'percentage');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "pricing_apply_as" AS ENUM('base_price', 'discount', 'surcharge', 'call_fee', 'booking_fee', 'after_hours_fee', 'emergency_fee');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "pricing_rule_type" AS ENUM('base_override', 'day_of_week', 'time_window', 'date_range', 'holiday', 'manual');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "privacy_identity_mode" AS ENUM('full_identity', 'pseudonymous', 'anonymous', 'sealed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "product_type" AS ENUM('physical', 'digital', 'service', 'membership', 'pass', 'credit_pack', 'fee', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "program_enrollment_status" AS ENUM('active', 'paused', 'completed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "program_session_status" AS ENUM('planned', 'scheduled', 'in_progress', 'completed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "program_status" AS ENUM('draft', 'active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "projection_health_status" AS ENUM('healthy', 'lagging', 'degraded', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "projection_scope_type" AS ENUM('biz', 'location', 'resource', 'sellable', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "purchase_order_status" AS ENUM('draft', 'issued', 'accepted', 'partially_billed', 'closed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "queue_entry_status" AS ENUM('waiting', 'offered', 'claimed', 'expired', 'removed', 'served', 'cancelled', 'no_show');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "queue_event_type" AS ENUM('joined', 'offered', 'claimed', 'expired', 'cancelled', 'called', 'served', 'status_changed', 'priority_changed', 'estimate_updated');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "queue_status" AS ENUM('active', 'paused', 'closed', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "queue_strategy" AS ENUM('fifo', 'priority', 'weighted', 'fair_share');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "queue_ticket_status" AS ENUM('issued', 'called', 'serving', 'completed', 'cancelled', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "ranking_event_type" AS ENUM('booking_completed', 'cancelled_by_host', 'cancelled_by_customer', 'no_show', 'rating_received', 'manual_adjustment');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "ranking_model_status" AS ENUM('draft', 'active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "redaction_job_status" AS ENUM('queued', 'running', 'completed', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "redaction_target_type" AS ENUM('user', 'booking_order', 'fulfillment_unit', 'payment', 'note', 'attachment', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "referral_event_type" AS ENUM('referral_created', 'qualified_purchase', 'converted', 'reward_granted', 'expired', 'reversed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "referral_reward_status" AS ENUM('pending', 'approved', 'granted', 'reversed', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "requirement_edge_type" AS ENUM('depends_on', 'unlocks', 'blocks');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "requirement_evaluation_status" AS ENUM('pending', 'in_progress', 'passed', 'failed', 'blocked', 'waived', 'expired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "requirement_evidence_type" AS ENUM('subject', 'external_reference', 'artifact', 'event');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "requirement_item_status" AS ENUM('pending', 'blocked', 'completed', 'skipped', 'waived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "requirement_item_type" AS ENUM('confirm', 'upload', 'watch', 'purchase', 'attestation', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "requirement_node_type" AS ENUM('predicate', 'group', 'milestone', 'manual', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "requirement_set_evaluation_mode" AS ENUM('all', 'any', 'threshold');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "requirement_set_status" AS ENUM('draft', 'active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "reservation_hold_reason" AS ENUM('checkout', 'cooldown', 'manual', 'sync', 'waitlist_offer');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "reservation_status" AS ENUM('active', 'expired', 'converted', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "residency_enforcement_mode" AS ENUM('hard_block', 'soft_warn', 'report_only');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "residency_scope" AS ENUM('global', 'region', 'country', 'tenant_custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "resource_capability_scope" AS ENUM('host', 'company_host', 'asset', 'venue');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "resource_condition_report_type" AS ENUM('pre_use', 'post_use', 'inspection', 'incident', 'return_check');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "resource_rate_unit" AS ENUM('flat', 'per_minute', 'per_hour', 'per_day', 'per_session');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "resource_status" AS ENUM('active', 'inactive', 'maintenance', 'retired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "retention_action" AS ENUM('delete', 'anonymize', 'archive');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "retention_interval_unit" AS ENUM('days', 'months', 'years', 'indefinite');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "revenue_share_rule_type" AS ENUM('fixed_percent', 'fixed_amount', 'tiered');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "review_item_status" AS ENUM('pending', 'claimed', 'approved', 'rejected', 'escalated', 'timed_out', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "review_queue_status" AS ENUM('active', 'paused', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "review_queue_type" AS ENUM('fraud', 'manual_approval', 'compliance', 'moderation', 'risk');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "rollover_run_status" AS ENUM('pending', 'running', 'completed', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "route_stop_kind" AS ENUM('pickup', 'dropoff', 'waypoint', 'depot', 'break');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "secured_balance_account_status" AS ENUM('open', 'locked', 'releasing', 'frozen', 'closed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "secured_balance_account_type" AS ENUM('escrow', 'retainage', 'deposit', 'assurance', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "secured_balance_allocation_type" AS ENUM('obligation_settlement', 'milestone_release', 'refund', 'forfeit', 'adjustment');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "secured_balance_ledger_entry_status" AS ENUM('pending', 'posted', 'reversed', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "secured_balance_ledger_entry_type" AS ENUM('fund', 'hold', 'release', 'refund', 'forfeit', 'adjustment', 'transfer_in', 'transfer_out');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "security_incident_severity" AS ENUM('low', 'medium', 'high', 'critical');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "security_incident_status" AS ENUM('open', 'investigating', 'contained', 'resolved', 'reported', 'closed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "security_incident_type" AS ENUM('unauthorized_access', 'improper_disclosure', 'ransomware', 'data_loss_or_theft', 'availability_outage', 'integrity_compromise', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sellable_kind" AS ENUM('product', 'service_product', 'offer_version', 'resource_rate');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sellable_pricing_mode" AS ENUM('free', 'fixed', 'flexible', 'tiered', 'metered', 'external_quote');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sellable_pricing_override_type" AS ENUM('absolute', 'delta', 'multiplier');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sellable_pricing_scope_type" AS ENUM('biz', 'location', 'channel', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sellable_pricing_threshold_type" AS ENUM('minimum', 'maximum', 'suggested', 'default');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sellable_variant_dimension_type" AS ENUM('choice', 'boolean', 'numeric', 'text');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sellable_variant_price_mode" AS ENUM('inherited', 'override', 'delta');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sellable_variant_status" AS ENUM('active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "service_product_kind" AS ENUM('booking', 'rental', 'hybrid');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "service_time_observation_source" AS ENUM('actual', 'manual_adjustment', 'imported');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "service_type" AS ENUM('appointment', 'class', 'rental', 'multi_day', 'call');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "service_visibility" AS ENUM('public', 'private', 'internal');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "session_attendance_status" AS ENUM('present', 'late', 'absent', 'excused', 'no_show', 'makeup');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "session_interaction_source_type" AS ENUM('program_session', 'fulfillment_unit', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "session_interaction_type" AS ENUM('join', 'leave', 'chat_message', 'qna_question', 'qna_answer', 'poll_response', 'reaction', 'hand_raise', 'replay_view', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "session_interaction_visibility" AS ENUM('public', 'participant_only', 'staff_only', 'private');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "settlement_batch_status" AS ENUM('open', 'calculating', 'ready', 'paid', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "shared_account_member_role" AS ENUM('primary', 'adult', 'minor', 'dependent', 'employee');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "shared_account_type" AS ENUM('family', 'company', 'group');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "signature_method" AS ENUM('typed', 'drawn', 'click_accept', 'uploaded');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "signature_signer_role" AS ENUM('customer', 'guardian', 'witness', 'provider', 'staff', 'other');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sla_breach_status" AS ENUM('open', 'acknowledged', 'compensated', 'waived', 'closed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sla_breach_target_type" AS ENUM('booking_order', 'fulfillment_unit', 'queue_entry', 'work_run', 'resource', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sla_compensation_status" AS ENUM('pending', 'applied', 'reversed', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sla_compensation_type" AS ENUM('credit', 'refund', 'gift_value', 'internal_adjustment', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sla_metric_kind" AS ENUM('response_time', 'start_time', 'completion_time', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "sla_policy_scope_type" AS ENUM('biz', 'location', 'resource', 'offer_version', 'service_product', 'queue', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "staffing_assignment_status" AS ENUM('planned', 'confirmed', 'in_progress', 'completed', 'cancelled', 'no_show');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "staffing_demand_status" AS ENUM('open', 'offered', 'claimed', 'assigned', 'filled', 'expired', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "staffing_demand_type" AS ENUM('replacement', 'open_shift', 'internal_task', 'on_call', 'overtime');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "staffing_fill_mode" AS ENUM('direct_assign', 'fcfs_claim', 'invite_accept', 'auction', 'auto_match');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "staffing_requirement_mode" AS ENUM('required', 'optional');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "staffing_response_mode" AS ENUM('invite', 'claim', 'bid');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "staffing_response_status" AS ENUM('pending', 'accepted', 'declined', 'expired', 'withdrawn', 'won', 'lost', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "staffing_selector_match_mode" AS ENUM('any', 'all');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "staffing_selector_type" AS ENUM('any', 'resource', 'resource_type', 'capability_template', 'location', 'custom_subject');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "standing_reservation_contract_status" AS ENUM('draft', 'active', 'paused', 'completed', 'cancelled', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "standing_reservation_exception_action" AS ENUM('skip_occurrence', 'cancel_occurrence', 'reschedule_occurrence', 'pause_window');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "standing_reservation_occurrence_status" AS ENUM('planned', 'generated', 'booked', 'fulfilled', 'skipped', 'cancelled', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "subject_relationship_direction" AS ENUM('directed', 'undirected');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "survey_invitation_status" AS ENUM('pending', 'sent', 'opened', 'completed', 'expired', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "survey_question_type" AS ENUM('rating', 'nps', 'single_choice', 'multi_choice', 'text', 'boolean');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "survey_response_status" AS ENUM('started', 'completed', 'abandoned', 'rejected');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "survey_response_visibility" AS ENUM('identified', 'anonymous', 'pseudonymous');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "tax_calculation_status" AS ENUM('calculated', 'finalized', 'voided');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "transaction_status" AS ENUM('pending', 'succeeded', 'failed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "transaction_type" AS ENUM('authorization', 'capture', 'void', 'refund', 'adjustment', 'fee', 'chargeback');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "transport_route_status" AS ENUM('active', 'inactive', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "transport_trip_status" AS ENUM('planned', 'boarding', 'in_progress', 'delayed', 'completed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "trip_manifest_status" AS ENUM('booked', 'checked_in', 'boarded', 'no_show', 'cancelled', 'completed');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "vehicle_status" AS ENUM('active', 'maintenance', 'out_of_service', 'retired');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "wait_time_prediction_model" AS ENUM('heuristic', 'statistical', 'ml', 'manual');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "waitlist_mode" AS ENUM('queue', 'race');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "waitlist_status" AS ENUM('waiting', 'offered', 'accepted', 'expired', 'cancelled', 'converted');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "work_approval_assignee_type" AS ENUM('user', 'group_account', 'role', 'external');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "work_approval_decision" AS ENUM('pending', 'approved', 'rejected', 'delegated', 'skipped');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "work_approval_routing_mode" AS ENUM('sequential', 'parallel');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "work_clock_source" AS ENUM('mobile', 'kiosk', 'web', 'api', 'import');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "work_entry_status" AS ENUM('logged', 'submitted', 'approved', 'rejected', 'voided');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "work_entry_type" AS ENUM('note', 'labor', 'material', 'expense', 'mileage', 'incident', 'weather', 'measurement', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "work_run_status" AS ENUM('draft', 'active', 'submitted', 'approved', 'rejected', 'completed', 'cancelled', 'archived');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "work_step_status" AS ENUM('pending', 'in_progress', 'completed', 'blocked', 'failed', 'skipped');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "work_step_type" AS ENUM('field', 'check_item', 'action', 'approval_gate', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "work_template_kind" AS ENUM('report', 'timesheet', 'checklist', 'inspection', 'punch_list', 'signoff', 'form', 'custom');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "work_time_segment_type" AS ENUM('work', 'break', 'travel', 'standby', 'overtime');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "workflow_decision_outcome" AS ENUM('approve', 'reject', 'request_changes', 'escalate', 'defer');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "workflow_instance_status" AS ENUM('pending', 'running', 'waiting_input', 'completed', 'failed', 'cancelled');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "workflow_step_status" AS ENUM('pending', 'running', 'blocked', 'completed', 'failed', 'skipped');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 CREATE TYPE "workflow_trigger_type" AS ENUM('manual', 'policy', 'webhook', 'schedule', 'system_event');
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bizes" (
	"id" text PRIMARY KEY NOT NULL,
	"name" varchar(255) NOT NULL,
	"slug" varchar(100) NOT NULL,
	"type" "biz_type" DEFAULT 'small_business' NOT NULL,
	"logo_url" varchar(500),
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "users" (
	"id" text PRIMARY KEY NOT NULL,
	"email" varchar(255) NOT NULL,
	"password_hash" varchar(255),
	"first_name" varchar(100),
	"last_name" varchar(100),
	"name" varchar(255) DEFAULT '' NOT NULL,
	"phone" varchar(50),
	"role" "org_membership_role" DEFAULT 'staff' NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"avatar_url" varchar(500),
	"settings" jsonb DEFAULT '{}'::jsonb,
	"preferences" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"email_verified" boolean DEFAULT false NOT NULL,
	"email_verified_at" timestamp with time zone,
	"banned" boolean DEFAULT false NOT NULL,
	"ban_reason" varchar(500),
	"ban_expires" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "accounts" (
	"id" text PRIMARY KEY NOT NULL,
	"account_id" text NOT NULL,
	"provider_id" text NOT NULL,
	"user_id" text NOT NULL,
	"access_token" text,
	"refresh_token" text,
	"id_token" text,
	"access_token_expires_at" timestamp,
	"refresh_token_expires_at" timestamp,
	"scope" text,
	"password" text,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "invitations" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" text NOT NULL,
	"email" text NOT NULL,
	"role" text,
	"status" text DEFAULT 'pending' NOT NULL,
	"expires_at" timestamp NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"inviter_id" text NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "members" (
	"id" text PRIMARY KEY NOT NULL,
	"organization_id" text NOT NULL,
	"user_id" text NOT NULL,
	"role" text DEFAULT 'member' NOT NULL,
	"created_at" timestamp NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sessions" (
	"id" text PRIMARY KEY NOT NULL,
	"expires_at" timestamp NOT NULL,
	"token" text NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp NOT NULL,
	"ip_address" text,
	"user_agent" text,
	"user_id" text NOT NULL,
	"active_organization_id" text,
	"impersonated_by" text,
	CONSTRAINT "sessions_token_unique" UNIQUE("token")
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "verifications" (
	"id" text PRIMARY KEY NOT NULL,
	"identifier" text NOT NULL,
	"value" text NOT NULL,
	"expires_at" timestamp NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "locations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(255) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"type" "location_type" DEFAULT 'physical' NOT NULL,
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"address" jsonb DEFAULT '{}'::jsonb,
	"operating_hours" jsonb DEFAULT '{}'::jsonb,
	"config_override" jsonb DEFAULT '{}'::jsonb,
	"service_area" jsonb DEFAULT '{}'::jsonb,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"is_default" boolean DEFAULT false NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "group_account_members" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"group_account_id" text NOT NULL,
	"user_id" text NOT NULL,
	"role" "shared_account_member_role" DEFAULT 'adult' NOT NULL,
	"relationship" varchar(50),
	"permissions" jsonb DEFAULT '{}'::jsonb,
	"managed_by" jsonb DEFAULT '[]'::jsonb,
	"date_of_birth" date,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "group_accounts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(255) NOT NULL,
	"type" "shared_account_type" DEFAULT 'family' NOT NULL,
	"primary_contact_user_id" text,
	"profile" jsonb DEFAULT '{}'::jsonb,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"settings" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "org_membership_locations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"membership_id" text NOT NULL,
	"location_id" text NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "org_memberships" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"user_id" text NOT NULL,
	"role" "org_membership_role" DEFAULT 'staff' NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"better_auth_member_id" varchar(255),
	"location_scope" jsonb DEFAULT '[]'::jsonb,
	"permissions" jsonb DEFAULT '{}'::jsonb,
	"invited_by_user_id" text,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "biz_config_bindings" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"config_set_id" text NOT NULL,
	"location_id" text,
	"scope_ref_type" varchar(80),
	"scope_ref_id" text,
	"target_entity" varchar(120) NOT NULL,
	"target_field" varchar(120) NOT NULL,
	"is_primary" boolean DEFAULT true NOT NULL,
	"is_strict" boolean DEFAULT true NOT NULL,
	"default_config_value_id" text,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "biz_config_promotion_run_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"promotion_run_id" text NOT NULL,
	"entity_type" varchar(30) NOT NULL,
	"source_key" varchar(240) NOT NULL,
	"target_key" varchar(240),
	"action" varchar(20) NOT NULL,
	"status" varchar(20) DEFAULT 'pending' NOT NULL,
	"before_state" jsonb,
	"after_state" jsonb,
	"error_message" text,
	"applied_at" timestamp with time zone,
	"config_set_id" text,
	"config_value_id" text,
	"config_binding_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "biz_config_promotion_runs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"source_profile_key" varchar(140) NOT NULL,
	"target_profile_key" varchar(140) NOT NULL,
	"operation" varchar(20) DEFAULT 'apply' NOT NULL,
	"status" varchar(20) DEFAULT 'queued' NOT NULL,
	"requested_by_user_id" text,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"total_items" integer DEFAULT 0 NOT NULL,
	"applied_items" integer DEFAULT 0 NOT NULL,
	"failed_items" integer DEFAULT 0 NOT NULL,
	"diff_summary" jsonb DEFAULT '{}'::jsonb,
	"error_summary" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "biz_config_sets" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"set_type" varchar(80) DEFAULT 'status' NOT NULL,
	"source_owner_key" varchar(180),
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" text,
	"allow_freeform_values" boolean DEFAULT false NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "biz_config_value_localizations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"config_value_id" text NOT NULL,
	"locale" varchar(35) NOT NULL,
	"label" varchar(200) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "biz_config_values" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"config_set_id" text NOT NULL,
	"code" varchar(140) NOT NULL,
	"label" varchar(200) NOT NULL,
	"description" text,
	"system_code" varchar(140),
	"replaced_by_config_value_id" text,
	"is_default" boolean DEFAULT false NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"color_hint" varchar(40),
	"behavior" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "service_groups" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(255) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"description" text,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"status_config_value_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "services" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"service_group_id" text NOT NULL,
	"name" varchar(255) NOT NULL,
	"slug" varchar(100) NOT NULL,
	"description" text,
	"type" "service_type" DEFAULT 'appointment' NOT NULL,
	"type_config_value_id" text,
	"visibility" "service_visibility" DEFAULT 'public' NOT NULL,
	"visibility_config_value_id" text,
	"min_advance_booking_hours" integer,
	"max_advance_booking_days" integer,
	"booking_cutoff_minutes" integer,
	"requires_approval" boolean DEFAULT false NOT NULL,
	"allow_waitlist" boolean DEFAULT true NOT NULL,
	"allow_overbooking" boolean DEFAULT false NOT NULL,
	"min_cancellation_notice_hours" integer,
	"min_reschedule_notice_hours" integer,
	"booking_policy" jsonb DEFAULT '{}'::jsonb,
	"cancellation_policy" jsonb DEFAULT '{}'::jsonb,
	"deposit_policy" jsonb DEFAULT '{}'::jsonb,
	"eligibility_policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"is_self_bookable" boolean DEFAULT true,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"status_config_value_id" text,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "products" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"name" varchar(255) NOT NULL,
	"slug" varchar(100) NOT NULL,
	"sku" varchar(120),
	"description" text,
	"base_price_minor" integer DEFAULT 0 NOT NULL,
	"cost_minor" integer,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"type" "product_type" DEFAULT 'digital' NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"download_url" varchar(500),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "booking_order_line_sellables" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"booking_order_line_id" text NOT NULL,
	"sellable_id" text NOT NULL,
	"quantity" integer DEFAULT 1 NOT NULL,
	"allocated_amount_minor" integer,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "inventory_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"inventory_location_id" text NOT NULL,
	"product_id" text NOT NULL,
	"sku_snapshot" varchar(120),
	"on_hand_qty" integer DEFAULT 0 NOT NULL,
	"reserved_qty" integer DEFAULT 0 NOT NULL,
	"available_qty" integer DEFAULT 0 NOT NULL,
	"reorder_point_qty" integer,
	"reorder_target_qty" integer,
	"allow_backorder" boolean DEFAULT false NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "inventory_locations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"name" varchar(180) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"kind" "inventory_location_kind" NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"description" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "inventory_movements" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"inventory_item_id" text NOT NULL,
	"movement_type" "inventory_movement_type" NOT NULL,
	"quantity_delta" integer NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"source_inventory_location_id" text,
	"destination_inventory_location_id" text,
	"booking_order_id" text,
	"booking_order_line_id" text,
	"fulfillment_unit_id" text,
	"inventory_reservation_id" text,
	"physical_fulfillment_item_id" text,
	"reason_code" varchar(120),
	"note" text,
	"idempotency_key" varchar(200),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "inventory_reservations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"inventory_item_id" text NOT NULL,
	"booking_order_id" text,
	"booking_order_line_id" text,
	"fulfillment_unit_id" text,
	"status" "inventory_reservation_status" DEFAULT 'reserved' NOT NULL,
	"quantity_reserved" integer NOT NULL,
	"quantity_committed" integer DEFAULT 0 NOT NULL,
	"quantity_released" integer DEFAULT 0 NOT NULL,
	"expires_at" timestamp with time zone,
	"committed_at" timestamp with time zone,
	"released_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"idempotency_key" varchar(200),
	"note" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "physical_fulfillment_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"physical_fulfillment_id" text NOT NULL,
	"product_id" text NOT NULL,
	"booking_order_line_id" text,
	"inventory_item_id" text,
	"inventory_reservation_id" text,
	"status" "physical_fulfillment_item_status" DEFAULT 'pending' NOT NULL,
	"quantity" integer NOT NULL,
	"quantity_shipped" integer DEFAULT 0 NOT NULL,
	"quantity_delivered" integer DEFAULT 0 NOT NULL,
	"quantity_returned" integer DEFAULT 0 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "physical_fulfillments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"booking_order_id" text,
	"method" "physical_fulfillment_method" NOT NULL,
	"status" "physical_fulfillment_status" DEFAULT 'draft' NOT NULL,
	"origin_inventory_location_id" text,
	"destination_location_id" text,
	"recipient_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"carrier" varchar(120),
	"service_level" varchar(120),
	"tracking_number" varchar(160),
	"external_fulfillment_ref" varchar(200),
	"ship_by_at" timestamp with time zone,
	"shipped_at" timestamp with time zone,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "product_bundle_components" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"product_bundle_id" text NOT NULL,
	"requirement_mode" "requirement_mode" DEFAULT 'required' NOT NULL,
	"target_type" "bundle_component_target_type" NOT NULL,
	"product_id" text,
	"service_product_id" text,
	"offer_id" text,
	"min_quantity" integer DEFAULT 1 NOT NULL,
	"max_quantity" integer,
	"default_quantity" integer DEFAULT 1 NOT NULL,
	"price_mode" "bundle_component_price_mode" DEFAULT 'included' NOT NULL,
	"price_override_minor" integer,
	"surcharge_minor" integer,
	"price_multiplier_bps" integer,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"description" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "product_bundles" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"bundle_product_id" text NOT NULL,
	"pricing_mode" "bundle_pricing_mode" DEFAULT 'fixed_bundle_price' NOT NULL,
	"allow_partial_selection" boolean DEFAULT false NOT NULL,
	"min_component_selections" integer DEFAULT 0 NOT NULL,
	"max_component_selections" integer,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellable_offer_versions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sellable_id" text NOT NULL,
	"sellable_kind" "sellable_kind" DEFAULT 'offer_version' NOT NULL,
	"offer_version_id" text NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellable_products" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sellable_id" text NOT NULL,
	"sellable_kind" "sellable_kind" DEFAULT 'product' NOT NULL,
	"product_id" text NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellable_resource_rates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sellable_id" text NOT NULL,
	"sellable_kind" "sellable_kind" DEFAULT 'resource_rate' NOT NULL,
	"resource_id" text NOT NULL,
	"rate_unit" "resource_rate_unit" NOT NULL,
	"base_price_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"minimum_charge_minor" integer,
	"minimum_duration_min" integer,
	"billing_increment_min" integer,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellable_service_products" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sellable_id" text NOT NULL,
	"sellable_kind" "sellable_kind" DEFAULT 'service_product' NOT NULL,
	"service_product_id" text NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellables" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"kind" "sellable_kind" NOT NULL,
	"display_name" varchar(255) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellable_variant_dimension_values" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sellable_variant_dimension_id" text NOT NULL,
	"value_key" varchar(120) NOT NULL,
	"value_label" varchar(180) NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"is_default" boolean DEFAULT false NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellable_variant_dimensions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"base_sellable_id" text NOT NULL,
	"dimension_key" varchar(120) NOT NULL,
	"name" varchar(180) NOT NULL,
	"description" varchar(2000),
	"dimension_type" "sellable_variant_dimension_type" DEFAULT 'choice' NOT NULL,
	"is_required" boolean DEFAULT true NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellable_variant_selections" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sellable_variant_id" text NOT NULL,
	"base_sellable_id" text NOT NULL,
	"sellable_variant_dimension_id" text NOT NULL,
	"sellable_variant_dimension_value_id" text NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellable_variants" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"base_sellable_id" text NOT NULL,
	"variant_sellable_id" text NOT NULL,
	"status" "sellable_variant_status" DEFAULT 'active' NOT NULL,
	"pricing_mode" "sellable_variant_price_mode" DEFAULT 'inherited' NOT NULL,
	"price_override_minor" integer,
	"price_delta_minor" integer,
	"sku_suffix" varchar(120),
	"display_label" varchar(220),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellable_pricing_modes" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sellable_id" text NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"mode" "sellable_pricing_mode" NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"base_price_minor" integer,
	"minimum_order_quantity" integer DEFAULT 1 NOT NULL,
	"maximum_order_quantity" integer,
	"billing_unit" varchar(80) DEFAULT 'unit' NOT NULL,
	"billing_unit_count" integer DEFAULT 1 NOT NULL,
	"metered_unit_key" varchar(140),
	"external_quote_key" varchar(140),
	"effective_from" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_to" timestamp with time zone,
	"priority" integer DEFAULT 100 NOT NULL,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellable_pricing_overrides" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sellable_pricing_mode_id" text NOT NULL,
	"scope_type" "sellable_pricing_scope_type" DEFAULT 'biz' NOT NULL,
	"location_id" text,
	"channel_account_id" text,
	"custom_subject_type" varchar(80),
	"custom_subject_id" varchar(140),
	"override_type" "sellable_pricing_override_type" NOT NULL,
	"absolute_price_minor" integer,
	"delta_price_minor" integer,
	"multiplier_bps" integer,
	"effective_from" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_to" timestamp with time zone,
	"priority" integer DEFAULT 100 NOT NULL,
	"reason_code" varchar(80),
	"reason_text" varchar(500),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sellable_pricing_thresholds" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sellable_pricing_mode_id" text NOT NULL,
	"threshold_type" "sellable_pricing_threshold_type" NOT NULL,
	"metric_key" varchar(120) NOT NULL,
	"comparison_operator" varchar(20) DEFAULT 'gte' NOT NULL,
	"min_value" integer,
	"max_value" integer,
	"price_minor" integer,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "service_product_requirement_groups" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"service_product_id" text NOT NULL,
	"name" varchar(160) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"target_resource_type" "resource_type" NOT NULL,
	"requirement_mode" "requirement_mode" DEFAULT 'required' NOT NULL,
	"min_quantity" integer DEFAULT 1 NOT NULL,
	"max_quantity" integer,
	"selector_match_mode" "selector_match_mode" DEFAULT 'any' NOT NULL,
	"allow_substitution" boolean DEFAULT true NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"description" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "service_product_requirement_selectors" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"requirement_group_id" text NOT NULL,
	"selector_type" "resource_selector_type" NOT NULL,
	"is_included" boolean DEFAULT true NOT NULL,
	"resource_id" text,
	"resource_type" "resource_type",
	"capability_template_id" text,
	"location_id" text,
	"subject_type" varchar(80),
	"subject_id" varchar(140),
	"sort_order" integer DEFAULT 100 NOT NULL,
	"description" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "service_product_seat_type_requirements" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"seat_type_id" text NOT NULL,
	"requirement_group_id" text NOT NULL,
	"min_quantity_override" integer,
	"max_quantity_override" integer,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "service_product_seat_types" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"service_product_id" text NOT NULL,
	"name" varchar(120) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"description" text,
	"is_default" boolean DEFAULT false NOT NULL,
	"min_seats" integer DEFAULT 0 NOT NULL,
	"max_seats" integer,
	"default_quantity" integer DEFAULT 1 NOT NULL,
	"base_price_amount" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"status_config_value_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "service_product_services" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"service_product_id" text NOT NULL,
	"service_id" text,
	"service_group_id" text,
	"requirement_mode" "requirement_mode" DEFAULT 'required' NOT NULL,
	"min_quantity" integer DEFAULT 1 NOT NULL,
	"max_quantity" integer,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"description" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "service_products" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"product_id" text,
	"name" varchar(255) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"description" text,
	"kind" "service_product_kind" DEFAULT 'booking' NOT NULL,
	"kind_config_value_id" text,
	"duration_mode" "duration_mode" DEFAULT 'fixed' NOT NULL,
	"duration_mode_config_value_id" text,
	"default_duration_minutes" integer DEFAULT 60 NOT NULL,
	"min_duration_minutes" integer,
	"max_duration_minutes" integer,
	"duration_step_minutes" integer DEFAULT 15 NOT NULL,
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"base_price_amount" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"pricing_policy" jsonb DEFAULT '{}'::jsonb,
	"availability_policy" jsonb DEFAULT '{}'::jsonb,
	"is_published" boolean DEFAULT false NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"status_config_value_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "assets" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"name" varchar(255) NOT NULL,
	"slug" varchar(100) NOT NULL,
	"description" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "venues" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"name" varchar(255) NOT NULL,
	"slug" varchar(100) NOT NULL,
	"address" text,
	"setup_minutes" integer DEFAULT 0 NOT NULL,
	"teardown_minutes" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "host_group_members" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"host_group_id" text NOT NULL,
	"user_id" text NOT NULL,
	"role" varchar(50) DEFAULT 'member' NOT NULL,
	"is_assignable" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "host_groups" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"group_account_id" text NOT NULL,
	"email" varchar(255),
	"phone" varchar(50),
	"website" varchar(500),
	"dispatch_method" varchar(50) DEFAULT 'manual' NOT NULL,
	"service_radius_miles" integer,
	"business_hours" jsonb DEFAULT '{}'::jsonb,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "host_users" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"user_id" text,
	"email" varchar(255),
	"phone" varchar(50),
	"bio" varchar(1500),
	"languages" jsonb DEFAULT '[]'::jsonb,
	"travel_radius_miles" integer,
	"max_daily_bookings" integer,
	"min_rest_between_bookings_min" integer DEFAULT 0 NOT NULL,
	"payment_profile" jsonb DEFAULT '{}'::jsonb,
	"rating" integer,
	"review_count" integer DEFAULT 0 NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "resource_service_capabilities" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"service_id" text NOT NULL,
	"location_id" text,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"description" varchar(600),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "resource_status_definitions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"name" varchar(100) NOT NULL,
	"slug" varchar(100) NOT NULL,
	"description" varchar(600),
	"is_bookable" boolean DEFAULT true NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "resources" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text NOT NULL,
	"type" "resource_type" NOT NULL,
	"name" varchar(255) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"description" varchar(1000),
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"status_definition_id" text,
	"host_user_id" text,
	"group_account_id" text,
	"asset_id" text,
	"venue_id" text,
	"capacity" integer,
	"allow_simultaneous_bookings" boolean DEFAULT false NOT NULL,
	"max_simultaneous_bookings" integer,
	"buffer_before_minutes" integer DEFAULT 0 NOT NULL,
	"buffer_after_minutes" integer DEFAULT 0 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_accounts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"payment_processor_account_id" text NOT NULL,
	"stripe_account_id" varchar(255) NOT NULL,
	"account_type" varchar(30) DEFAULT 'express' NOT NULL,
	"country" varchar(2),
	"default_currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"charges_enabled" boolean DEFAULT false NOT NULL,
	"payouts_enabled" boolean DEFAULT false NOT NULL,
	"details_submitted" boolean DEFAULT false NOT NULL,
	"account_usage_model" varchar(40) DEFAULT 'platform_mor' NOT NULL,
	"merchant_model" varchar(40) DEFAULT 'merchant_of_record' NOT NULL,
	"is_default_for_charges" boolean DEFAULT false NOT NULL,
	"is_default_for_payouts" boolean DEFAULT false NOT NULL,
	"requirements_current_deadline" timestamp with time zone,
	"capabilities" jsonb DEFAULT '{}'::jsonb,
	"business_profile" jsonb DEFAULT '{}'::jsonb,
	"settings" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_checkout_sessions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"booking_order_id" text,
	"cross_biz_order_id" text,
	"payment_intent_ref_id" text,
	"stripe_customer_ref_id" text,
	"stripe_account_ref_id" text NOT NULL,
	"stripe_checkout_session_id" varchar(255) NOT NULL,
	"mode" varchar(30) NOT NULL,
	"status" varchar(30),
	"payment_status" varchar(30),
	"url" varchar(1000),
	"expires_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"livemode" boolean DEFAULT false NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_customers" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"stripe_account_ref_id" text NOT NULL,
	"user_id" text,
	"group_account_id" text,
	"stripe_customer_id" varchar(255) NOT NULL,
	"email" varchar(255),
	"name" varchar(255),
	"phone" varchar(50),
	"default_payment_method_stripe_id" varchar(255),
	"livemode" boolean DEFAULT false NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_invoices" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"booking_order_id" text,
	"cross_biz_order_id" text,
	"stripe_customer_ref_id" text,
	"stripe_account_ref_id" text NOT NULL,
	"stripe_invoice_id" varchar(255) NOT NULL,
	"status" varchar(30),
	"billing_reason" varchar(50),
	"amount_due" integer DEFAULT 0 NOT NULL,
	"amount_paid" integer DEFAULT 0 NOT NULL,
	"amount_remaining" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"hosted_invoice_url" varchar(1000),
	"invoice_pdf_url" varchar(1000),
	"due_at" timestamp with time zone,
	"paid_at" timestamp with time zone,
	"livemode" boolean DEFAULT false NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_payment_methods" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"stripe_customer_ref_id" text,
	"stripe_payment_method_id" varchar(255) NOT NULL,
	"type" varchar(50),
	"brand" varchar(50),
	"last4" varchar(4),
	"exp_month" integer,
	"exp_year" integer,
	"fingerprint" varchar(255),
	"country" varchar(2),
	"funding" varchar(20),
	"is_default" boolean DEFAULT false NOT NULL,
	"livemode" boolean DEFAULT false NOT NULL,
	"billing_details" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_payouts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"stripe_account_ref_id" text NOT NULL,
	"stripe_payout_id" varchar(255) NOT NULL,
	"amount" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"status" varchar(30) NOT NULL,
	"arrival_at" timestamp with time zone,
	"failure_code" varchar(120),
	"failure_message" varchar(2000),
	"method" varchar(50),
	"statement_descriptor" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_setup_intents" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"user_id" text,
	"group_account_id" text,
	"stripe_customer_ref_id" text,
	"stripe_setup_intent_id" varchar(255) NOT NULL,
	"status" varchar(50) NOT NULL,
	"usage" varchar(50),
	"stripe_payment_method_id" varchar(255),
	"last_setup_error" jsonb DEFAULT '{}'::jsonb,
	"livemode" boolean DEFAULT false NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_transfers" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"booking_order_id" text,
	"cross_biz_order_id" text,
	"payment_intent_ref_id" text,
	"payment_transaction_ref_id" text,
	"destination_account_ref_id" text NOT NULL,
	"stripe_transfer_id" varchar(255) NOT NULL,
	"amount" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"transfer_group" varchar(255),
	"source_transaction_id" varchar(255),
	"status" varchar(30) DEFAULT 'pending' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "stripe_webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text,
	"stripe_event_id" varchar(255) NOT NULL,
	"stripe_account_id" varchar(255),
	"stripe_account_ref_id" text,
	"event_type" varchar(120) NOT NULL,
	"api_version" varchar(50),
	"livemode" boolean DEFAULT false NOT NULL,
	"event_created_at" timestamp with time zone,
	"payload" jsonb NOT NULL,
	"signature_verified" boolean DEFAULT false NOT NULL,
	"processing_status" varchar(30) DEFAULT 'pending' NOT NULL,
	"attempts" integer DEFAULT 0 NOT NULL,
	"processed_at" timestamp with time zone,
	"processing_error" varchar(2000),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "subject_location_bindings" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"subject_type" varchar(80) NOT NULL,
	"subject_id" varchar(140) NOT NULL,
	"location_id" text NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"effective_from" timestamp with time zone,
	"effective_to" timestamp with time zone,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "subject_relationships" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"from_subject_type" varchar(80) NOT NULL,
	"from_subject_id" varchar(140) NOT NULL,
	"to_subject_type" varchar(80) NOT NULL,
	"to_subject_id" varchar(140) NOT NULL,
	"relationship_type" varchar(120) NOT NULL,
	"direction" "subject_relationship_direction" DEFAULT 'directed' NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"effective_from" timestamp with time zone,
	"effective_to" timestamp with time zone,
	"priority" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "subjects" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"subject_type" varchar(80) NOT NULL,
	"subject_id" varchar(140) NOT NULL,
	"display_name" varchar(240),
	"category" varchar(80),
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"is_linkable" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "offer_component_seat_types" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"offer_version_id" text NOT NULL,
	"component_id" text,
	"code" varchar(100) NOT NULL,
	"name" varchar(150) NOT NULL,
	"description" text,
	"min_seats" integer DEFAULT 0 NOT NULL,
	"max_seats" integer,
	"default_seats" integer DEFAULT 0 NOT NULL,
	"pricing_mode" "offer_seat_pricing_mode" DEFAULT 'included' NOT NULL,
	"price_delta_minor" integer,
	"price_multiplier_bps" integer,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "offer_component_selectors" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"component_id" text NOT NULL,
	"selector_type" "resource_selector_type" NOT NULL,
	"resource_id" text,
	"resource_type" "resource_type",
	"capability_template_id" text,
	"location_id" text,
	"subject_type" varchar(80),
	"subject_id" varchar(140),
	"weight" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "offer_components" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"offer_version_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"target_type" "resource_type" NOT NULL,
	"mode" "requirement_mode" DEFAULT 'required' NOT NULL,
	"selector_match_mode" "selector_match_mode" DEFAULT 'any' NOT NULL,
	"min_quantity" integer DEFAULT 1 NOT NULL,
	"max_quantity" integer,
	"allow_substitution" boolean DEFAULT true NOT NULL,
	"description" text,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "offer_version_admission_modes" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"offer_version_id" text NOT NULL,
	"mode" "offer_execution_mode" NOT NULL,
	"mode_config_value_id" text,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"is_customer_visible" boolean DEFAULT true NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"effective_start_at" timestamp with time zone,
	"effective_end_at" timestamp with time zone,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "offer_versions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"offer_id" text NOT NULL,
	"version" integer NOT NULL,
	"status" "offer_version_status" DEFAULT 'draft' NOT NULL,
	"status_config_value_id" text,
	"publish_at" timestamp with time zone,
	"retire_at" timestamp with time zone,
	"duration_mode" "duration_mode" DEFAULT 'fixed' NOT NULL,
	"duration_mode_config_value_id" text,
	"default_duration_min" integer DEFAULT 60 NOT NULL,
	"min_duration_min" integer,
	"max_duration_min" integer,
	"duration_step_min" integer DEFAULT 15 NOT NULL,
	"base_price_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"pricing_model" jsonb DEFAULT '{}'::jsonb,
	"policy_model" jsonb DEFAULT '{}'::jsonb,
	"capacity_model" jsonb DEFAULT '{}'::jsonb,
	"revision_hash" varchar(128),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "offers" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(255) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" text,
	"execution_mode" "offer_execution_mode" NOT NULL,
	"execution_mode_config_value_id" text,
	"status" "offer_status" DEFAULT 'draft' NOT NULL,
	"status_config_value_id" text,
	"is_published" boolean DEFAULT false NOT NULL,
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "resource_capability_assignments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"capability_template_id" text NOT NULL,
	"proficiency_score" integer,
	"is_primary" boolean DEFAULT false NOT NULL,
	"valid_from" timestamp with time zone,
	"valid_to" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "resource_capability_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"scope" "resource_capability_scope" NOT NULL,
	"name" varchar(180) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" text,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "resource_condition_reports" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"report_type" "resource_condition_report_type" NOT NULL,
	"reporter_user_id" text,
	"reported_at" timestamp with time zone DEFAULT now() NOT NULL,
	"severity" integer DEFAULT 1 NOT NULL,
	"summary" varchar(280) NOT NULL,
	"notes" text,
	"checklist" jsonb DEFAULT '{}'::jsonb,
	"media_evidence" jsonb DEFAULT '[]'::jsonb,
	"resolved_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "resource_maintenance_policies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"resource_id" text,
	"capability_template_id" text,
	"scope_resource_type" "resource_capability_scope",
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"trigger_type" "maintenance_trigger_type" NOT NULL,
	"threshold_value" integer,
	"trigger_expression" varchar(300),
	"action_type" "maintenance_action_type" NOT NULL,
	"auto_create_work_order" boolean DEFAULT true NOT NULL,
	"block_until_completed" boolean DEFAULT false NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "resource_maintenance_work_orders" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"policy_id" text,
	"calendar_id" text,
	"calendar_timeline_event_id" text,
	"title" varchar(220) NOT NULL,
	"description" text,
	"status" "maintenance_work_order_status" DEFAULT 'open' NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"opened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"scheduled_start_at" timestamp with time zone,
	"scheduled_end_at" timestamp with time zone,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"blocks_availability" boolean DEFAULT true NOT NULL,
	"resolution_notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "resource_usage_counters" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"counter_key" varchar(120) NOT NULL,
	"unit" varchar(40) NOT NULL,
	"current_value" integer DEFAULT 0 NOT NULL,
	"last_increment_at" timestamp with time zone,
	"last_reset_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "availability_dependency_rule_targets" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"availability_dependency_rule_id" text NOT NULL,
	"target_type" "availability_dependency_target_type" NOT NULL,
	"required_calendar_id" text,
	"required_subject_type" varchar(80),
	"required_subject_id" varchar(140),
	"role_key" varchar(80),
	"weight" integer DEFAULT 1 NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "availability_dependency_rules" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"dependent_calendar_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"description" varchar(700),
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"enforcement_mode" "availability_dependency_enforcement_mode" DEFAULT 'hard_block' NOT NULL,
	"evaluation_mode" "availability_dependency_evaluation_mode" DEFAULT 'all' NOT NULL,
	"failure_action" "availability_rule_action" DEFAULT 'unavailable' NOT NULL,
	"capacity_delta" integer,
	"pricing_adjustment" jsonb,
	"time_offset_before_min" integer DEFAULT 0 NOT NULL,
	"time_offset_after_min" integer DEFAULT 0 NOT NULL,
	"min_satisfied_count" integer,
	"min_satisfied_percent" integer,
	"effective_start_at" timestamp with time zone,
	"effective_end_at" timestamp with time zone,
	"request_key" varchar(140),
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "availability_gates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"calendar_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"signal_type" "availability_gate_signal_type" DEFAULT 'manual' NOT NULL,
	"action" "availability_rule_action" NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"window_start_at" timestamp with time zone NOT NULL,
	"window_end_at" timestamp with time zone,
	"capacity_delta" integer,
	"pricing_adjustment" jsonb,
	"source_ref_type" varchar(80),
	"source_ref_id" text,
	"request_key" varchar(140),
	"signal_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "availability_resolution_runs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"calendar_id" text NOT NULL,
	"request_key" varchar(140),
	"window_start_at" timestamp with time zone NOT NULL,
	"window_end_at" timestamp with time zone NOT NULL,
	"status" "availability_resolution_status" NOT NULL,
	"request_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"decision_trace" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"resolved_output" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"runtime_ms" integer,
	"resolved_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "availability_rule_exclusion_dates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"availability_rule_id" text NOT NULL,
	"exclusion_date" date NOT NULL,
	"reason_code" varchar(120),
	"note" varchar(600),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "availability_rule_template_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"availability_rule_template_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"mode" "availability_rule_mode" NOT NULL,
	"frequency" "availability_rule_frequency" DEFAULT 'none' NOT NULL,
	"recurrence_rule" varchar(500),
	"day_of_week" integer,
	"day_of_month" integer,
	"start_date" date,
	"end_date" date,
	"start_time" time,
	"end_time" time,
	"start_at" timestamp with time zone,
	"end_at" timestamp with time zone,
	"action" "availability_rule_action" NOT NULL,
	"capacity_delta" integer,
	"pricing_adjustment" jsonb,
	"priority" integer DEFAULT 100 NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "availability_rule_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" varchar(800),
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "availability_rules" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"calendar_id" text NOT NULL,
	"overlay_id" text,
	"name" varchar(200) NOT NULL,
	"mode" "availability_rule_mode" NOT NULL,
	"frequency" "availability_rule_frequency" DEFAULT 'none' NOT NULL,
	"recurrence_rule" varchar(500),
	"day_of_week" integer,
	"day_of_month" integer,
	"start_date" date,
	"end_date" date,
	"start_time" time,
	"end_time" time,
	"start_at" timestamp with time zone,
	"end_at" timestamp with time zone,
	"action" "availability_rule_action" NOT NULL,
	"capacity_delta" integer,
	"pricing_adjustment" jsonb,
	"priority" integer DEFAULT 100 NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "calendar_bindings" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"calendar_id" text NOT NULL,
	"owner_type" "calendar_owner_type" NOT NULL,
	"resource_id" text,
	"service_id" text,
	"service_product_id" text,
	"offer_id" text,
	"offer_version_id" text,
	"location_id" text,
	"owner_user_id" text,
	"owner_ref_type" varchar(80),
	"owner_ref_id" text,
	"is_primary" boolean DEFAULT true NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "calendar_overlays" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"calendar_id" text NOT NULL,
	"kind" "calendar_overlay_kind" NOT NULL,
	"name" varchar(180) NOT NULL,
	"description" varchar(600),
	"priority" integer DEFAULT 100 NOT NULL,
	"effective_start_at" timestamp with time zone,
	"effective_end_at" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "calendar_revisions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"calendar_id" text NOT NULL,
	"revision" integer NOT NULL,
	"change_type" varchar(120) NOT NULL,
	"change_summary" varchar(1000),
	"source_ref_type" varchar(80),
	"source_ref_id" text,
	"idempotency_key" varchar(200),
	"snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "calendar_rule_template_binding_exclusion_dates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"calendar_rule_template_binding_id" text NOT NULL,
	"exclusion_date" date NOT NULL,
	"reason_code" varchar(120),
	"note" varchar(600),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "calendar_rule_template_bindings" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"calendar_id" text NOT NULL,
	"availability_rule_template_id" text NOT NULL,
	"merge_mode" "calendar_template_merge_mode" DEFAULT 'append' NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"effective_start_at" timestamp with time zone,
	"effective_end_at" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "calendar_timeline_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"calendar_id" text NOT NULL,
	"source_type" "calendar_timeline_event_source_type" NOT NULL,
	"state" "calendar_timeline_state" NOT NULL,
	"visibility" "calendar_timeline_visibility" DEFAULT 'private' NOT NULL,
	"title" varchar(260),
	"summary" varchar(1000),
	"start_at" timestamp with time zone NOT NULL,
	"end_at" timestamp with time zone NOT NULL,
	"is_all_day" boolean DEFAULT false NOT NULL,
	"source_ref_type" varchar(80),
	"source_ref_id" text,
	"correlation_id" varchar(200),
	"idempotency_key" varchar(200),
	"is_active" boolean DEFAULT true NOT NULL,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "calendars" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"slot_duration_min" integer DEFAULT 30 NOT NULL,
	"slot_interval_min" integer DEFAULT 15 NOT NULL,
	"pre_buffer_min" integer DEFAULT 0 NOT NULL,
	"post_buffer_min" integer DEFAULT 0 NOT NULL,
	"min_advance_booking_hours" integer DEFAULT 0 NOT NULL,
	"max_advance_booking_days" integer DEFAULT 365 NOT NULL,
	"default_mode" "availability_default_mode" DEFAULT 'available_by_default' NOT NULL,
	"rule_evaluation_order" "calendar_rule_evaluation_order" DEFAULT 'specificity_then_priority' NOT NULL,
	"conflict_resolution_mode" "calendar_conflict_resolution_mode" DEFAULT 'unavailable_wins' NOT NULL,
	"enforce_strict_non_overlap" boolean DEFAULT false NOT NULL,
	"emit_timeline_facts" boolean DEFAULT true NOT NULL,
	"status" "calendar_status" DEFAULT 'active' NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "capacity_holds" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"calendar_id" text NOT NULL,
	"target_type" "capacity_hold_target_type" NOT NULL,
	"capacity_pool_id" text,
	"resource_id" text,
	"offer_version_id" text,
	"target_ref_type" varchar(80),
	"target_ref_id" text,
	"status" "capacity_hold_status" DEFAULT 'active' NOT NULL,
	"quantity" integer DEFAULT 1 NOT NULL,
	"starts_at" timestamp with time zone NOT NULL,
	"ends_at" timestamp with time zone NOT NULL,
	"expires_at" timestamp with time zone,
	"released_at" timestamp with time zone,
	"consumed_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"source_signal_type" "availability_gate_signal_type" DEFAULT 'manual' NOT NULL,
	"source_ref_type" varchar(80),
	"source_ref_id" text,
	"request_key" varchar(140),
	"reason_code" varchar(120),
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "capacity_pool_members" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"capacity_pool_id" text NOT NULL,
	"member_type" "capacity_pool_member_type" NOT NULL,
	"resource_id" text,
	"offer_version_id" text,
	"location_id" text,
	"member_ref_type" varchar(80),
	"member_ref_id" text,
	"capacity_weight" integer DEFAULT 1 NOT NULL,
	"reserved_capacity" integer DEFAULT 0 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "capacity_pools" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "capacity_pool_status" DEFAULT 'active' NOT NULL,
	"total_capacity" integer NOT NULL,
	"overbook_capacity" integer DEFAULT 0 NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "calendar_access_grant_sources" (
	"id" text PRIMARY KEY NOT NULL,
	"owner_user_id" text NOT NULL,
	"grantee_biz_id" text NOT NULL,
	"calendar_access_grant_id" text NOT NULL,
	"source_type" "calendar_grant_source_type" NOT NULL,
	"external_calendar_id" text,
	"source_biz_id" text,
	"calendar_binding_id" text,
	"is_included" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "calendar_access_grants" (
	"id" text PRIMARY KEY NOT NULL,
	"owner_user_id" text NOT NULL,
	"grantee_biz_id" text NOT NULL,
	"status" "calendar_access_grant_status" DEFAULT 'granted' NOT NULL,
	"access_level" "calendar_access_level" DEFAULT 'free_busy' NOT NULL,
	"scope" "calendar_grant_scope" DEFAULT 'all_sources' NOT NULL,
	"allow_availability_computation" boolean DEFAULT true NOT NULL,
	"allow_conflict_detection" boolean DEFAULT true NOT NULL,
	"allow_write_back_busy_blocks" boolean DEFAULT false NOT NULL,
	"granted_by_user_id" text,
	"granted_at" timestamp with time zone DEFAULT now() NOT NULL,
	"revoked_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"reason" varchar(1000),
	"metadata" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "calendar_sync_connections" (
	"id" text PRIMARY KEY NOT NULL,
	"owner_user_id" text NOT NULL,
	"provider" "calendar_sync_provider" NOT NULL,
	"provider_account_ref" varchar(255) NOT NULL,
	"display_name" varchar(255),
	"status" "calendar_sync_connection_status" DEFAULT 'active' NOT NULL,
	"auth_secret_ref" varchar(255) NOT NULL,
	"refresh_secret_ref" varchar(255),
	"granted_scopes" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"provider_timezone" varchar(50),
	"sync_cursor" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"last_successful_sync_at" timestamp with time zone,
	"last_failed_sync_at" timestamp with time zone,
	"last_failure_reason" varchar(1000),
	"webhook_channel_ref" varchar(255),
	"metadata" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_calendar_events" (
	"id" text PRIMARY KEY NOT NULL,
	"owner_user_id" text NOT NULL,
	"external_calendar_id" text NOT NULL,
	"provider_event_ref" varchar(255) NOT NULL,
	"ical_uid" varchar(255),
	"event_status" "external_calendar_event_status" DEFAULT 'confirmed' NOT NULL,
	"busy_status" "external_calendar_event_busy_status" DEFAULT 'busy' NOT NULL,
	"title" varchar(500),
	"starts_at" timestamp with time zone NOT NULL,
	"ends_at" timestamp with time zone NOT NULL,
	"is_all_day" boolean DEFAULT false NOT NULL,
	"source_created_at" timestamp with time zone,
	"source_updated_at" timestamp with time zone,
	"last_seen_at" timestamp with time zone DEFAULT now() NOT NULL,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "external_calendars" (
	"id" text PRIMARY KEY NOT NULL,
	"owner_user_id" text NOT NULL,
	"calendar_sync_connection_id" text NOT NULL,
	"provider_calendar_ref" varchar(255) NOT NULL,
	"name" varchar(255) NOT NULL,
	"description" varchar(600),
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"color" varchar(32),
	"is_primary" boolean DEFAULT false NOT NULL,
	"is_selected_for_sync" boolean DEFAULT true NOT NULL,
	"is_read_only" boolean DEFAULT false NOT NULL,
	"sync_state" "external_calendar_sync_state" DEFAULT 'pending' NOT NULL,
	"last_synced_at" timestamp with time zone,
	"last_sync_error_at" timestamp with time zone,
	"last_sync_error_reason" varchar(1000),
	"metadata" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "booking_order_lines" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"booking_order_id" text NOT NULL,
	"line_type" "booking_order_line_type" NOT NULL,
	"label" varchar(240) NOT NULL,
	"description" text,
	"offer_component_id" text,
	"seat_type_id" text,
	"quantity" integer DEFAULT 1 NOT NULL,
	"unit_amount_minor" integer NOT NULL,
	"line_total_minor" integer NOT NULL,
	"pricing_detail" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "booking_orders" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"offer_id" text NOT NULL,
	"offer_version_id" text NOT NULL,
	"customer_user_id" text,
	"customer_group_account_id" text,
	"status" "booking_order_status" DEFAULT 'draft' NOT NULL,
	"status_config_value_id" text,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"subtotal_minor" integer DEFAULT 0 NOT NULL,
	"tax_minor" integer DEFAULT 0 NOT NULL,
	"fee_minor" integer DEFAULT 0 NOT NULL,
	"discount_minor" integer DEFAULT 0 NOT NULL,
	"total_minor" integer DEFAULT 0 NOT NULL,
	"requested_start_at" timestamp with time zone,
	"requested_end_at" timestamp with time zone,
	"confirmed_start_at" timestamp with time zone,
	"confirmed_end_at" timestamp with time zone,
	"pricing_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fulfillment_assignments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"fulfillment_unit_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"status" "fulfillment_assignment_status" DEFAULT 'proposed' NOT NULL,
	"status_config_value_id" text,
	"conflict_policy" "fulfillment_assignment_conflict_policy" DEFAULT 'enforce_no_overlap' NOT NULL,
	"role_label" varchar(120),
	"starts_at" timestamp with time zone,
	"ends_at" timestamp with time zone,
	"is_primary" boolean DEFAULT false NOT NULL,
	"compensation_split_bps" integer,
	"assigned_by_user_id" text,
	"assigned_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fulfillment_checkpoints" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"fulfillment_unit_id" text NOT NULL,
	"checkpoint_type" "fulfillment_checkpoint_type" NOT NULL,
	"status" "fulfillment_checkpoint_status" DEFAULT 'pending' NOT NULL,
	"status_config_value_id" text,
	"sequence" integer DEFAULT 1 NOT NULL,
	"expected_at" timestamp with time zone,
	"recorded_at" timestamp with time zone,
	"recorded_by_user_id" text,
	"evidence" jsonb DEFAULT '{}'::jsonb,
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fulfillment_dependencies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"predecessor_unit_id" text NOT NULL,
	"successor_unit_id" text NOT NULL,
	"dependency_type" "fulfillment_dependency_type" NOT NULL,
	"min_gap_min" integer,
	"max_gap_min" integer,
	"hard_block" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fulfillment_units" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"booking_order_id" text NOT NULL,
	"offer_component_id" text,
	"kind" "fulfillment_unit_kind" DEFAULT 'service_task' NOT NULL,
	"status" "fulfillment_unit_status" DEFAULT 'planned' NOT NULL,
	"status_config_value_id" text,
	"code" varchar(140),
	"planned_start_at" timestamp with time zone,
	"planned_end_at" timestamp with time zone,
	"actual_start_at" timestamp with time zone,
	"actual_end_at" timestamp with time zone,
	"location_id" text,
	"calendar_binding_id" text,
	"queue_entry_id" varchar(64),
	"transport_trip_id" varchar(64),
	"assignment_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "standing_reservation_contracts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"offer_id" text NOT NULL,
	"offer_version_id" text NOT NULL,
	"location_id" text,
	"customer_user_id" text,
	"customer_group_account_id" text,
	"name" varchar(200) NOT NULL,
	"description" text,
	"status" "standing_reservation_contract_status" DEFAULT 'draft' NOT NULL,
	"status_config_value_id" text,
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"anchor_start_at" timestamp with time zone NOT NULL,
	"default_duration_min" integer DEFAULT 60 NOT NULL,
	"recurrence_rule" varchar(500) NOT NULL,
	"effective_start_date" date NOT NULL,
	"effective_end_date" date,
	"auto_create_orders" boolean DEFAULT true NOT NULL,
	"max_generated_ahead_days" integer DEFAULT 60 NOT NULL,
	"next_planned_occurrence_at" timestamp with time zone,
	"last_occurrence_generated_at" timestamp with time zone,
	"paused_at" timestamp with time zone,
	"resume_at" timestamp with time zone,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "standing_reservation_exceptions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"standing_reservation_contract_id" text NOT NULL,
	"action" "standing_reservation_exception_action" NOT NULL,
	"target_occurrence_key" varchar(120),
	"target_local_date" date,
	"override_start_at" timestamp with time zone,
	"override_end_at" timestamp with time zone,
	"override_location_id" text,
	"override_offer_version_id" text,
	"reason" text,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "standing_reservation_occurrences" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"standing_reservation_contract_id" text NOT NULL,
	"occurrence_key" varchar(120) NOT NULL,
	"occurrence_local_date" date NOT NULL,
	"planned_start_at" timestamp with time zone NOT NULL,
	"planned_end_at" timestamp with time zone NOT NULL,
	"status" "standing_reservation_occurrence_status" DEFAULT 'planned' NOT NULL,
	"status_config_value_id" text,
	"booking_order_id" text,
	"generated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"booked_at" timestamp with time zone,
	"fulfilled_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"skipped_at" timestamp with time zone,
	"skip_reason" text,
	"failure_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_disputes" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"payment_transaction_id" text NOT NULL,
	"payment_intent_id" text,
	"status" "payment_dispute_status" DEFAULT 'needs_response' NOT NULL,
	"amount_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"reason_code" varchar(120),
	"provider_dispute_ref" varchar(200),
	"opened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"response_due_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"evidence_payload" jsonb DEFAULT '{}'::jsonb,
	"outcome_payload" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_intent_line_allocations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"payment_intent_id" text NOT NULL,
	"payment_intent_tender_id" text NOT NULL,
	"booking_order_id" text NOT NULL,
	"booking_order_line_id" text NOT NULL,
	"allocated_minor" integer NOT NULL,
	"captured_minor" integer DEFAULT 0 NOT NULL,
	"refunded_minor" integer DEFAULT 0 NOT NULL,
	"sort_order" integer DEFAULT 1 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_intent_tenders" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"payment_intent_id" text NOT NULL,
	"payment_method_id" text,
	"gift_instrument_id" text,
	"method_type" "payment_method_type" NOT NULL,
	"allocated_minor" integer NOT NULL,
	"captured_minor" integer DEFAULT 0 NOT NULL,
	"refunded_minor" integer DEFAULT 0 NOT NULL,
	"sort_order" integer DEFAULT 1 NOT NULL,
	"external_tender_ref" varchar(200),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_intents" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"booking_order_id" text,
	"cross_biz_order_id" text,
	"payment_processor_account_id" text,
	"status" "payment_intent_status" DEFAULT 'requires_payment_method' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"amount_target_minor" integer NOT NULL,
	"amount_captured_minor" integer DEFAULT 0 NOT NULL,
	"amount_refunded_minor" integer DEFAULT 0 NOT NULL,
	"requires_capture" boolean DEFAULT false NOT NULL,
	"provider_intent_ref" varchar(200),
	"source" varchar(40) DEFAULT 'api' NOT NULL,
	"authorized_at" timestamp with time zone,
	"captured_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"amount_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_methods" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"owner_user_id" text,
	"payment_processor_account_id" text,
	"type" "payment_method_type" NOT NULL,
	"provider" varchar(80) NOT NULL,
	"provider_method_ref" varchar(200) NOT NULL,
	"label" varchar(120),
	"card_brand" varchar(40),
	"card_last4" varchar(4),
	"card_exp_month" integer,
	"card_exp_year" integer,
	"is_default" boolean DEFAULT false NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_processor_accounts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"provider_key" varchar(120) NOT NULL,
	"processor_account_ref" varchar(220) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"ownership_model" varchar(40) DEFAULT 'platform_managed' NOT NULL,
	"commerce_model" varchar(40) DEFAULT 'merchant_of_record' NOT NULL,
	"is_default" boolean DEFAULT false NOT NULL,
	"charges_enabled" boolean DEFAULT true NOT NULL,
	"payouts_enabled" boolean DEFAULT true NOT NULL,
	"supports_split_tender" boolean DEFAULT true NOT NULL,
	"supports_disputes" boolean DEFAULT true NOT NULL,
	"supports_refunds" boolean DEFAULT true NOT NULL,
	"secret_ref" varchar(255),
	"configuration" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"capabilities" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_transaction_line_allocations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"payment_transaction_id" text NOT NULL,
	"payment_intent_id" text NOT NULL,
	"payment_intent_tender_id" text,
	"booking_order_id" text NOT NULL,
	"booking_order_line_id" text NOT NULL,
	"payment_intent_line_allocation_id" text,
	"amount_minor" integer NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"idempotency_key" varchar(200),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payment_transactions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"payment_intent_id" text,
	"booking_order_id" text,
	"cross_biz_order_id" text,
	"payment_intent_tender_id" text,
	"payment_method_id" text,
	"payment_processor_account_id" text,
	"gift_instrument_id" text,
	"type" "payment_transaction_type" NOT NULL,
	"status" "payment_transaction_status" DEFAULT 'pending' NOT NULL,
	"amount_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"provider_transaction_ref" varchar(200),
	"idempotency_key" varchar(200),
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"failure_reason" varchar(400),
	"provider_payload" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payout_ledger_entries" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"payout_id" text NOT NULL,
	"settlement_entry_id" text,
	"entry_type" "payout_ledger_entry_type" NOT NULL,
	"amount_minor" integer NOT NULL,
	"description" varchar(500),
	"recorded_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "payouts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"settlement_batch_id" text,
	"payment_processor_account_id" text,
	"status" "payout_status" DEFAULT 'pending' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"amount_minor" integer NOT NULL,
	"destination_ref" varchar(200) NOT NULL,
	"provider_payout_ref" varchar(200),
	"initiated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"expected_arrival_at" timestamp with time zone,
	"paid_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"failure_reason" varchar(400),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "settlement_batches" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"status" "settlement_batch_status" DEFAULT 'open' NOT NULL,
	"payment_processor_account_id" text,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"period_start_at" timestamp with time zone NOT NULL,
	"period_end_at" timestamp with time zone NOT NULL,
	"gross_minor" integer DEFAULT 0 NOT NULL,
	"fees_minor" integer DEFAULT 0 NOT NULL,
	"net_minor" integer DEFAULT 0 NOT NULL,
	"entry_count" integer DEFAULT 0 NOT NULL,
	"payout_due_at" timestamp with time zone,
	"paid_at" timestamp with time zone,
	"provider_batch_ref" varchar(200),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "settlement_entries" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"settlement_batch_id" text NOT NULL,
	"payment_transaction_id" text,
	"booking_order_id" text,
	"cross_biz_order_id" text,
	"entry_type" "payment_transaction_type" NOT NULL,
	"amount_minor" integer NOT NULL,
	"description" varchar(500),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "compensation_assignment_roles" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"fulfillment_assignment_id" text NOT NULL,
	"role_template_id" text NOT NULL,
	"source" varchar(60) DEFAULT 'manual' NOT NULL,
	"assigned_at" timestamp with time zone DEFAULT now() NOT NULL,
	"assigned_by_user_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "compensation_ledger_entries" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"payee_resource_id" text NOT NULL,
	"role_template_id" text,
	"compensation_assignment_role_id" text,
	"compensation_plan_version_id" text,
	"compensation_plan_rule_id" text,
	"booking_order_id" text,
	"booking_order_line_id" text,
	"fulfillment_unit_id" text,
	"fulfillment_assignment_id" text,
	"staffing_assignment_id" text,
	"work_time_segment_id" text,
	"payment_transaction_id" text,
	"cross_biz_order_id" text,
	"entry_type" "compensation_ledger_entry_type" NOT NULL,
	"amount_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_at" timestamp with time zone,
	"description" varchar(500),
	"idempotency_key" varchar(200),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "compensation_pay_run_item_entries" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"compensation_pay_run_item_id" text NOT NULL,
	"compensation_ledger_entry_id" text NOT NULL,
	"included_amount_minor" integer NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "compensation_pay_run_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"compensation_pay_run_id" text NOT NULL,
	"payee_resource_id" text NOT NULL,
	"status" "compensation_pay_run_item_status" DEFAULT 'pending' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"accrual_minor" integer DEFAULT 0 NOT NULL,
	"adjustment_minor" integer DEFAULT 0 NOT NULL,
	"deduction_minor" integer DEFAULT 0 NOT NULL,
	"net_minor" integer DEFAULT 0 NOT NULL,
	"entry_count" integer DEFAULT 0 NOT NULL,
	"payout_id" text,
	"payout_destination_ref" varchar(200),
	"paid_at" timestamp with time zone,
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "compensation_pay_runs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"status" "compensation_pay_run_status" DEFAULT 'draft' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"period_start_at" timestamp with time zone NOT NULL,
	"period_end_at" timestamp with time zone NOT NULL,
	"scheduled_pay_at" timestamp with time zone,
	"approved_by_user_id" text,
	"approved_at" timestamp with time zone,
	"finalized_at" timestamp with time zone,
	"paid_at" timestamp with time zone,
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "compensation_plan_rules" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"compensation_plan_version_id" text NOT NULL,
	"name" varchar(160) NOT NULL,
	"description" text,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"role_template_id" text,
	"selector_type" "compensation_rule_selector_type" NOT NULL,
	"resource_id" text,
	"resource_type" "resource_type",
	"capability_template_id" text,
	"location_id" text,
	"service_id" text,
	"service_product_id" text,
	"offer_component_id" text,
	"calculation_mode" "compensation_calculation_mode" NOT NULL,
	"flat_amount_minor" integer,
	"base_amount_minor" integer,
	"percent_bps" integer,
	"hourly_rate_minor" integer,
	"minimum_payout_minor" integer,
	"maximum_payout_minor" integer,
	"apply_per_quantity" boolean DEFAULT false NOT NULL,
	"effective_from_at" timestamp with time zone,
	"effective_to_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "compensation_plan_versions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"compensation_plan_id" text NOT NULL,
	"version_number" integer NOT NULL,
	"status" "compensation_plan_version_status" DEFAULT 'draft' NOT NULL,
	"effective_from_at" timestamp with time zone NOT NULL,
	"effective_to_at" timestamp with time zone,
	"is_current" boolean DEFAULT false NOT NULL,
	"notes" text,
	"calculation_policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "compensation_plans" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" text,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"location_id" text,
	"service_id" text,
	"service_product_id" text,
	"is_default" boolean DEFAULT false NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "compensation_role_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"name" varchar(140) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" text,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "demand_pricing_applications" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"demand_pricing_evaluation_id" text NOT NULL,
	"booking_order_id" text,
	"booking_order_line_id" text,
	"applied_amount_minor" integer NOT NULL,
	"applied_final_unit_price_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"applied_at" timestamp with time zone DEFAULT now() NOT NULL,
	"is_locked" boolean DEFAULT false NOT NULL,
	"reversal_of_application_id" text,
	"note" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "demand_pricing_evaluations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"demand_pricing_policy_id" text NOT NULL,
	"demand_pricing_policy_tier_id" text,
	"booking_order_id" text,
	"booking_order_line_id" text,
	"window_start_at" timestamp with time zone,
	"window_end_at" timestamp with time zone,
	"status" "demand_pricing_evaluation_status" NOT NULL,
	"base_unit_price_minor" integer NOT NULL,
	"computed_score" integer,
	"adjustment_type" "pricing_adjustment_type",
	"apply_as" "pricing_apply_as",
	"adjustment_value" integer,
	"adjustment_amount_minor" integer DEFAULT 0 NOT NULL,
	"final_unit_price_minor" integer NOT NULL,
	"reason_code" varchar(120),
	"request_key" varchar(200),
	"signal_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"calculation_trace" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"evaluated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "demand_pricing_policies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" text,
	"status" "demand_pricing_policy_status" DEFAULT 'draft' NOT NULL,
	"target_type" "demand_pricing_target_type" DEFAULT 'global' NOT NULL,
	"resource_id" text,
	"service_id" text,
	"service_product_id" text,
	"offer_id" text,
	"offer_version_id" text,
	"location_id" text,
	"scoring_mode" "demand_pricing_scoring_mode" DEFAULT 'weighted_sum' NOT NULL,
	"score_floor" integer DEFAULT 0 NOT NULL,
	"score_ceiling" integer DEFAULT 10000 NOT NULL,
	"default_adjustment_type" "pricing_adjustment_type" DEFAULT 'percentage' NOT NULL,
	"default_apply_as" "pricing_apply_as" DEFAULT 'surcharge' NOT NULL,
	"default_adjustment_value" integer,
	"min_adjustment_minor" integer,
	"max_adjustment_minor" integer,
	"min_final_unit_price_minor" integer,
	"max_final_unit_price_minor" integer,
	"cooldown_min" integer DEFAULT 0 NOT NULL,
	"effective_start_at" timestamp with time zone,
	"effective_end_at" timestamp with time zone,
	"priority" integer DEFAULT 100 NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "demand_pricing_policy_signals" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"demand_pricing_policy_id" text NOT NULL,
	"demand_signal_definition_id" text NOT NULL,
	"weight_bps" integer DEFAULT 10000 NOT NULL,
	"is_required" boolean DEFAULT false NOT NULL,
	"freshness_max_min" integer DEFAULT 180 NOT NULL,
	"offset_value" integer DEFAULT 0 NOT NULL,
	"multiplier_bps" integer DEFAULT 10000 NOT NULL,
	"clamp_min_value" integer,
	"clamp_max_value" integer,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "demand_pricing_policy_tiers" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"demand_pricing_policy_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"min_score" integer DEFAULT 0 NOT NULL,
	"max_score" integer,
	"adjustment_type" "pricing_adjustment_type" DEFAULT 'percentage' NOT NULL,
	"apply_as" "pricing_apply_as" DEFAULT 'surcharge' NOT NULL,
	"adjustment_value" integer NOT NULL,
	"min_adjustment_minor" integer,
	"max_adjustment_minor" integer,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "demand_signal_definitions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" text,
	"kind" "demand_signal_kind" NOT NULL,
	"source" "demand_signal_source" DEFAULT 'system' NOT NULL,
	"aggregation_method" "demand_signal_aggregation_method" DEFAULT 'avg' NOT NULL,
	"aggregation_window_min" integer DEFAULT 60 NOT NULL,
	"value_scale" integer DEFAULT 10000 NOT NULL,
	"target_type" "demand_pricing_target_type" DEFAULT 'global' NOT NULL,
	"resource_id" text,
	"service_id" text,
	"service_product_id" text,
	"offer_id" text,
	"offer_version_id" text,
	"location_id" text,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "demand_signal_observations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"demand_signal_definition_id" text NOT NULL,
	"window_start_at" timestamp with time zone NOT NULL,
	"window_end_at" timestamp with time zone NOT NULL,
	"observed_at" timestamp with time zone DEFAULT now() NOT NULL,
	"value" integer NOT NULL,
	"sample_size" integer,
	"confidence_bps" integer,
	"source" "demand_signal_source" DEFAULT 'system' NOT NULL,
	"source_ref" varchar(200),
	"idempotency_key" varchar(200),
	"dimensions" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "entitlement_grants" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"wallet_id" text NOT NULL,
	"membership_id" text,
	"booking_order_id" text,
	"grant_type" "entitlement_grant_type" NOT NULL,
	"quantity" integer NOT NULL,
	"valid_from_at" timestamp with time zone NOT NULL,
	"valid_until_at" timestamp with time zone,
	"rollover_eligible" boolean DEFAULT false NOT NULL,
	"transferable" boolean DEFAULT false NOT NULL,
	"reason" varchar(400),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "entitlement_ledger_entries" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"wallet_id" text NOT NULL,
	"grant_id" text,
	"transfer_id" text,
	"booking_order_id" text,
	"fulfillment_unit_id" text,
	"entry_type" "entitlement_ledger_entry_type" NOT NULL,
	"quantity_delta" integer NOT NULL,
	"balance_after" integer NOT NULL,
	"reason_code" varchar(120),
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "entitlement_transfers" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"from_wallet_id" text NOT NULL,
	"to_wallet_id" text NOT NULL,
	"status" "entitlement_transfer_status" DEFAULT 'requested' NOT NULL,
	"quantity" integer NOT NULL,
	"requested_by_user_id" text,
	"reviewed_by_user_id" text,
	"requested_at" timestamp with time zone DEFAULT now() NOT NULL,
	"reviewed_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"reason" varchar(500),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "entitlement_wallets" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"membership_id" text,
	"owner_user_id" text,
	"owner_group_account_id" text,
	"name" varchar(180) NOT NULL,
	"entitlement_type" "entitlement_grant_type" NOT NULL,
	"unit_code" varchar(60) DEFAULT 'credits' NOT NULL,
	"balance_quantity" integer DEFAULT 0 NOT NULL,
	"expires_at" timestamp with time zone,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "membership_plans" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" text,
	"status" "membership_plan_status" DEFAULT 'draft' NOT NULL,
	"billing_interval_count" integer DEFAULT 1 NOT NULL,
	"billing_interval_unit" "membership_billing_interval_unit" DEFAULT 'month' NOT NULL,
	"price_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"entitlement_type" "entitlement_grant_type" NOT NULL,
	"entitlement_quantity_per_cycle" integer DEFAULT 0 NOT NULL,
	"allow_rollover" boolean DEFAULT false NOT NULL,
	"rollover_cap_quantity" integer,
	"allow_transfers" boolean DEFAULT false NOT NULL,
	"transfer_fee_minor" integer DEFAULT 0 NOT NULL,
	"entitlement_policy" jsonb DEFAULT '{}'::jsonb,
	"membership_policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "memberships" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"membership_plan_id" text NOT NULL,
	"owner_user_id" text,
	"owner_group_account_id" text,
	"status" "membership_status" DEFAULT 'trialing' NOT NULL,
	"starts_at" timestamp with time zone NOT NULL,
	"current_period_start_at" timestamp with time zone NOT NULL,
	"current_period_end_at" timestamp with time zone NOT NULL,
	"paused_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"ended_at" timestamp with time zone,
	"auto_renew" boolean DEFAULT true NOT NULL,
	"provider_subscription_ref" varchar(200),
	"status_reason" varchar(400),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "rollover_runs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"membership_plan_id" text,
	"membership_id" text,
	"status" "rollover_run_status" DEFAULT 'pending' NOT NULL,
	"source_period_start_at" timestamp with time zone NOT NULL,
	"source_period_end_at" timestamp with time zone NOT NULL,
	"run_at" timestamp with time zone DEFAULT now() NOT NULL,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"rolled_over_quantity" integer DEFAULT 0 NOT NULL,
	"expired_quantity" integer DEFAULT 0 NOT NULL,
	"summary" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "channel_accounts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"provider" "channel_provider" NOT NULL,
	"name" varchar(180) NOT NULL,
	"status" "channel_connection_status" DEFAULT 'active' NOT NULL,
	"provider_account_ref" varchar(200),
	"scopes" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"auth_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"last_synced_at" timestamp with time zone,
	"last_error" varchar(600),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "channel_entity_links" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"channel_account_id" text NOT NULL,
	"object_type" "channel_object_type" NOT NULL,
	"offer_version_id" text,
	"booking_order_id" text,
	"resource_id" text,
	"customer_user_id" text,
	"local_reference_key" varchar(200),
	"external_object_id" varchar(200) NOT NULL,
	"external_parent_id" varchar(200),
	"sync_hash" varchar(140),
	"is_active" boolean DEFAULT true NOT NULL,
	"last_synced_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "channel_sync_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"channel_sync_job_id" text NOT NULL,
	"channel_entity_link_id" text,
	"object_type" "channel_object_type" NOT NULL,
	"local_reference_key" varchar(200),
	"external_object_id" varchar(200),
	"status" "channel_sync_item_status" DEFAULT 'pending' NOT NULL,
	"error_message" varchar(600),
	"processed_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "channel_sync_jobs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"channel_account_id" text NOT NULL,
	"direction" "channel_sync_direction" NOT NULL,
	"object_type" "channel_object_type" NOT NULL,
	"status" "channel_sync_job_status" DEFAULT 'queued' NOT NULL,
	"requested_at" timestamp with time zone DEFAULT now() NOT NULL,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"cursor_snapshot" jsonb DEFAULT '{}'::jsonb,
	"processed_count" integer DEFAULT 0 NOT NULL,
	"failed_count" integer DEFAULT 0 NOT NULL,
	"summary" varchar(800),
	"error_payload" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "channel_sync_states" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"channel_account_id" text NOT NULL,
	"object_type" "channel_object_type" NOT NULL,
	"direction" "channel_sync_direction" NOT NULL,
	"inbound_cursor" varchar(500),
	"outbound_cursor" varchar(500),
	"last_attempt_at" timestamp with time zone,
	"last_success_at" timestamp with time zone,
	"last_failure" varchar(600),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "channel_webhook_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"channel_account_id" text NOT NULL,
	"status" "channel_webhook_status" DEFAULT 'received' NOT NULL,
	"event_type" varchar(140) NOT NULL,
	"external_event_id" varchar(200) NOT NULL,
	"received_at" timestamp with time zone DEFAULT now() NOT NULL,
	"processed_at" timestamp with time zone,
	"retry_count" integer DEFAULT 0 NOT NULL,
	"error_message" varchar(600),
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "overtime_forecasts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"overtime_policy_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"forecast_date" date NOT NULL,
	"status" "overtime_forecast_status" DEFAULT 'projected' NOT NULL,
	"scheduled_minutes" integer DEFAULT 0 NOT NULL,
	"projected_overtime_minutes" integer DEFAULT 0 NOT NULL,
	"projected_overtime_cost_minor" integer DEFAULT 0 NOT NULL,
	"mitigation_suggestion" varchar(600),
	"feature_snapshot" jsonb DEFAULT '{}'::jsonb,
	"generated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "overtime_policies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"scope" "overtime_policy_scope" NOT NULL,
	"location_id" text,
	"resource_type" "resource_type",
	"resource_id" text,
	"status" "overtime_policy_status" DEFAULT 'active' NOT NULL,
	"daily_threshold_min" integer DEFAULT 480 NOT NULL,
	"weekly_threshold_min" integer DEFAULT 2400 NOT NULL,
	"overtime_rate_bps" integer DEFAULT 15000 NOT NULL,
	"mitigation_policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ranking_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"ranking_profile_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"event_type" "ranking_event_type" NOT NULL,
	"score_delta" integer NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"source_ref" varchar(200),
	"details" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ranking_profiles" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "ranking_model_status" DEFAULT 'draft' NOT NULL,
	"location_id" text,
	"service_id" text,
	"weights" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"is_default" boolean DEFAULT false NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ranking_scores" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"ranking_profile_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"score" integer DEFAULT 0 NOT NULL,
	"percentile" integer,
	"is_manual_override" boolean DEFAULT false NOT NULL,
	"computed_at" timestamp with time zone DEFAULT now() NOT NULL,
	"component_breakdown" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "staffing_assignments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"staffing_demand_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"staffing_response_id" text,
	"fulfillment_assignment_id" text,
	"fulfillment_unit_id" text,
	"status" "staffing_assignment_status" DEFAULT 'planned' NOT NULL,
	"starts_at" timestamp with time zone NOT NULL,
	"ends_at" timestamp with time zone NOT NULL,
	"is_primary" boolean DEFAULT false NOT NULL,
	"compensation_rate_minor" integer,
	"compensation_currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"assigned_by_user_id" text,
	"assigned_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "staffing_demand_requirements" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"staffing_demand_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"target_resource_type" "resource_type" NOT NULL,
	"requirement_mode" "staffing_requirement_mode" DEFAULT 'required' NOT NULL,
	"min_quantity" integer DEFAULT 1 NOT NULL,
	"max_quantity" integer,
	"selector_match_mode" "staffing_selector_match_mode" DEFAULT 'any' NOT NULL,
	"allow_substitution" boolean DEFAULT true NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"description" varchar(700),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "staffing_demand_selectors" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"staffing_demand_requirement_id" text NOT NULL,
	"selector_type" "staffing_selector_type" NOT NULL,
	"is_included" boolean DEFAULT true NOT NULL,
	"resource_id" text,
	"resource_type" "resource_type",
	"capability_template_id" text,
	"location_id" text,
	"subject_type" varchar(80),
	"subject_id" varchar(140),
	"sort_order" integer DEFAULT 100 NOT NULL,
	"description" varchar(700),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "staffing_demands" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"staffing_pool_id" text,
	"demand_type" "staffing_demand_type" DEFAULT 'open_shift' NOT NULL,
	"fill_mode" "staffing_fill_mode" DEFAULT 'fcfs_claim' NOT NULL,
	"status" "staffing_demand_status" DEFAULT 'open' NOT NULL,
	"title" varchar(220) NOT NULL,
	"description" varchar(1000),
	"location_id" text,
	"target_resource_type" "resource_type",
	"required_count" integer DEFAULT 1 NOT NULL,
	"filled_count" integer DEFAULT 0 NOT NULL,
	"starts_at" timestamp with time zone NOT NULL,
	"ends_at" timestamp with time zone NOT NULL,
	"claim_opens_at" timestamp with time zone,
	"claim_closes_at" timestamp with time zone,
	"auction_opens_at" timestamp with time zone,
	"auction_closes_at" timestamp with time zone,
	"auction_id" text,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"base_rate_minor" integer,
	"max_rate_minor" integer,
	"fulfillment_assignment_id" text,
	"fulfillment_unit_id" text,
	"from_resource_id" text,
	"assigned_resource_id" text,
	"requested_by_user_id" text,
	"source_type" varchar(100),
	"source_ref_id" varchar(140),
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "staffing_fairness_counters" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"staffing_pool_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"window_start_at" timestamp with time zone NOT NULL,
	"window_end_at" timestamp with time zone NOT NULL,
	"offered_count" integer DEFAULT 0 NOT NULL,
	"claim_count" integer DEFAULT 0 NOT NULL,
	"bid_count" integer DEFAULT 0 NOT NULL,
	"accepted_count" integer DEFAULT 0 NOT NULL,
	"assigned_count" integer DEFAULT 0 NOT NULL,
	"declined_count" integer DEFAULT 0 NOT NULL,
	"no_response_count" integer DEFAULT 0 NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "staffing_pool_members" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"staffing_pool_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"capability_template_id" text,
	"priority_score" integer DEFAULT 100 NOT NULL,
	"weight" integer DEFAULT 1 NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"last_assigned_at" timestamp with time zone,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "staffing_pools" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"location_id" text,
	"target_resource_type" "resource_type" NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"fairness_window_value" integer DEFAULT 1 NOT NULL,
	"fairness_window_unit" "fairness_window_unit" DEFAULT 'week' NOT NULL,
	"selection_policy" jsonb DEFAULT '{}'::jsonb,
	"claim_policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "staffing_responses" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"staffing_demand_id" text NOT NULL,
	"candidate_resource_id" text NOT NULL,
	"response_mode" "staffing_response_mode" NOT NULL,
	"status" "staffing_response_status" DEFAULT 'pending' NOT NULL,
	"rank_order" integer DEFAULT 1 NOT NULL,
	"offered_at" timestamp with time zone DEFAULT now() NOT NULL,
	"responded_at" timestamp with time zone,
	"proposed_hourly_rate_minor" integer,
	"proposed_total_minor" integer,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"response_reason" varchar(600),
	"responded_by_user_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "certification_awards" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"certification_template_id" text NOT NULL,
	"enrollment_id" text NOT NULL,
	"learner_user_id" text NOT NULL,
	"status" "certification_award_status" DEFAULT 'awarded' NOT NULL,
	"awarded_at" timestamp with time zone DEFAULT now() NOT NULL,
	"expires_at" timestamp with time zone,
	"revoked_at" timestamp with time zone,
	"evidence" jsonb DEFAULT '{}'::jsonb,
	"certificate_code" varchar(120),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "certification_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"program_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"criteria" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"valid_for_days" integer,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cohort_enrollments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"cohort_id" text NOT NULL,
	"learner_user_id" text NOT NULL,
	"booking_order_id" text,
	"status" "enrollment_status" DEFAULT 'enrolled' NOT NULL,
	"enrolled_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"dropped_at" timestamp with time zone,
	"final_score" integer,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "program_cohort_sessions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"cohort_id" text NOT NULL,
	"sequence" integer NOT NULL,
	"name" varchar(220) NOT NULL,
	"status" "program_session_status" DEFAULT 'planned' NOT NULL,
	"starts_at" timestamp with time zone NOT NULL,
	"ends_at" timestamp with time zone NOT NULL,
	"location_id" text,
	"instructor_resource_id" text,
	"fulfillment_unit_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "program_cohorts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"program_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"code" varchar(120) NOT NULL,
	"status" "cohort_status" DEFAULT 'planned' NOT NULL,
	"enrollment_opens_at" timestamp with time zone,
	"enrollment_closes_at" timestamp with time zone,
	"starts_at" timestamp with time zone NOT NULL,
	"ends_at" timestamp with time zone NOT NULL,
	"location_id" text,
	"lead_resource_id" text,
	"capacity" integer,
	"min_enrollment" integer,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "programs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "program_status" DEFAULT 'draft' NOT NULL,
	"offer_version_id" text,
	"calendar_binding_id" text,
	"expected_duration_days" integer,
	"required_attendance_bps" integer DEFAULT 8000 NOT NULL,
	"curriculum" jsonb DEFAULT '{}'::jsonb,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "session_attendance_records" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"session_id" text NOT NULL,
	"enrollment_id" text NOT NULL,
	"status" "session_attendance_status" DEFAULT 'present' NOT NULL,
	"checked_in_at" timestamp with time zone,
	"checked_out_at" timestamp with time zone,
	"attended_minutes" integer,
	"notes" varchar(800),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "requirement_edges" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"requirement_set_id" text NOT NULL,
	"from_node_id" text NOT NULL,
	"to_node_id" text NOT NULL,
	"edge_type" "requirement_edge_type" DEFAULT 'depends_on' NOT NULL,
	"is_required" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "requirement_evaluations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"requirement_set_id" text NOT NULL,
	"evaluated_subject_type" varchar(80) NOT NULL,
	"evaluated_subject_id" varchar(140) NOT NULL,
	"context_subject_type" varchar(80),
	"context_subject_id" varchar(140),
	"status" "requirement_evaluation_status" DEFAULT 'pending' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"evaluated_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"total_node_count" integer DEFAULT 0 NOT NULL,
	"satisfied_node_count" integer DEFAULT 0 NOT NULL,
	"score_percent" integer,
	"request_key" varchar(140),
	"result_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "requirement_evidence_links" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"requirement_evaluation_id" text NOT NULL,
	"requirement_node_id" text,
	"evidence_type" "requirement_evidence_type" NOT NULL,
	"subject_type" varchar(80),
	"subject_id" varchar(140),
	"external_reference_type" varchar(80),
	"external_reference_id" varchar(180),
	"artifact_type" varchar(120),
	"artifact_id" varchar(180),
	"event_type" varchar(120),
	"event_id" varchar(180),
	"occurred_at" timestamp with time zone,
	"details" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "requirement_nodes" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"requirement_set_id" text NOT NULL,
	"node_key" varchar(140) NOT NULL,
	"name" varchar(220) NOT NULL,
	"node_type" "requirement_node_type" NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"description" varchar(2000),
	"sort_order" integer DEFAULT 100 NOT NULL,
	"weight" integer DEFAULT 1 NOT NULL,
	"is_blocking" boolean DEFAULT true NOT NULL,
	"predicate_type" varchar(140),
	"predicate_config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"target_subject_type" varchar(80),
	"target_subject_id" varchar(140),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "requirement_sets" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" varchar(2000),
	"status" "requirement_set_status" DEFAULT 'draft' NOT NULL,
	"evaluation_mode" "requirement_set_evaluation_mode" DEFAULT 'all' NOT NULL,
	"min_satisfied_count" integer,
	"pass_threshold_percent" integer,
	"version" integer DEFAULT 1 NOT NULL,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "assessment_attempts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"assessment_template_id" text NOT NULL,
	"candidate_subject_type" varchar(80) NOT NULL,
	"candidate_subject_id" varchar(140) NOT NULL,
	"context_subject_type" varchar(80),
	"context_subject_id" varchar(140),
	"requirement_evaluation_id" text,
	"status" "assessment_attempt_status" DEFAULT 'started' NOT NULL,
	"attempt_number" integer DEFAULT 1 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"submitted_at" timestamp with time zone,
	"graded_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"score_percent" integer,
	"max_score" integer,
	"earned_score" integer,
	"evaluation_mode" "assessment_evaluation_mode",
	"reviewer_user_id" text,
	"request_key" varchar(140),
	"result_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "assessment_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"assessment_template_id" text NOT NULL,
	"item_key" varchar(140) NOT NULL,
	"prompt" text NOT NULL,
	"description" text,
	"item_type" "assessment_item_type" NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"is_required" boolean DEFAULT true NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"max_score" integer DEFAULT 1 NOT NULL,
	"requirement_node_id" text,
	"config" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "assessment_responses" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"assessment_attempt_id" text NOT NULL,
	"assessment_template_id" text NOT NULL,
	"assessment_item_id" text NOT NULL,
	"response_payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"response_text" text,
	"score_awarded" integer,
	"auto_scored" boolean DEFAULT false NOT NULL,
	"scored_by_user_id" text,
	"responded_at" timestamp with time zone DEFAULT now() NOT NULL,
	"scored_at" timestamp with time zone,
	"feedback" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "assessment_results" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"assessment_attempt_id" text NOT NULL,
	"assessment_template_id" text NOT NULL,
	"candidate_subject_type" varchar(80) NOT NULL,
	"candidate_subject_id" varchar(140) NOT NULL,
	"status" "assessment_result_status" DEFAULT 'pending' NOT NULL,
	"score_percent" integer,
	"max_score" integer,
	"earned_score" integer,
	"decided_at" timestamp with time zone DEFAULT now() NOT NULL,
	"invalidated_at" timestamp with time zone,
	"requirement_evaluation_id" text,
	"details" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "assessment_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" varchar(2000),
	"status" "assessment_template_status" DEFAULT 'draft' NOT NULL,
	"evaluation_mode" "assessment_evaluation_mode" DEFAULT 'hybrid' NOT NULL,
	"pass_score_percent" integer,
	"max_attempts" integer,
	"attempt_duration_seconds" integer,
	"requirement_set_id" text,
	"version" integer DEFAULT 1 NOT NULL,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "grading_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"assessment_attempt_id" text NOT NULL,
	"assessment_template_id" text NOT NULL,
	"assessment_response_id" text,
	"event_type" "grading_event_type" NOT NULL,
	"happened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"actor_user_id" text,
	"actor_subject_type" varchar(80),
	"actor_subject_id" varchar(140),
	"score_delta" integer,
	"note" text,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "audit_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"stream_id" text NOT NULL,
	"sequence" integer NOT NULL,
	"event_type" "audit_event_type" NOT NULL,
	"actor_type" "audit_actor_type" NOT NULL,
	"actor_user_id" text,
	"actor_ref" varchar(200),
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"entity_type" varchar(120) NOT NULL,
	"entity_id" varchar(140) NOT NULL,
	"reason_code" varchar(120),
	"note" varchar(1000),
	"request_ref" varchar(200),
	"source_ip" varchar(80),
	"user_agent" varchar(500),
	"before_state" jsonb,
	"after_state" jsonb,
	"diff" jsonb,
	"previous_event_hash" varchar(128),
	"event_hash" varchar(128) NOT NULL,
	"signature" varchar(256),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "audit_integrity_runs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"stream_id" text,
	"status" "audit_integrity_status" DEFAULT 'unverified' NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"checked_events" integer DEFAULT 0 NOT NULL,
	"broken_events" integer DEFAULT 0 NOT NULL,
	"first_broken_event_id" text,
	"summary" varchar(800),
	"details" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "audit_streams" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"stream_key" varchar(260) NOT NULL,
	"stream_type" varchar(120) NOT NULL,
	"entity_type" varchar(120),
	"entity_id" varchar(140),
	"description" varchar(600),
	"is_active" boolean DEFAULT true NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "biz_extension_installs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"extension_definition_id" text NOT NULL,
	"status" "extension_install_status" DEFAULT 'active' NOT NULL,
	"installed_version" varchar(80) NOT NULL,
	"configuration" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"secret_ref" varchar(255),
	"last_healthcheck_at" timestamp with time zone,
	"last_health_status" varchar(80),
	"installed_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "biz_extension_permission_grants" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text NOT NULL,
	"extension_permission_definition_id" text NOT NULL,
	"scope" "extension_scope" DEFAULT 'biz' NOT NULL,
	"scope_ref_key" varchar(300) NOT NULL,
	"location_id" text,
	"subject_ref_type" varchar(80),
	"subject_ref_id" text,
	"effect" "extension_permission_effect" NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"granted_by_user_id" text,
	"granted_at" timestamp with time zone DEFAULT now() NOT NULL,
	"expires_at" timestamp with time zone,
	"reason" varchar(1200),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "custom_field_definition_options" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"custom_field_definition_id" text NOT NULL,
	"option_key" varchar(120) NOT NULL,
	"label" varchar(200) NOT NULL,
	"description" varchar(800),
	"sort_order" integer DEFAULT 100 NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "custom_field_definitions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text,
	"target_type" "custom_field_target_type" NOT NULL,
	"scope" "custom_field_scope" DEFAULT 'biz' NOT NULL,
	"location_id" text,
	"field_key" varchar(120) NOT NULL,
	"label" varchar(200) NOT NULL,
	"description" varchar(2000),
	"data_type" "custom_field_data_type" NOT NULL,
	"visibility" "custom_field_visibility" DEFAULT 'internal' NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"is_required" boolean DEFAULT false NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"validation_schema" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"default_value" jsonb,
	"help_text" varchar(500),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "custom_field_values" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"custom_field_definition_id" text NOT NULL,
	"target_type" "custom_field_target_type" NOT NULL,
	"target_ref_id" varchar(140) NOT NULL,
	"value" jsonb NOT NULL,
	"value_text_search" varchar(500),
	"value_number_search" numeric(24, 8),
	"value_boolean_search" boolean,
	"value_date_search" date,
	"value_timestamp_search" timestamp with time zone,
	"source" "custom_field_value_source" DEFAULT 'user' NOT NULL,
	"set_by_user_id" text,
	"set_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "extension_api_call_runs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"extension_service_connection_id" text NOT NULL,
	"operation_key" varchar(160) NOT NULL,
	"http_method" varchar(16) NOT NULL,
	"endpoint_key" varchar(220) NOT NULL,
	"status" "outbox_status" DEFAULT 'pending' NOT NULL,
	"attempt_count" integer DEFAULT 0 NOT NULL,
	"next_attempt_at" timestamp with time zone DEFAULT now() NOT NULL,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"http_status" integer,
	"idempotency_key" varchar(200),
	"error_code" varchar(120),
	"error_message" varchar(2000),
	"request_payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"response_payload" jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "extension_definitions" (
	"id" text PRIMARY KEY NOT NULL,
	"key" varchar(140) NOT NULL,
	"name" varchar(200) NOT NULL,
	"publisher" varchar(200),
	"source_type" "extension_source_type" NOT NULL,
	"runtime_type" "extension_runtime_type" NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"current_version" varchar(80),
	"docs_url" varchar(1000),
	"homepage_url" varchar(1000),
	"description" varchar(2000),
	"manifest" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"capabilities" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "extension_permission_definitions" (
	"id" text PRIMARY KEY NOT NULL,
	"extension_definition_id" text NOT NULL,
	"permission_key" varchar(160) NOT NULL,
	"name" varchar(220) NOT NULL,
	"description" varchar(2000),
	"scope" "extension_scope" DEFAULT 'biz' NOT NULL,
	"is_required" boolean DEFAULT false NOT NULL,
	"default_effect" "extension_permission_effect" DEFAULT 'deny' NOT NULL,
	"risk_level" integer DEFAULT 2 NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "extension_service_connections" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text NOT NULL,
	"connection_key" varchar(140) NOT NULL,
	"name" varchar(200) NOT NULL,
	"provider_key" varchar(120) NOT NULL,
	"service_category" varchar(80) DEFAULT 'api' NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"auth_mode" varchar(60) DEFAULT 'oauth2' NOT NULL,
	"external_account_ref" varchar(255),
	"secret_ref" varchar(255),
	"scopes" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"capabilities" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"sync_cursor" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"last_successful_at" timestamp with time zone,
	"last_failed_at" timestamp with time zone,
	"last_failure_reason" varchar(1000),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "extension_service_object_links" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"extension_service_connection_id" text NOT NULL,
	"subject_type" varchar(80),
	"subject_id" varchar(140),
	"local_reference_key" varchar(200),
	"external_object_type" varchar(120) NOT NULL,
	"external_object_ref" varchar(255) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"sync_hash" varchar(140),
	"last_synced_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "extension_service_sync_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"extension_service_sync_job_id" text NOT NULL,
	"extension_service_object_link_id" text,
	"status" varchar(40) DEFAULT 'pending' NOT NULL,
	"object_type" varchar(120) NOT NULL,
	"local_reference_key" varchar(200),
	"external_object_ref" varchar(255),
	"error_message" varchar(1000),
	"processed_at" timestamp with time zone,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "extension_service_sync_jobs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"extension_service_connection_id" text NOT NULL,
	"status" varchar(40) DEFAULT 'queued' NOT NULL,
	"direction" varchar(40) DEFAULT 'bidirectional' NOT NULL,
	"object_type" varchar(120) NOT NULL,
	"requested_at" timestamp with time zone DEFAULT now() NOT NULL,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"processed_count" integer DEFAULT 0 NOT NULL,
	"failed_count" integer DEFAULT 0 NOT NULL,
	"cursor_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"summary" varchar(800),
	"error_payload" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "extension_state_documents" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text NOT NULL,
	"namespace" varchar(120) NOT NULL,
	"document_key" varchar(180) NOT NULL,
	"scope" "extension_scope" DEFAULT 'biz' NOT NULL,
	"scope_ref_key" varchar(300) NOT NULL,
	"location_id" text,
	"subject_ref_type" varchar(80),
	"subject_ref_id" text,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"revision" integer DEFAULT 1 NOT NULL,
	"schema_version" integer DEFAULT 1 NOT NULL,
	"last_lifecycle_event_id" text,
	"last_materialized_at" timestamp with time zone,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"payload_checksum" varchar(128),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "extension_webhook_ingress_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"extension_service_connection_id" text NOT NULL,
	"status" varchar(40) DEFAULT 'received' NOT NULL,
	"event_type" varchar(160) NOT NULL,
	"external_event_id" varchar(255) NOT NULL,
	"received_at" timestamp with time zone DEFAULT now() NOT NULL,
	"processed_at" timestamp with time zone,
	"retry_count" integer DEFAULT 0 NOT NULL,
	"signature_verified" boolean DEFAULT false NOT NULL,
	"error_message" varchar(2000),
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "idempotency_keys" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"scope" varchar(160) NOT NULL,
	"idempotency_key" varchar(200) NOT NULL,
	"status" "idempotency_status" DEFAULT 'processing' NOT NULL,
	"request_hash" varchar(128),
	"response_code" integer,
	"response_body" jsonb,
	"error_code" varchar(120),
	"error_message" varchar(2000),
	"locked_until" timestamp with time zone,
	"first_seen_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "lifecycle_event_deliveries" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"lifecycle_event_id" text NOT NULL,
	"lifecycle_event_subscription_id" text NOT NULL,
	"status" "outbox_status" DEFAULT 'pending' NOT NULL,
	"attempt_count" integer DEFAULT 0 NOT NULL,
	"next_attempt_at" timestamp with time zone DEFAULT now() NOT NULL,
	"locked_at" timestamp with time zone,
	"published_at" timestamp with time zone,
	"dead_lettered_at" timestamp with time zone,
	"http_status" integer,
	"last_error_code" varchar(120),
	"last_error_message" varchar(2000),
	"request_payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"response_payload" jsonb,
	"idempotency_key" varchar(200),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "lifecycle_event_subscriptions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text,
	"name" varchar(200) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"event_pattern" varchar(200) NOT NULL,
	"phase" "lifecycle_event_phase" DEFAULT 'after' NOT NULL,
	"delivery_mode" "extension_hook_delivery_mode" NOT NULL,
	"internal_handler_key" varchar(200),
	"webhook_url" varchar(1000),
	"signing_secret_ref" varchar(255),
	"timeout_ms" integer DEFAULT 10000 NOT NULL,
	"max_attempts" integer DEFAULT 8 NOT NULL,
	"retry_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"filter" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "lifecycle_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"source_type" "lifecycle_event_source" NOT NULL,
	"event_name" varchar(200) NOT NULL,
	"event_version" integer DEFAULT 1 NOT NULL,
	"entity_type" varchar(120) NOT NULL,
	"entity_id" varchar(140) NOT NULL,
	"aggregate_type" varchar(120),
	"aggregate_id" varchar(140),
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"actor_user_id" text,
	"correlation_id" varchar(200),
	"causation_event_id" text,
	"idempotency_key" varchar(200),
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_action_token_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"access_action_token_id" text NOT NULL,
	"event_type" "access_action_token_event_type" NOT NULL,
	"happened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"outcome" "access_action_outcome",
	"access_activity_log_id" text,
	"actor_user_id" text,
	"actor_subject_type" varchar(80),
	"actor_subject_id" varchar(140),
	"ip_address" varchar(64),
	"country_code" varchar(2),
	"user_agent_hash" varchar(128),
	"device_fingerprint" varchar(180),
	"reason_code" varchar(80),
	"reason_text" text,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_action_tokens" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"access_artifact_id" text NOT NULL,
	"action_type" "access_action_type" NOT NULL,
	"token_type" "access_action_token_type" DEFAULT 'opaque_link' NOT NULL,
	"status" "access_action_token_status" DEFAULT 'active' NOT NULL,
	"token_hash" varchar(255) NOT NULL,
	"token_preview" varchar(50),
	"max_validation_count" integer DEFAULT 1 NOT NULL,
	"successful_validation_count" integer DEFAULT 0 NOT NULL,
	"issued_at" timestamp with time zone DEFAULT now() NOT NULL,
	"expires_at" timestamp with time zone,
	"first_validated_at" timestamp with time zone,
	"last_validated_at" timestamp with time zone,
	"used_at" timestamp with time zone,
	"revoked_at" timestamp with time zone,
	"intended_holder_user_id" text,
	"intended_holder_group_account_id" text,
	"intended_holder_subject_type" varchar(80),
	"intended_holder_subject_id" varchar(140),
	"request_key" varchar(140),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_activity_logs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"access_artifact_id" text,
	"action_type" "access_action_type" NOT NULL,
	"outcome" "access_action_outcome" NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"actor_user_id" text,
	"actor_subject_type" varchar(80),
	"actor_subject_id" varchar(140),
	"ip_address" varchar(64),
	"country_code" varchar(2),
	"user_agent_hash" varchar(128),
	"device_fingerprint" varchar(180),
	"risk_score" integer,
	"risk_signals" jsonb DEFAULT '{}'::jsonb,
	"message" varchar(400),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_artifact_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"access_artifact_id" text NOT NULL,
	"event_type" "access_artifact_event_type" NOT NULL,
	"happened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"quantity_delta" integer DEFAULT 0 NOT NULL,
	"outcome" "access_action_outcome",
	"reason_code" varchar(80),
	"reason_text" text,
	"actor_user_id" text,
	"actor_subject_type" varchar(80),
	"actor_subject_id" varchar(140),
	"request_key" varchar(140),
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_artifact_links" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"access_artifact_id" text NOT NULL,
	"link_type" "access_artifact_link_type" NOT NULL,
	"relation_key" varchar(120) DEFAULT 'source' NOT NULL,
	"sellable_id" text,
	"booking_order_id" text,
	"booking_order_line_id" text,
	"membership_id" text,
	"entitlement_grant_id" text,
	"payment_transaction_id" text,
	"fulfillment_unit_id" text,
	"custom_subject_type" varchar(80),
	"custom_subject_id" varchar(140),
	"external_reference_type" varchar(80),
	"external_reference_id" varchar(180),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_artifacts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"artifact_type" "access_artifact_type" NOT NULL,
	"status" "access_artifact_status" DEFAULT 'draft' NOT NULL,
	"public_code" varchar(200),
	"secret_hash" varchar(255),
	"holder_user_id" text,
	"holder_group_account_id" text,
	"holder_subject_type" varchar(80),
	"holder_subject_id" varchar(140),
	"sellable_id" text,
	"issued_at" timestamp with time zone DEFAULT now() NOT NULL,
	"activated_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"suspended_at" timestamp with time zone,
	"revoked_at" timestamp with time zone,
	"consumed_at" timestamp with time zone,
	"transferable" boolean DEFAULT false NOT NULL,
	"usage_granted" integer,
	"usage_remaining" integer,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_delivery_links" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"access_artifact_id" text NOT NULL,
	"channel" "access_delivery_link_channel" NOT NULL,
	"status" "access_delivery_link_status" DEFAULT 'active' NOT NULL,
	"token_hash" varchar(255) NOT NULL,
	"token_preview" varchar(40),
	"issued_at" timestamp with time zone DEFAULT now() NOT NULL,
	"expires_at" timestamp with time zone,
	"revoked_at" timestamp with time zone,
	"consumed_at" timestamp with time zone,
	"max_access_count" integer DEFAULT 1 NOT NULL,
	"used_access_count" integer DEFAULT 0 NOT NULL,
	"last_access_at" timestamp with time zone,
	"delivery_target" varchar(255),
	"request_key" varchar(140),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_resale_listings" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"access_artifact_id" text NOT NULL,
	"access_transfer_policy_id" text,
	"status" "access_resale_status" DEFAULT 'draft' NOT NULL,
	"seller_user_id" text,
	"seller_group_account_id" text,
	"seller_subject_type" varchar(80),
	"seller_subject_id" varchar(140),
	"listed_price_minor" integer NOT NULL,
	"min_acceptable_price_minor" integer,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"listed_at" timestamp with time zone DEFAULT now() NOT NULL,
	"expires_at" timestamp with time zone,
	"reserved_at" timestamp with time zone,
	"sold_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"buyer_user_id" text,
	"buyer_group_account_id" text,
	"buyer_subject_type" varchar(80),
	"buyer_subject_id" varchar(140),
	"completed_transfer_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_security_decisions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"outcome" "access_security_decision_outcome" NOT NULL,
	"status" "access_security_decision_status" DEFAULT 'active' NOT NULL,
	"decided_at" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_from" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_until" timestamp with time zone,
	"reverted_at" timestamp with time zone,
	"access_security_signal_id" text,
	"access_artifact_id" text,
	"access_action_token_id" text,
	"access_activity_log_id" text,
	"decided_by_user_id" text,
	"decided_by_subject_type" varchar(80),
	"decided_by_subject_id" varchar(140),
	"reason_code" varchar(80),
	"reason_text" text,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_security_signals" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"signal_type" "access_security_signal_type" NOT NULL,
	"status" "access_security_signal_status" DEFAULT 'open' NOT NULL,
	"severity" integer DEFAULT 50 NOT NULL,
	"confidence" integer,
	"detected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"resolved_at" timestamp with time zone,
	"access_artifact_id" text,
	"access_action_token_id" text,
	"access_activity_log_id" text,
	"source_subject_type" varchar(80),
	"source_subject_id" varchar(140),
	"details" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_transfer_policies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"applies_to_artifact_type" "access_artifact_type",
	"applies_to_sellable_id" text,
	"allow_transfers" boolean DEFAULT true NOT NULL,
	"allow_resale" boolean DEFAULT false NOT NULL,
	"approval_required" boolean DEFAULT false NOT NULL,
	"max_transfers_per_artifact" integer,
	"min_hold_seconds" integer,
	"transfer_cooldown_seconds" integer,
	"transfer_fee_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_transfers" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"source_access_artifact_id" text NOT NULL,
	"target_access_artifact_id" text,
	"access_transfer_policy_id" text,
	"mode" "access_transfer_mode" DEFAULT 'full_transfer' NOT NULL,
	"status" "access_transfer_status" DEFAULT 'requested' NOT NULL,
	"quantity_requested" integer DEFAULT 1 NOT NULL,
	"quantity_transferred" integer,
	"requested_by_user_id" text,
	"approved_by_user_id" text,
	"requested_at" timestamp with time zone DEFAULT now() NOT NULL,
	"expires_at" timestamp with time zone,
	"decided_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"reversed_at" timestamp with time zone,
	"target_holder_user_id" text,
	"target_holder_group_account_id" text,
	"target_holder_subject_type" varchar(80),
	"target_holder_subject_id" varchar(140),
	"reason_code" varchar(80),
	"reason_text" text,
	"from_holder_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"to_holder_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "access_usage_windows" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"access_artifact_id" text NOT NULL,
	"action_type" "access_action_type" NOT NULL,
	"window_mode" "access_usage_window_mode" NOT NULL,
	"max_events" integer,
	"max_quantity" integer,
	"window_seconds" integer,
	"window_starts_at" timestamp with time zone,
	"window_ends_at" timestamp with time zone,
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"is_soft_limit" boolean DEFAULT false NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "checkout_recovery_links" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"checkout_session_id" text NOT NULL,
	"status" "checkout_recovery_status" DEFAULT 'active' NOT NULL,
	"channel" "checkout_recovery_channel" NOT NULL,
	"token_hash" varchar(255) NOT NULL,
	"token_preview" varchar(40),
	"issued_at" timestamp with time zone DEFAULT now() NOT NULL,
	"expires_at" timestamp with time zone,
	"used_at" timestamp with time zone,
	"revoked_at" timestamp with time zone,
	"max_use_count" integer DEFAULT 1 NOT NULL,
	"used_count" integer DEFAULT 0 NOT NULL,
	"discount_campaign_id" text,
	"delivery_target" varchar(255),
	"request_key" varchar(140),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "checkout_session_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"checkout_session_id" text NOT NULL,
	"event_type" "checkout_event_type" NOT NULL,
	"event_at" timestamp with time zone DEFAULT now() NOT NULL,
	"actor_user_id" text,
	"actor_subject_type" varchar(80),
	"actor_subject_id" varchar(140),
	"request_key" varchar(140),
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "checkout_session_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"checkout_session_id" text NOT NULL,
	"item_type" "checkout_item_type" NOT NULL,
	"sellable_id" text,
	"custom_subject_type" varchar(80),
	"custom_subject_id" varchar(140),
	"display_name" varchar(255) NOT NULL,
	"description" text,
	"quantity" integer DEFAULT 1 NOT NULL,
	"unit_price_minor" integer DEFAULT 0 NOT NULL,
	"line_subtotal_minor" integer DEFAULT 0 NOT NULL,
	"tax_minor" integer DEFAULT 0 NOT NULL,
	"fee_minor" integer DEFAULT 0 NOT NULL,
	"discount_minor" integer DEFAULT 0 NOT NULL,
	"total_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"requested_start_at" timestamp with time zone,
	"requested_end_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "checkout_sessions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"status" "checkout_session_status" DEFAULT 'active' NOT NULL,
	"channel" "checkout_channel" DEFAULT 'web' NOT NULL,
	"owner_user_id" text,
	"owner_group_account_id" text,
	"location_id" text,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"subtotal_minor" integer DEFAULT 0 NOT NULL,
	"tax_minor" integer DEFAULT 0 NOT NULL,
	"fee_minor" integer DEFAULT 0 NOT NULL,
	"discount_minor" integer DEFAULT 0 NOT NULL,
	"total_minor" integer DEFAULT 0 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_activity_at" timestamp with time zone DEFAULT now() NOT NULL,
	"abandoned_at" timestamp with time zone,
	"recovered_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"booking_order_id" text,
	"recovered_from_checkout_session_id" text,
	"acquisition_source" varchar(120),
	"campaign_reference" varchar(140),
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "wishlist_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"wishlist_id" text NOT NULL,
	"sellable_id" text NOT NULL,
	"variant_key" varchar(180),
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"desired_quantity" integer DEFAULT 1 NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"note" text,
	"desired_unit_price_minor" integer,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"added_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_touched_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "wishlists" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"crm_contact_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"visibility_mode" varchar(40) DEFAULT 'private' NOT NULL,
	"is_default" boolean DEFAULT false NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sales_quote_acceptances" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sales_quote_version_id" text NOT NULL,
	"decision_type" varchar(40) DEFAULT 'accepted' NOT NULL,
	"decided_at" timestamp with time zone DEFAULT now() NOT NULL,
	"decided_by_crm_contact_id" text,
	"decided_by_subject_type" varchar(80),
	"decided_by_subject_id" varchar(140),
	"signer_name" varchar(220),
	"signer_email" varchar(320),
	"interaction_submission_id" text,
	"booking_order_id" text,
	"decision_note" text,
	"source_ip" varchar(80),
	"source_user_agent" varchar(800),
	"signature_evidence" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sales_quote_lines" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sales_quote_version_id" text NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"line_type" varchar(40) DEFAULT 'sellable' NOT NULL,
	"sellable_id" text,
	"description" text,
	"quantity" integer DEFAULT 1 NOT NULL,
	"unit_price_minor" integer DEFAULT 0 NOT NULL,
	"line_subtotal_minor" integer DEFAULT 0 NOT NULL,
	"tax_minor" integer DEFAULT 0 NOT NULL,
	"fee_minor" integer DEFAULT 0 NOT NULL,
	"discount_minor" integer DEFAULT 0 NOT NULL,
	"total_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sales_quote_versions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sales_quote_id" text NOT NULL,
	"version_number" integer NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"is_current" boolean DEFAULT false NOT NULL,
	"issued_at" timestamp with time zone,
	"valid_until" timestamp with time zone,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"subtotal_minor" integer DEFAULT 0 NOT NULL,
	"tax_minor" integer DEFAULT 0 NOT NULL,
	"fee_minor" integer DEFAULT 0 NOT NULL,
	"discount_minor" integer DEFAULT 0 NOT NULL,
	"total_minor" integer DEFAULT 0 NOT NULL,
	"notes" text,
	"pricing_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"terms_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sales_quotes" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"quote_number" varchar(120) NOT NULL,
	"status" varchar(40) DEFAULT 'draft' NOT NULL,
	"title" varchar(240),
	"description" text,
	"crm_contact_id" text NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"valid_from" timestamp with time zone,
	"valid_until" timestamp with time zone,
	"current_version_number" integer DEFAULT 1 NOT NULL,
	"source_checkout_session_id" text,
	"converted_booking_order_id" text,
	"converted_at" timestamp with time zone,
	"terms_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"pricing_context" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "session_interaction_aggregates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"source_type" "session_interaction_source_type" NOT NULL,
	"program_session_id" text,
	"fulfillment_unit_id" text,
	"custom_session_subject_type" varchar(80),
	"custom_session_subject_id" varchar(140),
	"granularity" varchar(24) NOT NULL,
	"bucket_starts_at" timestamp with time zone NOT NULL,
	"bucket_ends_at" timestamp with time zone NOT NULL,
	"interaction_type" "session_interaction_type",
	"event_count" integer DEFAULT 0 NOT NULL,
	"unique_participant_count" integer DEFAULT 0 NOT NULL,
	"last_event_at" timestamp with time zone,
	"metrics" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "session_interaction_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"source_type" "session_interaction_source_type" NOT NULL,
	"program_session_id" text,
	"fulfillment_unit_id" text,
	"custom_session_subject_type" varchar(80),
	"custom_session_subject_id" varchar(140),
	"participant_user_id" text,
	"participant_enrollment_id" text,
	"participant_subject_type" varchar(80),
	"participant_subject_id" varchar(140),
	"interaction_type" "session_interaction_type" NOT NULL,
	"visibility" "session_interaction_visibility" DEFAULT 'public' NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"thread_key" varchar(120),
	"content_text" text,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"request_key" varchar(140),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "interaction_assignments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"interaction_template_id" text NOT NULL,
	"target_type" "custom_field_target_type" NOT NULL,
	"target_ref_id" varchar(140) NOT NULL,
	"subject_user_id" text,
	"subject_group_account_id" text,
	"status" "interaction_assignment_status" DEFAULT 'pending' NOT NULL,
	"status_config_value_id" text,
	"is_blocking" boolean DEFAULT true NOT NULL,
	"due_at" timestamp with time zone,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"last_reminder_at" timestamp with time zone,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "interaction_submission_artifacts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"interaction_submission_id" text NOT NULL,
	"artifact_type" "interaction_artifact_type" NOT NULL,
	"storage_ref" varchar(600) NOT NULL,
	"file_name" varchar(260),
	"mime_type" varchar(160),
	"file_size_bytes" integer,
	"sha256" varchar(128),
	"captured_at" timestamp with time zone DEFAULT now() NOT NULL,
	"captured_by_user_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "interaction_submission_signatures" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"interaction_submission_id" text NOT NULL,
	"signer_role" "signature_signer_role" NOT NULL,
	"signer_user_id" text,
	"signer_name" varchar(220),
	"signature_method" "signature_method" NOT NULL,
	"consent_statement" text NOT NULL,
	"signature_payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"signed_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ip_address" varchar(80),
	"user_agent" varchar(500),
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"status_config_value_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "interaction_submissions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"interaction_assignment_id" text NOT NULL,
	"attempt_number" integer DEFAULT 1 NOT NULL,
	"status" "interaction_submission_status" DEFAULT 'draft' NOT NULL,
	"status_config_value_id" text,
	"submitted_at" timestamp with time zone,
	"reviewed_at" timestamp with time zone,
	"reviewed_by_user_id" text,
	"completion_percent" integer DEFAULT 0 NOT NULL,
	"response_payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"validation_errors" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "interaction_template_bindings" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"interaction_template_id" text NOT NULL,
	"target_type" "custom_field_target_type" NOT NULL,
	"trigger_event" varchar(180) NOT NULL,
	"requirement_mode" "interaction_requirement_mode" DEFAULT 'required' NOT NULL,
	"location_id" text,
	"service_id" text,
	"service_product_id" text,
	"offer_id" text,
	"offer_version_id" text,
	"priority" integer DEFAULT 100 NOT NULL,
	"condition_expr" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "interaction_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text,
	"template_type" "interaction_template_type" NOT NULL,
	"template_type_config_value_id" text,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"status_config_value_id" text,
	"is_current" boolean DEFAULT false NOT NULL,
	"title" varchar(300),
	"description" text,
	"schema" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"validation_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"requires_signature" boolean DEFAULT false NOT NULL,
	"is_reusable" boolean DEFAULT true NOT NULL,
	"effective_from" timestamp with time zone,
	"effective_to" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "requirement_list_assignment_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"requirement_list_assignment_id" text NOT NULL,
	"template_item_id" text NOT NULL,
	"status" "requirement_item_status" DEFAULT 'pending' NOT NULL,
	"status_config_value_id" text,
	"completed_at" timestamp with time zone,
	"completed_by_user_id" text,
	"evidence" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "requirement_list_assignments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"requirement_list_template_id" text NOT NULL,
	"target_type" "custom_field_target_type" NOT NULL,
	"target_ref_id" varchar(140) NOT NULL,
	"subject_user_id" text,
	"subject_group_account_id" text,
	"status" "interaction_assignment_status" DEFAULT 'pending' NOT NULL,
	"status_config_value_id" text,
	"is_blocking" boolean DEFAULT true NOT NULL,
	"due_at" timestamp with time zone,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "requirement_list_template_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"requirement_list_template_id" text NOT NULL,
	"item_key" varchar(120) NOT NULL,
	"title" varchar(240) NOT NULL,
	"description" text,
	"item_type" "requirement_item_type" DEFAULT 'confirm' NOT NULL,
	"item_type_config_value_id" text,
	"is_required" boolean DEFAULT true NOT NULL,
	"depends_on_template_item_id" text,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"instructions" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "requirement_list_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"status_config_value_id" text,
	"is_current" boolean DEFAULT false NOT NULL,
	"title" varchar(300),
	"description" text,
	"policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"effective_from" timestamp with time zone,
	"effective_to" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "communication_consents" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"subject_type" "custom_field_target_type" NOT NULL,
	"subject_ref_id" varchar(140) NOT NULL,
	"subject_user_id" text,
	"subject_group_account_id" text,
	"channel" "communication_channel" NOT NULL,
	"purpose" "communication_purpose" NOT NULL,
	"status" "communication_consent_status" DEFAULT 'opted_in' NOT NULL,
	"source" "communication_consent_source" DEFAULT 'user_action' NOT NULL,
	"legal_basis" varchar(180),
	"captured_at" timestamp with time zone DEFAULT now() NOT NULL,
	"expires_at" timestamp with time zone,
	"revoked_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "marketing_campaign_enrollments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"marketing_campaign_id" text NOT NULL,
	"subject_type" "custom_field_target_type" NOT NULL,
	"subject_ref_id" varchar(140) NOT NULL,
	"subject_user_id" text,
	"subject_group_account_id" text,
	"status" "marketing_enrollment_status" DEFAULT 'active' NOT NULL,
	"current_step_key" varchar(120),
	"entered_at" timestamp with time zone DEFAULT now() NOT NULL,
	"last_evaluated_at" timestamp with time zone,
	"exited_at" timestamp with time zone,
	"exit_reason" varchar(240),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "marketing_campaign_steps" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"marketing_campaign_id" text NOT NULL,
	"step_key" varchar(120) NOT NULL,
	"step_type" "marketing_campaign_step_type" NOT NULL,
	"name" varchar(220),
	"sort_order" integer DEFAULT 100 NOT NULL,
	"channel" "communication_channel",
	"message_template_id" text,
	"delay_minutes" integer,
	"condition_expr" jsonb DEFAULT '{}'::jsonb,
	"next_step_key" varchar(120),
	"on_true_step_key" varchar(120),
	"on_false_step_key" varchar(120),
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "marketing_campaigns" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "marketing_campaign_status" DEFAULT 'draft' NOT NULL,
	"description" text,
	"starts_at" timestamp with time zone,
	"ends_at" timestamp with time zone,
	"entry_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"exit_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "message_template_bindings" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"message_template_id" text NOT NULL,
	"event_pattern" varchar(200) NOT NULL,
	"target_type" "custom_field_target_type",
	"priority" integer DEFAULT 100 NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"condition_expr" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "message_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text,
	"channel" "communication_channel" NOT NULL,
	"purpose" "communication_purpose" NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"is_current" boolean DEFAULT false NOT NULL,
	"locale" varchar(20) DEFAULT 'en-US' NOT NULL,
	"subject_template" varchar(600),
	"body_template" text NOT NULL,
	"structured_template" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"variable_schema" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"render_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "outbound_message_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"outbound_message_id" text NOT NULL,
	"event_type" "message_event_type" NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"provider_event_ref" varchar(240),
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "outbound_messages" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"message_template_id" text,
	"lifecycle_event_id" text,
	"marketing_campaign_id" text,
	"marketing_campaign_step_id" text,
	"channel" "communication_channel" NOT NULL,
	"purpose" "communication_purpose" NOT NULL,
	"recipient_user_id" text,
	"recipient_group_account_id" text,
	"recipient_ref" varchar(500) NOT NULL,
	"status" "message_delivery_status" DEFAULT 'queued' NOT NULL,
	"scheduled_for" timestamp with time zone DEFAULT now() NOT NULL,
	"sent_at" timestamp with time zone,
	"delivered_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"provider_key" varchar(120),
	"provider_message_ref" varchar(240),
	"error_code" varchar(120),
	"error_message" varchar(2000),
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "quiet_hour_policies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"channel" "communication_channel",
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"quiet_start_local" time NOT NULL,
	"quiet_end_local" time NOT NULL,
	"target_type" "custom_field_target_type",
	"target_ref_id" varchar(140),
	"target_user_id" text,
	"target_group_account_id" text,
	"allow_transactional_bypass" boolean DEFAULT true NOT NULL,
	"allow_emergency_bypass" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "survey_invitations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"survey_template_id" text NOT NULL,
	"target_type" "custom_field_target_type" NOT NULL,
	"target_ref_id" varchar(140) NOT NULL,
	"recipient_user_id" text,
	"recipient_group_account_id" text,
	"channel" "communication_channel" DEFAULT 'email' NOT NULL,
	"status" "survey_invitation_status" DEFAULT 'pending' NOT NULL,
	"token_hash" varchar(128),
	"sent_at" timestamp with time zone,
	"opened_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "survey_questions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"survey_template_id" text NOT NULL,
	"question_key" varchar(120) NOT NULL,
	"question_type" "survey_question_type" NOT NULL,
	"prompt" text NOT NULL,
	"is_required" boolean DEFAULT false NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"options" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"scale_min" integer,
	"scale_max" integer,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "survey_response_answers" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"survey_response_id" text NOT NULL,
	"survey_question_id" text NOT NULL,
	"answer_text" text,
	"answer_number" numeric(24, 8),
	"answer_boolean" boolean,
	"answer_options" jsonb,
	"answer_payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "survey_responses" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"survey_invitation_id" text NOT NULL,
	"status" "survey_response_status" DEFAULT 'started' NOT NULL,
	"visibility" "survey_response_visibility" DEFAULT 'identified' NOT NULL,
	"respondent_user_id" text,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"submitted_at" timestamp with time zone,
	"overall_rating" integer,
	"nps_score" integer,
	"response_payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "survey_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"is_current" boolean DEFAULT false NOT NULL,
	"title" varchar(320),
	"description" text,
	"allow_anonymous" boolean DEFAULT false NOT NULL,
	"trigger_event" varchar(180),
	"send_delay_minutes" integer DEFAULT 0 NOT NULL,
	"incentive_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "discount_campaigns" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "discount_campaign_status" DEFAULT 'draft' NOT NULL,
	"discount_type" "discount_type" NOT NULL,
	"scope" "discount_scope" DEFAULT 'order' NOT NULL,
	"stacking_mode" "discount_stacking_mode" DEFAULT 'exclusive' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"percent_off_bps" integer,
	"fixed_amount_minor" integer,
	"max_discount_minor" integer,
	"min_subtotal_minor" integer DEFAULT 0 NOT NULL,
	"max_total_redemptions" integer,
	"max_per_customer" integer,
	"first_time_only" boolean DEFAULT false NOT NULL,
	"starts_at" timestamp with time zone,
	"ends_at" timestamp with time zone,
	"conditions" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "discount_codes" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"discount_campaign_id" text NOT NULL,
	"code" varchar(100) NOT NULL,
	"status" "discount_campaign_status" DEFAULT 'active' NOT NULL,
	"starts_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"max_redemptions" integer,
	"max_per_customer" integer,
	"redemption_count" integer DEFAULT 0 NOT NULL,
	"is_single_use" boolean DEFAULT false NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "discount_redemptions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"discount_campaign_id" text NOT NULL,
	"discount_code_id" text,
	"booking_order_id" text,
	"booking_order_line_id" text,
	"customer_user_id" text,
	"status" "discount_redemption_status" DEFAULT 'applied' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"discount_minor" integer DEFAULT 0 NOT NULL,
	"redeemed_at" timestamp with time zone DEFAULT now() NOT NULL,
	"voided_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "work_approvals" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"work_run_id" text NOT NULL,
	"routing_mode" "work_approval_routing_mode" DEFAULT 'sequential' NOT NULL,
	"stage" integer DEFAULT 1 NOT NULL,
	"assignee_type" "work_approval_assignee_type" NOT NULL,
	"approver_user_id" text,
	"approver_group_account_id" text,
	"approver_role_key" varchar(120),
	"approver_ref" varchar(200),
	"decision" "work_approval_decision" DEFAULT 'pending' NOT NULL,
	"decided_at" timestamp with time zone,
	"decided_by_user_id" text,
	"decision_note" text,
	"due_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "work_artifacts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"work_run_id" text NOT NULL,
	"work_entry_id" text,
	"artifact_type" "interaction_artifact_type" NOT NULL,
	"storage_ref" varchar(600) NOT NULL,
	"file_name" varchar(260),
	"mime_type" varchar(160),
	"file_size_bytes" integer,
	"sha256" varchar(128),
	"geo_lat" double precision,
	"geo_lng" double precision,
	"annotations" jsonb DEFAULT '{}'::jsonb,
	"captured_at" timestamp with time zone DEFAULT now() NOT NULL,
	"captured_by_user_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "work_entries" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"work_run_id" text NOT NULL,
	"work_run_step_id" text,
	"entry_type" "work_entry_type" NOT NULL,
	"status" "work_entry_status" DEFAULT 'logged' NOT NULL,
	"status_config_value_id" text,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"starts_at" timestamp with time zone,
	"ends_at" timestamp with time zone,
	"duration_min" integer,
	"quantity" numeric(18, 6),
	"quantity_unit" varchar(40),
	"amount_minor" integer,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"geo_lat" double precision,
	"geo_lng" double precision,
	"note" text,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "work_run_steps" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"work_run_id" text NOT NULL,
	"work_template_step_id" text NOT NULL,
	"status" "work_step_status" DEFAULT 'pending' NOT NULL,
	"status_config_value_id" text,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"completed_by_user_id" text,
	"result" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "work_runs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"work_template_id" text NOT NULL,
	"parent_work_run_id" text,
	"target_type" "custom_field_target_type" NOT NULL,
	"target_ref_id" varchar(140) NOT NULL,
	"location_id" text,
	"resource_id" text,
	"assignee_user_id" text,
	"assignee_group_account_id" text,
	"status" "work_run_status" DEFAULT 'draft' NOT NULL,
	"status_config_value_id" text,
	"priority" integer DEFAULT 100 NOT NULL,
	"due_at" timestamp with time zone,
	"started_at" timestamp with time zone,
	"submitted_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"idempotency_key_id" text,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "work_template_steps" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"work_template_id" text NOT NULL,
	"step_key" varchar(120) NOT NULL,
	"step_type" "work_step_type" DEFAULT 'field' NOT NULL,
	"label" varchar(260) NOT NULL,
	"instructions" text,
	"is_required" boolean DEFAULT true NOT NULL,
	"depends_on_step_key" varchar(120),
	"sort_order" integer DEFAULT 100 NOT NULL,
	"definition" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "work_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"biz_extension_install_id" text,
	"kind" "work_template_kind" NOT NULL,
	"kind_config_value_id" text,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"status_config_value_id" text,
	"is_current" boolean DEFAULT false NOT NULL,
	"title" varchar(320),
	"description" text,
	"schema" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"effective_from" timestamp with time zone,
	"effective_to" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "work_time_segment_allocations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"work_time_segment_id" text NOT NULL,
	"staffing_assignment_id" text NOT NULL,
	"allocated_minutes" integer,
	"allocation_bps" integer,
	"note" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "work_time_segments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"work_run_id" text NOT NULL,
	"user_id" text NOT NULL,
	"segment_type" "work_time_segment_type" DEFAULT 'work' NOT NULL,
	"clock_source" "work_clock_source" DEFAULT 'mobile' NOT NULL,
	"clock_in_at" timestamp with time zone NOT NULL,
	"clock_out_at" timestamp with time zone,
	"break_minutes" integer DEFAULT 0 NOT NULL,
	"clock_in_lat" double precision,
	"clock_in_lng" double precision,
	"clock_out_lat" double precision,
	"clock_out_lng" double precision,
	"is_clock_in_within_geofence" boolean,
	"is_clock_out_within_geofence" boolean,
	"geofence_policy_ref" varchar(200),
	"approved_by_user_id" text,
	"approved_at" timestamp with time zone,
	"correction_note" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "note_access_overrides" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"note_id" text NOT NULL,
	"user_id" text NOT NULL,
	"can_read" boolean DEFAULT true NOT NULL,
	"can_edit" boolean DEFAULT false NOT NULL,
	"expires_at" timestamp with time zone,
	"reason" varchar(500),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "note_revisions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"note_id" text NOT NULL,
	"revision" integer NOT NULL,
	"body" text NOT NULL,
	"diff" jsonb,
	"edited_by_user_id" text,
	"edited_at" timestamp with time zone DEFAULT now() NOT NULL,
	"reason" varchar(500),
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "notes" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"target_type" "note_target_type" NOT NULL,
	"booking_order_id" text,
	"fulfillment_unit_id" text,
	"resource_id" text,
	"offer_id" text,
	"offer_version_id" text,
	"customer_user_id" text,
	"queue_entry_id" text,
	"trip_id" text,
	"custom_target_key" varchar(240),
	"visibility" "note_visibility" DEFAULT 'private' NOT NULL,
	"status" "note_status" DEFAULT 'active' NOT NULL,
	"body" text NOT NULL,
	"title" varchar(200),
	"source_type" varchar(40) DEFAULT 'user' NOT NULL,
	"source_ref" varchar(200),
	"created_by_user_id" text,
	"edited_by_user_id" text,
	"edited_at" timestamp with time zone,
	"is_pinned" boolean DEFAULT false NOT NULL,
	"is_locked" boolean DEFAULT false NOT NULL,
	"revision" integer DEFAULT 1 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "queue_entries" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"queue_id" text NOT NULL,
	"customer_user_id" text,
	"customer_group_account_id" text,
	"requested_offer_version_id" text,
	"booking_order_id" text,
	"fulfillment_unit_id" text,
	"status" "queue_entry_status" DEFAULT 'waiting' NOT NULL,
	"status_config_value_id" text,
	"priority_score" integer DEFAULT 0 NOT NULL,
	"display_code" varchar(60),
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"estimated_start_at" timestamp with time zone,
	"estimated_wait_min" integer,
	"offered_at" timestamp with time zone,
	"offer_expires_at" timestamp with time zone,
	"served_at" timestamp with time zone,
	"decision_state" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "queue_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"queue_entry_id" text NOT NULL,
	"event_type" "queue_event_type" NOT NULL,
	"actor_user_id" text,
	"event_at" timestamp with time zone DEFAULT now() NOT NULL,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "queue_tickets" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"queue_entry_id" text NOT NULL,
	"queue_id" text NOT NULL,
	"ticket_number" integer NOT NULL,
	"status" "queue_ticket_status" DEFAULT 'issued' NOT NULL,
	"status_config_value_id" text,
	"issued_at" timestamp with time zone DEFAULT now() NOT NULL,
	"called_at" timestamp with time zone,
	"service_started_at" timestamp with time zone,
	"service_ended_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "queues" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"description" varchar(600),
	"strategy" "queue_strategy" DEFAULT 'fifo' NOT NULL,
	"strategy_config_value_id" text,
	"status" "queue_status" DEFAULT 'active' NOT NULL,
	"status_config_value_id" text,
	"calendar_binding_id" text,
	"is_self_join_enabled" boolean DEFAULT true NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "service_time_observations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"queue_id" text NOT NULL,
	"offer_version_id" text,
	"resource_id" text,
	"fulfillment_unit_id" text,
	"source" "service_time_observation_source" DEFAULT 'actual' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"ended_at" timestamp with time zone NOT NULL,
	"duration_seconds" integer NOT NULL,
	"features" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "wait_time_predictions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"queue_id" text NOT NULL,
	"queue_entry_id" text,
	"model_type" "wait_time_prediction_model" DEFAULT 'heuristic' NOT NULL,
	"generated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"horizon_min" integer NOT NULL,
	"estimated_wait_min" integer NOT NULL,
	"p50_wait_min" integer,
	"p90_wait_min" integer,
	"details" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "dispatch_tasks" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"trip_id" text,
	"assigned_resource_id" text,
	"title" varchar(220) NOT NULL,
	"instructions" varchar(2000),
	"status" "dispatch_task_status" DEFAULT 'queued' NOT NULL,
	"due_at" timestamp with time zone,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"created_by_user_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "eta_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"trip_id" text NOT NULL,
	"route_stop_id" text,
	"event_type" "eta_event_type" NOT NULL,
	"event_at" timestamp with time zone DEFAULT now() NOT NULL,
	"eta_at" timestamp with time zone,
	"actual_at" timestamp with time zone,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fleet_vehicles" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"resource_id" text,
	"name" varchar(180) NOT NULL,
	"plate_number" varchar(40),
	"vin" varchar(64),
	"seat_capacity" integer NOT NULL,
	"luggage_capacity" integer,
	"status" "vehicle_status" DEFAULT 'active' NOT NULL,
	"telemetry_config" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "transport_route_stops" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"route_id" text NOT NULL,
	"stop_order" integer NOT NULL,
	"kind" "route_stop_kind" NOT NULL,
	"name" varchar(180) NOT NULL,
	"location_id" text,
	"geo_point" jsonb DEFAULT '{}'::jsonb,
	"offset_from_start_min" integer,
	"dwell_min" integer,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "transport_routes" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "transport_route_status" DEFAULT 'active' NOT NULL,
	"origin_location_id" text,
	"destination_location_id" text,
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "transport_trips" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"route_id" text NOT NULL,
	"offer_version_id" text,
	"fleet_vehicle_id" text,
	"driver_resource_id" text,
	"calendar_binding_id" text,
	"status" "transport_trip_status" DEFAULT 'planned' NOT NULL,
	"boarding_opens_at" timestamp with time zone,
	"departure_at" timestamp with time zone NOT NULL,
	"arrival_at" timestamp with time zone NOT NULL,
	"capacity_seats" integer NOT NULL,
	"overbook_seats" integer DEFAULT 0 NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "trip_manifests" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"trip_id" text NOT NULL,
	"booking_order_id" text,
	"fulfillment_unit_id" text,
	"queue_entry_id" text,
	"passenger_user_id" text,
	"passenger_group_account_id" text,
	"status" "trip_manifest_status" DEFAULT 'booked' NOT NULL,
	"seat_count" integer DEFAULT 1 NOT NULL,
	"seat_label" varchar(80),
	"checked_in_at" timestamp with time zone,
	"boarded_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "trip_stop_inventory" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"trip_id" text NOT NULL,
	"route_stop_id" text NOT NULL,
	"total_capacity" integer NOT NULL,
	"reserved_capacity" integer DEFAULT 0 NOT NULL,
	"waitlisted_count" integer DEFAULT 0 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "auctions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"target_type" "auction_target_type" DEFAULT 'marketplace_listing' NOT NULL,
	"marketplace_listing_id" text,
	"target_subject_type" varchar(80),
	"target_subject_id" varchar(140),
	"title" varchar(220),
	"status" "auction_status" DEFAULT 'scheduled' NOT NULL,
	"starts_at" timestamp with time zone NOT NULL,
	"ends_at" timestamp with time zone NOT NULL,
	"reserve_price_minor" integer,
	"buy_now_price_minor" integer,
	"min_increment_minor" integer DEFAULT 1 NOT NULL,
	"winning_bid_id" text,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "bids" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"auction_id" text NOT NULL,
	"bidder_biz_id" text,
	"bidder_user_id" text,
	"amount_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"status" "bid_status" DEFAULT 'pending' NOT NULL,
	"submitted_at" timestamp with time zone DEFAULT now() NOT NULL,
	"expires_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cross_biz_contracts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"counterparty_biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"status" "cross_biz_contract_status" DEFAULT 'draft' NOT NULL,
	"effective_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"terms" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"governance_policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "cross_biz_orders" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"buyer_biz_id" text NOT NULL,
	"seller_biz_id" text NOT NULL,
	"contract_id" text,
	"offer_version_id" text,
	"booking_order_id" text,
	"status" "cross_biz_order_status" DEFAULT 'draft' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"total_minor" integer DEFAULT 0 NOT NULL,
	"settlement_due_at" timestamp with time zone,
	"settled_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "marketplace_listings" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"listing_type" "marketplace_listing_type" NOT NULL,
	"offer_version_id" text,
	"resource_id" text,
	"title" varchar(240) NOT NULL,
	"summary" varchar(1000),
	"status" "marketplace_listing_status" DEFAULT 'draft' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"base_price_minor" integer DEFAULT 0 NOT NULL,
	"visibility_policy" jsonb DEFAULT '{}'::jsonb,
	"published_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "referral_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"referral_program_id" text NOT NULL,
	"event_type" "referral_event_type" NOT NULL,
	"referrer_user_id" text,
	"referred_user_id" text,
	"booking_order_id" text,
	"cross_biz_order_id" text,
	"event_at" timestamp with time zone DEFAULT now() NOT NULL,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "referral_programs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"starts_at" timestamp with time zone,
	"ends_at" timestamp with time zone,
	"policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "revenue_share_rules" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"contract_id" text,
	"marketplace_listing_id" text,
	"rule_type" "revenue_share_rule_type" NOT NULL,
	"percent_bps" integer,
	"amount_minor" integer,
	"tier_model" jsonb,
	"is_active" boolean DEFAULT true NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "reward_grants" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"referral_program_id" text NOT NULL,
	"referral_event_id" text NOT NULL,
	"recipient_user_id" text NOT NULL,
	"status" "referral_reward_status" DEFAULT 'pending' NOT NULL,
	"reward_type" varchar(80) NOT NULL,
	"amount_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"granted_at" timestamp with time zone,
	"reversed_at" timestamp with time zone,
	"payout_reference" varchar(140),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "operational_assignments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"operational_demand_id" text,
	"source_type" "operational_assignment_source_type" NOT NULL,
	"fulfillment_assignment_id" text,
	"staffing_assignment_id" text,
	"custom_subject_type" varchar(80),
	"custom_subject_id" varchar(140),
	"resource_id" text,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"source_status" varchar(80) NOT NULL,
	"starts_at" timestamp with time zone,
	"ends_at" timestamp with time zone,
	"priority" integer DEFAULT 100 NOT NULL,
	"request_key" varchar(140),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "operational_demands" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"source_type" "operational_demand_source_type" NOT NULL,
	"fulfillment_unit_id" text,
	"staffing_demand_id" text,
	"custom_subject_type" varchar(80),
	"custom_subject_id" varchar(140),
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"source_status" varchar(80) NOT NULL,
	"starts_at" timestamp with time zone,
	"ends_at" timestamp with time zone,
	"priority" integer DEFAULT 100 NOT NULL,
	"request_key" varchar(140),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_admin_delegations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"delegator_user_id" text NOT NULL,
	"delegate_user_id" text NOT NULL,
	"delegation_action" varchar(100) NOT NULL,
	"scope_id" text NOT NULL,
	"status" "enterprise_delegation_status" DEFAULT 'active' NOT NULL,
	"effective_from" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_to" timestamp with time zone,
	"can_subdelegate" boolean DEFAULT false NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_approval_authority_limits" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"user_id" text NOT NULL,
	"action_type" varchar(100) NOT NULL,
	"scope_id" text NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"per_approval_limit_minor" integer,
	"daily_limit_minor" integer,
	"monthly_limit_minor" integer,
	"requires_second_approver" boolean DEFAULT false NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_change_rollout_results" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"rollout_target_id" text NOT NULL,
	"result_type" varchar(80) DEFAULT 'applied' NOT NULL,
	"result_code" varchar(120),
	"message" text,
	"before_snapshot" jsonb DEFAULT '{}'::jsonb,
	"after_snapshot" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_change_rollout_runs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"slug" varchar(120),
	"change_type" varchar(100) NOT NULL,
	"status" "enterprise_rollout_status" DEFAULT 'draft' NOT NULL,
	"source_revision" varchar(160),
	"target_revision" varchar(160),
	"requested_by_user_id" text,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"finished_at" timestamp with time zone,
	"error_summary" varchar(2000),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_change_rollout_targets" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"rollout_run_id" text NOT NULL,
	"scope_id" text NOT NULL,
	"target_order" integer DEFAULT 100 NOT NULL,
	"status" "enterprise_rollout_target_status" DEFAULT 'pending' NOT NULL,
	"applied_at" timestamp with time zone,
	"error_summary" varchar(2000),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_contract_pack_bindings" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"contract_pack_version_id" text NOT NULL,
	"binding_mode" "enterprise_contract_pack_binding_mode" DEFAULT 'required' NOT NULL,
	"scope_id" text NOT NULL,
	"is_inherited" boolean DEFAULT false NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"effective_from" timestamp with time zone,
	"effective_to" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_contract_pack_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"domain_key" varchar(80) DEFAULT 'operations' NOT NULL,
	"description" text,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_contract_pack_versions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"contract_pack_template_id" text NOT NULL,
	"version_number" integer NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"effective_from" timestamp with time zone,
	"effective_to" timestamp with time zone,
	"definition" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_external_directory_links" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"identity_provider_id" text NOT NULL,
	"principal_type" varchar(60) NOT NULL,
	"user_id" text,
	"subject_type" varchar(80),
	"subject_id" varchar(140),
	"external_directory_id" varchar(200) NOT NULL,
	"external_parent_id" varchar(200),
	"status" "enterprise_directory_link_status" DEFAULT 'active' NOT NULL,
	"last_seen_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_identity_providers" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"provider_type" "enterprise_identity_provider_type" NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"issuer_url" varchar(500),
	"authorization_url" varchar(500),
	"token_url" varchar(500),
	"jwks_url" varchar(500),
	"sso_entry_point_url" varchar(500),
	"scim_base_url" varchar(500),
	"audience" varchar(255),
	"client_id" varchar(255),
	"last_sync_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_inheritance_resolutions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"strategy_id" text NOT NULL,
	"scope_id" text NOT NULL,
	"domain_key" varchar(140) NOT NULL,
	"resolution_status" "enterprise_resolution_status" DEFAULT 'ready' NOT NULL,
	"resolved_version" integer DEFAULT 1 NOT NULL,
	"resolution_hash" varchar(180),
	"resolved_document" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"source_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"resolved_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_inheritance_strategies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"inheritance_domain" varchar(100) NOT NULL,
	"resolution_mode" varchar(80) DEFAULT 'override_last' NOT NULL,
	"precedence" jsonb DEFAULT '["network","biz","location","subject"]'::jsonb NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"description" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_intercompany_accounts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"source_biz_id" text NOT NULL,
	"counterparty_biz_id" text NOT NULL,
	"account_type" "intercompany_account_type" NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"external_account_ref" varchar(140),
	"description" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_intercompany_entries" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"intercompany_account_id" text NOT NULL,
	"settlement_run_id" text,
	"entry_type" "intercompany_entry_type" NOT NULL,
	"status" "intercompany_entry_status" DEFAULT 'pending' NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"amount_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"description" text,
	"reference_key" varchar(160),
	"source_cross_biz_order_id" text,
	"source_payment_transaction_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_intercompany_settlement_runs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"intercompany_account_id" text NOT NULL,
	"status" "intercompany_settlement_run_status" DEFAULT 'draft' NOT NULL,
	"window_start_date" date NOT NULL,
	"window_end_date" date NOT NULL,
	"expected_total_minor" integer DEFAULT 0 NOT NULL,
	"posted_total_minor" integer DEFAULT 0 NOT NULL,
	"difference_minor" integer DEFAULT 0 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"finished_at" timestamp with time zone,
	"error_summary" varchar(2000),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_relationship_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(160) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"relationship_type_key" varchar(120) NOT NULL,
	"inverse_relationship_type_key" varchar(120),
	"description" text,
	"is_symmetric" boolean DEFAULT false NOT NULL,
	"allows_cycles" boolean DEFAULT false NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_relationships" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"relationship_template_id" text NOT NULL,
	"from_biz_id" text NOT NULL,
	"to_biz_id" text NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"effective_from" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_to" timestamp with time zone,
	"priority" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_scim_sync_states" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"identity_provider_id" text NOT NULL,
	"status" "enterprise_scim_sync_status" DEFAULT 'pending' NOT NULL,
	"sync_started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"sync_finished_at" timestamp with time zone,
	"cursor" varchar(1000),
	"imported_users_count" integer DEFAULT 0 NOT NULL,
	"updated_users_count" integer DEFAULT 0 NOT NULL,
	"deactivated_users_count" integer DEFAULT 0 NOT NULL,
	"error_summary" varchar(2000),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "enterprise_scopes" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"scope_type" "enterprise_scope_type" NOT NULL,
	"scope_key" varchar(260) NOT NULL,
	"target_biz_id" text,
	"target_location_id" text,
	"target_subject_type" varchar(80),
	"target_subject_id" varchar(140),
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fact_enterprise_compliance_daily" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"member_biz_id" text,
	"fact_date" date NOT NULL,
	"open_incidents_count" integer DEFAULT 0 NOT NULL,
	"open_breaches_count" integer DEFAULT 0 NOT NULL,
	"overdue_review_count" integer DEFAULT 0 NOT NULL,
	"resolved_incidents_count" integer DEFAULT 0 NOT NULL,
	"compliance_score_bps" integer,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fact_enterprise_revenue_daily" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"member_biz_id" text,
	"fact_date" date NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"gross_minor" integer DEFAULT 0 NOT NULL,
	"fee_minor" integer DEFAULT 0 NOT NULL,
	"refund_minor" integer DEFAULT 0 NOT NULL,
	"net_minor" integer DEFAULT 0 NOT NULL,
	"orders_count" integer DEFAULT 0 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fact_enterprise_utilization_daily" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"member_biz_id" text,
	"fact_date" date NOT NULL,
	"available_minutes" integer DEFAULT 0 NOT NULL,
	"scheduled_minutes" integer DEFAULT 0 NOT NULL,
	"blocked_minutes" integer DEFAULT 0 NOT NULL,
	"utilization_bps" integer DEFAULT 0 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "data_residency_policies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"compliance_profile_id" text,
	"name" varchar(220) NOT NULL,
	"scope" "residency_scope" NOT NULL,
	"enforcement_mode" "residency_enforcement_mode" DEFAULT 'hard_block' NOT NULL,
	"allowed_regions" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"allowed_countries" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"denied_regions" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"denied_countries" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"applies_to" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "data_subject_requests" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"request_type" "data_subject_request_type" NOT NULL,
	"status" "data_subject_request_status" DEFAULT 'submitted' NOT NULL,
	"subject_user_id" text,
	"subject_external_ref" varchar(200),
	"submitted_by_user_id" text,
	"verification_method" "dsr_verification_method",
	"verified_at" timestamp with time zone,
	"due_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolution_summary" text,
	"request_payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"fulfillment_evidence" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "legal_holds" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"scope" "legal_hold_scope" NOT NULL,
	"target_record_id" varchar(140),
	"status" "legal_hold_status" DEFAULT 'active' NOT NULL,
	"source_reference" varchar(200),
	"reason" text NOT NULL,
	"starts_at" timestamp with time zone DEFAULT now() NOT NULL,
	"ends_at" timestamp with time zone,
	"issued_by_user_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "policy_bindings" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"policy_template_id" text NOT NULL,
	"target_type" "policy_binding_target_type" NOT NULL,
	"location_id" text,
	"resource_id" text,
	"service_id" text,
	"service_product_id" text,
	"offer_id" text,
	"offer_version_id" text,
	"queue_id" text,
	"target_subject_type" varchar(80),
	"target_subject_id" varchar(140),
	"priority" integer DEFAULT 100 NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"enforcement_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "policy_breach_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"policy_template_id" text NOT NULL,
	"policy_rule_id" text,
	"policy_binding_id" text,
	"status" "policy_breach_status" DEFAULT 'open' NOT NULL,
	"detection_source" "policy_breach_detection_source" DEFAULT 'auto_engine' NOT NULL,
	"severity" "policy_rule_severity" DEFAULT 'medium' NOT NULL,
	"target_subject_type" varchar(80) NOT NULL,
	"target_subject_id" varchar(140) NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"acknowledged_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"waived_at" timestamp with time zone,
	"dismissed_at" timestamp with time zone,
	"measured_value" integer,
	"threshold_value" integer,
	"breach_code" varchar(120),
	"summary" text,
	"evidence" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"context_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "policy_consequence_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"policy_breach_event_id" text NOT NULL,
	"consequence_type" "policy_consequence_type" NOT NULL,
	"status" "policy_consequence_status" DEFAULT 'planned' NOT NULL,
	"planned_at" timestamp with time zone DEFAULT now() NOT NULL,
	"applied_at" timestamp with time zone,
	"failed_at" timestamp with time zone,
	"reverted_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"amount_minor" integer,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"actor_user_id" text,
	"compensation_ledger_entry_id" text,
	"payment_transaction_id" text,
	"settlement_entry_id" text,
	"workflow_instance_id" text,
	"review_queue_item_id" text,
	"details" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "policy_rules" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"policy_template_id" text NOT NULL,
	"rule_key" varchar(140) NOT NULL,
	"name" varchar(220) NOT NULL,
	"description" text,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"predicate_type" "policy_rule_predicate_type" NOT NULL,
	"condition_expr" text,
	"metric_key" varchar(140),
	"metric_comparator" varchar(8),
	"metric_threshold" integer,
	"schedule_window" jsonb,
	"severity" "policy_rule_severity" DEFAULT 'medium' NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"is_blocking" boolean DEFAULT true NOT NULL,
	"is_enabled" boolean DEFAULT true NOT NULL,
	"evidence_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"consequence_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "policy_templates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"domain_key" varchar(120) NOT NULL,
	"description" text,
	"version" integer DEFAULT 1 NOT NULL,
	"aggregation_mode" "policy_rule_aggregation_mode" DEFAULT 'all' NOT NULL,
	"min_passing_rule_count" integer,
	"effective_from_at" timestamp with time zone,
	"effective_to_at" timestamp with time zone,
	"is_default" boolean DEFAULT false NOT NULL,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"evaluation_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"consequence_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "privacy_identity_modes" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"slug" varchar(120) NOT NULL,
	"mode" "privacy_identity_mode" NOT NULL,
	"sensitivity" "pii_sensitivity_level" DEFAULT 'moderate' NOT NULL,
	"masking_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"access_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"is_default" boolean DEFAULT false NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "redaction_jobs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"data_subject_request_id" text,
	"legal_hold_id" text,
	"target_type" "redaction_target_type" NOT NULL,
	"target_record_id" varchar(200) NOT NULL,
	"status" "redaction_job_status" DEFAULT 'queued' NOT NULL,
	"queued_at" timestamp with time zone DEFAULT now() NOT NULL,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"failure_reason" text,
	"execution_log" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "retention_policies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"compliance_profile_id" text,
	"name" varchar(220) NOT NULL,
	"data_class" varchar(140) NOT NULL,
	"interval_value" integer,
	"interval_unit" "retention_interval_unit" NOT NULL,
	"action" "retention_action" NOT NULL,
	"honor_legal_holds" boolean DEFAULT true NOT NULL,
	"minimum_retain_days" integer,
	"is_active" boolean DEFAULT true NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tenant_compliance_profiles" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"regime" "compliance_regime" NOT NULL,
	"description" text,
	"is_default" boolean DEFAULT false NOT NULL,
	"is_active" boolean DEFAULT true NOT NULL,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"evidence_requirements" jsonb DEFAULT '{}'::jsonb,
	"incident_policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "breach_notifications" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"security_incident_id" text NOT NULL,
	"recipient_type" "breach_notification_recipient_type" NOT NULL,
	"recipient_name" varchar(260),
	"recipient_ref" varchar(200),
	"channel" "communication_channel" DEFAULT 'email' NOT NULL,
	"status" "breach_notification_status" DEFAULT 'draft' NOT NULL,
	"due_at" timestamp with time zone,
	"sent_at" timestamp with time zone,
	"failure_reason" text,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"delivery_ref" varchar(240),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "break_glass_reviews" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"phi_access_event_id" text NOT NULL,
	"status" "break_glass_review_status" DEFAULT 'pending' NOT NULL,
	"reviewer_user_id" text,
	"reviewed_at" timestamp with time zone,
	"summary" text,
	"security_incident_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "business_associate_agreements" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"compliance_profile_id" text,
	"party_type" "baa_party_type" NOT NULL,
	"party_name" varchar(220) NOT NULL,
	"party_external_ref" varchar(200),
	"biz_extension_install_id" text,
	"status" "baa_status" DEFAULT 'draft' NOT NULL,
	"agreement_version" varchar(60) DEFAULT '1.0' NOT NULL,
	"contract_ref" varchar(200),
	"document_ref" varchar(600),
	"allows_phi_processing" boolean DEFAULT false NOT NULL,
	"requires_subcontractor_flow_down" boolean DEFAULT true NOT NULL,
	"breach_notice_window_hours" integer DEFAULT 72 NOT NULL,
	"effective_from" timestamp with time zone,
	"effective_to" timestamp with time zone,
	"signed_at" timestamp with time zone,
	"terminated_at" timestamp with time zone,
	"obligations" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "hipaa_authorizations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"compliance_profile_id" text,
	"subject_user_id" text,
	"subject_group_account_id" text,
	"subject_external_ref" varchar(200),
	"status" "hipaa_authorization_status" DEFAULT 'draft' NOT NULL,
	"purpose_of_use" "hipaa_purpose_of_use" NOT NULL,
	"scope_description" text NOT NULL,
	"signed_at" timestamp with time zone,
	"effective_from" timestamp with time zone,
	"effective_to" timestamp with time zone,
	"revoked_at" timestamp with time zone,
	"revoked_reason" text,
	"document_ref" varchar(600),
	"granted_by_user_id" text,
	"witnessed_by_user_id" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "phi_access_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"phi_access_policy_id" text,
	"hipaa_authorization_id" text,
	"actor_user_id" text,
	"actor_ref" varchar(200),
	"target_type" "custom_field_target_type" NOT NULL,
	"target_ref_id" varchar(140) NOT NULL,
	"subject_user_id" text,
	"subject_group_account_id" text,
	"subject_external_ref" varchar(200),
	"purpose_of_use" "hipaa_purpose_of_use" NOT NULL,
	"action" "phi_access_action" NOT NULL,
	"decision" "phi_access_decision" DEFAULT 'allowed' NOT NULL,
	"is_break_glass" boolean DEFAULT false NOT NULL,
	"break_glass_reason" text,
	"request_ref" varchar(200),
	"source_ip" varchar(80),
	"user_agent" varchar(500),
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"fields_accessed" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "phi_access_policies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"compliance_profile_id" text,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"scope" "extension_scope" DEFAULT 'biz' NOT NULL,
	"scope_ref_key" varchar(300) NOT NULL,
	"location_id" text,
	"subject_ref_type" varchar(80),
	"subject_ref_id" text,
	"sensitivity" "pii_sensitivity_level" DEFAULT 'high' NOT NULL,
	"allowed_purposes" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"allowed_actions" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"require_authorization" boolean DEFAULT false NOT NULL,
	"require_mfa" boolean DEFAULT false NOT NULL,
	"require_break_glass_justification" boolean DEFAULT true NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "phi_disclosure_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"compliance_profile_id" text,
	"subject_user_id" text,
	"subject_group_account_id" text,
	"subject_external_ref" varchar(200),
	"disclosed_by_user_id" text,
	"recipient_type" "disclosure_recipient_type" NOT NULL,
	"recipient_name" varchar(260) NOT NULL,
	"recipient_ref" varchar(200),
	"purpose_of_use" "hipaa_purpose_of_use" NOT NULL,
	"disclosed_at" timestamp with time zone DEFAULT now() NOT NULL,
	"data_classes" jsonb DEFAULT '[]'::jsonb NOT NULL,
	"legal_basis" varchar(220),
	"is_tpo_exempt" boolean DEFAULT false NOT NULL,
	"hipaa_authorization_id" text,
	"business_associate_agreement_id" text,
	"request_ref" varchar(200),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "security_incidents" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"compliance_profile_id" text,
	"incident_type" "security_incident_type" NOT NULL,
	"severity" "security_incident_severity" DEFAULT 'medium' NOT NULL,
	"status" "security_incident_status" DEFAULT 'open' NOT NULL,
	"summary" varchar(800) NOT NULL,
	"details" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"affected_records_count" integer,
	"reported_by_user_id" text,
	"detected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"contained_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "async_deliverables" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"workflow_instance_id" text,
	"booking_order_id" text,
	"fulfillment_unit_id" text,
	"deliverable_type" "async_deliverable_type" NOT NULL,
	"status" "async_deliverable_status" DEFAULT 'queued' NOT NULL,
	"requested_at" timestamp with time zone DEFAULT now() NOT NULL,
	"processing_started_at" timestamp with time zone,
	"ready_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"delivery_channel" varchar(80),
	"result_payload" jsonb DEFAULT '{}'::jsonb,
	"failure_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "review_queue_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"review_queue_id" text NOT NULL,
	"status" "review_item_status" DEFAULT 'pending' NOT NULL,
	"item_type" varchar(100) NOT NULL,
	"item_ref_id" varchar(140) NOT NULL,
	"booking_order_id" text,
	"fulfillment_unit_id" text,
	"priority" integer DEFAULT 100 NOT NULL,
	"risk_score" integer,
	"assigned_to_user_id" text,
	"due_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"resolution_payload" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "review_queues" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(200) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"type" "review_queue_type" NOT NULL,
	"status" "review_queue_status" DEFAULT 'active' NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_decisions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"workflow_instance_id" text NOT NULL,
	"workflow_step_id" text,
	"outcome" "workflow_decision_outcome" NOT NULL,
	"decider_user_id" text,
	"decided_at" timestamp with time zone DEFAULT now() NOT NULL,
	"reason" text,
	"payload" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_instances" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"workflow_key" varchar(140) NOT NULL,
	"trigger_type" "workflow_trigger_type" NOT NULL,
	"status" "workflow_instance_status" DEFAULT 'pending' NOT NULL,
	"target_type" varchar(100) NOT NULL,
	"target_ref_id" varchar(140) NOT NULL,
	"booking_order_id" text,
	"fulfillment_unit_id" text,
	"review_queue_item_id" text,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"current_step_key" varchar(140),
	"error_code" varchar(120),
	"input_payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"output_payload" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "workflow_steps" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"workflow_instance_id" text NOT NULL,
	"step_key" varchar(140) NOT NULL,
	"name" varchar(200) NOT NULL,
	"sequence" integer NOT NULL,
	"status" "workflow_step_status" DEFAULT 'pending' NOT NULL,
	"assigned_to_user_id" text,
	"started_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"due_at" timestamp with time zone,
	"input_payload" jsonb DEFAULT '{}'::jsonb,
	"output_payload" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gift_expiration_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"gift_instrument_id" text NOT NULL,
	"reason" "gift_expiration_reason" NOT NULL,
	"amount_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"expired_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gift_instrument_ledger_entries" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"gift_instrument_id" text NOT NULL,
	"entry_type" "gift_ledger_entry_type" NOT NULL,
	"amount_delta_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"running_balance_after_minor" integer NOT NULL,
	"gift_redemption_id" text,
	"gift_transfer_id" text,
	"gift_expiration_event_id" text,
	"booking_order_id" text,
	"booking_order_line_id" text,
	"payment_intent_id" text,
	"payment_intent_tender_id" text,
	"payment_transaction_id" text,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"idempotency_key" varchar(200),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gift_instruments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"code" varchar(120) NOT NULL,
	"status" "gift_instrument_status" DEFAULT 'draft' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"initial_amount_minor" integer NOT NULL,
	"remaining_amount_minor" integer NOT NULL,
	"balance_version" integer DEFAULT 0 NOT NULL,
	"source_type" "gift_instrument_source_type" DEFAULT 'manual' NOT NULL,
	"source_gift_instrument_id" text,
	"issued_from_sellable_id" text,
	"issued_from_booking_order_id" text,
	"issued_from_booking_order_line_id" text,
	"issued_from_payment_intent_id" text,
	"issued_from_payment_intent_tender_id" text,
	"issued_from_payment_transaction_id" text,
	"owner_user_id" text,
	"owner_group_account_id" text,
	"expires_at" timestamp with time zone,
	"issued_at" timestamp with time zone DEFAULT now() NOT NULL,
	"activated_at" timestamp with time zone,
	"voided_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gift_redemptions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"gift_instrument_id" text NOT NULL,
	"booking_order_id" text,
	"booking_order_line_id" text,
	"payment_intent_id" text,
	"payment_intent_tender_id" text,
	"payment_transaction_id" text,
	"status" "gift_redemption_status" DEFAULT 'applied' NOT NULL,
	"amount_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"redeemed_at" timestamp with time zone DEFAULT now() NOT NULL,
	"reversed_at" timestamp with time zone,
	"idempotency_key" varchar(200),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gift_transfers" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"gift_instrument_id" text NOT NULL,
	"mode" "gift_transfer_mode" DEFAULT 'full_transfer' NOT NULL,
	"target_gift_instrument_id" text,
	"from_user_id" text,
	"from_group_account_id" text,
	"to_user_id" text,
	"to_group_account_id" text,
	"status" "gift_transfer_status" DEFAULT 'pending' NOT NULL,
	"amount_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"transferred_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "booking_participant_obligations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"booking_order_id" text NOT NULL,
	"booking_order_line_id" text,
	"participant_user_id" text,
	"participant_group_account_id" text,
	"obligation_type" "participant_obligation_type" NOT NULL,
	"status" "participant_obligation_status" DEFAULT 'pending' NOT NULL,
	"amount_due_minor" integer,
	"amount_satisfied_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"due_at" timestamp with time zone,
	"satisfied_at" timestamp with time zone,
	"status_reason" varchar(400),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "participant_obligation_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"booking_participant_obligation_id" text NOT NULL,
	"event_type" "participant_obligation_event_type" NOT NULL,
	"delta_amount_minor" integer,
	"happened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"actor_user_id" text,
	"note" varchar(1000),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ar_invoices" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"billing_account_id" text NOT NULL,
	"purchase_order_id" text,
	"invoice_number" varchar(120) NOT NULL,
	"status" "ar_invoice_status" DEFAULT 'draft' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"subtotal_minor" integer DEFAULT 0 NOT NULL,
	"tax_minor" integer DEFAULT 0 NOT NULL,
	"fee_minor" integer DEFAULT 0 NOT NULL,
	"discount_minor" integer DEFAULT 0 NOT NULL,
	"total_minor" integer DEFAULT 0 NOT NULL,
	"outstanding_minor" integer DEFAULT 0 NOT NULL,
	"issued_at" timestamp with time zone,
	"due_at" timestamp with time zone,
	"paid_at" timestamp with time zone,
	"voided_at" timestamp with time zone,
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "billing_accounts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"account_type" "billing_account_type" NOT NULL,
	"status" "billing_account_status" DEFAULT 'active' NOT NULL,
	"counterparty_biz_id" text,
	"counterparty_user_id" text,
	"counterparty_group_account_id" text,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"credit_limit_minor" integer,
	"payment_terms_days" integer DEFAULT 0 NOT NULL,
	"tax_profile" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "invoice_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"ar_invoice_id" text NOT NULL,
	"event_type" "invoice_event_type" NOT NULL,
	"amount_minor" integer,
	"happened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"actor_user_id" text,
	"note" varchar(1000),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "purchase_orders" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"billing_account_id" text NOT NULL,
	"po_number" varchar(120) NOT NULL,
	"status" "purchase_order_status" DEFAULT 'draft' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"authorized_amount_minor" integer DEFAULT 0 NOT NULL,
	"billed_amount_minor" integer DEFAULT 0 NOT NULL,
	"issued_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "autocollection_attempts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"billing_account_autopay_rule_id" text NOT NULL,
	"billing_account_id" text NOT NULL,
	"ar_invoice_id" text,
	"installment_schedule_item_id" text,
	"status" varchar(40) DEFAULT 'queued' NOT NULL,
	"attempt_number" integer DEFAULT 1 NOT NULL,
	"scheduled_for" timestamp with time zone NOT NULL,
	"started_at" timestamp with time zone,
	"finished_at" timestamp with time zone,
	"payment_intent_id" text,
	"payment_transaction_id" text,
	"attempted_amount_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"failure_code" varchar(120),
	"failure_message" text,
	"idempotency_key" varchar(160),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "billing_account_autopay_rules" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"billing_account_id" text NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"name" varchar(220) NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"is_default" boolean DEFAULT false NOT NULL,
	"payment_method_id" text,
	"target_scope" varchar(40) DEFAULT 'both' NOT NULL,
	"run_offset_days" integer DEFAULT 0 NOT NULL,
	"max_attempts_per_item" integer DEFAULT 3 NOT NULL,
	"retry_interval_hours" integer DEFAULT 24 NOT NULL,
	"minimum_amount_minor" integer DEFAULT 0 NOT NULL,
	"maximum_amount_minor" integer,
	"allow_partial_collection" boolean DEFAULT false NOT NULL,
	"collection_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "installment_plans" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"ar_invoice_id" text NOT NULL,
	"version" integer DEFAULT 1 NOT NULL,
	"is_current" boolean DEFAULT true NOT NULL,
	"status" varchar(40) DEFAULT 'draft' NOT NULL,
	"plan_kind" varchar(40) DEFAULT 'custom_schedule' NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"total_planned_minor" integer DEFAULT 0 NOT NULL,
	"total_paid_minor" integer DEFAULT 0 NOT NULL,
	"total_waived_minor" integer DEFAULT 0 NOT NULL,
	"total_failed_minor" integer DEFAULT 0 NOT NULL,
	"installment_count" integer DEFAULT 1 NOT NULL,
	"starts_at" timestamp with time zone,
	"ends_at" timestamp with time zone,
	"next_due_at" timestamp with time zone,
	"auto_advance" boolean DEFAULT true NOT NULL,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "installment_schedule_items" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"installment_plan_id" text NOT NULL,
	"sequence_no" integer NOT NULL,
	"due_at" timestamp with time zone NOT NULL,
	"status" varchar(40) DEFAULT 'pending' NOT NULL,
	"amount_minor" integer NOT NULL,
	"paid_minor" integer DEFAULT 0 NOT NULL,
	"waived_minor" integer DEFAULT 0 NOT NULL,
	"failed_minor" integer DEFAULT 0 NOT NULL,
	"late_fee_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"attempt_count" integer DEFAULT 0 NOT NULL,
	"last_attempt_at" timestamp with time zone,
	"paid_at" timestamp with time zone,
	"payment_intent_id" text,
	"payment_transaction_id" text,
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "commitment_claim_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"commitment_claim_id" text NOT NULL,
	"event_type" "commitment_claim_event_type" NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"actor_user_id" text,
	"actor_subject_type" varchar(80),
	"actor_subject_id" varchar(140),
	"secured_balance_ledger_entry_id" text,
	"note" text,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "commitment_claims" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"commitment_contract_id" text NOT NULL,
	"claim_type" "commitment_claim_type" NOT NULL,
	"status" "commitment_claim_status" DEFAULT 'open' NOT NULL,
	"resolution_type" "commitment_claim_resolution_type",
	"title" varchar(220) NOT NULL,
	"description" text,
	"raised_by_subject_type" varchar(80) NOT NULL,
	"raised_by_subject_id" varchar(140) NOT NULL,
	"against_subject_type" varchar(80),
	"against_subject_id" varchar(140),
	"opened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"respond_by_at" timestamp with time zone,
	"resolved_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"disputed_amount_minor" integer,
	"settled_amount_minor" integer,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"resolved_by_user_id" text,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "commitment_contracts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"contract_type" "commitment_contract_type" NOT NULL,
	"status" "commitment_contract_status" DEFAULT 'draft' NOT NULL,
	"title" varchar(220) NOT NULL,
	"description" text,
	"anchor_subject_type" varchar(80) NOT NULL,
	"anchor_subject_id" varchar(140) NOT NULL,
	"counterparty_subject_type" varchar(80),
	"counterparty_subject_id" varchar(140),
	"offer_version_id" text,
	"booking_order_id" text,
	"ar_invoice_id" text,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"committed_amount_minor" integer DEFAULT 0 NOT NULL,
	"released_amount_minor" integer DEFAULT 0 NOT NULL,
	"forfeited_amount_minor" integer DEFAULT 0 NOT NULL,
	"started_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"completed_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "commitment_milestone_obligations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"commitment_contract_id" text NOT NULL,
	"commitment_milestone_id" text NOT NULL,
	"commitment_obligation_id" text NOT NULL,
	"is_required" boolean DEFAULT true NOT NULL,
	"weight" integer DEFAULT 1 NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "commitment_milestones" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"commitment_contract_id" text NOT NULL,
	"code" varchar(100) NOT NULL,
	"title" varchar(220) NOT NULL,
	"description" text,
	"status" "commitment_milestone_status" DEFAULT 'pending' NOT NULL,
	"evaluation_mode" "commitment_milestone_evaluation_mode" DEFAULT 'all' NOT NULL,
	"min_satisfied_count" integer,
	"release_mode" "commitment_milestone_release_mode" DEFAULT 'manual' NOT NULL,
	"release_amount_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"due_at" timestamp with time zone,
	"ready_at" timestamp with time zone,
	"released_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"released_by_user_id" text,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "commitment_obligations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"commitment_contract_id" text NOT NULL,
	"obligation_type" "commitment_obligation_type" NOT NULL,
	"status" "commitment_obligation_status" DEFAULT 'pending' NOT NULL,
	"title" varchar(220) NOT NULL,
	"description" text,
	"obligor_subject_type" varchar(80),
	"obligor_subject_id" varchar(140),
	"beneficiary_subject_type" varchar(80),
	"beneficiary_subject_id" varchar(140),
	"required_amount_minor" integer,
	"satisfied_amount_minor" integer DEFAULT 0,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"due_at" timestamp with time zone,
	"satisfied_at" timestamp with time zone,
	"breached_at" timestamp with time zone,
	"waived_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"source_subject_type" varchar(80),
	"source_subject_id" varchar(140),
	"sort_order" integer DEFAULT 100 NOT NULL,
	"evidence_policy" jsonb DEFAULT '{}'::jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "secured_balance_accounts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"commitment_contract_id" text,
	"account_type" "secured_balance_account_type" NOT NULL,
	"status" "secured_balance_account_status" DEFAULT 'open' NOT NULL,
	"title" varchar(220) NOT NULL,
	"description" text,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"balance_minor" integer DEFAULT 0 NOT NULL,
	"held_minor" integer DEFAULT 0 NOT NULL,
	"released_minor" integer DEFAULT 0 NOT NULL,
	"forfeited_minor" integer DEFAULT 0 NOT NULL,
	"owner_subject_type" varchar(80) NOT NULL,
	"owner_subject_id" varchar(140) NOT NULL,
	"counterparty_subject_type" varchar(80),
	"counterparty_subject_id" varchar(140),
	"opened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"closed_at" timestamp with time zone,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "secured_balance_allocations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"secured_balance_ledger_entry_id" text NOT NULL,
	"allocation_type" "secured_balance_allocation_type" NOT NULL,
	"allocated_amount_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"commitment_obligation_id" text,
	"commitment_milestone_id" text,
	"booking_order_line_id" text,
	"ar_invoice_id" text,
	"payment_transaction_line_allocation_id" text,
	"target_subject_type" varchar(80),
	"target_subject_id" varchar(140),
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "secured_balance_ledger_entries" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"secured_balance_account_id" text NOT NULL,
	"entry_type" "secured_balance_ledger_entry_type" NOT NULL,
	"status" "secured_balance_ledger_entry_status" DEFAULT 'posted' NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"balance_delta_minor" integer DEFAULT 0 NOT NULL,
	"held_delta_minor" integer DEFAULT 0 NOT NULL,
	"commitment_contract_id" text,
	"commitment_milestone_id" text,
	"commitment_obligation_id" text,
	"payment_transaction_id" text,
	"ar_invoice_id" text,
	"booking_order_id" text,
	"booking_order_line_id" text,
	"source_subject_type" varchar(80),
	"source_subject_id" varchar(140),
	"idempotency_key" varchar(200),
	"reason_code" varchar(120),
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_breach_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sla_policy_id" text,
	"target_type" "sla_breach_target_type" NOT NULL,
	"booking_order_id" text,
	"fulfillment_unit_id" text,
	"queue_entry_id" text,
	"work_run_id" text,
	"resource_id" text,
	"target_ref_type" varchar(80),
	"target_ref_id" text,
	"status" "sla_breach_status" DEFAULT 'open' NOT NULL,
	"started_at" timestamp with time zone NOT NULL,
	"breached_at" timestamp with time zone NOT NULL,
	"resolved_at" timestamp with time zone,
	"target_duration_min" integer NOT NULL,
	"grace_duration_min" integer DEFAULT 0 NOT NULL,
	"measured_duration_min" integer NOT NULL,
	"severity_level" integer DEFAULT 2 NOT NULL,
	"is_auto_detected" boolean DEFAULT true NOT NULL,
	"details" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_compensation_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sla_breach_event_id" text NOT NULL,
	"type" "sla_compensation_type" NOT NULL,
	"status" "sla_compensation_status" DEFAULT 'pending' NOT NULL,
	"amount_minor" integer NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"booking_order_id" text,
	"ar_invoice_id" text,
	"applied_at" timestamp with time zone,
	"reversed_at" timestamp with time zone,
	"note" varchar(1000),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "sla_policies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"metric_kind" "sla_metric_kind" NOT NULL,
	"scope_type" "sla_policy_scope_type" DEFAULT 'biz' NOT NULL,
	"location_id" text,
	"resource_id" text,
	"offer_version_id" text,
	"service_product_id" text,
	"queue_id" text,
	"scope_ref_type" varchar(80),
	"scope_ref_id" text,
	"target_duration_min" integer NOT NULL,
	"grace_duration_min" integer DEFAULT 0 NOT NULL,
	"severity_level" integer DEFAULT 2 NOT NULL,
	"business_hours_only" boolean DEFAULT false NOT NULL,
	"evaluation_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"compensation_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fx_rate_snapshots" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"base_currency" varchar(3) NOT NULL,
	"quote_currency" varchar(3) NOT NULL,
	"rate" numeric(24, 10) NOT NULL,
	"source" "fx_rate_source" DEFAULT 'provider' NOT NULL,
	"source_ref" varchar(200),
	"effective_at" timestamp with time zone NOT NULL,
	"expires_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tax_calculations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"tax_profile_id" text,
	"tax_rule_ref_id" text,
	"fx_rate_snapshot_id" text,
	"booking_order_id" text,
	"ar_invoice_id" text,
	"status" "tax_calculation_status" DEFAULT 'calculated' NOT NULL,
	"taxable_subtotal_minor" integer DEFAULT 0 NOT NULL,
	"tax_minor" integer DEFAULT 0 NOT NULL,
	"total_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"calculated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"finalized_at" timestamp with time zone,
	"input_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"output_breakdown" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tax_profiles" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"country_code" varchar(2) NOT NULL,
	"region_code" varchar(80),
	"city_code" varchar(80),
	"postal_code_pattern" varchar(120),
	"tax_inclusive_default" boolean DEFAULT false NOT NULL,
	"rounding_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "tax_rule_refs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"tax_profile_id" text NOT NULL,
	"rule_key" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"rate_bps" integer,
	"flat_amount_minor" integer,
	"applies_to" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"valid_from" timestamp with time zone,
	"valid_to" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "leave_balances" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"leave_policy_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"balance_amount" numeric(18, 6) DEFAULT '0' NOT NULL,
	"reserved_amount" numeric(18, 6) DEFAULT '0' NOT NULL,
	"used_amount" numeric(18, 6) DEFAULT '0' NOT NULL,
	"as_of_at" timestamp with time zone DEFAULT now() NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "leave_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"leave_policy_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"leave_request_id" text,
	"event_type" "leave_event_type" NOT NULL,
	"amount_delta" numeric(18, 6) NOT NULL,
	"resulting_balance" numeric(18, 6),
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"actor_user_id" text,
	"note" varchar(1000),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "leave_policies" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'draft' NOT NULL,
	"location_id" text,
	"resource_type" "resource_type",
	"unit" "leave_unit" DEFAULT 'hours' NOT NULL,
	"accrual_period" "leave_accrual_period" DEFAULT 'monthly' NOT NULL,
	"accrual_rate" numeric(18, 6) DEFAULT '0' NOT NULL,
	"annual_allowance" numeric(18, 6) DEFAULT '0' NOT NULL,
	"carryover_max" numeric(18, 6),
	"allow_negative_balance" boolean DEFAULT false NOT NULL,
	"min_notice_minutes" integer DEFAULT 0 NOT NULL,
	"policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "leave_requests" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"leave_policy_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"requester_user_id" text,
	"approver_user_id" text,
	"status" "leave_request_status" DEFAULT 'pending' NOT NULL,
	"unit" "leave_unit" NOT NULL,
	"quantity_requested" numeric(18, 6) NOT NULL,
	"quantity_approved" numeric(18, 6),
	"start_at" timestamp with time zone NOT NULL,
	"end_at" timestamp with time zone NOT NULL,
	"submitted_at" timestamp with time zone DEFAULT now() NOT NULL,
	"decided_at" timestamp with time zone,
	"reason" text,
	"decision_reason" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "offline_merge_conflicts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"offline_op_journal_id" text NOT NULL,
	"conflict_type" "offline_conflict_type" NOT NULL,
	"status" "offline_conflict_status" DEFAULT 'open' NOT NULL,
	"entity_type" varchar(120) NOT NULL,
	"entity_id" varchar(140),
	"local_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"remote_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"summary" varchar(1000),
	"details" jsonb DEFAULT '{}'::jsonb,
	"detected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"resolved_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "offline_ops_journal" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"actor_user_id" text,
	"client_id" varchar(200) NOT NULL,
	"session_key" varchar(200),
	"operation_key" varchar(200) NOT NULL,
	"operation_kind" "offline_operation_kind" NOT NULL,
	"status" "offline_operation_status" DEFAULT 'pending' NOT NULL,
	"entity_type" varchar(120) NOT NULL,
	"entity_id" varchar(140),
	"expected_version" integer,
	"applied_version" integer,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"patch" jsonb,
	"failure_reason" text,
	"queued_at" timestamp with time zone NOT NULL,
	"received_at" timestamp with time zone DEFAULT now() NOT NULL,
	"applied_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "offline_resolution_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"offline_merge_conflict_id" text NOT NULL,
	"action" "offline_resolution_action" NOT NULL,
	"actor_user_id" text,
	"happened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"resulting_offline_op_journal_id" text,
	"note" varchar(1000),
	"patch_applied" jsonb,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fact_operational_daily" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"source_type" "operational_demand_source_type",
	"fact_date" date NOT NULL,
	"open_demands_count" integer DEFAULT 0 NOT NULL,
	"filled_demands_count" integer DEFAULT 0 NOT NULL,
	"active_assignments_count" integer DEFAULT 0 NOT NULL,
	"completed_assignments_count" integer DEFAULT 0 NOT NULL,
	"avg_fill_lead_minutes" integer,
	"avg_assignment_duration_minutes" integer,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fact_refresh_runs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"fact_key" varchar(120) NOT NULL,
	"status" "fact_refresh_status" DEFAULT 'running' NOT NULL,
	"window_start_date" date NOT NULL,
	"window_end_date" date NOT NULL,
	"input_rows" integer DEFAULT 0 NOT NULL,
	"output_rows" integer DEFAULT 0 NOT NULL,
	"started_at" timestamp with time zone DEFAULT now() NOT NULL,
	"finished_at" timestamp with time zone,
	"error_summary" varchar(2000),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fact_resource_utilization_daily" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"resource_id" text NOT NULL,
	"fact_date" date NOT NULL,
	"available_minutes" integer DEFAULT 0 NOT NULL,
	"booked_minutes" integer DEFAULT 0 NOT NULL,
	"blocked_minutes" integer DEFAULT 0 NOT NULL,
	"utilization_bps" integer DEFAULT 0 NOT NULL,
	"assignments_count" integer DEFAULT 0 NOT NULL,
	"no_show_count" integer DEFAULT 0 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fact_revenue_daily" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"fact_date" date NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"gross_minor" integer DEFAULT 0 NOT NULL,
	"tax_minor" integer DEFAULT 0 NOT NULL,
	"fee_minor" integer DEFAULT 0 NOT NULL,
	"discount_minor" integer DEFAULT 0 NOT NULL,
	"refund_minor" integer DEFAULT 0 NOT NULL,
	"net_minor" integer DEFAULT 0 NOT NULL,
	"orders_count" integer DEFAULT 0 NOT NULL,
	"paid_orders_count" integer DEFAULT 0 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fact_revenue_monthly" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"month_start_date" date NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"gross_minor" integer DEFAULT 0 NOT NULL,
	"tax_minor" integer DEFAULT 0 NOT NULL,
	"fee_minor" integer DEFAULT 0 NOT NULL,
	"discount_minor" integer DEFAULT 0 NOT NULL,
	"refund_minor" integer DEFAULT 0 NOT NULL,
	"net_minor" integer DEFAULT 0 NOT NULL,
	"orders_count" integer DEFAULT 0 NOT NULL,
	"paid_orders_count" integer DEFAULT 0 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "fact_sellable_daily" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"sellable_id" text NOT NULL,
	"fact_date" date NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"quantity" integer DEFAULT 0 NOT NULL,
	"gross_minor" integer DEFAULT 0 NOT NULL,
	"discount_minor" integer DEFAULT 0 NOT NULL,
	"refund_minor" integer DEFAULT 0 NOT NULL,
	"net_minor" integer DEFAULT 0 NOT NULL,
	"cost_minor" integer,
	"margin_minor" integer,
	"orders_count" integer DEFAULT 0 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "projection_checkpoints" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"projection_key" varchar(140) NOT NULL,
	"scope_type" "projection_scope_type" DEFAULT 'biz' NOT NULL,
	"location_id" text,
	"resource_id" text,
	"sellable_id" text,
	"subject_type" varchar(80),
	"subject_id" varchar(140),
	"status" "projection_health_status" DEFAULT 'healthy' NOT NULL,
	"revision" integer DEFAULT 0 NOT NULL,
	"last_lifecycle_event_id" text,
	"last_event_occurred_at" timestamp with time zone,
	"last_applied_at" timestamp with time zone DEFAULT now() NOT NULL,
	"lag_seconds" integer DEFAULT 0 NOT NULL,
	"error_summary" varchar(2000),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gift_delivery_attempts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"gift_delivery_schedule_id" text NOT NULL,
	"attempt_no" integer DEFAULT 1 NOT NULL,
	"status" varchar(40) DEFAULT 'queued' NOT NULL,
	"channel" varchar(40) NOT NULL,
	"attempted_at" timestamp with time zone DEFAULT now() NOT NULL,
	"completed_at" timestamp with time zone,
	"provider" varchar(80),
	"provider_message_ref" varchar(220),
	"outbound_message_id" text,
	"error_code" varchar(120),
	"error_message" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "gift_delivery_schedules" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"gift_instrument_id" text NOT NULL,
	"status" varchar(40) DEFAULT 'scheduled' NOT NULL,
	"recipient_name" varchar(220),
	"recipient_channel" varchar(40) NOT NULL,
	"recipient_address" varchar(500) NOT NULL,
	"recipient_locale" varchar(20),
	"timezone" varchar(50) DEFAULT 'UTC' NOT NULL,
	"send_at" timestamp with time zone NOT NULL,
	"not_before_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"message_subject" varchar(300),
	"message_body" text,
	"message_template_id" text,
	"outbound_message_id" text,
	"attempt_count" integer DEFAULT 0 NOT NULL,
	"last_attempt_at" timestamp with time zone,
	"sent_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"delivery_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "ad_spend_daily_facts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"fact_date" date NOT NULL,
	"provider" varchar(80) NOT NULL,
	"channel_account_id" text,
	"provider_account_ref" varchar(220),
	"provider_account_name" varchar(220),
	"campaign_ref" varchar(220),
	"campaign_name" varchar(220),
	"ad_group_ref" varchar(220),
	"ad_group_name" varchar(220),
	"ad_ref" varchar(220),
	"ad_name" varchar(220),
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"impressions" integer DEFAULT 0 NOT NULL,
	"clicks" integer DEFAULT 0 NOT NULL,
	"conversions" integer DEFAULT 0 NOT NULL,
	"spend_minor" integer DEFAULT 0 NOT NULL,
	"conversion_value_minor" integer,
	"attributed_revenue_minor" integer,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "marketing_audience_segment_memberships" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"marketing_audience_segment_id" text NOT NULL,
	"member_crm_contact_id" text,
	"member_subject_type" varchar(80),
	"member_subject_id" varchar(140),
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"source_type" varchar(40) DEFAULT 'rule' NOT NULL,
	"source_ref" varchar(180),
	"score" integer,
	"added_at" timestamp with time zone DEFAULT now() NOT NULL,
	"removed_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "marketing_audience_segments" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"segment_type" varchar(40) DEFAULT 'dynamic' NOT NULL,
	"source_type" varchar(40) DEFAULT 'rule' NOT NULL,
	"graph_audience_segment_id" text,
	"definition" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"last_materialized_at" timestamp with time zone,
	"member_count" integer DEFAULT 0 NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "marketing_audience_sync_runs" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"marketing_audience_segment_id" text NOT NULL,
	"channel_account_id" text,
	"provider" varchar(80) NOT NULL,
	"external_audience_ref" varchar(220),
	"direction" varchar(40) DEFAULT 'export' NOT NULL,
	"status" varchar(40) DEFAULT 'queued' NOT NULL,
	"requested_by_user_id" text,
	"requested_at" timestamp with time zone DEFAULT now() NOT NULL,
	"started_at" timestamp with time zone,
	"finished_at" timestamp with time zone,
	"input_count" integer DEFAULT 0 NOT NULL,
	"added_count" integer DEFAULT 0 NOT NULL,
	"removed_count" integer DEFAULT 0 NOT NULL,
	"failed_count" integer DEFAULT 0 NOT NULL,
	"error_summary" text,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "offline_conversion_pushes" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"channel_account_id" text,
	"provider" varchar(80) NOT NULL,
	"conversion_action_ref" varchar(220),
	"status" varchar(40) DEFAULT 'queued' NOT NULL,
	"booking_order_id" text,
	"payment_transaction_id" text,
	"referral_attribution_id" text,
	"conversion_at" timestamp with time zone NOT NULL,
	"conversion_value_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"external_event_ref" varchar(220),
	"attempt_count" integer DEFAULT 0 NOT NULL,
	"last_attempt_at" timestamp with time zone,
	"sent_at" timestamp with time zone,
	"error_code" varchar(120),
	"error_message" text,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_contact_channels" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"crm_contact_id" text NOT NULL,
	"channel_type" varchar(40) NOT NULL,
	"channel_address" varchar(500) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"label" varchar(120),
	"is_primary" boolean DEFAULT false NOT NULL,
	"verified_at" timestamp with time zone,
	"opted_out_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_contacts" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"contact_type" varchar(40) NOT NULL,
	"user_id" text,
	"group_account_id" text,
	"external_contact_ref" varchar(220),
	"display_name" varchar(220),
	"email" varchar(320),
	"phone" varchar(80),
	"source_type" varchar(80),
	"source_ref" varchar(220),
	"profile" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_conversation_messages" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"crm_conversation_id" text NOT NULL,
	"direction" varchar(40) DEFAULT 'inbound' NOT NULL,
	"sender_crm_contact_id" text,
	"sender_subject_type" varchar(80),
	"sender_subject_id" varchar(140),
	"sender_display_name" varchar(220),
	"body" text,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"status" varchar(40) DEFAULT 'received' NOT NULL,
	"occurred_at" timestamp with time zone DEFAULT now() NOT NULL,
	"outbound_message_id" text,
	"provider_message_ref" varchar(220),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_conversation_participants" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"crm_conversation_id" text NOT NULL,
	"participant_crm_contact_id" text,
	"participant_subject_type" varchar(80),
	"participant_subject_id" varchar(140),
	"display_name" varchar(220),
	"role" varchar(40) DEFAULT 'customer' NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"joined_at" timestamp with time zone DEFAULT now() NOT NULL,
	"left_at" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_conversations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"status" varchar(40) DEFAULT 'open' NOT NULL,
	"channel_type" varchar(40) DEFAULT 'email' NOT NULL,
	"topic" varchar(260),
	"crm_lead_id" text,
	"crm_opportunity_id" text,
	"crm_contact_id" text,
	"owner_user_id" text,
	"assigned_user_id" text,
	"priority" integer DEFAULT 100 NOT NULL,
	"first_inbound_at" timestamp with time zone,
	"last_message_at" timestamp with time zone,
	"next_action_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"external_thread_ref" varchar(240),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_lead_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"crm_lead_id" text NOT NULL,
	"event_type" varchar(80) NOT NULL,
	"from_status" varchar(40),
	"to_status" varchar(40),
	"actor_user_id" text,
	"happened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"note" text,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_leads" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"status" varchar(40) DEFAULT 'new' NOT NULL,
	"source_type" varchar(80),
	"source_ref" varchar(220),
	"crm_contact_id" text NOT NULL,
	"location_id" text,
	"crm_pipeline_id" text,
	"crm_pipeline_stage_id" text,
	"owner_user_id" text,
	"score_bps" integer DEFAULT 0 NOT NULL,
	"priority" integer DEFAULT 100 NOT NULL,
	"qualified_at" timestamp with time zone,
	"converted_at" timestamp with time zone,
	"lost_at" timestamp with time zone,
	"notes" text,
	"attributes" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_merge_candidates" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"left_subject_type" varchar(80) NOT NULL,
	"left_subject_id" varchar(140) NOT NULL,
	"right_subject_type" varchar(80) NOT NULL,
	"right_subject_id" varchar(140) NOT NULL,
	"status" varchar(40) DEFAULT 'open' NOT NULL,
	"similarity_score_bps" integer DEFAULT 0 NOT NULL,
	"rule_key" varchar(140),
	"detected_at" timestamp with time zone DEFAULT now() NOT NULL,
	"evidence" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_merge_decisions" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"crm_merge_candidate_id" text NOT NULL,
	"decision_type" varchar(40) NOT NULL,
	"decided_by_user_id" text,
	"decided_at" timestamp with time zone DEFAULT now() NOT NULL,
	"winner_subject_type" varchar(80),
	"winner_subject_id" varchar(140),
	"loser_subject_type" varchar(80),
	"loser_subject_id" varchar(140),
	"decision_note" text,
	"field_resolution" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_opportunities" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"status" varchar(40) DEFAULT 'open' NOT NULL,
	"crm_pipeline_id" text NOT NULL,
	"crm_pipeline_stage_id" text NOT NULL,
	"title" varchar(260) NOT NULL,
	"description" text,
	"primary_crm_lead_id" text,
	"owner_user_id" text,
	"crm_contact_id" text,
	"estimated_amount_minor" integer DEFAULT 0 NOT NULL,
	"committed_amount_minor" integer DEFAULT 0 NOT NULL,
	"weighted_amount_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"probability_bps" integer DEFAULT 0 NOT NULL,
	"expected_close_at" timestamp with time zone,
	"won_at" timestamp with time zone,
	"lost_at" timestamp with time zone,
	"closed_reason_code" varchar(120),
	"source_type" varchar(80),
	"source_ref" varchar(220),
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_opportunity_stage_events" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"crm_opportunity_id" text NOT NULL,
	"from_crm_pipeline_stage_id" text,
	"to_crm_pipeline_stage_id" text,
	"event_type" varchar(60) DEFAULT 'moved' NOT NULL,
	"actor_user_id" text,
	"happened_at" timestamp with time zone DEFAULT now() NOT NULL,
	"note" text,
	"payload" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_pipeline_stages" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"crm_pipeline_id" text NOT NULL,
	"name" varchar(180) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"sort_order" integer DEFAULT 100 NOT NULL,
	"is_closed_won" boolean DEFAULT false NOT NULL,
	"is_closed_lost" boolean DEFAULT false NOT NULL,
	"default_probability_bps" integer DEFAULT 0 NOT NULL,
	"stage_policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_pipelines" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"name" varchar(220) NOT NULL,
	"slug" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"pipeline_type" varchar(40) DEFAULT 'opportunity' NOT NULL,
	"is_default" boolean DEFAULT false NOT NULL,
	"description" text,
	"policy" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "crm_subject_redirects" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"subject_type" varchar(80) NOT NULL,
	"from_subject_id" varchar(140) NOT NULL,
	"to_subject_id" varchar(140) NOT NULL,
	"status" "lifecycle_status" DEFAULT 'active' NOT NULL,
	"crm_merge_decision_id" text,
	"reason_code" varchar(120),
	"effective_from" timestamp with time zone DEFAULT now() NOT NULL,
	"effective_to" timestamp with time zone,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "production_batch_reservations" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"production_batch_id" text NOT NULL,
	"status" varchar(40) DEFAULT 'waitlisted' NOT NULL,
	"owner_user_id" text,
	"owner_group_account_id" text,
	"guest_email" varchar(320),
	"requested_quantity" integer DEFAULT 1 NOT NULL,
	"allocated_quantity" integer DEFAULT 0 NOT NULL,
	"paid_amount_minor" integer DEFAULT 0 NOT NULL,
	"currency" varchar(3) DEFAULT 'USD' NOT NULL,
	"source_checkout_session_id" text,
	"booking_order_id" text,
	"requested_at" timestamp with time zone DEFAULT now() NOT NULL,
	"fulfilled_at" timestamp with time zone,
	"cancelled_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"notes" text,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE TABLE IF NOT EXISTS "production_batches" (
	"id" text PRIMARY KEY NOT NULL,
	"biz_id" text NOT NULL,
	"location_id" text,
	"sellable_id" text NOT NULL,
	"batch_code" varchar(120) NOT NULL,
	"name" varchar(220),
	"status" varchar(40) DEFAULT 'planned' NOT NULL,
	"planned_quantity" integer DEFAULT 0 NOT NULL,
	"produced_quantity" integer DEFAULT 0 NOT NULL,
	"reserved_quantity" integer DEFAULT 0 NOT NULL,
	"released_quantity" integer DEFAULT 0 NOT NULL,
	"production_start_at" timestamp with time zone,
	"ready_at" timestamp with time zone,
	"expires_at" timestamp with time zone,
	"closed_at" timestamp with time zone,
	"policy_snapshot" jsonb DEFAULT '{}'::jsonb NOT NULL,
	"metadata" jsonb DEFAULT '{}'::jsonb,
	"created_at" timestamp with time zone DEFAULT now() NOT NULL,
	"updated_at" timestamp with time zone DEFAULT now() NOT NULL,
	"deleted_at" timestamp with time zone,
	"created_by" text,
	"updated_by" text,
	"deleted_by" text
);
--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "bizes_slug_unique" ON "bizes" ("slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "bizes_status_idx" ON "bizes" ("status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "users_email_unique" ON "users" ("email");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "users_status_idx" ON "users" ("status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "accounts_user_id_idx" ON "accounts" ("user_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "invitations_organization_id_idx" ON "invitations" ("organization_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "invitations_email_idx" ON "invitations" ("email");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "members_organization_id_idx" ON "members" ("organization_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "members_user_id_idx" ON "members" ("user_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sessions_user_id_idx" ON "sessions" ("user_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "verifications_identifier_idx" ON "verifications" ("identifier");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "locations_org_id_unique" ON "locations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "locations_org_slug_unique" ON "locations" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "locations_org_status_idx" ON "locations" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "group_account_members_unique" ON "group_account_members" ("biz_id","group_account_id","user_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "group_account_members_org_idx" ON "group_account_members" ("biz_id","group_account_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "group_accounts_biz_id_id_unique" ON "group_accounts" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "group_accounts_org_status_idx" ON "group_accounts" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "group_accounts_org_name_idx" ON "group_accounts" ("biz_id","name");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "org_membership_locations_unique" ON "org_membership_locations" ("membership_id","location_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "org_membership_locations_org_idx" ON "org_membership_locations" ("biz_id","location_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "org_memberships_unique" ON "org_memberships" ("biz_id","user_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "org_memberships_better_auth_unique" ON "org_memberships" ("biz_id","better_auth_member_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "org_memberships_org_role_idx" ON "org_memberships" ("biz_id","role");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "org_memberships_org_status_idx" ON "org_memberships" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_bindings_biz_id_id_unique" ON "biz_config_bindings" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_bindings_unique" ON "biz_config_bindings" ("biz_id","location_id","scope_ref_type","scope_ref_id","target_entity","target_field","config_set_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_bindings_primary_per_target_unique" ON "biz_config_bindings" ("biz_id","location_id","scope_ref_type","scope_ref_id","target_entity","target_field");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "biz_config_bindings_resolver_idx" ON "biz_config_bindings" ("biz_id","target_entity","target_field","location_id","scope_ref_type","scope_ref_id","is_active");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_promotion_run_items_run_entity_source_unique" ON "biz_config_promotion_run_items" ("promotion_run_id","entity_type","source_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "biz_config_promotion_run_items_biz_run_status_idx" ON "biz_config_promotion_run_items" ("biz_id","promotion_run_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_promotion_runs_biz_id_id_unique" ON "biz_config_promotion_runs" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "biz_config_promotion_runs_biz_status_started_idx" ON "biz_config_promotion_runs" ("biz_id","status","started_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_sets_biz_id_id_unique" ON "biz_config_sets" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_sets_biz_location_slug_unique" ON "biz_config_sets" ("biz_id","location_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "biz_config_sets_biz_type_active_idx" ON "biz_config_sets" ("biz_id","set_type","is_active");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_value_localizations_biz_id_id_unique" ON "biz_config_value_localizations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_value_localizations_value_locale_unique" ON "biz_config_value_localizations" ("config_value_id","locale");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "biz_config_value_localizations_biz_locale_idx" ON "biz_config_value_localizations" ("biz_id","locale","is_active");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_values_biz_id_id_unique" ON "biz_config_values" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_values_biz_set_id_id_unique" ON "biz_config_values" ("biz_id","config_set_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_values_set_code_unique" ON "biz_config_values" ("config_set_id","code");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_config_values_single_default_per_set_unique" ON "biz_config_values" ("config_set_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "biz_config_values_set_active_sort_idx" ON "biz_config_values" ("config_set_id","is_active","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "biz_config_values_replacement_idx" ON "biz_config_values" ("config_set_id","replaced_by_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_groups_biz_id_id_unique" ON "service_groups" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_groups_biz_slug_unique" ON "service_groups" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_groups_biz_status_idx" ON "service_groups" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_groups_biz_status_config_idx" ON "service_groups" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "services_biz_id_id_unique" ON "services" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "services_org_slug_unique" ON "services" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "services_org_status_idx" ON "services" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "services_org_type_idx" ON "services" ("biz_id","type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "services_biz_type_config_idx" ON "services" ("biz_id","type_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "services_biz_visibility_config_idx" ON "services" ("biz_id","visibility_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "services_biz_status_config_idx" ON "services" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "services_biz_group_idx" ON "services" ("biz_id","service_group_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "services_biz_approval_waitlist_idx" ON "services" ("biz_id","requires_approval","allow_waitlist","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "products_biz_id_id_unique" ON "products" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "products_org_slug_unique" ON "products" ("biz_id","slug");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "products_org_sku_unique" ON "products" ("biz_id","sku");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "products_org_status_idx" ON "products" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "booking_order_line_sellables_biz_line_idx" ON "booking_order_line_sellables" ("biz_id","booking_order_line_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "booking_order_line_sellables_biz_sellable_idx" ON "booking_order_line_sellables" ("biz_id","sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "booking_order_line_sellables_line_sellable_unique" ON "booking_order_line_sellables" ("booking_order_line_id","sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "inventory_items_biz_id_id_unique" ON "inventory_items" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "inventory_items_location_product_unique" ON "inventory_items" ("inventory_location_id","product_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "inventory_items_biz_product_idx" ON "inventory_items" ("biz_id","product_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "inventory_items_biz_location_idx" ON "inventory_items" ("biz_id","inventory_location_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "inventory_locations_biz_id_id_unique" ON "inventory_locations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "inventory_locations_biz_slug_unique" ON "inventory_locations" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "inventory_locations_biz_kind_status_idx" ON "inventory_locations" ("biz_id","kind","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "inventory_movements_biz_idempotency_unique" ON "inventory_movements" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "inventory_movements_biz_item_occurred_idx" ON "inventory_movements" ("biz_id","inventory_item_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "inventory_movements_biz_booking_occurred_idx" ON "inventory_movements" ("biz_id","booking_order_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "inventory_reservations_biz_id_id_unique" ON "inventory_reservations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "inventory_reservations_biz_idempotency_unique" ON "inventory_reservations" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "inventory_reservations_biz_status_expiry_idx" ON "inventory_reservations" ("biz_id","status","expires_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "inventory_reservations_biz_inventory_item_idx" ON "inventory_reservations" ("biz_id","inventory_item_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "physical_fulfillment_items_biz_id_id_unique" ON "physical_fulfillment_items" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "physical_fulfillment_items_biz_fulfillment_idx" ON "physical_fulfillment_items" ("biz_id","physical_fulfillment_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "physical_fulfillments_biz_id_id_unique" ON "physical_fulfillments" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "physical_fulfillments_biz_external_ref_unique" ON "physical_fulfillments" ("biz_id","external_fulfillment_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "physical_fulfillments_biz_status_ship_by_idx" ON "physical_fulfillments" ("biz_id","status","ship_by_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "product_bundle_components_biz_bundle_sort_idx" ON "product_bundle_components" ("biz_id","product_bundle_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "product_bundle_components_product_unique" ON "product_bundle_components" ("product_bundle_id","product_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "product_bundle_components_service_product_unique" ON "product_bundle_components" ("product_bundle_id","service_product_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "product_bundle_components_offer_unique" ON "product_bundle_components" ("product_bundle_id","offer_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "product_bundles_biz_id_id_unique" ON "product_bundles" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "product_bundles_bundle_product_unique" ON "product_bundles" ("bundle_product_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "product_bundles_biz_status_idx" ON "product_bundles" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_offer_versions_sellable_unique" ON "sellable_offer_versions" ("sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_offer_versions_offer_version_unique" ON "sellable_offer_versions" ("offer_version_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_products_sellable_unique" ON "sellable_products" ("sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_products_product_unique" ON "sellable_products" ("product_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_resource_rates_sellable_unique" ON "sellable_resource_rates" ("sellable_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sellable_resource_rates_biz_resource_idx" ON "sellable_resource_rates" ("biz_id","resource_id","rate_unit");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_service_products_sellable_unique" ON "sellable_service_products" ("sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_service_products_service_product_unique" ON "sellable_service_products" ("service_product_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellables_biz_id_id_unique" ON "sellables" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellables_biz_id_id_kind_unique" ON "sellables" ("biz_id","id","kind");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellables_biz_slug_unique" ON "sellables" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sellables_biz_kind_status_idx" ON "sellables" ("biz_id","kind","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variant_dimension_values_biz_id_id_unique" ON "sellable_variant_dimension_values" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variant_dimension_values_biz_id_id_dimension_unique" ON "sellable_variant_dimension_values" ("biz_id","id","sellable_variant_dimension_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variant_dimension_values_dimension_key_unique" ON "sellable_variant_dimension_values" ("sellable_variant_dimension_id","value_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sellable_variant_dimension_values_biz_dimension_sort_idx" ON "sellable_variant_dimension_values" ("biz_id","sellable_variant_dimension_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variant_dimensions_biz_id_id_unique" ON "sellable_variant_dimensions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variant_dimensions_biz_id_id_base_unique" ON "sellable_variant_dimensions" ("biz_id","id","base_sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variant_dimensions_base_key_unique" ON "sellable_variant_dimensions" ("base_sellable_id","dimension_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sellable_variant_dimensions_biz_base_sort_idx" ON "sellable_variant_dimensions" ("biz_id","base_sellable_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variant_selections_variant_dimension_unique" ON "sellable_variant_selections" ("sellable_variant_id","sellable_variant_dimension_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variant_selections_variant_value_unique" ON "sellable_variant_selections" ("sellable_variant_id","sellable_variant_dimension_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sellable_variant_selections_biz_variant_idx" ON "sellable_variant_selections" ("biz_id","sellable_variant_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sellable_variant_selections_biz_dimension_idx" ON "sellable_variant_selections" ("biz_id","sellable_variant_dimension_id","sellable_variant_dimension_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variants_biz_id_id_unique" ON "sellable_variants" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variants_biz_id_id_base_unique" ON "sellable_variants" ("biz_id","id","base_sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variants_variant_sellable_unique" ON "sellable_variants" ("variant_sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_variants_biz_base_variant_unique" ON "sellable_variants" ("biz_id","base_sellable_id","variant_sellable_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sellable_variants_biz_base_status_idx" ON "sellable_variants" ("biz_id","base_sellable_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sellable_pricing_modes_biz_id_id_unique" ON "sellable_pricing_modes" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sellable_pricing_modes_biz_sellable_status_effective_idx" ON "sellable_pricing_modes" ("biz_id","sellable_id","status","effective_from");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sellable_pricing_overrides_biz_mode_scope_effective_idx" ON "sellable_pricing_overrides" ("biz_id","sellable_pricing_mode_id","scope_type","priority","effective_from");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sellable_pricing_thresholds_biz_mode_sort_idx" ON "sellable_pricing_thresholds" ("biz_id","sellable_pricing_mode_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_product_requirement_groups_biz_id_id_unique" ON "service_product_requirement_groups" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_product_requirement_groups_unique" ON "service_product_requirement_groups" ("service_product_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_requirement_groups_biz_product_idx" ON "service_product_requirement_groups" ("biz_id","service_product_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_requirement_groups_biz_type_idx" ON "service_product_requirement_groups" ("biz_id","target_resource_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_requirement_selectors_group_idx" ON "service_product_requirement_selectors" ("requirement_group_id","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_requirement_selectors_resource_idx" ON "service_product_requirement_selectors" ("resource_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_requirement_selectors_resource_type_idx" ON "service_product_requirement_selectors" ("resource_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_requirement_selectors_subject_idx" ON "service_product_requirement_selectors" ("subject_type","subject_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_requirement_selectors_capability_idx" ON "service_product_requirement_selectors" ("capability_template_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_requirement_selectors_location_idx" ON "service_product_requirement_selectors" ("location_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_product_seat_type_requirements_unique" ON "service_product_seat_type_requirements" ("seat_type_id","requirement_group_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_seat_type_requirements_biz_seat_idx" ON "service_product_seat_type_requirements" ("biz_id","seat_type_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_product_seat_types_biz_id_id_unique" ON "service_product_seat_types" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_product_seat_types_unique" ON "service_product_seat_types" ("service_product_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_seat_types_biz_product_idx" ON "service_product_seat_types" ("biz_id","service_product_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_seat_types_biz_status_config_idx" ON "service_product_seat_types" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_product_services_unique_service" ON "service_product_services" ("service_product_id","service_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_product_services_unique_group" ON "service_product_services" ("service_product_id","service_group_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_product_services_biz_product_idx" ON "service_product_services" ("biz_id","service_product_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_products_biz_id_id_unique" ON "service_products" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_products_biz_slug_unique" ON "service_products" ("biz_id","slug");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "service_products_product_unique" ON "service_products" ("product_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_products_biz_status_idx" ON "service_products" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_products_biz_kind_idx" ON "service_products" ("biz_id","kind");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_products_biz_kind_config_idx" ON "service_products" ("biz_id","kind_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_products_biz_duration_mode_config_idx" ON "service_products" ("biz_id","duration_mode_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_products_biz_status_config_idx" ON "service_products" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assets_biz_id_id_unique" ON "assets" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assets_biz_slug_unique" ON "assets" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "assets_biz_location_idx" ON "assets" ("biz_id","location_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "venues_biz_id_id_unique" ON "venues" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "venues_biz_slug_unique" ON "venues" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "venues_biz_location_idx" ON "venues" ("biz_id","location_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "host_group_members_unique" ON "host_group_members" ("host_group_id","user_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "host_group_members_biz_group_idx" ON "host_group_members" ("biz_id","host_group_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "host_group_members_biz_user_idx" ON "host_group_members" ("biz_id","user_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "host_groups_resource_unique" ON "host_groups" ("resource_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "host_groups_biz_status_idx" ON "host_groups" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "host_users_resource_unique" ON "host_users" ("resource_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "host_users_biz_status_idx" ON "host_users" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resource_service_capabilities_unique" ON "resource_service_capabilities" ("resource_id","service_id","location_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_service_capabilities_biz_service_idx" ON "resource_service_capabilities" ("biz_id","service_id","is_enabled");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_service_capabilities_biz_resource_idx" ON "resource_service_capabilities" ("biz_id","resource_id","is_enabled");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resource_status_definitions_biz_id_id_unique" ON "resource_status_definitions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resource_status_definitions_biz_location_slug_unique" ON "resource_status_definitions" ("biz_id","location_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_status_definitions_biz_schedulable_idx" ON "resource_status_definitions" ("biz_id","is_bookable");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resources_biz_id_id_unique" ON "resources" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resources_biz_slug_unique" ON "resources" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resources_biz_type_idx" ON "resources" ("biz_id","type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resources_biz_status_definition_idx" ON "resources" ("biz_id","status_definition_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resources_host_user_single_wrapper_unique" ON "resources" ("host_user_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resources_group_account_single_wrapper_unique" ON "resources" ("group_account_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resources_asset_single_wrapper_unique" ON "resources" ("asset_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resources_venue_single_wrapper_unique" ON "resources" ("venue_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_accounts_biz_id_id_unique" ON "stripe_accounts" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_accounts_biz_processor_account_unique" ON "stripe_accounts" ("biz_id","payment_processor_account_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_accounts_biz_stripe_id_unique" ON "stripe_accounts" ("biz_id","stripe_account_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_accounts_biz_default_charges_unique" ON "stripe_accounts" ("biz_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_accounts_biz_default_payouts_unique" ON "stripe_accounts" ("biz_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_accounts_enabled_idx" ON "stripe_accounts" ("charges_enabled","payouts_enabled");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_accounts_biz_usage_model_idx" ON "stripe_accounts" ("biz_id","account_usage_model","merchant_model");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_checkout_sessions_stripe_id_unique" ON "stripe_checkout_sessions" ("stripe_checkout_session_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_checkout_sessions_org_status_idx" ON "stripe_checkout_sessions" ("biz_id","status","payment_status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_checkout_sessions_biz_account_idx" ON "stripe_checkout_sessions" ("biz_id","stripe_account_ref_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_customers_stripe_id_unique" ON "stripe_customers" ("stripe_customer_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_customers_biz_account_user_unique" ON "stripe_customers" ("biz_id","stripe_account_ref_id","user_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_customers_biz_account_group_account_unique" ON "stripe_customers" ("biz_id","stripe_account_ref_id","group_account_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_customers_biz_account_idx" ON "stripe_customers" ("biz_id","stripe_account_ref_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_invoices_stripe_id_unique" ON "stripe_invoices" ("stripe_invoice_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_invoices_org_status_idx" ON "stripe_invoices" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_invoices_biz_account_idx" ON "stripe_invoices" ("biz_id","stripe_account_ref_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_payment_methods_stripe_id_unique" ON "stripe_payment_methods" ("stripe_payment_method_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_payment_methods_org_customer_idx" ON "stripe_payment_methods" ("biz_id","stripe_customer_ref_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_payment_methods_fingerprint_idx" ON "stripe_payment_methods" ("fingerprint");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_payouts_stripe_id_unique" ON "stripe_payouts" ("stripe_payout_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_payouts_org_status_idx" ON "stripe_payouts" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_payouts_biz_account_idx" ON "stripe_payouts" ("biz_id","stripe_account_ref_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_setup_intents_stripe_id_unique" ON "stripe_setup_intents" ("stripe_setup_intent_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_setup_intents_org_status_idx" ON "stripe_setup_intents" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_transfers_stripe_id_unique" ON "stripe_transfers" ("stripe_transfer_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_transfers_org_status_idx" ON "stripe_transfers" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_transfers_biz_destination_account_idx" ON "stripe_transfers" ("biz_id","destination_account_ref_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_transfers_booking_order_idx" ON "stripe_transfers" ("booking_order_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_transfers_cross_biz_order_idx" ON "stripe_transfers" ("cross_biz_order_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "stripe_webhook_events_stripe_id_unique" ON "stripe_webhook_events" ("stripe_event_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_webhook_events_status_idx" ON "stripe_webhook_events" ("processing_status","created_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_webhook_events_type_idx" ON "stripe_webhook_events" ("event_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "stripe_webhook_events_biz_account_idx" ON "stripe_webhook_events" ("biz_id","stripe_account_ref_id","processing_status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "subject_location_bindings_unique" ON "subject_location_bindings" ("biz_id","subject_type","subject_id","location_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "subject_location_bindings_biz_location_active_idx" ON "subject_location_bindings" ("biz_id","location_id","is_active");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "subject_location_bindings_biz_subject_active_idx" ON "subject_location_bindings" ("biz_id","subject_type","subject_id","is_active");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "subject_location_bindings_single_primary_per_subject_unique" ON "subject_location_bindings" ("biz_id","subject_type","subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "subject_relationships_biz_edge_unique" ON "subject_relationships" ("biz_id","from_subject_type","from_subject_id","relationship_type","to_subject_type","to_subject_id","direction");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "subject_relationships_biz_from_idx" ON "subject_relationships" ("biz_id","from_subject_type","from_subject_id","relationship_type","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "subject_relationships_biz_to_idx" ON "subject_relationships" ("biz_id","to_subject_type","to_subject_id","relationship_type","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "subjects_biz_type_id_unique" ON "subjects" ("biz_id","subject_type","subject_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "subjects_biz_status_idx" ON "subjects" ("biz_id","status","is_linkable");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "subjects_biz_type_idx" ON "subjects" ("biz_id","subject_type");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offer_component_seat_types_biz_id_id_unique" ON "offer_component_seat_types" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offer_component_seat_types_unique" ON "offer_component_seat_types" ("offer_version_id","component_id","code");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offer_component_seat_types_biz_offer_version_idx" ON "offer_component_seat_types" ("biz_id","offer_version_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offer_component_selectors_biz_component_idx" ON "offer_component_selectors" ("biz_id","component_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offer_component_selectors_biz_resource_type_idx" ON "offer_component_selectors" ("biz_id","resource_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offer_component_selectors_biz_subject_idx" ON "offer_component_selectors" ("biz_id","subject_type","subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offer_components_biz_id_id_unique" ON "offer_components" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offer_components_offer_version_slug_unique" ON "offer_components" ("offer_version_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offer_components_biz_offer_version_idx" ON "offer_components" ("biz_id","offer_version_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offer_version_admission_modes_biz_id_id_unique" ON "offer_version_admission_modes" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offer_version_admission_modes_version_mode_unique" ON "offer_version_admission_modes" ("offer_version_id","mode");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offer_version_admission_modes_one_primary_unique" ON "offer_version_admission_modes" ("offer_version_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offer_version_admission_modes_biz_version_status_priority_idx" ON "offer_version_admission_modes" ("biz_id","offer_version_id","status","priority");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offer_versions_biz_id_id_unique" ON "offer_versions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offer_versions_offer_version_unique" ON "offer_versions" ("offer_id","version");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offer_versions_single_published_per_offer_unique" ON "offer_versions" ("offer_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offer_versions_biz_status_idx" ON "offer_versions" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offer_versions_biz_status_config_idx" ON "offer_versions" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offer_versions_biz_duration_mode_config_idx" ON "offer_versions" ("biz_id","duration_mode_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offers_biz_id_id_unique" ON "offers" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offers_biz_slug_unique" ON "offers" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offers_biz_status_idx" ON "offers" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offers_biz_status_config_idx" ON "offers" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offers_biz_execution_mode_idx" ON "offers" ("biz_id","execution_mode");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offers_biz_execution_mode_config_idx" ON "offers" ("biz_id","execution_mode_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resource_capability_assignments_unique" ON "resource_capability_assignments" ("resource_id","capability_template_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_capability_assignments_biz_resource_idx" ON "resource_capability_assignments" ("biz_id","resource_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_capability_assignments_biz_capability_idx" ON "resource_capability_assignments" ("biz_id","capability_template_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resource_capability_templates_biz_id_id_unique" ON "resource_capability_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resource_capability_templates_scope_slug_unique" ON "resource_capability_templates" ("biz_id","location_id","scope","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_capability_templates_biz_scope_idx" ON "resource_capability_templates" ("biz_id","scope","is_active");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_condition_reports_biz_resource_idx" ON "resource_condition_reports" ("biz_id","resource_id","reported_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_condition_reports_biz_severity_idx" ON "resource_condition_reports" ("biz_id","severity","resolved_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resource_maintenance_policies_biz_id_id_unique" ON "resource_maintenance_policies" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resource_maintenance_policies_biz_slug_unique" ON "resource_maintenance_policies" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_maintenance_policies_biz_active_idx" ON "resource_maintenance_policies" ("biz_id","is_active");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_maintenance_work_orders_biz_status_idx" ON "resource_maintenance_work_orders" ("biz_id","status","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_maintenance_work_orders_biz_resource_idx" ON "resource_maintenance_work_orders" ("biz_id","resource_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_maintenance_work_orders_biz_calendar_idx" ON "resource_maintenance_work_orders" ("biz_id","calendar_id","status","scheduled_start_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "resource_usage_counters_unique" ON "resource_usage_counters" ("resource_id","counter_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "resource_usage_counters_biz_resource_idx" ON "resource_usage_counters" ("biz_id","resource_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_dependency_rule_targets_biz_id_id_unique" ON "availability_dependency_rule_targets" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_dependency_rule_targets_biz_rule_idx" ON "availability_dependency_rule_targets" ("biz_id","availability_dependency_rule_id","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_dependency_rule_targets_biz_calendar_idx" ON "availability_dependency_rule_targets" ("biz_id","required_calendar_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_dependency_rule_targets_biz_subject_idx" ON "availability_dependency_rule_targets" ("biz_id","required_subject_type","required_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_dependency_rule_targets_unique_calendar" ON "availability_dependency_rule_targets" ("availability_dependency_rule_id","required_calendar_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_dependency_rule_targets_unique_subject" ON "availability_dependency_rule_targets" ("availability_dependency_rule_id","required_subject_type","required_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_dependency_rules_biz_id_id_unique" ON "availability_dependency_rules" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_dependency_rules_biz_request_key_unique" ON "availability_dependency_rules" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_dependency_rules_biz_calendar_status_idx" ON "availability_dependency_rules" ("biz_id","dependent_calendar_id","status","evaluation_mode");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_dependency_rules_biz_calendar_window_idx" ON "availability_dependency_rules" ("biz_id","dependent_calendar_id","status","effective_start_at","effective_end_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_gates_biz_id_id_unique" ON "availability_gates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_gates_biz_request_key_unique" ON "availability_gates" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_gates_biz_calendar_status_window_idx" ON "availability_gates" ("biz_id","calendar_id","status","priority","window_start_at","window_end_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_gates_biz_source_ref_idx" ON "availability_gates" ("biz_id","source_ref_type","source_ref_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_resolution_runs_biz_calendar_resolved_idx" ON "availability_resolution_runs" ("biz_id","calendar_id","resolved_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_resolution_runs_biz_calendar_window_status_idx" ON "availability_resolution_runs" ("biz_id","calendar_id","window_start_at","window_end_at","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_resolution_runs_biz_request_key_idx" ON "availability_resolution_runs" ("biz_id","request_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_rule_exclusion_dates_unique" ON "availability_rule_exclusion_dates" ("biz_id","availability_rule_id","exclusion_date");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_rule_exclusion_dates_biz_rule_date_idx" ON "availability_rule_exclusion_dates" ("biz_id","availability_rule_id","exclusion_date");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_rule_template_items_biz_id_id_unique" ON "availability_rule_template_items" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_rule_template_items_biz_template_idx" ON "availability_rule_template_items" ("biz_id","availability_rule_template_id","is_active","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_rule_template_items_biz_tpl_mode_window_idx" ON "availability_rule_template_items" ("biz_id","availability_rule_template_id","is_active","mode","start_at","end_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_rule_templates_biz_id_id_unique" ON "availability_rule_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_rule_templates_biz_scope_slug_unique" ON "availability_rule_templates" ("biz_id","location_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_rule_templates_biz_status_active_idx" ON "availability_rule_templates" ("biz_id","status","priority");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "availability_rules_biz_id_id_unique" ON "availability_rules" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_rules_biz_calendar_idx" ON "availability_rules" ("biz_id","calendar_id","is_active","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_rules_biz_calendar_mode_window_idx" ON "availability_rules" ("biz_id","calendar_id","is_active","mode","start_at","end_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "availability_rules_biz_calendar_weekly_idx" ON "availability_rules" ("biz_id","calendar_id","is_active","frequency","day_of_week","start_time","end_time");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_bindings_biz_id_id_unique" ON "calendar_bindings" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_bindings_biz_id_id_owner_user_unique" ON "calendar_bindings" ("biz_id","id","owner_user_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_bindings_biz_owner_type_idx" ON "calendar_bindings" ("biz_id","owner_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_bindings_biz_calendar_idx" ON "calendar_bindings" ("biz_id","calendar_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_bindings_biz_owner_ref_idx" ON "calendar_bindings" ("biz_id","owner_ref_type","owner_ref_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_bindings_biz_owner_user_idx" ON "calendar_bindings" ("biz_id","owner_user_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_bindings_primary_per_biz_unique" ON "calendar_bindings" ("biz_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_bindings_primary_per_user_unique" ON "calendar_bindings" ("biz_id","owner_user_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_bindings_primary_per_resource_unique" ON "calendar_bindings" ("biz_id","resource_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_bindings_primary_per_service_unique" ON "calendar_bindings" ("biz_id","service_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_bindings_primary_per_service_product_unique" ON "calendar_bindings" ("biz_id","service_product_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_bindings_primary_per_offer_unique" ON "calendar_bindings" ("biz_id","offer_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_bindings_primary_per_offer_version_unique" ON "calendar_bindings" ("biz_id","offer_version_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_bindings_primary_per_location_unique" ON "calendar_bindings" ("biz_id","location_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_bindings_primary_per_custom_subject_unique" ON "calendar_bindings" ("biz_id","owner_ref_type","owner_ref_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_overlays_biz_id_id_unique" ON "calendar_overlays" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_overlays_biz_calendar_active_idx" ON "calendar_overlays" ("biz_id","calendar_id","is_active","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_overlays_biz_calendar_window_idx" ON "calendar_overlays" ("biz_id","calendar_id","is_active","effective_start_at","effective_end_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_revisions_biz_id_id_unique" ON "calendar_revisions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_revisions_calendar_revision_unique" ON "calendar_revisions" ("calendar_id","revision");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_revisions_biz_calendar_revision_idx" ON "calendar_revisions" ("biz_id","calendar_id","revision");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_revisions_biz_idempotency_unique" ON "calendar_revisions" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_rule_template_binding_excl_dates_unique" ON "calendar_rule_template_binding_exclusion_dates" ("biz_id","calendar_rule_template_binding_id","exclusion_date");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_rule_template_binding_excl_dates_biz_binding_idx" ON "calendar_rule_template_binding_exclusion_dates" ("biz_id","calendar_rule_template_binding_id","exclusion_date");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_rule_template_bindings_biz_id_id_unique" ON "calendar_rule_template_bindings" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_rule_template_bindings_active_pair_unique" ON "calendar_rule_template_bindings" ("biz_id","calendar_id","availability_rule_template_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_rule_template_bindings_biz_cal_active_idx" ON "calendar_rule_template_bindings" ("biz_id","calendar_id","is_active","priority","effective_start_at","effective_end_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_rule_template_bindings_biz_tpl_active_idx" ON "calendar_rule_template_bindings" ("biz_id","availability_rule_template_id","is_active");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_timeline_events_biz_id_id_unique" ON "calendar_timeline_events" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_timeline_events_biz_idempotency_unique" ON "calendar_timeline_events" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_timeline_events_biz_cal_window_state_idx" ON "calendar_timeline_events" ("biz_id","calendar_id","is_active","start_at","end_at","state");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_timeline_events_biz_source_ref_idx" ON "calendar_timeline_events" ("biz_id","source_type","source_ref_type","source_ref_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_timeline_events_biz_source_window_unique" ON "calendar_timeline_events" ("biz_id","source_type","source_ref_type","source_ref_id","start_at","end_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendars_biz_id_id_unique" ON "calendars" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendars_biz_status_idx" ON "calendars" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendars_biz_policy_mode_idx" ON "calendars" ("biz_id","rule_evaluation_order","conflict_resolution_mode","enforce_strict_non_overlap","emit_timeline_facts");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "capacity_holds_biz_id_id_unique" ON "capacity_holds" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "capacity_holds_biz_request_key_unique" ON "capacity_holds" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "capacity_holds_biz_calendar_status_window_idx" ON "capacity_holds" ("biz_id","calendar_id","status","starts_at","ends_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "capacity_holds_biz_pool_status_window_idx" ON "capacity_holds" ("biz_id","capacity_pool_id","status","starts_at","ends_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "capacity_holds_biz_resource_status_window_idx" ON "capacity_holds" ("biz_id","resource_id","status","starts_at","ends_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "capacity_holds_biz_source_ref_idx" ON "capacity_holds" ("biz_id","source_ref_type","source_ref_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "capacity_pool_members_biz_pool_idx" ON "capacity_pool_members" ("biz_id","capacity_pool_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "capacity_pool_members_biz_member_ref_idx" ON "capacity_pool_members" ("biz_id","member_ref_type","member_ref_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "capacity_pool_members_unique_resource" ON "capacity_pool_members" ("capacity_pool_id","resource_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "capacity_pool_members_unique_offer_version" ON "capacity_pool_members" ("capacity_pool_id","offer_version_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "capacity_pool_members_unique_location" ON "capacity_pool_members" ("capacity_pool_id","location_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "capacity_pool_members_unique_custom_subject" ON "capacity_pool_members" ("capacity_pool_id","member_ref_type","member_ref_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "capacity_pools_biz_id_id_unique" ON "capacity_pools" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "capacity_pools_biz_slug_unique" ON "capacity_pools" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "capacity_pools_biz_status_idx" ON "capacity_pools" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_access_grant_sources_unique_external" ON "calendar_access_grant_sources" ("calendar_access_grant_id","external_calendar_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_access_grant_sources_unique_internal_binding" ON "calendar_access_grant_sources" ("calendar_access_grant_id","source_biz_id","calendar_binding_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_access_grant_sources_grant_idx" ON "calendar_access_grant_sources" ("calendar_access_grant_id","source_type","is_included");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_access_grants_owner_id_unique" ON "calendar_access_grants" ("owner_user_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_access_grants_biz_id_unique" ON "calendar_access_grants" ("grantee_biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_access_grants_active_pair_unique" ON "calendar_access_grants" ("owner_user_id","grantee_biz_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_access_grants_biz_lookup_idx" ON "calendar_access_grants" ("grantee_biz_id","status","access_level","scope");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_sync_connections_owner_id_unique" ON "calendar_sync_connections" ("owner_user_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "calendar_sync_connections_owner_provider_account_unique" ON "calendar_sync_connections" ("owner_user_id","provider","provider_account_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "calendar_sync_connections_owner_status_idx" ON "calendar_sync_connections" ("owner_user_id","status","provider");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "external_calendar_events_owner_id_unique" ON "external_calendar_events" ("owner_user_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "external_calendar_events_feed_provider_ref_unique" ON "external_calendar_events" ("external_calendar_id","provider_event_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "external_calendar_events_owner_window_idx" ON "external_calendar_events" ("owner_user_id","starts_at","ends_at","busy_status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "external_calendars_owner_id_unique" ON "external_calendars" ("owner_user_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "external_calendars_connection_provider_calendar_unique" ON "external_calendars" ("calendar_sync_connection_id","provider_calendar_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "external_calendars_owner_sync_idx" ON "external_calendars" ("owner_user_id","is_selected_for_sync","sync_state");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "booking_order_lines_biz_id_id_unique" ON "booking_order_lines" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "booking_order_lines_biz_order_id_id_unique" ON "booking_order_lines" ("biz_id","booking_order_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "booking_order_lines_biz_order_idx" ON "booking_order_lines" ("biz_id","booking_order_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "booking_orders_biz_id_id_unique" ON "booking_orders" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "booking_orders_biz_status_idx" ON "booking_orders" ("biz_id","status","confirmed_start_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "booking_orders_biz_status_config_idx" ON "booking_orders" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "booking_orders_biz_customer_idx" ON "booking_orders" ("biz_id","customer_user_id","confirmed_start_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fulfillment_assignments_biz_id_id_unique" ON "fulfillment_assignments" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_assignments_biz_unit_idx" ON "fulfillment_assignments" ("biz_id","fulfillment_unit_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_assignments_biz_resource_idx" ON "fulfillment_assignments" ("biz_id","resource_id","starts_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_assignments_biz_resource_policy_status_idx" ON "fulfillment_assignments" ("biz_id","resource_id","conflict_policy","status","starts_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_assignments_biz_status_start_idx" ON "fulfillment_assignments" ("biz_id","status","starts_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_assignments_biz_status_config_idx" ON "fulfillment_assignments" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fulfillment_checkpoints_unique" ON "fulfillment_checkpoints" ("fulfillment_unit_id","checkpoint_type","sequence");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_checkpoints_biz_unit_idx" ON "fulfillment_checkpoints" ("biz_id","fulfillment_unit_id","sequence");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_checkpoints_biz_status_config_idx" ON "fulfillment_checkpoints" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fulfillment_dependencies_unique" ON "fulfillment_dependencies" ("predecessor_unit_id","successor_unit_id","dependency_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_dependencies_biz_predecessor_idx" ON "fulfillment_dependencies" ("biz_id","predecessor_unit_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_dependencies_biz_successor_idx" ON "fulfillment_dependencies" ("biz_id","successor_unit_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fulfillment_units_biz_id_id_unique" ON "fulfillment_units" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_units_biz_order_idx" ON "fulfillment_units" ("biz_id","booking_order_id","planned_start_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_units_biz_status_idx" ON "fulfillment_units" ("biz_id","status","planned_start_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fulfillment_units_biz_status_config_idx" ON "fulfillment_units" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "standing_reservation_contracts_biz_id_id_unique" ON "standing_reservation_contracts" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "standing_reservation_contracts_biz_status_next_idx" ON "standing_reservation_contracts" ("biz_id","status","next_planned_occurrence_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "standing_reservation_contracts_biz_customer_idx" ON "standing_reservation_contracts" ("biz_id","customer_user_id","customer_group_account_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "standing_reservation_contracts_biz_offer_version_idx" ON "standing_reservation_contracts" ("biz_id","offer_version_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "standing_reservation_contracts_biz_status_config_idx" ON "standing_reservation_contracts" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "standing_reservation_exceptions_biz_id_id_unique" ON "standing_reservation_exceptions" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "standing_reservation_exceptions_biz_contract_action_idx" ON "standing_reservation_exceptions" ("biz_id","standing_reservation_contract_id","action","is_active");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "standing_reservation_exceptions_biz_contract_date_idx" ON "standing_reservation_exceptions" ("biz_id","standing_reservation_contract_id","target_local_date");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "standing_reservation_occurrences_biz_id_id_unique" ON "standing_reservation_occurrences" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "standing_reservation_occurrences_contract_key_unique" ON "standing_reservation_occurrences" ("biz_id","standing_reservation_contract_id","occurrence_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "standing_reservation_occurrences_booking_order_unique" ON "standing_reservation_occurrences" ("biz_id","booking_order_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "standing_reservation_occurrences_biz_contract_start_idx" ON "standing_reservation_occurrences" ("biz_id","standing_reservation_contract_id","planned_start_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "standing_reservation_occurrences_biz_status_start_idx" ON "standing_reservation_occurrences" ("biz_id","status","planned_start_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "standing_reservation_occurrences_biz_status_config_idx" ON "standing_reservation_occurrences" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_disputes_provider_ref_unique" ON "payment_disputes" ("biz_id","provider_dispute_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_disputes_biz_status_due_idx" ON "payment_disputes" ("biz_id","status","response_due_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_intent_line_allocations_biz_id_id_unique" ON "payment_intent_line_allocations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_intent_line_allocations_tender_line_unique" ON "payment_intent_line_allocations" ("payment_intent_tender_id","booking_order_line_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_intent_line_allocations_biz_order_idx" ON "payment_intent_line_allocations" ("biz_id","booking_order_id","booking_order_line_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_intent_line_allocations_biz_tender_idx" ON "payment_intent_line_allocations" ("biz_id","payment_intent_tender_id","booking_order_line_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_intent_tenders_biz_id_id_unique" ON "payment_intent_tenders" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_intent_tenders_biz_intent_id_id_unique" ON "payment_intent_tenders" ("biz_id","payment_intent_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_intent_tenders_intent_sort_unique" ON "payment_intent_tenders" ("payment_intent_id","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_intent_tenders_biz_intent_idx" ON "payment_intent_tenders" ("biz_id","payment_intent_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_intent_tenders_biz_gift_idx" ON "payment_intent_tenders" ("biz_id","gift_instrument_id","payment_intent_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_intents_biz_id_id_unique" ON "payment_intents" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_intents_biz_provider_ref_unique" ON "payment_intents" ("biz_id","provider_intent_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_intents_biz_status_idx" ON "payment_intents" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_intents_biz_processor_status_idx" ON "payment_intents" ("biz_id","payment_processor_account_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_methods_biz_id_id_unique" ON "payment_methods" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_methods_biz_provider_ref_unique" ON "payment_methods" ("biz_id","provider","provider_method_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_methods_biz_owner_idx" ON "payment_methods" ("biz_id","owner_user_id","is_default","is_active");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_methods_biz_processor_owner_idx" ON "payment_methods" ("biz_id","payment_processor_account_id","owner_user_id","is_active");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_methods_one_default_per_user_unique" ON "payment_methods" ("biz_id","owner_user_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_processor_accounts_biz_id_id_unique" ON "payment_processor_accounts" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_processor_accounts_biz_provider_account_unique" ON "payment_processor_accounts" ("biz_id","provider_key","processor_account_ref");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_processor_accounts_biz_default_unique" ON "payment_processor_accounts" ("biz_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_processor_accounts_biz_provider_status_idx" ON "payment_processor_accounts" ("biz_id","provider_key","status","is_default");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_transaction_line_allocations_biz_id_id_unique" ON "payment_transaction_line_allocations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_transaction_line_allocations_biz_idempotency_unique" ON "payment_transaction_line_allocations" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_transaction_line_allocations_txn_line_unique" ON "payment_transaction_line_allocations" ("payment_transaction_id","booking_order_line_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_transaction_line_allocations_biz_txn_idx" ON "payment_transaction_line_allocations" ("biz_id","payment_transaction_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_transaction_line_allocations_biz_order_line_occurred_idx" ON "payment_transaction_line_allocations" ("biz_id","booking_order_line_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_transactions_biz_id_id_unique" ON "payment_transactions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payment_transactions_biz_idempotency_unique" ON "payment_transactions" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_transactions_biz_occurred_idx" ON "payment_transactions" ("biz_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_transactions_biz_gift_occurred_idx" ON "payment_transactions" ("biz_id","gift_instrument_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payment_transactions_biz_processor_occurred_idx" ON "payment_transactions" ("biz_id","payment_processor_account_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payout_ledger_entries_biz_payout_recorded_idx" ON "payout_ledger_entries" ("biz_id","payout_id","recorded_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payouts_biz_id_id_unique" ON "payouts" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "payouts_provider_ref_unique" ON "payouts" ("biz_id","provider_payout_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payouts_biz_status_initiated_idx" ON "payouts" ("biz_id","status","initiated_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "payouts_biz_processor_status_initiated_idx" ON "payouts" ("biz_id","payment_processor_account_id","status","initiated_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "settlement_batches_biz_id_id_unique" ON "settlement_batches" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "settlement_batches_biz_status_period_idx" ON "settlement_batches" ("biz_id","status","period_start_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "settlement_batches_biz_processor_status_period_idx" ON "settlement_batches" ("biz_id","payment_processor_account_id","status","period_start_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "settlement_entries_biz_id_id_unique" ON "settlement_entries" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "settlement_entries_biz_batch_idx" ON "settlement_entries" ("biz_id","settlement_batch_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_assignment_roles_biz_id_id_unique" ON "compensation_assignment_roles" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_assignment_roles_assignment_unique" ON "compensation_assignment_roles" ("fulfillment_assignment_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_assignment_roles_biz_role_idx" ON "compensation_assignment_roles" ("biz_id","role_template_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_ledger_entries_biz_id_id_unique" ON "compensation_ledger_entries" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_ledger_entries_biz_idempotency_unique" ON "compensation_ledger_entries" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_ledger_entries_biz_payee_occurred_idx" ON "compensation_ledger_entries" ("biz_id","payee_resource_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_ledger_entries_biz_payee_effective_idx" ON "compensation_ledger_entries" ("biz_id","payee_resource_id","effective_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_ledger_entries_biz_booking_occurred_idx" ON "compensation_ledger_entries" ("biz_id","booking_order_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_pay_run_item_entries_unique" ON "compensation_pay_run_item_entries" ("compensation_pay_run_item_id","compensation_ledger_entry_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_pay_run_item_entries_biz_item_idx" ON "compensation_pay_run_item_entries" ("biz_id","compensation_pay_run_item_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_pay_run_item_entries_biz_ledger_idx" ON "compensation_pay_run_item_entries" ("biz_id","compensation_ledger_entry_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_pay_run_items_biz_id_id_unique" ON "compensation_pay_run_items" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_pay_run_items_run_payee_unique" ON "compensation_pay_run_items" ("compensation_pay_run_id","payee_resource_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_pay_run_items_biz_run_status_idx" ON "compensation_pay_run_items" ("biz_id","compensation_pay_run_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_pay_run_items_biz_payee_paid_idx" ON "compensation_pay_run_items" ("biz_id","payee_resource_id","paid_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_pay_runs_biz_id_id_unique" ON "compensation_pay_runs" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_pay_runs_biz_status_period_idx" ON "compensation_pay_runs" ("biz_id","status","period_start_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_plan_rules_biz_id_id_unique" ON "compensation_plan_rules" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_plan_rules_biz_version_enabled_priority_idx" ON "compensation_plan_rules" ("biz_id","compensation_plan_version_id","is_enabled","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_plan_rules_biz_role_enabled_idx" ON "compensation_plan_rules" ("biz_id","role_template_id","is_enabled","priority");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_plan_versions_biz_id_id_unique" ON "compensation_plan_versions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_plan_versions_plan_version_unique" ON "compensation_plan_versions" ("compensation_plan_id","version_number");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_plan_versions_current_unique" ON "compensation_plan_versions" ("compensation_plan_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_plan_versions_biz_plan_status_idx" ON "compensation_plan_versions" ("biz_id","compensation_plan_id","status","effective_from_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_plans_biz_id_id_unique" ON "compensation_plans" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_plans_biz_slug_unique" ON "compensation_plans" ("biz_id","slug");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_plans_biz_default_unique" ON "compensation_plans" ("biz_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_plans_biz_status_priority_idx" ON "compensation_plans" ("biz_id","status","priority");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_role_templates_biz_id_id_unique" ON "compensation_role_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_role_templates_biz_location_slug_unique" ON "compensation_role_templates" ("biz_id","location_id","slug");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "compensation_role_templates_biz_global_slug_unique" ON "compensation_role_templates" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "compensation_role_templates_biz_status_sort_idx" ON "compensation_role_templates" ("biz_id","status","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "demand_pricing_applications_biz_id_id_unique" ON "demand_pricing_applications" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "demand_pricing_applications_biz_booking_line_at_idx" ON "demand_pricing_applications" ("biz_id","booking_order_line_id","applied_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "demand_pricing_applications_biz_booking_order_at_idx" ON "demand_pricing_applications" ("biz_id","booking_order_id","applied_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "demand_pricing_applications_biz_evaluation_at_idx" ON "demand_pricing_applications" ("biz_id","demand_pricing_evaluation_id","applied_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "demand_pricing_evaluations_biz_id_id_unique" ON "demand_pricing_evaluations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "demand_pricing_evaluations_biz_request_key_unique" ON "demand_pricing_evaluations" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "demand_pricing_evaluations_biz_policy_at_idx" ON "demand_pricing_evaluations" ("biz_id","demand_pricing_policy_id","evaluated_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "demand_pricing_evaluations_biz_booking_line_idx" ON "demand_pricing_evaluations" ("biz_id","booking_order_line_id","evaluated_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "demand_pricing_policies_biz_id_id_unique" ON "demand_pricing_policies" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "demand_pricing_policies_biz_slug_unique" ON "demand_pricing_policies" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "demand_pricing_policies_biz_enabled_priority_idx" ON "demand_pricing_policies" ("biz_id","is_enabled","status","priority");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "demand_pricing_policy_signals_unique" ON "demand_pricing_policy_signals" ("demand_pricing_policy_id","demand_signal_definition_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "demand_pricing_policy_signals_biz_policy_sort_idx" ON "demand_pricing_policy_signals" ("biz_id","demand_pricing_policy_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "demand_pricing_policy_tiers_biz_id_id_unique" ON "demand_pricing_policy_tiers" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "demand_pricing_policy_tiers_biz_policy_sort_idx" ON "demand_pricing_policy_tiers" ("biz_id","demand_pricing_policy_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "demand_signal_definitions_biz_id_id_unique" ON "demand_signal_definitions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "demand_signal_definitions_biz_slug_unique" ON "demand_signal_definitions" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "demand_signal_definitions_biz_enabled_kind_idx" ON "demand_signal_definitions" ("biz_id","is_enabled","kind");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "demand_signal_observations_definition_window_unique" ON "demand_signal_observations" ("demand_signal_definition_id","window_start_at","window_end_at","source");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "demand_signal_observations_biz_idempotency_unique" ON "demand_signal_observations" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "demand_signal_observations_biz_signal_window_idx" ON "demand_signal_observations" ("biz_id","demand_signal_definition_id","window_start_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "entitlement_grants_biz_id_id_unique" ON "entitlement_grants" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "entitlement_grants_biz_wallet_valid_idx" ON "entitlement_grants" ("biz_id","wallet_id","valid_from_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "entitlement_ledger_entries_biz_wallet_occurred_idx" ON "entitlement_ledger_entries" ("biz_id","wallet_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "entitlement_transfers_biz_id_id_unique" ON "entitlement_transfers" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "entitlement_transfers_biz_status_requested_idx" ON "entitlement_transfers" ("biz_id","status","requested_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "entitlement_wallets_biz_id_id_unique" ON "entitlement_wallets" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "entitlement_wallets_biz_owner_idx" ON "entitlement_wallets" ("biz_id","owner_user_id","owner_group_account_id","is_active");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "membership_plans_biz_id_id_unique" ON "membership_plans" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "membership_plans_biz_slug_unique" ON "membership_plans" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "membership_plans_biz_status_idx" ON "membership_plans" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "memberships_biz_id_id_unique" ON "memberships" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "memberships_active_per_user_plan_unique" ON "memberships" ("biz_id","membership_plan_id","owner_user_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "memberships_biz_status_period_idx" ON "memberships" ("biz_id","status","current_period_end_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "rollover_runs_biz_status_run_idx" ON "rollover_runs" ("biz_id","status","run_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_accounts_biz_id_id_unique" ON "channel_accounts" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_accounts_provider_account_unique" ON "channel_accounts" ("biz_id","provider","provider_account_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "channel_accounts_biz_provider_status_idx" ON "channel_accounts" ("biz_id","provider","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_entity_links_biz_id_id_unique" ON "channel_entity_links" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_entity_links_external_unique" ON "channel_entity_links" ("channel_account_id","external_object_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_entity_links_local_offer_version_unique" ON "channel_entity_links" ("channel_account_id","object_type","offer_version_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_entity_links_local_booking_order_unique" ON "channel_entity_links" ("channel_account_id","object_type","booking_order_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_entity_links_local_resource_unique" ON "channel_entity_links" ("channel_account_id","object_type","resource_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_entity_links_local_customer_unique" ON "channel_entity_links" ("channel_account_id","object_type","customer_user_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_entity_links_local_ref_key_unique" ON "channel_entity_links" ("channel_account_id","object_type","local_reference_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "channel_entity_links_biz_account_type_idx" ON "channel_entity_links" ("biz_id","channel_account_id","object_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "channel_sync_items_biz_job_status_idx" ON "channel_sync_items" ("biz_id","channel_sync_job_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_sync_jobs_biz_id_id_unique" ON "channel_sync_jobs" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "channel_sync_jobs_biz_status_requested_idx" ON "channel_sync_jobs" ("biz_id","status","requested_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_sync_states_unique" ON "channel_sync_states" ("channel_account_id","object_type","direction");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "channel_sync_states_biz_account_type_idx" ON "channel_sync_states" ("biz_id","channel_account_id","object_type");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "channel_webhook_events_account_external_unique" ON "channel_webhook_events" ("channel_account_id","external_event_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "channel_webhook_events_biz_status_received_idx" ON "channel_webhook_events" ("biz_id","status","received_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "overtime_forecasts_unique" ON "overtime_forecasts" ("overtime_policy_id","resource_id","forecast_date");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "overtime_forecasts_biz_date_status_idx" ON "overtime_forecasts" ("biz_id","forecast_date","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "overtime_policies_biz_id_id_unique" ON "overtime_policies" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "overtime_policies_biz_status_scope_idx" ON "overtime_policies" ("biz_id","status","scope");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "ranking_events_biz_profile_occurred_idx" ON "ranking_events" ("biz_id","ranking_profile_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "ranking_profiles_biz_id_id_unique" ON "ranking_profiles" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "ranking_profiles_biz_slug_unique" ON "ranking_profiles" ("biz_id","slug");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "ranking_profiles_default_unique" ON "ranking_profiles" ("biz_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "ranking_profiles_biz_status_idx" ON "ranking_profiles" ("biz_id","status","location_id","service_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "ranking_scores_profile_resource_unique" ON "ranking_scores" ("ranking_profile_id","resource_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "ranking_scores_biz_profile_score_idx" ON "ranking_scores" ("biz_id","ranking_profile_id","score");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_assignments_biz_id_id_unique" ON "staffing_assignments" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_assignments_response_unique" ON "staffing_assignments" ("staffing_response_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_assignments_biz_demand_status_idx" ON "staffing_assignments" ("biz_id","staffing_demand_id","status","starts_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_assignments_biz_resource_status_idx" ON "staffing_assignments" ("biz_id","resource_id","status","starts_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_demand_requirements_biz_id_id_unique" ON "staffing_demand_requirements" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_demand_requirements_unique" ON "staffing_demand_requirements" ("staffing_demand_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_demand_requirements_biz_demand_sort_idx" ON "staffing_demand_requirements" ("biz_id","staffing_demand_id","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_demand_selectors_biz_requirement_sort_idx" ON "staffing_demand_selectors" ("biz_id","staffing_demand_requirement_id","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_demand_selectors_biz_resource_idx" ON "staffing_demand_selectors" ("biz_id","resource_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_demand_selectors_biz_capability_idx" ON "staffing_demand_selectors" ("biz_id","capability_template_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_demand_selectors_biz_subject_idx" ON "staffing_demand_selectors" ("biz_id","subject_type","subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_demands_biz_id_id_unique" ON "staffing_demands" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_demands_biz_status_start_idx" ON "staffing_demands" ("biz_id","status","starts_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_demands_biz_fill_mode_start_idx" ON "staffing_demands" ("biz_id","fill_mode","starts_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_demands_biz_auction_idx" ON "staffing_demands" ("biz_id","auction_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_demands_auction_unique" ON "staffing_demands" ("auction_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_demands_biz_source_assignment_idx" ON "staffing_demands" ("biz_id","fulfillment_assignment_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_fairness_counters_unique" ON "staffing_fairness_counters" ("staffing_pool_id","resource_id","window_start_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_fairness_counters_biz_pool_window_idx" ON "staffing_fairness_counters" ("biz_id","staffing_pool_id","window_start_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_pool_members_unique" ON "staffing_pool_members" ("staffing_pool_id","resource_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_pool_members_biz_pool_active_idx" ON "staffing_pool_members" ("biz_id","staffing_pool_id","is_active","priority_score");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_pools_biz_id_id_unique" ON "staffing_pools" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_pools_biz_slug_unique" ON "staffing_pools" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_pools_biz_type_location_idx" ON "staffing_pools" ("biz_id","target_resource_type","location_id","is_active");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_responses_biz_id_id_unique" ON "staffing_responses" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_responses_biz_demand_status_idx" ON "staffing_responses" ("biz_id","staffing_demand_id","status","offered_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "staffing_responses_biz_candidate_status_idx" ON "staffing_responses" ("biz_id","candidate_resource_id","status","offered_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "staffing_responses_unique_non_bid" ON "staffing_responses" ("staffing_demand_id","candidate_resource_id","response_mode");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "certification_awards_template_enrollment_unique" ON "certification_awards" ("certification_template_id","enrollment_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "certification_awards_code_unique" ON "certification_awards" ("biz_id","certificate_code");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "certification_awards_biz_learner_status_idx" ON "certification_awards" ("biz_id","learner_user_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "certification_templates_biz_id_id_unique" ON "certification_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "certification_templates_program_slug_unique" ON "certification_templates" ("program_id","slug");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "cohort_enrollments_unique" ON "cohort_enrollments" ("cohort_id","learner_user_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "cohort_enrollments_biz_id_id_unique" ON "cohort_enrollments" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "cohort_enrollments_biz_status_idx" ON "cohort_enrollments" ("biz_id","status","enrolled_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "program_cohort_sessions_biz_id_id_unique" ON "program_cohort_sessions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "program_cohort_sessions_sequence_unique" ON "program_cohort_sessions" ("cohort_id","sequence");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "program_cohort_sessions_biz_cohort_starts_idx" ON "program_cohort_sessions" ("biz_id","cohort_id","starts_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "program_cohorts_biz_id_id_unique" ON "program_cohorts" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "program_cohorts_program_code_unique" ON "program_cohorts" ("program_id","code");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "program_cohorts_biz_status_starts_idx" ON "program_cohorts" ("biz_id","status","starts_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "programs_biz_id_id_unique" ON "programs" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "programs_biz_slug_unique" ON "programs" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "programs_biz_status_idx" ON "programs" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "session_attendance_records_unique" ON "session_attendance_records" ("session_id","enrollment_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "session_attendance_records_biz_session_status_idx" ON "session_attendance_records" ("biz_id","session_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_edges_set_edge_unique" ON "requirement_edges" ("requirement_set_id","from_node_id","to_node_id","edge_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_edges_biz_set_from_idx" ON "requirement_edges" ("biz_id","requirement_set_id","from_node_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_edges_biz_set_to_idx" ON "requirement_edges" ("biz_id","requirement_set_id","to_node_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_evaluations_biz_id_id_unique" ON "requirement_evaluations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_evaluations_biz_request_key_unique" ON "requirement_evaluations" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_evaluations_biz_set_status_started_idx" ON "requirement_evaluations" ("biz_id","requirement_set_id","status","started_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_evaluations_biz_subject_started_idx" ON "requirement_evaluations" ("biz_id","evaluated_subject_type","evaluated_subject_id","started_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_evidence_links_biz_evaluation_idx" ON "requirement_evidence_links" ("biz_id","requirement_evaluation_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_evidence_links_biz_node_idx" ON "requirement_evidence_links" ("biz_id","requirement_node_id","evidence_type");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_nodes_biz_id_id_unique" ON "requirement_nodes" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_nodes_biz_set_id_id_unique" ON "requirement_nodes" ("biz_id","requirement_set_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_nodes_set_node_key_unique" ON "requirement_nodes" ("requirement_set_id","node_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_nodes_biz_set_sort_idx" ON "requirement_nodes" ("biz_id","requirement_set_id","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_nodes_biz_target_subject_idx" ON "requirement_nodes" ("biz_id","target_subject_type","target_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_sets_biz_id_id_unique" ON "requirement_sets" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_sets_biz_slug_unique" ON "requirement_sets" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_sets_biz_status_idx" ON "requirement_sets" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assessment_attempts_biz_id_id_template_unique" ON "assessment_attempts" ("biz_id","id","assessment_template_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assessment_attempts_template_candidate_attempt_unique" ON "assessment_attempts" ("assessment_template_id","candidate_subject_type","candidate_subject_id","attempt_number");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assessment_attempts_biz_request_key_unique" ON "assessment_attempts" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "assessment_attempts_biz_template_status_started_idx" ON "assessment_attempts" ("biz_id","assessment_template_id","status","started_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "assessment_attempts_biz_candidate_started_idx" ON "assessment_attempts" ("biz_id","candidate_subject_type","candidate_subject_id","started_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assessment_items_biz_id_id_template_unique" ON "assessment_items" ("biz_id","id","assessment_template_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assessment_items_template_item_key_unique" ON "assessment_items" ("assessment_template_id","item_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "assessment_items_biz_template_sort_idx" ON "assessment_items" ("biz_id","assessment_template_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assessment_responses_biz_id_id_unique" ON "assessment_responses" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assessment_responses_attempt_item_unique" ON "assessment_responses" ("assessment_attempt_id","assessment_item_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "assessment_responses_biz_attempt_idx" ON "assessment_responses" ("biz_id","assessment_attempt_id","responded_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "assessment_responses_biz_item_idx" ON "assessment_responses" ("biz_id","assessment_item_id","responded_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assessment_results_attempt_unique" ON "assessment_results" ("assessment_attempt_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "assessment_results_biz_status_decided_idx" ON "assessment_results" ("biz_id","status","decided_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "assessment_results_biz_candidate_decided_idx" ON "assessment_results" ("biz_id","candidate_subject_type","candidate_subject_id","decided_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assessment_templates_biz_id_id_unique" ON "assessment_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "assessment_templates_biz_slug_unique" ON "assessment_templates" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "assessment_templates_biz_status_idx" ON "assessment_templates" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "grading_events_biz_attempt_happened_idx" ON "grading_events" ("biz_id","assessment_attempt_id","happened_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "grading_events_biz_type_happened_idx" ON "grading_events" ("biz_id","event_type","happened_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "audit_events_biz_id_id_unique" ON "audit_events" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "audit_events_stream_sequence_unique" ON "audit_events" ("stream_id","sequence");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "audit_events_stream_hash_unique" ON "audit_events" ("stream_id","event_hash");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "audit_events_biz_stream_sequence_idx" ON "audit_events" ("biz_id","stream_id","sequence");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "audit_events_biz_entity_occurred_idx" ON "audit_events" ("biz_id","entity_type","entity_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "audit_integrity_runs_biz_started_idx" ON "audit_integrity_runs" ("biz_id","started_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "audit_streams_biz_id_id_unique" ON "audit_streams" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "audit_streams_biz_stream_key_unique" ON "audit_streams" ("biz_id","stream_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "audit_streams_biz_type_active_idx" ON "audit_streams" ("biz_id","stream_type","is_active");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_extension_installs_biz_id_id_unique" ON "biz_extension_installs" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_extension_installs_biz_extension_unique" ON "biz_extension_installs" ("biz_id","extension_definition_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "biz_extension_installs_biz_status_idx" ON "biz_extension_installs" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_extension_permission_grants_biz_id_id_unique" ON "biz_extension_permission_grants" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "biz_extension_permission_grants_unique" ON "biz_extension_permission_grants" ("biz_id","biz_extension_install_id","extension_permission_definition_id","scope_ref_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "biz_extension_permission_grants_biz_install_status_idx" ON "biz_extension_permission_grants" ("biz_id","biz_extension_install_id","status","scope");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "biz_extension_permission_grants_biz_expiry_idx" ON "biz_extension_permission_grants" ("biz_id","expires_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "custom_field_definition_options_unique" ON "custom_field_definition_options" ("biz_id","custom_field_definition_id","option_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "custom_field_definition_options_biz_field_status_idx" ON "custom_field_definition_options" ("biz_id","custom_field_definition_id","status","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "custom_field_definitions_biz_id_id_unique" ON "custom_field_definitions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "custom_field_definitions_biz_scope_unique" ON "custom_field_definitions" ("biz_id","target_type","field_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "custom_field_definitions_location_scope_unique" ON "custom_field_definitions" ("biz_id","target_type","location_id","field_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "custom_field_definitions_biz_target_status_idx" ON "custom_field_definitions" ("biz_id","target_type","status","scope");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "custom_field_values_target_field_unique" ON "custom_field_values" ("biz_id","custom_field_definition_id","target_type","target_ref_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "custom_field_values_biz_target_idx" ON "custom_field_values" ("biz_id","target_type","target_ref_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "custom_field_values_biz_definition_idx" ON "custom_field_values" ("biz_id","custom_field_definition_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_api_call_runs_biz_idempotency_unique" ON "extension_api_call_runs" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "extension_api_call_runs_biz_connection_status_next_attempt_idx" ON "extension_api_call_runs" ("biz_id","extension_service_connection_id","status","next_attempt_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_definitions_key_unique" ON "extension_definitions" ("key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "extension_definitions_status_source_idx" ON "extension_definitions" ("status","source_type");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_permission_definitions_unique" ON "extension_permission_definitions" ("extension_definition_id","permission_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "extension_permission_definitions_status_scope_idx" ON "extension_permission_definitions" ("status","scope","is_required");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_service_connections_biz_id_id_unique" ON "extension_service_connections" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_service_connections_biz_install_key_unique" ON "extension_service_connections" ("biz_id","biz_extension_install_id","connection_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_service_connections_biz_provider_account_unique" ON "extension_service_connections" ("biz_id","provider_key","external_account_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "extension_service_connections_biz_status_provider_idx" ON "extension_service_connections" ("biz_id","status","provider_key","service_category");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_service_object_links_biz_id_id_unique" ON "extension_service_object_links" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_service_object_links_external_unique" ON "extension_service_object_links" ("extension_service_connection_id","external_object_type","external_object_ref");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_service_object_links_local_subject_unique" ON "extension_service_object_links" ("extension_service_connection_id","subject_type","subject_id","external_object_type");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_service_object_links_local_ref_key_unique" ON "extension_service_object_links" ("extension_service_connection_id","local_reference_key","external_object_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "extension_service_object_links_biz_connection_status_type_idx" ON "extension_service_object_links" ("biz_id","extension_service_connection_id","status","external_object_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "extension_service_sync_items_biz_job_status_idx" ON "extension_service_sync_items" ("biz_id","extension_service_sync_job_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_service_sync_jobs_biz_id_id_unique" ON "extension_service_sync_jobs" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "extension_service_sync_jobs_biz_connection_status_idx" ON "extension_service_sync_jobs" ("biz_id","extension_service_connection_id","status","requested_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_state_documents_biz_id_id_unique" ON "extension_state_documents" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_state_documents_unique" ON "extension_state_documents" ("biz_id","biz_extension_install_id","namespace","document_key","scope_ref_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "extension_state_documents_biz_install_namespace_idx" ON "extension_state_documents" ("biz_id","biz_extension_install_id","namespace","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "extension_state_documents_biz_scope_idx" ON "extension_state_documents" ("biz_id","scope","scope_ref_key","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "extension_webhook_ingress_events_connection_event_unique" ON "extension_webhook_ingress_events" ("extension_service_connection_id","external_event_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "extension_webhook_ingress_events_biz_status_received_idx" ON "extension_webhook_ingress_events" ("biz_id","status","received_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "idempotency_keys_biz_id_id_unique" ON "idempotency_keys" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "idempotency_keys_biz_scope_key_unique" ON "idempotency_keys" ("biz_id","scope","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "idempotency_keys_biz_scope_status_idx" ON "idempotency_keys" ("biz_id","scope","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "lifecycle_event_deliveries_biz_event_subscription_unique" ON "lifecycle_event_deliveries" ("biz_id","lifecycle_event_id","lifecycle_event_subscription_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "lifecycle_event_deliveries_biz_idempotency_unique" ON "lifecycle_event_deliveries" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "lifecycle_event_deliveries_biz_status_next_attempt_idx" ON "lifecycle_event_deliveries" ("biz_id","status","next_attempt_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "lifecycle_event_deliveries_biz_subscription_status_idx" ON "lifecycle_event_deliveries" ("biz_id","lifecycle_event_subscription_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "lifecycle_event_subscriptions_biz_id_id_unique" ON "lifecycle_event_subscriptions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "lifecycle_event_subscriptions_biz_name_unique" ON "lifecycle_event_subscriptions" ("biz_id","name");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "lifecycle_event_subscriptions_biz_status_pattern_idx" ON "lifecycle_event_subscriptions" ("biz_id","status","event_pattern","phase");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "lifecycle_events_biz_id_id_unique" ON "lifecycle_events" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "lifecycle_events_biz_event_occurred_idx" ON "lifecycle_events" ("biz_id","event_name","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "lifecycle_events_biz_entity_occurred_idx" ON "lifecycle_events" ("biz_id","entity_type","entity_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "lifecycle_events_biz_idempotency_unique" ON "lifecycle_events" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_action_token_events_biz_token_happened_idx" ON "access_action_token_events" ("biz_id","access_action_token_id","happened_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_action_token_events_biz_type_happened_idx" ON "access_action_token_events" ("biz_id","event_type","happened_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_action_tokens_biz_id_id_unique" ON "access_action_tokens" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_action_tokens_biz_token_hash_unique" ON "access_action_tokens" ("biz_id","token_hash");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_action_tokens_biz_request_key_unique" ON "access_action_tokens" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_action_tokens_biz_artifact_action_status_idx" ON "access_action_tokens" ("biz_id","access_artifact_id","action_type","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_action_tokens_biz_status_expiry_idx" ON "access_action_tokens" ("biz_id","status","expires_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_activity_logs_biz_id_id_unique" ON "access_activity_logs" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_activity_logs_biz_occurred_idx" ON "access_activity_logs" ("biz_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_activity_logs_biz_artifact_occurred_idx" ON "access_activity_logs" ("biz_id","access_artifact_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_activity_logs_biz_action_outcome_occurred_idx" ON "access_activity_logs" ("biz_id","action_type","outcome","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_artifact_events_biz_artifact_happened_idx" ON "access_artifact_events" ("biz_id","access_artifact_id","happened_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_artifact_events_biz_type_happened_idx" ON "access_artifact_events" ("biz_id","event_type","happened_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_artifact_events_biz_request_key_unique" ON "access_artifact_events" ("biz_id","request_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_artifact_links_biz_id_id_unique" ON "access_artifact_links" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_artifact_links_biz_artifact_type_idx" ON "access_artifact_links" ("biz_id","access_artifact_id","link_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_artifact_links_biz_artifact_role_idx" ON "access_artifact_links" ("biz_id","access_artifact_id","relation_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_artifacts_biz_id_id_unique" ON "access_artifacts" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_artifacts_biz_public_code_unique" ON "access_artifacts" ("biz_id","public_code");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_artifacts_biz_type_status_issued_idx" ON "access_artifacts" ("biz_id","artifact_type","status","issued_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_artifacts_biz_holder_user_status_idx" ON "access_artifacts" ("biz_id","holder_user_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_artifacts_biz_holder_group_status_idx" ON "access_artifacts" ("biz_id","holder_group_account_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_artifacts_biz_sellable_status_idx" ON "access_artifacts" ("biz_id","sellable_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_delivery_links_biz_id_id_unique" ON "access_delivery_links" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_delivery_links_biz_token_hash_unique" ON "access_delivery_links" ("biz_id","token_hash");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_delivery_links_biz_request_key_unique" ON "access_delivery_links" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_delivery_links_biz_artifact_status_expiry_idx" ON "access_delivery_links" ("biz_id","access_artifact_id","status","expires_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_resale_listings_biz_id_id_unique" ON "access_resale_listings" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_resale_listings_biz_status_listed_idx" ON "access_resale_listings" ("biz_id","status","listed_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_resale_listings_biz_artifact_listed_idx" ON "access_resale_listings" ("biz_id","access_artifact_id","listed_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_security_decisions_biz_decided_idx" ON "access_security_decisions" ("biz_id","decided_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_security_decisions_biz_artifact_decided_idx" ON "access_security_decisions" ("biz_id","access_artifact_id","decided_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_security_signals_biz_id_id_unique" ON "access_security_signals" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_security_signals_biz_status_detected_idx" ON "access_security_signals" ("biz_id","status","detected_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_security_signals_biz_artifact_detected_idx" ON "access_security_signals" ("biz_id","access_artifact_id","detected_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_transfer_policies_biz_id_id_unique" ON "access_transfer_policies" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_transfer_policies_biz_slug_unique" ON "access_transfer_policies" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_transfer_policies_biz_status_idx" ON "access_transfer_policies" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_transfer_policies_biz_sellable_status_idx" ON "access_transfer_policies" ("biz_id","applies_to_sellable_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "access_transfers_biz_id_id_unique" ON "access_transfers" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_transfers_biz_status_requested_idx" ON "access_transfers" ("biz_id","status","requested_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_transfers_biz_source_requested_idx" ON "access_transfers" ("biz_id","source_access_artifact_id","requested_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "access_usage_windows_biz_artifact_action_idx" ON "access_usage_windows" ("biz_id","access_artifact_id","action_type");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "checkout_recovery_links_biz_id_id_unique" ON "checkout_recovery_links" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "checkout_recovery_links_biz_token_hash_unique" ON "checkout_recovery_links" ("biz_id","token_hash");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "checkout_recovery_links_biz_request_key_unique" ON "checkout_recovery_links" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "checkout_recovery_links_biz_session_status_issued_idx" ON "checkout_recovery_links" ("biz_id","checkout_session_id","status","issued_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "checkout_session_events_biz_session_event_idx" ON "checkout_session_events" ("biz_id","checkout_session_id","event_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "checkout_session_events_biz_type_event_idx" ON "checkout_session_events" ("biz_id","event_type","event_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "checkout_session_events_biz_request_key_unique" ON "checkout_session_events" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "checkout_session_items_biz_session_idx" ON "checkout_session_items" ("biz_id","checkout_session_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "checkout_session_items_biz_sellable_idx" ON "checkout_session_items" ("biz_id","sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "checkout_session_items_session_sellable_unique" ON "checkout_session_items" ("checkout_session_id","sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "checkout_sessions_biz_id_id_unique" ON "checkout_sessions" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "checkout_sessions_biz_status_activity_idx" ON "checkout_sessions" ("biz_id","status","last_activity_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "checkout_sessions_biz_owner_idx" ON "checkout_sessions" ("biz_id","owner_user_id","started_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "checkout_sessions_biz_recovered_from_idx" ON "checkout_sessions" ("biz_id","recovered_from_checkout_session_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "wishlist_items_biz_id_id_unique" ON "wishlist_items" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "wishlist_items_active_unique" ON "wishlist_items" ("wishlist_id","sellable_id","variant_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "wishlist_items_biz_wishlist_priority_idx" ON "wishlist_items" ("biz_id","wishlist_id","priority","added_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "wishlist_items_biz_sellable_idx" ON "wishlist_items" ("biz_id","sellable_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "wishlists_biz_id_id_unique" ON "wishlists" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "wishlists_owner_slug_unique" ON "wishlists" ("biz_id","crm_contact_id","slug");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "wishlists_one_default_per_owner_unique" ON "wishlists" ("biz_id","crm_contact_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "wishlists_biz_owner_status_idx" ON "wishlists" ("biz_id","crm_contact_id","status","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sales_quote_acceptances_biz_id_id_unique" ON "sales_quote_acceptances" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sales_quote_acceptances_accepted_unique" ON "sales_quote_acceptances" ("sales_quote_version_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sales_quote_acceptances_biz_version_decided_idx" ON "sales_quote_acceptances" ("biz_id","sales_quote_version_id","decided_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sales_quote_acceptances_biz_booking_order_idx" ON "sales_quote_acceptances" ("biz_id","booking_order_id","decided_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sales_quote_acceptances_biz_actor_contact_idx" ON "sales_quote_acceptances" ("biz_id","decided_by_crm_contact_id","decided_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sales_quote_lines_biz_id_id_unique" ON "sales_quote_lines" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sales_quote_lines_version_sort_unique" ON "sales_quote_lines" ("sales_quote_version_id","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sales_quote_lines_biz_version_sort_idx" ON "sales_quote_lines" ("biz_id","sales_quote_version_id","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sales_quote_lines_biz_sellable_idx" ON "sales_quote_lines" ("biz_id","sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sales_quote_versions_biz_id_id_unique" ON "sales_quote_versions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sales_quote_versions_unique" ON "sales_quote_versions" ("sales_quote_id","version_number");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sales_quote_versions_current_unique" ON "sales_quote_versions" ("sales_quote_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sales_quote_versions_biz_quote_status_idx" ON "sales_quote_versions" ("biz_id","sales_quote_id","status","version_number");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sales_quotes_biz_id_id_unique" ON "sales_quotes" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sales_quotes_biz_number_unique" ON "sales_quotes" ("biz_id","quote_number");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sales_quotes_biz_status_valid_until_idx" ON "sales_quotes" ("biz_id","status","valid_until");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sales_quotes_biz_contact_idx" ON "sales_quotes" ("biz_id","crm_contact_id","status","valid_until");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "session_interaction_aggregates_bucket_unique" ON "session_interaction_aggregates" ("biz_id","source_type","program_session_id","fulfillment_unit_id","custom_session_subject_type","custom_session_subject_id","granularity","bucket_starts_at","interaction_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "session_interaction_aggregates_biz_source_bucket_idx" ON "session_interaction_aggregates" ("biz_id","source_type","bucket_starts_at","interaction_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "session_interaction_events_biz_source_occurred_idx" ON "session_interaction_events" ("biz_id","source_type","program_session_id","fulfillment_unit_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "session_interaction_events_biz_participant_occurred_idx" ON "session_interaction_events" ("biz_id","participant_user_id","participant_enrollment_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "session_interaction_events_biz_type_occurred_idx" ON "session_interaction_events" ("biz_id","interaction_type","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "session_interaction_events_biz_request_key_unique" ON "session_interaction_events" ("biz_id","request_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "interaction_assignments_biz_id_id_unique" ON "interaction_assignments" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_assignments_biz_status_due_idx" ON "interaction_assignments" ("biz_id","status","due_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_assignments_biz_status_config_idx" ON "interaction_assignments" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_assignments_biz_target_idx" ON "interaction_assignments" ("biz_id","target_type","target_ref_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_assignments_biz_subject_idx" ON "interaction_assignments" ("biz_id","subject_user_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_submission_artifacts_biz_submission_idx" ON "interaction_submission_artifacts" ("biz_id","interaction_submission_id","captured_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_submission_signatures_biz_submission_idx" ON "interaction_submission_signatures" ("biz_id","interaction_submission_id","signed_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_submission_signatures_biz_status_config_idx" ON "interaction_submission_signatures" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "interaction_submissions_biz_id_id_unique" ON "interaction_submissions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "interaction_submissions_assignment_attempt_unique" ON "interaction_submissions" ("interaction_assignment_id","attempt_number");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_submissions_biz_assignment_idx" ON "interaction_submissions" ("biz_id","interaction_assignment_id","attempt_number");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_submissions_biz_status_config_idx" ON "interaction_submissions" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "interaction_template_bindings_biz_id_id_unique" ON "interaction_template_bindings" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_template_bindings_biz_target_trigger_idx" ON "interaction_template_bindings" ("biz_id","target_type","trigger_event","is_active","priority");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "interaction_templates_biz_id_id_unique" ON "interaction_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "interaction_templates_biz_slug_version_unique" ON "interaction_templates" ("biz_id","slug","version");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "interaction_templates_biz_slug_current_unique" ON "interaction_templates" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_templates_biz_type_status_idx" ON "interaction_templates" ("biz_id","template_type","status","is_current");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_templates_biz_template_type_config_idx" ON "interaction_templates" ("biz_id","template_type_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "interaction_templates_biz_status_config_idx" ON "interaction_templates" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_list_assignment_items_unique" ON "requirement_list_assignment_items" ("requirement_list_assignment_id","template_item_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_list_assignment_items_biz_assignment_status_idx" ON "requirement_list_assignment_items" ("biz_id","requirement_list_assignment_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_list_assignment_items_biz_status_config_idx" ON "requirement_list_assignment_items" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_list_assignments_biz_id_id_unique" ON "requirement_list_assignments" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_list_assignments_biz_status_due_idx" ON "requirement_list_assignments" ("biz_id","status","due_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_list_assignments_biz_status_config_idx" ON "requirement_list_assignments" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_list_assignments_biz_target_idx" ON "requirement_list_assignments" ("biz_id","target_type","target_ref_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_list_template_items_biz_id_id_unique" ON "requirement_list_template_items" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_list_template_items_unique" ON "requirement_list_template_items" ("requirement_list_template_id","item_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_list_template_items_biz_template_sort_idx" ON "requirement_list_template_items" ("biz_id","requirement_list_template_id","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_list_template_items_biz_item_type_config_idx" ON "requirement_list_template_items" ("biz_id","item_type_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_list_templates_biz_id_id_unique" ON "requirement_list_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_list_templates_biz_slug_version_unique" ON "requirement_list_templates" ("biz_id","slug","version");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "requirement_list_templates_biz_slug_current_unique" ON "requirement_list_templates" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_list_templates_biz_status_idx" ON "requirement_list_templates" ("biz_id","status","is_current");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "requirement_list_templates_biz_status_config_idx" ON "requirement_list_templates" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "communication_consents_subject_unique" ON "communication_consents" ("biz_id","subject_type","subject_ref_id","channel","purpose");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "communication_consents_biz_channel_purpose_status_idx" ON "communication_consents" ("biz_id","channel","purpose","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketing_campaign_enrollments_unique" ON "marketing_campaign_enrollments" ("biz_id","marketing_campaign_id","subject_type","subject_ref_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "marketing_campaign_enrollments_biz_status_eval_idx" ON "marketing_campaign_enrollments" ("biz_id","status","last_evaluated_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketing_campaign_steps_biz_id_id_unique" ON "marketing_campaign_steps" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketing_campaign_steps_unique" ON "marketing_campaign_steps" ("marketing_campaign_id","step_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "marketing_campaign_steps_biz_campaign_sort_idx" ON "marketing_campaign_steps" ("biz_id","marketing_campaign_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketing_campaigns_biz_id_id_unique" ON "marketing_campaigns" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketing_campaigns_biz_slug_unique" ON "marketing_campaigns" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "marketing_campaigns_biz_status_starts_idx" ON "marketing_campaigns" ("biz_id","status","starts_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "message_template_bindings_biz_pattern_active_priority_idx" ON "message_template_bindings" ("biz_id","event_pattern","is_active","priority");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "message_templates_biz_id_id_unique" ON "message_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "message_templates_biz_channel_slug_version_unique" ON "message_templates" ("biz_id","channel","slug","version");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "message_templates_biz_channel_slug_current_unique" ON "message_templates" ("biz_id","channel","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "message_templates_biz_channel_purpose_status_idx" ON "message_templates" ("biz_id","channel","purpose","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "outbound_message_events_provider_ref_unique" ON "outbound_message_events" ("biz_id","provider_event_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "outbound_message_events_biz_message_occurred_idx" ON "outbound_message_events" ("biz_id","outbound_message_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "outbound_messages_biz_id_id_unique" ON "outbound_messages" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "outbound_messages_provider_ref_unique" ON "outbound_messages" ("biz_id","provider_key","provider_message_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "outbound_messages_biz_status_schedule_idx" ON "outbound_messages" ("biz_id","status","scheduled_for");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "outbound_messages_biz_recipient_idx" ON "outbound_messages" ("biz_id","recipient_user_id","channel","scheduled_for");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "quiet_hour_policies_biz_status_channel_idx" ON "quiet_hour_policies" ("biz_id","status","channel");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "quiet_hour_policies_biz_default_unique" ON "quiet_hour_policies" ("biz_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "survey_invitations_biz_id_id_unique" ON "survey_invitations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "survey_invitations_token_unique" ON "survey_invitations" ("biz_id","token_hash");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "survey_invitations_biz_status_sent_idx" ON "survey_invitations" ("biz_id","status","sent_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "survey_questions_biz_id_id_unique" ON "survey_questions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "survey_questions_unique" ON "survey_questions" ("survey_template_id","question_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "survey_questions_biz_template_sort_idx" ON "survey_questions" ("biz_id","survey_template_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "survey_response_answers_unique" ON "survey_response_answers" ("survey_response_id","survey_question_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "survey_response_answers_biz_response_idx" ON "survey_response_answers" ("biz_id","survey_response_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "survey_response_answers_biz_question_idx" ON "survey_response_answers" ("biz_id","survey_question_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "survey_responses_invitation_unique" ON "survey_responses" ("survey_invitation_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "survey_responses_biz_id_id_unique" ON "survey_responses" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "survey_responses_biz_status_submitted_idx" ON "survey_responses" ("biz_id","status","submitted_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "survey_templates_biz_id_id_unique" ON "survey_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "survey_templates_biz_slug_version_unique" ON "survey_templates" ("biz_id","slug","version");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "survey_templates_biz_slug_current_unique" ON "survey_templates" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "survey_templates_biz_status_idx" ON "survey_templates" ("biz_id","status","is_current");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "discount_campaigns_biz_id_id_unique" ON "discount_campaigns" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "discount_campaigns_biz_slug_unique" ON "discount_campaigns" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "discount_campaigns_biz_status_starts_idx" ON "discount_campaigns" ("biz_id","status","starts_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "discount_codes_biz_id_id_unique" ON "discount_codes" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "discount_codes_biz_code_unique" ON "discount_codes" ("biz_id","code");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "discount_codes_biz_campaign_status_idx" ON "discount_codes" ("biz_id","discount_campaign_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "discount_redemptions_biz_campaign_redeemed_idx" ON "discount_redemptions" ("biz_id","discount_campaign_id","redeemed_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "discount_redemptions_biz_customer_redeemed_idx" ON "discount_redemptions" ("biz_id","customer_user_id","redeemed_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_approvals_biz_decision_due_idx" ON "work_approvals" ("biz_id","decision","due_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_approvals_biz_run_stage_idx" ON "work_approvals" ("biz_id","work_run_id","stage");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_artifacts_biz_run_captured_idx" ON "work_artifacts" ("biz_id","work_run_id","captured_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_artifacts_biz_entry_idx" ON "work_artifacts" ("biz_id","work_entry_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_entries_biz_id_id_unique" ON "work_entries" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_entries_biz_run_occurred_idx" ON "work_entries" ("biz_id","work_run_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_entries_biz_type_occurred_idx" ON "work_entries" ("biz_id","entry_type","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_entries_biz_status_config_idx" ON "work_entries" ("biz_id","status_config_value_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_run_steps_biz_id_id_unique" ON "work_run_steps" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_run_steps_unique" ON "work_run_steps" ("work_run_id","work_template_step_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_run_steps_biz_run_status_idx" ON "work_run_steps" ("biz_id","work_run_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_run_steps_biz_status_config_idx" ON "work_run_steps" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_runs_biz_id_id_unique" ON "work_runs" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_runs_biz_status_due_priority_idx" ON "work_runs" ("biz_id","status","due_at","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_runs_biz_status_config_idx" ON "work_runs" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_runs_biz_target_status_idx" ON "work_runs" ("biz_id","target_type","target_ref_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_template_steps_biz_id_id_unique" ON "work_template_steps" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_template_steps_unique" ON "work_template_steps" ("work_template_id","step_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_template_steps_biz_template_sort_idx" ON "work_template_steps" ("biz_id","work_template_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_templates_biz_id_id_unique" ON "work_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_templates_biz_slug_version_unique" ON "work_templates" ("biz_id","slug","version");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_templates_biz_slug_current_unique" ON "work_templates" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_templates_biz_kind_status_idx" ON "work_templates" ("biz_id","kind","status","is_current");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_templates_biz_kind_config_idx" ON "work_templates" ("biz_id","kind_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_templates_biz_status_config_idx" ON "work_templates" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_time_segment_allocations_biz_id_id_unique" ON "work_time_segment_allocations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_time_segment_allocations_unique" ON "work_time_segment_allocations" ("work_time_segment_id","staffing_assignment_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_time_segment_allocations_biz_segment_idx" ON "work_time_segment_allocations" ("biz_id","work_time_segment_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_time_segment_allocations_biz_assignment_idx" ON "work_time_segment_allocations" ("biz_id","staffing_assignment_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "work_time_segments_biz_id_id_unique" ON "work_time_segments" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_time_segments_biz_user_clock_in_idx" ON "work_time_segments" ("biz_id","user_id","clock_in_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "work_time_segments_biz_run_clock_in_idx" ON "work_time_segments" ("biz_id","work_run_id","clock_in_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "note_access_overrides_unique" ON "note_access_overrides" ("note_id","user_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "note_access_overrides_biz_user_idx" ON "note_access_overrides" ("biz_id","user_id","expires_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "note_revisions_unique" ON "note_revisions" ("note_id","revision");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "note_revisions_biz_note_revision_idx" ON "note_revisions" ("biz_id","note_id","revision");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "notes_biz_id_id_unique" ON "notes" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "notes_biz_target_idx" ON "notes" ("biz_id","target_type","visibility","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "queue_entries_biz_id_id_unique" ON "queue_entries" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "queue_entries_biz_id_id_queue_id_unique" ON "queue_entries" ("biz_id","id","queue_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "queue_entries_biz_queue_status_idx" ON "queue_entries" ("biz_id","queue_id","status","joined_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "queue_entries_biz_status_config_idx" ON "queue_entries" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "queue_entries_biz_customer_idx" ON "queue_entries" ("biz_id","customer_user_id","joined_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "queue_entries_active_customer_queue_unique" ON "queue_entries" ("biz_id","queue_id","customer_user_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "queue_events_biz_queue_entry_idx" ON "queue_events" ("biz_id","queue_entry_id","event_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "queue_tickets_queue_number_unique" ON "queue_tickets" ("biz_id","queue_id","ticket_number");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "queue_tickets_biz_queue_entry_idx" ON "queue_tickets" ("biz_id","queue_entry_id","issued_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "queue_tickets_biz_status_config_idx" ON "queue_tickets" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "queues_biz_id_id_unique" ON "queues" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "queues_biz_slug_unique" ON "queues" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "queues_biz_status_idx" ON "queues" ("biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "queues_biz_strategy_config_idx" ON "queues" ("biz_id","strategy_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "queues_biz_status_config_idx" ON "queues" ("biz_id","status_config_value_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "service_time_observations_biz_queue_started_idx" ON "service_time_observations" ("biz_id","queue_id","started_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "wait_time_predictions_biz_queue_generated_idx" ON "wait_time_predictions" ("biz_id","queue_id","generated_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "dispatch_tasks_biz_status_due_idx" ON "dispatch_tasks" ("biz_id","status","due_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "eta_events_biz_trip_event_at_idx" ON "eta_events" ("biz_id","trip_id","event_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fleet_vehicles_biz_id_id_unique" ON "fleet_vehicles" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fleet_vehicles_plate_unique" ON "fleet_vehicles" ("biz_id","plate_number");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fleet_vehicles_biz_status_idx" ON "fleet_vehicles" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "transport_route_stops_biz_id_id_unique" ON "transport_route_stops" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "transport_route_stops_route_order_unique" ON "transport_route_stops" ("route_id","stop_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "transport_route_stops_biz_route_idx" ON "transport_route_stops" ("biz_id","route_id","stop_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "transport_routes_biz_id_id_unique" ON "transport_routes" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "transport_routes_biz_slug_unique" ON "transport_routes" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "transport_routes_biz_status_idx" ON "transport_routes" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "transport_trips_biz_id_id_unique" ON "transport_trips" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "transport_trips_biz_status_departure_idx" ON "transport_trips" ("biz_id","status","departure_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "trip_manifests_biz_trip_status_idx" ON "trip_manifests" ("biz_id","trip_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "trip_stop_inventory_trip_stop_unique" ON "trip_stop_inventory" ("trip_id","route_stop_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "trip_stop_inventory_biz_trip_idx" ON "trip_stop_inventory" ("biz_id","trip_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "auctions_biz_id_id_unique" ON "auctions" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "auctions_biz_status_starts_idx" ON "auctions" ("biz_id","status","starts_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "auctions_biz_target_subject_idx" ON "auctions" ("biz_id","target_subject_type","target_subject_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "bids_biz_auction_submitted_idx" ON "bids" ("biz_id","auction_id","submitted_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "cross_biz_contracts_biz_id_id_unique" ON "cross_biz_contracts" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "cross_biz_contracts_biz_status_idx" ON "cross_biz_contracts" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "cross_biz_orders_biz_id_id_unique" ON "cross_biz_orders" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "cross_biz_orders_biz_status_due_idx" ON "cross_biz_orders" ("biz_id","status","settlement_due_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketplace_listings_biz_id_id_unique" ON "marketplace_listings" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "marketplace_listings_biz_status_published_idx" ON "marketplace_listings" ("biz_id","status","published_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "referral_events_biz_id_id_unique" ON "referral_events" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "referral_events_biz_program_event_at_idx" ON "referral_events" ("biz_id","referral_program_id","event_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "referral_programs_biz_id_id_unique" ON "referral_programs" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "referral_programs_biz_slug_unique" ON "referral_programs" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "revenue_share_rules_biz_active_priority_idx" ON "revenue_share_rules" ("biz_id","is_active","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "reward_grants_biz_status_granted_idx" ON "reward_grants" ("biz_id","status","granted_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "operational_assignments_biz_id_id_unique" ON "operational_assignments" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "operational_assignments_biz_request_key_unique" ON "operational_assignments" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "operational_assignments_biz_status_window_idx" ON "operational_assignments" ("biz_id","status","starts_at","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "operational_assignments_biz_resource_status_window_idx" ON "operational_assignments" ("biz_id","resource_id","status","starts_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "operational_assignments_biz_demand_idx" ON "operational_assignments" ("biz_id","operational_demand_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "operational_assignments_biz_custom_subject_idx" ON "operational_assignments" ("biz_id","custom_subject_type","custom_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "operational_assignments_unique_fulfillment_assignment" ON "operational_assignments" ("fulfillment_assignment_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "operational_assignments_unique_staffing_assignment" ON "operational_assignments" ("staffing_assignment_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "operational_assignments_unique_custom_subject" ON "operational_assignments" ("biz_id","custom_subject_type","custom_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "operational_demands_biz_id_id_unique" ON "operational_demands" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "operational_demands_biz_request_key_unique" ON "operational_demands" ("biz_id","request_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "operational_demands_biz_status_window_idx" ON "operational_demands" ("biz_id","status","starts_at","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "operational_demands_biz_source_type_status_idx" ON "operational_demands" ("biz_id","source_type","source_status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "operational_demands_biz_custom_subject_idx" ON "operational_demands" ("biz_id","custom_subject_type","custom_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "operational_demands_unique_fulfillment_unit" ON "operational_demands" ("fulfillment_unit_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "operational_demands_unique_staffing_demand" ON "operational_demands" ("staffing_demand_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "operational_demands_unique_custom_subject" ON "operational_demands" ("biz_id","custom_subject_type","custom_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_admin_delegations_biz_id_id_unique" ON "enterprise_admin_delegations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_admin_delegations_active_unique" ON "enterprise_admin_delegations" ("biz_id","delegator_user_id","delegate_user_id","delegation_action","scope_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_admin_delegations_biz_delegate_status_idx" ON "enterprise_admin_delegations" ("biz_id","delegate_user_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_approval_authority_limits_biz_id_id_unique" ON "enterprise_approval_authority_limits" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_approval_authority_limits_active_unique" ON "enterprise_approval_authority_limits" ("biz_id","user_id","action_type","scope_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_approval_authority_limits_biz_user_status_idx" ON "enterprise_approval_authority_limits" ("biz_id","user_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_change_rollout_results_biz_id_id_unique" ON "enterprise_change_rollout_results" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_change_rollout_results_biz_target_idx" ON "enterprise_change_rollout_results" ("biz_id","rollout_target_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_change_rollout_runs_biz_id_id_unique" ON "enterprise_change_rollout_runs" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_change_rollout_runs_biz_slug_unique" ON "enterprise_change_rollout_runs" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_change_rollout_runs_biz_status_started_idx" ON "enterprise_change_rollout_runs" ("biz_id","status","started_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_change_rollout_targets_biz_id_id_unique" ON "enterprise_change_rollout_targets" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_change_rollout_targets_run_scope_unique" ON "enterprise_change_rollout_targets" ("biz_id","rollout_run_id","scope_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_change_rollout_targets_biz_run_status_order_idx" ON "enterprise_change_rollout_targets" ("biz_id","rollout_run_id","status","target_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_contract_pack_bindings_biz_id_id_unique" ON "enterprise_contract_pack_bindings" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_contract_pack_bindings_active_unique" ON "enterprise_contract_pack_bindings" ("biz_id","contract_pack_version_id","scope_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_contract_pack_bindings_biz_scope_status_idx" ON "enterprise_contract_pack_bindings" ("biz_id","scope_id","status","priority");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_contract_pack_templates_biz_id_id_unique" ON "enterprise_contract_pack_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_contract_pack_templates_biz_slug_unique" ON "enterprise_contract_pack_templates" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_contract_pack_templates_biz_domain_status_idx" ON "enterprise_contract_pack_templates" ("biz_id","domain_key","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_contract_pack_versions_biz_id_id_unique" ON "enterprise_contract_pack_versions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_contract_pack_versions_template_version_unique" ON "enterprise_contract_pack_versions" ("contract_pack_template_id","version_number");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_contract_pack_versions_biz_template_status_idx" ON "enterprise_contract_pack_versions" ("biz_id","contract_pack_template_id","status","version_number");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_external_directory_links_biz_id_id_unique" ON "enterprise_external_directory_links" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_external_directory_links_external_unique" ON "enterprise_external_directory_links" ("biz_id","identity_provider_id","external_directory_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_external_directory_links_principal_unique" ON "enterprise_external_directory_links" ("biz_id","identity_provider_id","principal_type","user_id","subject_type","subject_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_external_directory_links_biz_provider_status_idx" ON "enterprise_external_directory_links" ("biz_id","identity_provider_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_identity_providers_biz_id_id_unique" ON "enterprise_identity_providers" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_identity_providers_biz_slug_unique" ON "enterprise_identity_providers" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_identity_providers_biz_status_type_idx" ON "enterprise_identity_providers" ("biz_id","status","provider_type");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_inheritance_resolutions_biz_id_id_unique" ON "enterprise_inheritance_resolutions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_inheritance_resolutions_scope_unique" ON "enterprise_inheritance_resolutions" ("biz_id","strategy_id","scope_id","domain_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_inheritance_resolutions_biz_scope_domain_status_idx" ON "enterprise_inheritance_resolutions" ("biz_id","scope_id","domain_key","resolution_status","resolved_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_inheritance_strategies_biz_id_id_unique" ON "enterprise_inheritance_strategies" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_inheritance_strategies_biz_slug_unique" ON "enterprise_inheritance_strategies" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_inheritance_strategies_biz_domain_status_idx" ON "enterprise_inheritance_strategies" ("biz_id","inheritance_domain","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_intercompany_accounts_biz_id_id_unique" ON "enterprise_intercompany_accounts" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_intercompany_accounts_active_lane_unique" ON "enterprise_intercompany_accounts" ("biz_id","source_biz_id","counterparty_biz_id","account_type","currency");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_intercompany_accounts_biz_source_counterparty_idx" ON "enterprise_intercompany_accounts" ("biz_id","source_biz_id","counterparty_biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_intercompany_entries_biz_id_id_unique" ON "enterprise_intercompany_entries" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_intercompany_entries_biz_account_occurred_idx" ON "enterprise_intercompany_entries" ("biz_id","intercompany_account_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_intercompany_entries_biz_status_occurred_idx" ON "enterprise_intercompany_entries" ("biz_id","status","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_intercompany_entries_biz_reference_key_unique" ON "enterprise_intercompany_entries" ("biz_id","reference_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_intercompany_settlement_runs_biz_id_id_unique" ON "enterprise_intercompany_settlement_runs" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_intercompany_settlement_runs_biz_account_window_unique" ON "enterprise_intercompany_settlement_runs" ("biz_id","intercompany_account_id","window_start_date","window_end_date");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_intercompany_settlement_runs_biz_status_started_idx" ON "enterprise_intercompany_settlement_runs" ("biz_id","status","started_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_relationship_templates_biz_id_id_unique" ON "enterprise_relationship_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_relationship_templates_biz_slug_unique" ON "enterprise_relationship_templates" ("biz_id","slug");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_relationship_templates_biz_type_key_unique" ON "enterprise_relationship_templates" ("biz_id","relationship_type_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_relationship_templates_biz_status_idx" ON "enterprise_relationship_templates" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_relationships_biz_id_id_unique" ON "enterprise_relationships" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_relationships_active_edge_unique" ON "enterprise_relationships" ("biz_id","relationship_template_id","from_biz_id","to_biz_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_relationships_biz_from_status_idx" ON "enterprise_relationships" ("biz_id","from_biz_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_relationships_biz_to_status_idx" ON "enterprise_relationships" ("biz_id","to_biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_scim_sync_states_biz_id_id_unique" ON "enterprise_scim_sync_states" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_scim_sync_states_biz_provider_started_idx" ON "enterprise_scim_sync_states" ("biz_id","identity_provider_id","sync_started_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_scim_sync_states_biz_status_started_idx" ON "enterprise_scim_sync_states" ("biz_id","status","sync_started_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_scopes_biz_id_id_unique" ON "enterprise_scopes" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_scopes_biz_scope_key_unique" ON "enterprise_scopes" ("biz_id","scope_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "enterprise_scopes_biz_canonical_unique" ON "enterprise_scopes" ("biz_id","scope_type","target_biz_id","target_location_id","target_subject_type","target_subject_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "enterprise_scopes_biz_scope_type_status_idx" ON "enterprise_scopes" ("biz_id","scope_type","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fact_enterprise_compliance_daily_slice_unique" ON "fact_enterprise_compliance_daily" ("biz_id","member_biz_id","fact_date");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fact_enterprise_compliance_daily_biz_date_idx" ON "fact_enterprise_compliance_daily" ("biz_id","fact_date");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fact_enterprise_revenue_daily_slice_unique" ON "fact_enterprise_revenue_daily" ("biz_id","member_biz_id","fact_date","currency");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fact_enterprise_revenue_daily_biz_date_idx" ON "fact_enterprise_revenue_daily" ("biz_id","fact_date");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fact_enterprise_utilization_daily_slice_unique" ON "fact_enterprise_utilization_daily" ("biz_id","member_biz_id","fact_date");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fact_enterprise_utilization_daily_biz_date_idx" ON "fact_enterprise_utilization_daily" ("biz_id","fact_date");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "data_residency_policies_biz_id_id_unique" ON "data_residency_policies" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "data_residency_policies_biz_active_idx" ON "data_residency_policies" ("biz_id","is_active");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "data_subject_requests_biz_id_id_unique" ON "data_subject_requests" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "data_subject_requests_biz_status_due_idx" ON "data_subject_requests" ("biz_id","status","due_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "legal_holds_biz_id_id_unique" ON "legal_holds" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "legal_holds_biz_status_starts_idx" ON "legal_holds" ("biz_id","status","starts_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_bindings_biz_id_id_unique" ON "policy_bindings" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_bindings_biz_template_id_id_unique" ON "policy_bindings" ("biz_id","policy_template_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_bindings_biz_target_active_priority_idx" ON "policy_bindings" ("biz_id","target_type","is_active","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_bindings_biz_template_active_idx" ON "policy_bindings" ("biz_id","policy_template_id","is_active");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_bindings_biz_subject_idx" ON "policy_bindings" ("biz_id","target_subject_type","target_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_bindings_template_biz_unique" ON "policy_bindings" ("policy_template_id","target_type");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_bindings_template_location_unique" ON "policy_bindings" ("policy_template_id","location_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_bindings_template_resource_unique" ON "policy_bindings" ("policy_template_id","resource_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_bindings_template_service_unique" ON "policy_bindings" ("policy_template_id","service_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_bindings_template_service_product_unique" ON "policy_bindings" ("policy_template_id","service_product_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_bindings_template_offer_unique" ON "policy_bindings" ("policy_template_id","offer_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_bindings_template_offer_version_unique" ON "policy_bindings" ("policy_template_id","offer_version_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_bindings_template_queue_unique" ON "policy_bindings" ("policy_template_id","queue_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_bindings_template_subject_unique" ON "policy_bindings" ("policy_template_id","target_subject_type","target_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_breach_events_biz_id_id_unique" ON "policy_breach_events" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_breach_events_biz_status_occurred_idx" ON "policy_breach_events" ("biz_id","status","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_breach_events_biz_template_occurred_idx" ON "policy_breach_events" ("biz_id","policy_template_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_breach_events_biz_target_occurred_idx" ON "policy_breach_events" ("biz_id","target_subject_type","target_subject_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_consequence_events_biz_id_id_unique" ON "policy_consequence_events" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_consequence_events_biz_status_planned_idx" ON "policy_consequence_events" ("biz_id","status","planned_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_consequence_events_biz_breach_idx" ON "policy_consequence_events" ("biz_id","policy_breach_event_id","planned_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_consequence_events_biz_type_status_idx" ON "policy_consequence_events" ("biz_id","consequence_type","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_rules_biz_id_id_unique" ON "policy_rules" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_rules_biz_template_id_id_unique" ON "policy_rules" ("biz_id","policy_template_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_rules_template_rule_key_unique" ON "policy_rules" ("policy_template_id","rule_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_rules_biz_template_enabled_priority_idx" ON "policy_rules" ("biz_id","policy_template_id","is_enabled","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_rules_biz_severity_idx" ON "policy_rules" ("biz_id","severity","is_enabled");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_templates_biz_id_id_unique" ON "policy_templates" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_templates_biz_slug_version_unique" ON "policy_templates" ("biz_id","slug","version");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "policy_templates_biz_domain_status_effective_idx" ON "policy_templates" ("biz_id","domain_key","status","effective_from_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "policy_templates_biz_domain_default_unique" ON "policy_templates" ("biz_id","domain_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "privacy_identity_modes_biz_id_id_unique" ON "privacy_identity_modes" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "privacy_identity_modes_biz_slug_unique" ON "privacy_identity_modes" ("biz_id","slug");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "privacy_identity_modes_single_default_unique" ON "privacy_identity_modes" ("biz_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "redaction_jobs_biz_status_queued_idx" ON "redaction_jobs" ("biz_id","status","queued_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "retention_policies_biz_id_id_unique" ON "retention_policies" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "retention_policies_data_class_unique" ON "retention_policies" ("biz_id","data_class");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "tenant_compliance_profiles_biz_id_id_unique" ON "tenant_compliance_profiles" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "tenant_compliance_profiles_biz_regime_idx" ON "tenant_compliance_profiles" ("biz_id","regime","is_active");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "tenant_compliance_profiles_single_default_unique" ON "tenant_compliance_profiles" ("biz_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "breach_notifications_biz_incident_status_idx" ON "breach_notifications" ("biz_id","security_incident_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "breach_notifications_biz_due_idx" ON "breach_notifications" ("biz_id","due_at","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "break_glass_reviews_biz_access_event_unique" ON "break_glass_reviews" ("biz_id","phi_access_event_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "break_glass_reviews_biz_status_reviewed_idx" ON "break_glass_reviews" ("biz_id","status","reviewed_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "business_associate_agreements_biz_id_id_unique" ON "business_associate_agreements" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "business_associate_agreements_biz_status_effective_idx" ON "business_associate_agreements" ("biz_id","status","effective_from");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "business_associate_agreements_biz_party_idx" ON "business_associate_agreements" ("biz_id","party_type","party_name","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "hipaa_authorizations_biz_id_id_unique" ON "hipaa_authorizations" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "hipaa_authorizations_biz_subject_status_idx" ON "hipaa_authorizations" ("biz_id","subject_user_id","subject_group_account_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "phi_access_events_biz_id_id_unique" ON "phi_access_events" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "phi_access_events_biz_decision_occurred_idx" ON "phi_access_events" ("biz_id","decision","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "phi_access_events_biz_subject_occurred_idx" ON "phi_access_events" ("biz_id","subject_user_id","subject_group_account_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "phi_access_events_biz_actor_occurred_idx" ON "phi_access_events" ("biz_id","actor_user_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "phi_access_policies_biz_id_id_unique" ON "phi_access_policies" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "phi_access_policies_biz_slug_unique" ON "phi_access_policies" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "phi_access_policies_biz_status_scope_idx" ON "phi_access_policies" ("biz_id","status","scope");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "phi_disclosure_events_biz_subject_disclosed_idx" ON "phi_disclosure_events" ("biz_id","subject_user_id","subject_group_account_id","disclosed_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "phi_disclosure_events_biz_recipient_disclosed_idx" ON "phi_disclosure_events" ("biz_id","recipient_type","disclosed_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "security_incidents_biz_id_id_unique" ON "security_incidents" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "security_incidents_biz_status_detected_idx" ON "security_incidents" ("biz_id","status","detected_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "security_incidents_biz_severity_detected_idx" ON "security_incidents" ("biz_id","severity","detected_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "async_deliverables_biz_status_requested_idx" ON "async_deliverables" ("biz_id","status","requested_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "review_queue_items_biz_id_id_unique" ON "review_queue_items" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "review_queue_items_biz_queue_status_priority_idx" ON "review_queue_items" ("biz_id","review_queue_id","status","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "review_queue_items_biz_assignee_idx" ON "review_queue_items" ("biz_id","assigned_to_user_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "review_queues_biz_id_id_unique" ON "review_queues" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "review_queues_biz_slug_unique" ON "review_queues" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "review_queues_biz_type_status_idx" ON "review_queues" ("biz_id","type","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "workflow_decisions_biz_instance_decided_idx" ON "workflow_decisions" ("biz_id","workflow_instance_id","decided_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "workflow_instances_biz_id_id_unique" ON "workflow_instances" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "workflow_instances_biz_status_started_idx" ON "workflow_instances" ("biz_id","status","started_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "workflow_instances_biz_target_idx" ON "workflow_instances" ("biz_id","target_type","target_ref_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "workflow_steps_biz_id_id_unique" ON "workflow_steps" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "workflow_steps_instance_step_key_unique" ON "workflow_steps" ("workflow_instance_id","step_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "workflow_steps_biz_instance_sequence_idx" ON "workflow_steps" ("biz_id","workflow_instance_id","sequence");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_expiration_events_biz_id_id_unique" ON "gift_expiration_events" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_expiration_events_biz_gift_expired_idx" ON "gift_expiration_events" ("biz_id","gift_instrument_id","expired_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_instrument_ledger_entries_biz_id_id_unique" ON "gift_instrument_ledger_entries" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_instrument_ledger_entries_biz_idempotency_unique" ON "gift_instrument_ledger_entries" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_instrument_ledger_entries_biz_gift_occurred_idx" ON "gift_instrument_ledger_entries" ("biz_id","gift_instrument_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_instrument_ledger_entries_biz_type_occurred_idx" ON "gift_instrument_ledger_entries" ("biz_id","entry_type","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_instruments_biz_id_id_unique" ON "gift_instruments" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_instruments_biz_code_unique" ON "gift_instruments" ("biz_id","code");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_instruments_biz_status_expiry_idx" ON "gift_instruments" ("biz_id","status","expires_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_instruments_biz_source_type_idx" ON "gift_instruments" ("biz_id","source_type","issued_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_instruments_biz_owner_idx" ON "gift_instruments" ("biz_id","owner_user_id","owner_group_account_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_instruments_biz_source_gift_idx" ON "gift_instruments" ("biz_id","source_gift_instrument_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_instruments_biz_issued_sellable_idx" ON "gift_instruments" ("biz_id","issued_from_sellable_id","issued_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_redemptions_biz_id_id_unique" ON "gift_redemptions" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_redemptions_biz_idempotency_unique" ON "gift_redemptions" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_redemptions_biz_gift_redeemed_idx" ON "gift_redemptions" ("biz_id","gift_instrument_id","redeemed_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_redemptions_biz_order_redeemed_idx" ON "gift_redemptions" ("biz_id","booking_order_id","redeemed_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_redemptions_biz_payment_tender_redeemed_idx" ON "gift_redemptions" ("biz_id","payment_intent_tender_id","redeemed_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_transfers_biz_id_id_unique" ON "gift_transfers" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_transfers_biz_gift_transferred_idx" ON "gift_transfers" ("biz_id","gift_instrument_id","transferred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_transfers_biz_target_gift_transferred_idx" ON "gift_transfers" ("biz_id","target_gift_instrument_id","transferred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "booking_participant_obligations_biz_id_id_unique" ON "booking_participant_obligations" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "booking_participant_obligations_biz_order_status_due_idx" ON "booking_participant_obligations" ("biz_id","booking_order_id","status","due_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "booking_participant_obligations_biz_participant_status_idx" ON "booking_participant_obligations" ("biz_id","participant_user_id","participant_group_account_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "participant_obligation_events_biz_obligation_happened_idx" ON "participant_obligation_events" ("biz_id","booking_participant_obligation_id","happened_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "ar_invoices_biz_id_id_unique" ON "ar_invoices" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "ar_invoices_biz_number_unique" ON "ar_invoices" ("biz_id","invoice_number");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "ar_invoices_biz_status_due_idx" ON "ar_invoices" ("biz_id","status","due_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "billing_accounts_biz_id_id_unique" ON "billing_accounts" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "billing_accounts_biz_status_type_idx" ON "billing_accounts" ("biz_id","status","account_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "invoice_events_biz_invoice_happened_idx" ON "invoice_events" ("biz_id","ar_invoice_id","happened_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "purchase_orders_biz_id_id_unique" ON "purchase_orders" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "purchase_orders_biz_number_unique" ON "purchase_orders" ("biz_id","po_number");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "purchase_orders_biz_status_issued_idx" ON "purchase_orders" ("biz_id","status","issued_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "autocollection_attempts_biz_id_id_unique" ON "autocollection_attempts" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "autocollection_attempts_idempotency_unique" ON "autocollection_attempts" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "autocollection_attempts_biz_status_schedule_idx" ON "autocollection_attempts" ("biz_id","status","scheduled_for");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "autocollection_attempts_biz_account_schedule_idx" ON "autocollection_attempts" ("biz_id","billing_account_id","scheduled_for");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "autocollection_attempts_biz_invoice_schedule_idx" ON "autocollection_attempts" ("biz_id","ar_invoice_id","scheduled_for");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "billing_account_autopay_rules_biz_id_id_unique" ON "billing_account_autopay_rules" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "billing_account_autopay_rules_name_unique" ON "billing_account_autopay_rules" ("biz_id","billing_account_id","name");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "billing_account_autopay_rules_default_unique" ON "billing_account_autopay_rules" ("biz_id","billing_account_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "billing_account_autopay_rules_resolve_idx" ON "billing_account_autopay_rules" ("biz_id","billing_account_id","status","priority");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "installment_plans_biz_id_id_unique" ON "installment_plans" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "installment_plans_invoice_version_unique" ON "installment_plans" ("ar_invoice_id","version");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "installment_plans_invoice_current_unique" ON "installment_plans" ("ar_invoice_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "installment_plans_biz_status_next_due_idx" ON "installment_plans" ("biz_id","status","next_due_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "installment_schedule_items_biz_id_id_unique" ON "installment_schedule_items" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "installment_schedule_items_plan_sequence_unique" ON "installment_schedule_items" ("installment_plan_id","sequence_no");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "installment_schedule_items_biz_plan_due_idx" ON "installment_schedule_items" ("biz_id","installment_plan_id","due_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "installment_schedule_items_biz_status_due_idx" ON "installment_schedule_items" ("biz_id","status","due_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_claim_events_biz_claim_occurred_idx" ON "commitment_claim_events" ("biz_id","commitment_claim_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_claim_events_biz_actor_subject_idx" ON "commitment_claim_events" ("biz_id","actor_subject_type","actor_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "commitment_claims_biz_id_id_unique" ON "commitment_claims" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_claims_biz_contract_status_opened_idx" ON "commitment_claims" ("biz_id","commitment_contract_id","status","opened_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_claims_biz_raised_by_subject_idx" ON "commitment_claims" ("biz_id","raised_by_subject_type","raised_by_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "commitment_contracts_biz_id_id_unique" ON "commitment_contracts" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_contracts_biz_status_started_idx" ON "commitment_contracts" ("biz_id","status","started_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_contracts_biz_anchor_subject_idx" ON "commitment_contracts" ("biz_id","anchor_subject_type","anchor_subject_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_contracts_biz_counterparty_subject_idx" ON "commitment_contracts" ("biz_id","counterparty_subject_type","counterparty_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "commitment_milestone_obligations_unique" ON "commitment_milestone_obligations" ("commitment_milestone_id","commitment_obligation_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_milestone_obligations_biz_milestone_idx" ON "commitment_milestone_obligations" ("biz_id","commitment_milestone_id","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_milestone_obligations_biz_obligation_idx" ON "commitment_milestone_obligations" ("biz_id","commitment_obligation_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "commitment_milestones_biz_id_id_unique" ON "commitment_milestones" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "commitment_milestones_biz_contract_id_id_unique" ON "commitment_milestones" ("biz_id","commitment_contract_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "commitment_milestones_contract_code_unique" ON "commitment_milestones" ("commitment_contract_id","code");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_milestones_biz_contract_status_due_idx" ON "commitment_milestones" ("biz_id","commitment_contract_id","status","due_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "commitment_obligations_biz_id_id_unique" ON "commitment_obligations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "commitment_obligations_biz_contract_id_id_unique" ON "commitment_obligations" ("biz_id","commitment_contract_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_obligations_biz_contract_status_due_idx" ON "commitment_obligations" ("biz_id","commitment_contract_id","status","due_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_obligations_biz_obligor_subject_idx" ON "commitment_obligations" ("biz_id","obligor_subject_type","obligor_subject_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "commitment_obligations_biz_beneficiary_subject_idx" ON "commitment_obligations" ("biz_id","beneficiary_subject_type","beneficiary_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "secured_balance_accounts_biz_id_id_unique" ON "secured_balance_accounts" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "secured_balance_accounts_biz_contract_status_idx" ON "secured_balance_accounts" ("biz_id","commitment_contract_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "secured_balance_accounts_biz_owner_subject_idx" ON "secured_balance_accounts" ("biz_id","owner_subject_type","owner_subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "secured_balance_allocations_biz_id_id_unique" ON "secured_balance_allocations" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "secured_balance_allocations_biz_ledger_idx" ON "secured_balance_allocations" ("biz_id","secured_balance_ledger_entry_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "secured_balance_allocations_biz_obligation_idx" ON "secured_balance_allocations" ("biz_id","commitment_obligation_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "secured_balance_allocations_biz_milestone_idx" ON "secured_balance_allocations" ("biz_id","commitment_milestone_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "secured_balance_ledger_entries_biz_id_id_unique" ON "secured_balance_ledger_entries" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "secured_balance_ledger_entries_biz_idempotency_unique" ON "secured_balance_ledger_entries" ("biz_id","idempotency_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "secured_balance_ledger_entries_biz_account_occurred_idx" ON "secured_balance_ledger_entries" ("biz_id","secured_balance_account_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "secured_balance_ledger_entries_biz_status_occurred_idx" ON "secured_balance_ledger_entries" ("biz_id","status","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sla_breach_events_biz_id_id_unique" ON "sla_breach_events" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sla_breach_events_biz_status_breached_idx" ON "sla_breach_events" ("biz_id","status","breached_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sla_breach_events_biz_policy_breached_idx" ON "sla_breach_events" ("biz_id","sla_policy_id","breached_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sla_breach_events_biz_target_ref_idx" ON "sla_breach_events" ("biz_id","target_ref_type","target_ref_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sla_compensation_events_biz_breach_status_idx" ON "sla_compensation_events" ("biz_id","sla_breach_event_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sla_compensation_events_biz_applied_idx" ON "sla_compensation_events" ("biz_id","applied_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sla_policies_biz_id_id_unique" ON "sla_policies" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "sla_policies_biz_slug_unique" ON "sla_policies" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sla_policies_biz_status_scope_idx" ON "sla_policies" ("biz_id","status","scope_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "sla_policies_biz_scope_ref_idx" ON "sla_policies" ("biz_id","scope_ref_type","scope_ref_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fx_rate_snapshots_biz_id_id_unique" ON "fx_rate_snapshots" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fx_rate_snapshots_biz_pair_effective_idx" ON "fx_rate_snapshots" ("biz_id","base_currency","quote_currency","effective_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fx_rate_snapshots_biz_pair_source_effective_unique" ON "fx_rate_snapshots" ("biz_id","base_currency","quote_currency","source","effective_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "tax_calculations_biz_status_calculated_idx" ON "tax_calculations" ("biz_id","status","calculated_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "tax_calculations_biz_booking_order_idx" ON "tax_calculations" ("biz_id","booking_order_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "tax_calculations_biz_ar_invoice_idx" ON "tax_calculations" ("biz_id","ar_invoice_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "tax_profiles_biz_id_id_unique" ON "tax_profiles" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "tax_profiles_biz_slug_unique" ON "tax_profiles" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "tax_profiles_biz_status_geo_idx" ON "tax_profiles" ("biz_id","status","country_code","region_code");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "tax_rule_refs_biz_id_id_unique" ON "tax_rule_refs" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "tax_rule_refs_profile_rule_unique" ON "tax_rule_refs" ("tax_profile_id","rule_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "tax_rule_refs_biz_profile_status_priority_idx" ON "tax_rule_refs" ("biz_id","tax_profile_id","status","priority");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "leave_balances_biz_id_id_unique" ON "leave_balances" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "leave_balances_policy_resource_unique" ON "leave_balances" ("leave_policy_id","resource_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "leave_balances_biz_resource_idx" ON "leave_balances" ("biz_id","resource_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "leave_events_biz_resource_occurred_idx" ON "leave_events" ("biz_id","resource_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "leave_policies_biz_id_id_unique" ON "leave_policies" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "leave_policies_biz_slug_unique" ON "leave_policies" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "leave_policies_biz_status_idx" ON "leave_policies" ("biz_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "leave_requests_biz_id_id_unique" ON "leave_requests" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "leave_requests_biz_status_start_idx" ON "leave_requests" ("biz_id","status","start_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "leave_requests_biz_resource_start_idx" ON "leave_requests" ("biz_id","resource_id","start_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offline_merge_conflicts_biz_id_id_unique" ON "offline_merge_conflicts" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offline_merge_conflicts_open_per_op_unique" ON "offline_merge_conflicts" ("offline_op_journal_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offline_merge_conflicts_biz_status_detected_idx" ON "offline_merge_conflicts" ("biz_id","status","detected_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offline_merge_conflicts_biz_entity_detected_idx" ON "offline_merge_conflicts" ("biz_id","entity_type","entity_id","detected_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offline_ops_journal_biz_id_id_unique" ON "offline_ops_journal" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offline_ops_journal_biz_client_operation_unique" ON "offline_ops_journal" ("biz_id","client_id","operation_key");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offline_ops_journal_biz_status_received_idx" ON "offline_ops_journal" ("biz_id","status","received_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offline_ops_journal_biz_entity_received_idx" ON "offline_ops_journal" ("biz_id","entity_type","entity_id","received_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offline_resolution_events_biz_conflict_happened_idx" ON "offline_resolution_events" ("biz_id","offline_merge_conflict_id","happened_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fact_operational_daily_slice_unique" ON "fact_operational_daily" ("biz_id","location_id","source_type","fact_date");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fact_operational_daily_biz_date_idx" ON "fact_operational_daily" ("biz_id","fact_date");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fact_operational_daily_biz_location_date_idx" ON "fact_operational_daily" ("biz_id","location_id","fact_date");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fact_refresh_runs_biz_fact_started_idx" ON "fact_refresh_runs" ("biz_id","fact_key","started_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fact_resource_utilization_daily_slice_unique" ON "fact_resource_utilization_daily" ("biz_id","resource_id","fact_date");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fact_resource_utilization_daily_biz_date_util_idx" ON "fact_resource_utilization_daily" ("biz_id","fact_date","utilization_bps");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fact_revenue_daily_slice_unique" ON "fact_revenue_daily" ("biz_id","location_id","fact_date","currency");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fact_revenue_daily_biz_date_idx" ON "fact_revenue_daily" ("biz_id","fact_date");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fact_revenue_daily_biz_location_date_idx" ON "fact_revenue_daily" ("biz_id","location_id","fact_date");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fact_revenue_monthly_slice_unique" ON "fact_revenue_monthly" ("biz_id","location_id","month_start_date","currency");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fact_revenue_monthly_biz_month_idx" ON "fact_revenue_monthly" ("biz_id","month_start_date");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "fact_sellable_daily_slice_unique" ON "fact_sellable_daily" ("biz_id","sellable_id","fact_date","currency");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "fact_sellable_daily_biz_date_net_idx" ON "fact_sellable_daily" ("biz_id","fact_date","net_minor");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "projection_checkpoints_biz_status_lag_idx" ON "projection_checkpoints" ("biz_id","status","lag_seconds","last_applied_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "projection_checkpoints_biz_projection_applied_idx" ON "projection_checkpoints" ("biz_id","projection_key","last_applied_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "projection_checkpoints_biz_subject_idx" ON "projection_checkpoints" ("biz_id","subject_type","subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "projection_checkpoints_biz_scope_unique" ON "projection_checkpoints" ("biz_id","projection_key");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "projection_checkpoints_location_scope_unique" ON "projection_checkpoints" ("biz_id","projection_key","location_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "projection_checkpoints_resource_scope_unique" ON "projection_checkpoints" ("biz_id","projection_key","resource_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "projection_checkpoints_sellable_scope_unique" ON "projection_checkpoints" ("biz_id","projection_key","sellable_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "projection_checkpoints_custom_subject_scope_unique" ON "projection_checkpoints" ("biz_id","projection_key","subject_type","subject_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_delivery_attempts_biz_id_id_unique" ON "gift_delivery_attempts" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_delivery_attempts_schedule_attempt_unique" ON "gift_delivery_attempts" ("gift_delivery_schedule_id","attempt_no");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_delivery_attempts_biz_status_attempted_idx" ON "gift_delivery_attempts" ("biz_id","status","attempted_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_delivery_attempts_biz_schedule_attempted_idx" ON "gift_delivery_attempts" ("biz_id","gift_delivery_schedule_id","attempted_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_delivery_schedules_biz_id_id_unique" ON "gift_delivery_schedules" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "gift_delivery_schedules_gift_send_unique" ON "gift_delivery_schedules" ("gift_instrument_id","send_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_delivery_schedules_biz_status_send_idx" ON "gift_delivery_schedules" ("biz_id","status","send_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "gift_delivery_schedules_biz_gift_send_idx" ON "gift_delivery_schedules" ("biz_id","gift_instrument_id","send_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "ad_spend_daily_facts_slice_unique" ON "ad_spend_daily_facts" ("biz_id","fact_date","provider","provider_account_ref","campaign_ref","ad_group_ref","ad_ref","currency");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "ad_spend_daily_facts_biz_date_provider_idx" ON "ad_spend_daily_facts" ("biz_id","fact_date","provider");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "ad_spend_daily_facts_biz_campaign_date_idx" ON "ad_spend_daily_facts" ("biz_id","campaign_ref","fact_date");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketing_audience_segment_memberships_biz_id_id_unique" ON "marketing_audience_segment_memberships" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketing_audience_segment_memberships_active_contact_unique" ON "marketing_audience_segment_memberships" ("biz_id","marketing_audience_segment_id","member_crm_contact_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketing_audience_segment_memberships_active_subject_unique" ON "marketing_audience_segment_memberships" ("biz_id","marketing_audience_segment_id","member_subject_type","member_subject_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "marketing_audience_segment_memberships_biz_segment_status_idx" ON "marketing_audience_segment_memberships" ("biz_id","marketing_audience_segment_id","status","added_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "marketing_audience_segment_memberships_biz_member_idx" ON "marketing_audience_segment_memberships" ("biz_id","member_crm_contact_id","member_subject_type","member_subject_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketing_audience_segments_biz_id_id_unique" ON "marketing_audience_segments" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketing_audience_segments_biz_slug_unique" ON "marketing_audience_segments" ("biz_id","slug");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "marketing_audience_segments_biz_status_type_idx" ON "marketing_audience_segments" ("biz_id","status","segment_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "marketing_audience_segments_biz_source_type_idx" ON "marketing_audience_segments" ("biz_id","source_type","last_materialized_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "marketing_audience_sync_runs_biz_id_id_unique" ON "marketing_audience_sync_runs" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "marketing_audience_sync_runs_biz_status_requested_idx" ON "marketing_audience_sync_runs" ("biz_id","status","requested_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "marketing_audience_sync_runs_biz_segment_requested_idx" ON "marketing_audience_sync_runs" ("biz_id","marketing_audience_segment_id","requested_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offline_conversion_pushes_biz_id_id_unique" ON "offline_conversion_pushes" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "offline_conversion_pushes_external_ref_unique" ON "offline_conversion_pushes" ("biz_id","provider","external_event_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offline_conversion_pushes_biz_status_conversion_idx" ON "offline_conversion_pushes" ("biz_id","status","conversion_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "offline_conversion_pushes_biz_attribution_idx" ON "offline_conversion_pushes" ("biz_id","referral_attribution_id","conversion_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_contact_channels_biz_id_id_unique" ON "crm_contact_channels" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_contact_channels_biz_id_id_contact_unique" ON "crm_contact_channels" ("biz_id","id","crm_contact_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_contact_channels_endpoint_unique" ON "crm_contact_channels" ("biz_id","crm_contact_id","channel_type","channel_address");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_contact_channels_primary_unique" ON "crm_contact_channels" ("biz_id","crm_contact_id","channel_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_contact_channels_biz_contact_status_idx" ON "crm_contact_channels" ("biz_id","crm_contact_id","status","channel_type");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_contacts_biz_id_id_unique" ON "crm_contacts" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_contacts_biz_user_unique" ON "crm_contacts" ("biz_id","user_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_contacts_biz_group_unique" ON "crm_contacts" ("biz_id","group_account_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_contacts_biz_external_unique" ON "crm_contacts" ("biz_id","external_contact_ref");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_contacts_biz_source_unique" ON "crm_contacts" ("biz_id","source_type","source_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_contacts_biz_status_display_idx" ON "crm_contacts" ("biz_id","status","display_name","email");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_conversation_messages_biz_conversation_occurred_idx" ON "crm_conversation_messages" ("biz_id","crm_conversation_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_conversation_messages_biz_status_occurred_idx" ON "crm_conversation_messages" ("biz_id","status","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_conversation_messages_biz_sender_contact_idx" ON "crm_conversation_messages" ("biz_id","sender_crm_contact_id","occurred_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_conversation_messages_biz_sender_subject_idx" ON "crm_conversation_messages" ("biz_id","sender_subject_type","sender_subject_id","occurred_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_conversation_messages_provider_ref_unique" ON "crm_conversation_messages" ("biz_id","provider_message_ref");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_conversation_participants_active_contact_unique" ON "crm_conversation_participants" ("biz_id","crm_conversation_id","participant_crm_contact_id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_conversation_participants_active_subject_unique" ON "crm_conversation_participants" ("biz_id","crm_conversation_id","participant_subject_type","participant_subject_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_conversation_participants_biz_conversation_status_idx" ON "crm_conversation_participants" ("biz_id","crm_conversation_id","status","joined_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_conversation_participants_biz_contact_idx" ON "crm_conversation_participants" ("biz_id","participant_crm_contact_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_conversation_participants_biz_subject_idx" ON "crm_conversation_participants" ("biz_id","participant_subject_type","participant_subject_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_conversations_biz_id_id_unique" ON "crm_conversations" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_conversations_external_thread_unique" ON "crm_conversations" ("biz_id","channel_type","external_thread_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_conversations_biz_status_recency_idx" ON "crm_conversations" ("biz_id","status","last_message_at","priority");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_conversations_biz_assignee_status_idx" ON "crm_conversations" ("biz_id","assigned_user_id","status","last_message_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_conversations_biz_contact_status_idx" ON "crm_conversations" ("biz_id","crm_contact_id","status","last_message_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_lead_events_biz_lead_happened_idx" ON "crm_lead_events" ("biz_id","crm_lead_id","happened_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_lead_events_biz_type_happened_idx" ON "crm_lead_events" ("biz_id","event_type","happened_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_leads_biz_id_id_unique" ON "crm_leads" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_leads_source_unique" ON "crm_leads" ("biz_id","source_type","source_ref");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_leads_biz_status_priority_idx" ON "crm_leads" ("biz_id","status","priority","score_bps");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_leads_biz_contact_status_idx" ON "crm_leads" ("biz_id","crm_contact_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_leads_biz_owner_status_idx" ON "crm_leads" ("biz_id","owner_user_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_merge_candidates_pair_unique" ON "crm_merge_candidates" ("biz_id","left_subject_type","left_subject_id","right_subject_type","right_subject_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_merge_candidates_biz_status_detected_idx" ON "crm_merge_candidates" ("biz_id","status","detected_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_merge_decisions_candidate_unique" ON "crm_merge_decisions" ("crm_merge_candidate_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_merge_decisions_biz_type_decided_idx" ON "crm_merge_decisions" ("biz_id","decision_type","decided_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_opportunities_biz_id_id_unique" ON "crm_opportunities" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_opportunities_biz_stage_status_idx" ON "crm_opportunities" ("biz_id","crm_pipeline_stage_id","status","probability_bps");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_opportunities_biz_owner_status_idx" ON "crm_opportunities" ("biz_id","owner_user_id","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_opportunities_biz_expected_close_idx" ON "crm_opportunities" ("biz_id","expected_close_at","status");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_opportunities_biz_contact_status_idx" ON "crm_opportunities" ("biz_id","crm_contact_id","status","expected_close_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_opportunity_stage_events_biz_opportunity_happened_idx" ON "crm_opportunity_stage_events" ("biz_id","crm_opportunity_id","happened_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_opportunity_stage_events_biz_type_happened_idx" ON "crm_opportunity_stage_events" ("biz_id","event_type","happened_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_pipeline_stages_biz_id_id_unique" ON "crm_pipeline_stages" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_pipeline_stages_slug_unique" ON "crm_pipeline_stages" ("crm_pipeline_id","slug");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_pipeline_stages_sort_unique" ON "crm_pipeline_stages" ("crm_pipeline_id","sort_order");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_pipeline_stages_biz_pipeline_sort_idx" ON "crm_pipeline_stages" ("biz_id","crm_pipeline_id","sort_order");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_pipelines_biz_id_id_unique" ON "crm_pipelines" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_pipelines_biz_slug_unique" ON "crm_pipelines" ("biz_id","slug");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_pipelines_default_per_type_unique" ON "crm_pipelines" ("biz_id","pipeline_type");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_pipelines_biz_type_status_idx" ON "crm_pipelines" ("biz_id","pipeline_type","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "crm_subject_redirects_active_unique" ON "crm_subject_redirects" ("biz_id","subject_type","from_subject_id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "crm_subject_redirects_biz_to_subject_idx" ON "crm_subject_redirects" ("biz_id","subject_type","to_subject_id","status");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "production_batch_reservations_biz_id_id_unique" ON "production_batch_reservations" ("biz_id","id");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "production_batch_reservations_biz_batch_status_requested_idx" ON "production_batch_reservations" ("biz_id","production_batch_id","status","requested_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "production_batch_reservations_biz_owner_requested_idx" ON "production_batch_reservations" ("biz_id","owner_user_id","owner_group_account_id","requested_at");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "production_batches_biz_id_id_unique" ON "production_batches" ("biz_id","id");--> statement-breakpoint
CREATE UNIQUE INDEX IF NOT EXISTS "production_batches_biz_code_unique" ON "production_batches" ("biz_id","batch_code");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "production_batches_biz_status_ready_idx" ON "production_batches" ("biz_id","status","ready_at");--> statement-breakpoint
CREATE INDEX IF NOT EXISTS "production_batches_biz_sellable_ready_idx" ON "production_batches" ("biz_id","sellable_id","ready_at");--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "accounts" ADD CONSTRAINT "accounts_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE cascade ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "invitations" ADD CONSTRAINT "invitations_organization_id_bizes_id_fk" FOREIGN KEY ("organization_id") REFERENCES "bizes"("id") ON DELETE cascade ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "invitations" ADD CONSTRAINT "invitations_inviter_id_users_id_fk" FOREIGN KEY ("inviter_id") REFERENCES "users"("id") ON DELETE cascade ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "members" ADD CONSTRAINT "members_organization_id_bizes_id_fk" FOREIGN KEY ("organization_id") REFERENCES "bizes"("id") ON DELETE cascade ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "members" ADD CONSTRAINT "members_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE cascade ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sessions" ADD CONSTRAINT "sessions_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE cascade ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "locations" ADD CONSTRAINT "locations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_account_members" ADD CONSTRAINT "group_account_members_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_account_members" ADD CONSTRAINT "group_account_members_group_account_id_group_accounts_id_fk" FOREIGN KEY ("group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_account_members" ADD CONSTRAINT "group_account_members_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_account_members" ADD CONSTRAINT "group_account_members_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_account_members" ADD CONSTRAINT "group_account_members_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_account_members" ADD CONSTRAINT "group_account_members_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_account_members" ADD CONSTRAINT "group_account_members_biz_group_account_fk" FOREIGN KEY ("biz_id","group_account_id") REFERENCES "group_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_accounts" ADD CONSTRAINT "group_accounts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_accounts" ADD CONSTRAINT "group_accounts_primary_contact_user_id_users_id_fk" FOREIGN KEY ("primary_contact_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_accounts" ADD CONSTRAINT "group_accounts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_accounts" ADD CONSTRAINT "group_accounts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "group_accounts" ADD CONSTRAINT "group_accounts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "org_membership_locations" ADD CONSTRAINT "org_membership_locations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "org_membership_locations" ADD CONSTRAINT "org_membership_locations_membership_id_org_memberships_id_fk" FOREIGN KEY ("membership_id") REFERENCES "org_memberships"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "org_membership_locations" ADD CONSTRAINT "org_membership_locations_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "org_memberships" ADD CONSTRAINT "org_memberships_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "org_memberships" ADD CONSTRAINT "org_memberships_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "org_memberships" ADD CONSTRAINT "org_memberships_invited_by_user_id_users_id_fk" FOREIGN KEY ("invited_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_bindings" ADD CONSTRAINT "biz_config_bindings_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_bindings" ADD CONSTRAINT "biz_config_bindings_config_set_id_biz_config_sets_id_fk" FOREIGN KEY ("config_set_id") REFERENCES "biz_config_sets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_bindings" ADD CONSTRAINT "biz_config_bindings_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_bindings" ADD CONSTRAINT "biz_config_bindings_default_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("default_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_bindings" ADD CONSTRAINT "biz_config_bindings_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_bindings" ADD CONSTRAINT "biz_config_bindings_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_bindings" ADD CONSTRAINT "biz_config_bindings_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_bindings" ADD CONSTRAINT "biz_config_bindings_biz_set_fk" FOREIGN KEY ("biz_id","config_set_id") REFERENCES "biz_config_sets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_bindings" ADD CONSTRAINT "biz_config_bindings_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_bindings" ADD CONSTRAINT "biz_config_bindings_biz_default_value_fk" FOREIGN KEY ("biz_id","default_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_bindings" ADD CONSTRAINT "biz_config_bindings_default_value_set_match_fk" FOREIGN KEY ("biz_id","config_set_id","default_config_value_id") REFERENCES "biz_config_values"("biz_id","config_set_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_promotion_run_id_biz_config_promotion_runs_id_fk" FOREIGN KEY ("promotion_run_id") REFERENCES "biz_config_promotion_runs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_config_set_id_biz_config_sets_id_fk" FOREIGN KEY ("config_set_id") REFERENCES "biz_config_sets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_config_binding_id_biz_config_bindings_id_fk" FOREIGN KEY ("config_binding_id") REFERENCES "biz_config_bindings"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_biz_run_fk" FOREIGN KEY ("biz_id","promotion_run_id") REFERENCES "biz_config_promotion_runs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_biz_set_fk" FOREIGN KEY ("biz_id","config_set_id") REFERENCES "biz_config_sets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_biz_value_fk" FOREIGN KEY ("biz_id","config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_run_items" ADD CONSTRAINT "biz_config_promotion_run_items_biz_binding_fk" FOREIGN KEY ("biz_id","config_binding_id") REFERENCES "biz_config_bindings"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_runs" ADD CONSTRAINT "biz_config_promotion_runs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_runs" ADD CONSTRAINT "biz_config_promotion_runs_requested_by_user_id_users_id_fk" FOREIGN KEY ("requested_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_runs" ADD CONSTRAINT "biz_config_promotion_runs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_runs" ADD CONSTRAINT "biz_config_promotion_runs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_promotion_runs" ADD CONSTRAINT "biz_config_promotion_runs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_sets" ADD CONSTRAINT "biz_config_sets_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_sets" ADD CONSTRAINT "biz_config_sets_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_sets" ADD CONSTRAINT "biz_config_sets_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_sets" ADD CONSTRAINT "biz_config_sets_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_sets" ADD CONSTRAINT "biz_config_sets_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_sets" ADD CONSTRAINT "biz_config_sets_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_value_localizations" ADD CONSTRAINT "biz_config_value_localizations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_value_localizations" ADD CONSTRAINT "biz_config_value_localizations_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_value_localizations" ADD CONSTRAINT "biz_config_value_localizations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_value_localizations" ADD CONSTRAINT "biz_config_value_localizations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_value_localizations" ADD CONSTRAINT "biz_config_value_localizations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_value_localizations" ADD CONSTRAINT "biz_config_value_localizations_biz_value_fk" FOREIGN KEY ("biz_id","config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_values" ADD CONSTRAINT "biz_config_values_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_values" ADD CONSTRAINT "biz_config_values_config_set_id_biz_config_sets_id_fk" FOREIGN KEY ("config_set_id") REFERENCES "biz_config_sets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_values" ADD CONSTRAINT "biz_config_values_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_values" ADD CONSTRAINT "biz_config_values_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_values" ADD CONSTRAINT "biz_config_values_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_values" ADD CONSTRAINT "biz_config_values_biz_set_fk" FOREIGN KEY ("biz_id","config_set_id") REFERENCES "biz_config_sets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_config_values" ADD CONSTRAINT "biz_config_values_replacement_set_match_fk" FOREIGN KEY ("biz_id","config_set_id","replaced_by_config_value_id") REFERENCES "biz_config_values"("biz_id","config_set_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_groups" ADD CONSTRAINT "service_groups_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_groups" ADD CONSTRAINT "service_groups_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_groups" ADD CONSTRAINT "service_groups_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_groups" ADD CONSTRAINT "service_groups_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_groups" ADD CONSTRAINT "service_groups_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_groups" ADD CONSTRAINT "service_groups_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_service_group_id_service_groups_id_fk" FOREIGN KEY ("service_group_id") REFERENCES "service_groups"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_type_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("type_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_visibility_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("visibility_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_biz_service_group_fk" FOREIGN KEY ("biz_id","service_group_id") REFERENCES "service_groups"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_biz_type_config_fk" FOREIGN KEY ("biz_id","type_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_biz_visibility_config_fk" FOREIGN KEY ("biz_id","visibility_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "services" ADD CONSTRAINT "services_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "products" ADD CONSTRAINT "products_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "products" ADD CONSTRAINT "products_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "products" ADD CONSTRAINT "products_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "products" ADD CONSTRAINT "products_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "products" ADD CONSTRAINT "products_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_line_sellables" ADD CONSTRAINT "booking_order_line_sellables_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_line_sellables" ADD CONSTRAINT "booking_order_line_sellables_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_line_sellables" ADD CONSTRAINT "booking_order_line_sellables_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_line_sellables" ADD CONSTRAINT "booking_order_line_sellables_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_line_sellables" ADD CONSTRAINT "booking_order_line_sellables_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_line_sellables" ADD CONSTRAINT "booking_order_line_sellables_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_line_sellables" ADD CONSTRAINT "booking_order_line_sellables_biz_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_line_sellables" ADD CONSTRAINT "booking_order_line_sellables_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_items" ADD CONSTRAINT "inventory_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_items" ADD CONSTRAINT "inventory_items_inventory_location_id_inventory_locations_id_fk" FOREIGN KEY ("inventory_location_id") REFERENCES "inventory_locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_items" ADD CONSTRAINT "inventory_items_product_id_products_id_fk" FOREIGN KEY ("product_id") REFERENCES "products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_items" ADD CONSTRAINT "inventory_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_items" ADD CONSTRAINT "inventory_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_items" ADD CONSTRAINT "inventory_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_items" ADD CONSTRAINT "inventory_items_biz_inventory_location_fk" FOREIGN KEY ("biz_id","inventory_location_id") REFERENCES "inventory_locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_items" ADD CONSTRAINT "inventory_items_biz_product_fk" FOREIGN KEY ("biz_id","product_id") REFERENCES "products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_locations" ADD CONSTRAINT "inventory_locations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_locations" ADD CONSTRAINT "inventory_locations_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_locations" ADD CONSTRAINT "inventory_locations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_locations" ADD CONSTRAINT "inventory_locations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_locations" ADD CONSTRAINT "inventory_locations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_locations" ADD CONSTRAINT "inventory_locations_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_inventory_item_id_inventory_items_id_fk" FOREIGN KEY ("inventory_item_id") REFERENCES "inventory_items"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_source_inventory_location_id_inventory_locations_id_fk" FOREIGN KEY ("source_inventory_location_id") REFERENCES "inventory_locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_destination_inventory_location_id_inventory_locations_id_fk" FOREIGN KEY ("destination_inventory_location_id") REFERENCES "inventory_locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_inventory_reservation_id_inventory_reservations_id_fk" FOREIGN KEY ("inventory_reservation_id") REFERENCES "inventory_reservations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_physical_fulfillment_item_id_physical_fulfillment_items_id_fk" FOREIGN KEY ("physical_fulfillment_item_id") REFERENCES "physical_fulfillment_items"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_biz_inventory_item_fk" FOREIGN KEY ("biz_id","inventory_item_id") REFERENCES "inventory_items"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_biz_source_inventory_location_fk" FOREIGN KEY ("biz_id","source_inventory_location_id") REFERENCES "inventory_locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_biz_destination_inventory_location_fk" FOREIGN KEY ("biz_id","destination_inventory_location_id") REFERENCES "inventory_locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_biz_booking_order_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_biz_inventory_reservation_fk" FOREIGN KEY ("biz_id","inventory_reservation_id") REFERENCES "inventory_reservations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_movements" ADD CONSTRAINT "inventory_movements_biz_physical_fulfillment_item_fk" FOREIGN KEY ("biz_id","physical_fulfillment_item_id") REFERENCES "physical_fulfillment_items"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_inventory_item_id_inventory_items_id_fk" FOREIGN KEY ("inventory_item_id") REFERENCES "inventory_items"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_biz_inventory_item_fk" FOREIGN KEY ("biz_id","inventory_item_id") REFERENCES "inventory_items"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_biz_booking_order_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "inventory_reservations" ADD CONSTRAINT "inventory_reservations_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_physical_fulfillment_id_physical_fulfillments_id_fk" FOREIGN KEY ("physical_fulfillment_id") REFERENCES "physical_fulfillments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_product_id_products_id_fk" FOREIGN KEY ("product_id") REFERENCES "products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_inventory_item_id_inventory_items_id_fk" FOREIGN KEY ("inventory_item_id") REFERENCES "inventory_items"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_inventory_reservation_id_inventory_reservations_id_fk" FOREIGN KEY ("inventory_reservation_id") REFERENCES "inventory_reservations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_biz_fulfillment_fk" FOREIGN KEY ("biz_id","physical_fulfillment_id") REFERENCES "physical_fulfillments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_biz_product_fk" FOREIGN KEY ("biz_id","product_id") REFERENCES "products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_biz_booking_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_biz_inventory_item_fk" FOREIGN KEY ("biz_id","inventory_item_id") REFERENCES "inventory_items"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillment_items" ADD CONSTRAINT "physical_fulfillment_items_biz_inventory_reservation_fk" FOREIGN KEY ("biz_id","inventory_reservation_id") REFERENCES "inventory_reservations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillments" ADD CONSTRAINT "physical_fulfillments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillments" ADD CONSTRAINT "physical_fulfillments_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillments" ADD CONSTRAINT "physical_fulfillments_origin_inventory_location_id_inventory_locations_id_fk" FOREIGN KEY ("origin_inventory_location_id") REFERENCES "inventory_locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillments" ADD CONSTRAINT "physical_fulfillments_destination_location_id_locations_id_fk" FOREIGN KEY ("destination_location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillments" ADD CONSTRAINT "physical_fulfillments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillments" ADD CONSTRAINT "physical_fulfillments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillments" ADD CONSTRAINT "physical_fulfillments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillments" ADD CONSTRAINT "physical_fulfillments_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillments" ADD CONSTRAINT "physical_fulfillments_biz_origin_inventory_location_fk" FOREIGN KEY ("biz_id","origin_inventory_location_id") REFERENCES "inventory_locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "physical_fulfillments" ADD CONSTRAINT "physical_fulfillments_biz_destination_location_fk" FOREIGN KEY ("biz_id","destination_location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_product_bundle_id_product_bundles_id_fk" FOREIGN KEY ("product_bundle_id") REFERENCES "product_bundles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_product_id_products_id_fk" FOREIGN KEY ("product_id") REFERENCES "products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_offer_id_offers_id_fk" FOREIGN KEY ("offer_id") REFERENCES "offers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_biz_bundle_fk" FOREIGN KEY ("biz_id","product_bundle_id") REFERENCES "product_bundles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_biz_product_fk" FOREIGN KEY ("biz_id","product_id") REFERENCES "products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundle_components" ADD CONSTRAINT "product_bundle_components_biz_offer_fk" FOREIGN KEY ("biz_id","offer_id") REFERENCES "offers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundles" ADD CONSTRAINT "product_bundles_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundles" ADD CONSTRAINT "product_bundles_bundle_product_id_products_id_fk" FOREIGN KEY ("bundle_product_id") REFERENCES "products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundles" ADD CONSTRAINT "product_bundles_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundles" ADD CONSTRAINT "product_bundles_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundles" ADD CONSTRAINT "product_bundles_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "product_bundles" ADD CONSTRAINT "product_bundles_biz_bundle_product_fk" FOREIGN KEY ("biz_id","bundle_product_id") REFERENCES "products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_offer_versions" ADD CONSTRAINT "sellable_offer_versions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_offer_versions" ADD CONSTRAINT "sellable_offer_versions_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_offer_versions" ADD CONSTRAINT "sellable_offer_versions_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_offer_versions" ADD CONSTRAINT "sellable_offer_versions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_offer_versions" ADD CONSTRAINT "sellable_offer_versions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_offer_versions" ADD CONSTRAINT "sellable_offer_versions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_offer_versions" ADD CONSTRAINT "sellable_offer_versions_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id","sellable_kind") REFERENCES "sellables"("biz_id","id","kind") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_offer_versions" ADD CONSTRAINT "sellable_offer_versions_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_products" ADD CONSTRAINT "sellable_products_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_products" ADD CONSTRAINT "sellable_products_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_products" ADD CONSTRAINT "sellable_products_product_id_products_id_fk" FOREIGN KEY ("product_id") REFERENCES "products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_products" ADD CONSTRAINT "sellable_products_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_products" ADD CONSTRAINT "sellable_products_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_products" ADD CONSTRAINT "sellable_products_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_products" ADD CONSTRAINT "sellable_products_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id","sellable_kind") REFERENCES "sellables"("biz_id","id","kind") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_products" ADD CONSTRAINT "sellable_products_biz_product_fk" FOREIGN KEY ("biz_id","product_id") REFERENCES "products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_resource_rates" ADD CONSTRAINT "sellable_resource_rates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_resource_rates" ADD CONSTRAINT "sellable_resource_rates_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_resource_rates" ADD CONSTRAINT "sellable_resource_rates_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_resource_rates" ADD CONSTRAINT "sellable_resource_rates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_resource_rates" ADD CONSTRAINT "sellable_resource_rates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_resource_rates" ADD CONSTRAINT "sellable_resource_rates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_resource_rates" ADD CONSTRAINT "sellable_resource_rates_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id","sellable_kind") REFERENCES "sellables"("biz_id","id","kind") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_resource_rates" ADD CONSTRAINT "sellable_resource_rates_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_service_products" ADD CONSTRAINT "sellable_service_products_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_service_products" ADD CONSTRAINT "sellable_service_products_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_service_products" ADD CONSTRAINT "sellable_service_products_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_service_products" ADD CONSTRAINT "sellable_service_products_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_service_products" ADD CONSTRAINT "sellable_service_products_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_service_products" ADD CONSTRAINT "sellable_service_products_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_service_products" ADD CONSTRAINT "sellable_service_products_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id","sellable_kind") REFERENCES "sellables"("biz_id","id","kind") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_service_products" ADD CONSTRAINT "sellable_service_products_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellables" ADD CONSTRAINT "sellables_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellables" ADD CONSTRAINT "sellables_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellables" ADD CONSTRAINT "sellables_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellables" ADD CONSTRAINT "sellables_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimension_values" ADD CONSTRAINT "sellable_variant_dimension_values_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimension_values" ADD CONSTRAINT "sellable_variant_dimension_values_sellable_variant_dimension_id_sellable_variant_dimensions_id_fk" FOREIGN KEY ("sellable_variant_dimension_id") REFERENCES "sellable_variant_dimensions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimension_values" ADD CONSTRAINT "sellable_variant_dimension_values_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimension_values" ADD CONSTRAINT "sellable_variant_dimension_values_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimension_values" ADD CONSTRAINT "sellable_variant_dimension_values_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimension_values" ADD CONSTRAINT "sellable_variant_dimension_values_biz_dimension_fk" FOREIGN KEY ("biz_id","sellable_variant_dimension_id") REFERENCES "sellable_variant_dimensions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimensions" ADD CONSTRAINT "sellable_variant_dimensions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimensions" ADD CONSTRAINT "sellable_variant_dimensions_base_sellable_id_sellables_id_fk" FOREIGN KEY ("base_sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimensions" ADD CONSTRAINT "sellable_variant_dimensions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimensions" ADD CONSTRAINT "sellable_variant_dimensions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimensions" ADD CONSTRAINT "sellable_variant_dimensions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_dimensions" ADD CONSTRAINT "sellable_variant_dimensions_biz_base_sellable_fk" FOREIGN KEY ("biz_id","base_sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_sellable_variant_id_sellable_variants_id_fk" FOREIGN KEY ("sellable_variant_id") REFERENCES "sellable_variants"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_base_sellable_id_sellables_id_fk" FOREIGN KEY ("base_sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_sellable_variant_dimension_id_sellable_variant_dimensions_id_fk" FOREIGN KEY ("sellable_variant_dimension_id") REFERENCES "sellable_variant_dimensions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_sellable_variant_dimension_value_id_sellable_variant_dimension_values_id_fk" FOREIGN KEY ("sellable_variant_dimension_value_id") REFERENCES "sellable_variant_dimension_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_biz_base_sellable_fk" FOREIGN KEY ("biz_id","base_sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_biz_variant_fk" FOREIGN KEY ("biz_id","sellable_variant_id","base_sellable_id") REFERENCES "sellable_variants"("biz_id","id","base_sellable_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_biz_dimension_fk" FOREIGN KEY ("biz_id","sellable_variant_dimension_id","base_sellable_id") REFERENCES "sellable_variant_dimensions"("biz_id","id","base_sellable_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variant_selections" ADD CONSTRAINT "sellable_variant_selections_biz_value_fk" FOREIGN KEY ("biz_id","sellable_variant_dimension_value_id","sellable_variant_dimension_id") REFERENCES "sellable_variant_dimension_values"("biz_id","id","sellable_variant_dimension_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variants" ADD CONSTRAINT "sellable_variants_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variants" ADD CONSTRAINT "sellable_variants_base_sellable_id_sellables_id_fk" FOREIGN KEY ("base_sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variants" ADD CONSTRAINT "sellable_variants_variant_sellable_id_sellables_id_fk" FOREIGN KEY ("variant_sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variants" ADD CONSTRAINT "sellable_variants_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variants" ADD CONSTRAINT "sellable_variants_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variants" ADD CONSTRAINT "sellable_variants_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variants" ADD CONSTRAINT "sellable_variants_biz_base_sellable_fk" FOREIGN KEY ("biz_id","base_sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_variants" ADD CONSTRAINT "sellable_variants_biz_variant_sellable_fk" FOREIGN KEY ("biz_id","variant_sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_modes" ADD CONSTRAINT "sellable_pricing_modes_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_modes" ADD CONSTRAINT "sellable_pricing_modes_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_modes" ADD CONSTRAINT "sellable_pricing_modes_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_modes" ADD CONSTRAINT "sellable_pricing_modes_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_modes" ADD CONSTRAINT "sellable_pricing_modes_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_modes" ADD CONSTRAINT "sellable_pricing_modes_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_overrides" ADD CONSTRAINT "sellable_pricing_overrides_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_overrides" ADD CONSTRAINT "sellable_pricing_overrides_sellable_pricing_mode_id_sellable_pricing_modes_id_fk" FOREIGN KEY ("sellable_pricing_mode_id") REFERENCES "sellable_pricing_modes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_overrides" ADD CONSTRAINT "sellable_pricing_overrides_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_overrides" ADD CONSTRAINT "sellable_pricing_overrides_channel_account_id_channel_accounts_id_fk" FOREIGN KEY ("channel_account_id") REFERENCES "channel_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_overrides" ADD CONSTRAINT "sellable_pricing_overrides_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_overrides" ADD CONSTRAINT "sellable_pricing_overrides_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_overrides" ADD CONSTRAINT "sellable_pricing_overrides_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_overrides" ADD CONSTRAINT "sellable_pricing_overrides_biz_mode_fk" FOREIGN KEY ("biz_id","sellable_pricing_mode_id") REFERENCES "sellable_pricing_modes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_overrides" ADD CONSTRAINT "sellable_pricing_overrides_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_overrides" ADD CONSTRAINT "sellable_pricing_overrides_biz_channel_fk" FOREIGN KEY ("biz_id","channel_account_id") REFERENCES "channel_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_overrides" ADD CONSTRAINT "sellable_pricing_overrides_biz_subject_fk" FOREIGN KEY ("biz_id","custom_subject_type","custom_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_thresholds" ADD CONSTRAINT "sellable_pricing_thresholds_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_thresholds" ADD CONSTRAINT "sellable_pricing_thresholds_sellable_pricing_mode_id_sellable_pricing_modes_id_fk" FOREIGN KEY ("sellable_pricing_mode_id") REFERENCES "sellable_pricing_modes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_thresholds" ADD CONSTRAINT "sellable_pricing_thresholds_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_thresholds" ADD CONSTRAINT "sellable_pricing_thresholds_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_thresholds" ADD CONSTRAINT "sellable_pricing_thresholds_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sellable_pricing_thresholds" ADD CONSTRAINT "sellable_pricing_thresholds_biz_mode_fk" FOREIGN KEY ("biz_id","sellable_pricing_mode_id") REFERENCES "sellable_pricing_modes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_groups" ADD CONSTRAINT "service_product_requirement_groups_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_groups" ADD CONSTRAINT "service_product_requirement_groups_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_groups" ADD CONSTRAINT "service_product_requirement_groups_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_groups" ADD CONSTRAINT "service_product_requirement_groups_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_groups" ADD CONSTRAINT "service_product_requirement_groups_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_groups" ADD CONSTRAINT "service_product_requirement_groups_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_requirement_group_id_service_product_requirement_groups_id_fk" FOREIGN KEY ("requirement_group_id") REFERENCES "service_product_requirement_groups"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_capability_template_id_resource_capability_templates_id_fk" FOREIGN KEY ("capability_template_id") REFERENCES "resource_capability_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_biz_group_fk" FOREIGN KEY ("biz_id","requirement_group_id") REFERENCES "service_product_requirement_groups"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_biz_subject_fk" FOREIGN KEY ("biz_id","subject_type","subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_biz_capability_template_fk" FOREIGN KEY ("biz_id","capability_template_id") REFERENCES "resource_capability_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_requirement_selectors" ADD CONSTRAINT "service_product_requirement_selectors_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_type_requirements" ADD CONSTRAINT "service_product_seat_type_requirements_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_type_requirements" ADD CONSTRAINT "service_product_seat_type_requirements_seat_type_id_service_product_seat_types_id_fk" FOREIGN KEY ("seat_type_id") REFERENCES "service_product_seat_types"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_type_requirements" ADD CONSTRAINT "service_product_seat_type_requirements_requirement_group_id_service_product_requirement_groups_id_fk" FOREIGN KEY ("requirement_group_id") REFERENCES "service_product_requirement_groups"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_type_requirements" ADD CONSTRAINT "service_product_seat_type_requirements_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_type_requirements" ADD CONSTRAINT "service_product_seat_type_requirements_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_type_requirements" ADD CONSTRAINT "service_product_seat_type_requirements_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_type_requirements" ADD CONSTRAINT "service_product_seat_type_requirements_biz_seat_type_fk" FOREIGN KEY ("biz_id","seat_type_id") REFERENCES "service_product_seat_types"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_type_requirements" ADD CONSTRAINT "service_product_seat_type_requirements_biz_requirement_group_fk" FOREIGN KEY ("biz_id","requirement_group_id") REFERENCES "service_product_requirement_groups"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_types" ADD CONSTRAINT "service_product_seat_types_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_types" ADD CONSTRAINT "service_product_seat_types_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_types" ADD CONSTRAINT "service_product_seat_types_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_types" ADD CONSTRAINT "service_product_seat_types_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_types" ADD CONSTRAINT "service_product_seat_types_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_types" ADD CONSTRAINT "service_product_seat_types_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_types" ADD CONSTRAINT "service_product_seat_types_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_seat_types" ADD CONSTRAINT "service_product_seat_types_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_services" ADD CONSTRAINT "service_product_services_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_services" ADD CONSTRAINT "service_product_services_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_services" ADD CONSTRAINT "service_product_services_service_id_services_id_fk" FOREIGN KEY ("service_id") REFERENCES "services"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_services" ADD CONSTRAINT "service_product_services_service_group_id_service_groups_id_fk" FOREIGN KEY ("service_group_id") REFERENCES "service_groups"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_services" ADD CONSTRAINT "service_product_services_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_services" ADD CONSTRAINT "service_product_services_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_services" ADD CONSTRAINT "service_product_services_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_services" ADD CONSTRAINT "service_product_services_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_services" ADD CONSTRAINT "service_product_services_biz_service_fk" FOREIGN KEY ("biz_id","service_id") REFERENCES "services"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_product_services" ADD CONSTRAINT "service_product_services_biz_service_group_fk" FOREIGN KEY ("biz_id","service_group_id") REFERENCES "service_groups"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_products" ADD CONSTRAINT "service_products_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_products" ADD CONSTRAINT "service_products_product_id_products_id_fk" FOREIGN KEY ("product_id") REFERENCES "products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_products" ADD CONSTRAINT "service_products_kind_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("kind_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_products" ADD CONSTRAINT "service_products_duration_mode_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("duration_mode_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_products" ADD CONSTRAINT "service_products_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_products" ADD CONSTRAINT "service_products_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_products" ADD CONSTRAINT "service_products_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_products" ADD CONSTRAINT "service_products_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_products" ADD CONSTRAINT "service_products_biz_kind_config_fk" FOREIGN KEY ("biz_id","kind_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_products" ADD CONSTRAINT "service_products_biz_duration_mode_config_fk" FOREIGN KEY ("biz_id","duration_mode_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_products" ADD CONSTRAINT "service_products_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assets" ADD CONSTRAINT "assets_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assets" ADD CONSTRAINT "assets_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assets" ADD CONSTRAINT "assets_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assets" ADD CONSTRAINT "assets_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assets" ADD CONSTRAINT "assets_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assets" ADD CONSTRAINT "assets_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "venues" ADD CONSTRAINT "venues_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "venues" ADD CONSTRAINT "venues_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "venues" ADD CONSTRAINT "venues_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "venues" ADD CONSTRAINT "venues_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "venues" ADD CONSTRAINT "venues_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "venues" ADD CONSTRAINT "venues_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_group_members" ADD CONSTRAINT "host_group_members_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_group_members" ADD CONSTRAINT "host_group_members_host_group_id_host_groups_id_fk" FOREIGN KEY ("host_group_id") REFERENCES "host_groups"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_group_members" ADD CONSTRAINT "host_group_members_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_group_members" ADD CONSTRAINT "host_group_members_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_group_members" ADD CONSTRAINT "host_group_members_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_group_members" ADD CONSTRAINT "host_group_members_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_groups" ADD CONSTRAINT "host_groups_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_groups" ADD CONSTRAINT "host_groups_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_groups" ADD CONSTRAINT "host_groups_group_account_id_group_accounts_id_fk" FOREIGN KEY ("group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_groups" ADD CONSTRAINT "host_groups_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_groups" ADD CONSTRAINT "host_groups_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_groups" ADD CONSTRAINT "host_groups_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_users" ADD CONSTRAINT "host_users_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_users" ADD CONSTRAINT "host_users_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_users" ADD CONSTRAINT "host_users_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_users" ADD CONSTRAINT "host_users_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_users" ADD CONSTRAINT "host_users_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "host_users" ADD CONSTRAINT "host_users_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_service_capabilities" ADD CONSTRAINT "resource_service_capabilities_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_service_capabilities" ADD CONSTRAINT "resource_service_capabilities_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_service_capabilities" ADD CONSTRAINT "resource_service_capabilities_service_id_services_id_fk" FOREIGN KEY ("service_id") REFERENCES "services"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_service_capabilities" ADD CONSTRAINT "resource_service_capabilities_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_service_capabilities" ADD CONSTRAINT "resource_service_capabilities_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_service_capabilities" ADD CONSTRAINT "resource_service_capabilities_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_service_capabilities" ADD CONSTRAINT "resource_service_capabilities_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_status_definitions" ADD CONSTRAINT "resource_status_definitions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_status_definitions" ADD CONSTRAINT "resource_status_definitions_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_status_definitions" ADD CONSTRAINT "resource_status_definitions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_status_definitions" ADD CONSTRAINT "resource_status_definitions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_status_definitions" ADD CONSTRAINT "resource_status_definitions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_status_definition_id_resource_status_definitions_id_fk" FOREIGN KEY ("status_definition_id") REFERENCES "resource_status_definitions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_host_user_id_users_id_fk" FOREIGN KEY ("host_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_group_account_id_group_accounts_id_fk" FOREIGN KEY ("group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_asset_id_assets_id_fk" FOREIGN KEY ("asset_id") REFERENCES "assets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_venue_id_venues_id_fk" FOREIGN KEY ("venue_id") REFERENCES "venues"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_biz_status_definition_fk" FOREIGN KEY ("biz_id","status_definition_id") REFERENCES "resource_status_definitions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_biz_group_account_fk" FOREIGN KEY ("biz_id","group_account_id") REFERENCES "group_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_biz_asset_fk" FOREIGN KEY ("biz_id","asset_id") REFERENCES "assets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resources" ADD CONSTRAINT "resources_biz_venue_fk" FOREIGN KEY ("biz_id","venue_id") REFERENCES "venues"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_accounts" ADD CONSTRAINT "stripe_accounts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_accounts" ADD CONSTRAINT "stripe_accounts_payment_processor_account_id_payment_processor_accounts_id_fk" FOREIGN KEY ("payment_processor_account_id") REFERENCES "payment_processor_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_accounts" ADD CONSTRAINT "stripe_accounts_biz_processor_account_fk" FOREIGN KEY ("biz_id","payment_processor_account_id") REFERENCES "payment_processor_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_checkout_sessions" ADD CONSTRAINT "stripe_checkout_sessions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_checkout_sessions" ADD CONSTRAINT "stripe_checkout_sessions_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_checkout_sessions" ADD CONSTRAINT "stripe_checkout_sessions_cross_biz_order_id_cross_biz_orders_id_fk" FOREIGN KEY ("cross_biz_order_id") REFERENCES "cross_biz_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_checkout_sessions" ADD CONSTRAINT "stripe_checkout_sessions_payment_intent_ref_id_payment_intents_id_fk" FOREIGN KEY ("payment_intent_ref_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_checkout_sessions" ADD CONSTRAINT "stripe_checkout_sessions_stripe_customer_ref_id_stripe_customers_id_fk" FOREIGN KEY ("stripe_customer_ref_id") REFERENCES "stripe_customers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_checkout_sessions" ADD CONSTRAINT "stripe_checkout_sessions_stripe_account_ref_id_stripe_accounts_id_fk" FOREIGN KEY ("stripe_account_ref_id") REFERENCES "stripe_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_checkout_sessions" ADD CONSTRAINT "stripe_checkout_sessions_biz_account_fk" FOREIGN KEY ("biz_id","stripe_account_ref_id") REFERENCES "stripe_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_customers" ADD CONSTRAINT "stripe_customers_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_customers" ADD CONSTRAINT "stripe_customers_stripe_account_ref_id_stripe_accounts_id_fk" FOREIGN KEY ("stripe_account_ref_id") REFERENCES "stripe_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_customers" ADD CONSTRAINT "stripe_customers_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_customers" ADD CONSTRAINT "stripe_customers_group_account_id_group_accounts_id_fk" FOREIGN KEY ("group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_customers" ADD CONSTRAINT "stripe_customers_biz_account_fk" FOREIGN KEY ("biz_id","stripe_account_ref_id") REFERENCES "stripe_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_invoices" ADD CONSTRAINT "stripe_invoices_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_invoices" ADD CONSTRAINT "stripe_invoices_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_invoices" ADD CONSTRAINT "stripe_invoices_cross_biz_order_id_cross_biz_orders_id_fk" FOREIGN KEY ("cross_biz_order_id") REFERENCES "cross_biz_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_invoices" ADD CONSTRAINT "stripe_invoices_stripe_customer_ref_id_stripe_customers_id_fk" FOREIGN KEY ("stripe_customer_ref_id") REFERENCES "stripe_customers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_invoices" ADD CONSTRAINT "stripe_invoices_stripe_account_ref_id_stripe_accounts_id_fk" FOREIGN KEY ("stripe_account_ref_id") REFERENCES "stripe_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_invoices" ADD CONSTRAINT "stripe_invoices_biz_account_fk" FOREIGN KEY ("biz_id","stripe_account_ref_id") REFERENCES "stripe_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_payment_methods" ADD CONSTRAINT "stripe_payment_methods_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_payment_methods" ADD CONSTRAINT "stripe_payment_methods_stripe_customer_ref_id_stripe_customers_id_fk" FOREIGN KEY ("stripe_customer_ref_id") REFERENCES "stripe_customers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_payouts" ADD CONSTRAINT "stripe_payouts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_payouts" ADD CONSTRAINT "stripe_payouts_stripe_account_ref_id_stripe_accounts_id_fk" FOREIGN KEY ("stripe_account_ref_id") REFERENCES "stripe_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_payouts" ADD CONSTRAINT "stripe_payouts_biz_account_fk" FOREIGN KEY ("biz_id","stripe_account_ref_id") REFERENCES "stripe_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_setup_intents" ADD CONSTRAINT "stripe_setup_intents_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_setup_intents" ADD CONSTRAINT "stripe_setup_intents_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_setup_intents" ADD CONSTRAINT "stripe_setup_intents_group_account_id_group_accounts_id_fk" FOREIGN KEY ("group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_setup_intents" ADD CONSTRAINT "stripe_setup_intents_stripe_customer_ref_id_stripe_customers_id_fk" FOREIGN KEY ("stripe_customer_ref_id") REFERENCES "stripe_customers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_transfers" ADD CONSTRAINT "stripe_transfers_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_transfers" ADD CONSTRAINT "stripe_transfers_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_transfers" ADD CONSTRAINT "stripe_transfers_cross_biz_order_id_cross_biz_orders_id_fk" FOREIGN KEY ("cross_biz_order_id") REFERENCES "cross_biz_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_transfers" ADD CONSTRAINT "stripe_transfers_payment_intent_ref_id_payment_intents_id_fk" FOREIGN KEY ("payment_intent_ref_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_transfers" ADD CONSTRAINT "stripe_transfers_payment_transaction_ref_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_ref_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_transfers" ADD CONSTRAINT "stripe_transfers_destination_account_ref_id_stripe_accounts_id_fk" FOREIGN KEY ("destination_account_ref_id") REFERENCES "stripe_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_transfers" ADD CONSTRAINT "stripe_transfers_biz_destination_account_fk" FOREIGN KEY ("biz_id","destination_account_ref_id") REFERENCES "stripe_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_webhook_events" ADD CONSTRAINT "stripe_webhook_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_webhook_events" ADD CONSTRAINT "stripe_webhook_events_stripe_account_ref_id_stripe_accounts_id_fk" FOREIGN KEY ("stripe_account_ref_id") REFERENCES "stripe_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "stripe_webhook_events" ADD CONSTRAINT "stripe_webhook_events_biz_account_fk" FOREIGN KEY ("biz_id","stripe_account_ref_id") REFERENCES "stripe_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_location_bindings" ADD CONSTRAINT "subject_location_bindings_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_location_bindings" ADD CONSTRAINT "subject_location_bindings_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_location_bindings" ADD CONSTRAINT "subject_location_bindings_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_location_bindings" ADD CONSTRAINT "subject_location_bindings_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_location_bindings" ADD CONSTRAINT "subject_location_bindings_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_location_bindings" ADD CONSTRAINT "subject_location_bindings_biz_subject_fk" FOREIGN KEY ("biz_id","subject_type","subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_location_bindings" ADD CONSTRAINT "subject_location_bindings_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_relationships" ADD CONSTRAINT "subject_relationships_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_relationships" ADD CONSTRAINT "subject_relationships_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_relationships" ADD CONSTRAINT "subject_relationships_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_relationships" ADD CONSTRAINT "subject_relationships_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_relationships" ADD CONSTRAINT "subject_relationships_biz_from_subject_fk" FOREIGN KEY ("biz_id","from_subject_type","from_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subject_relationships" ADD CONSTRAINT "subject_relationships_biz_to_subject_fk" FOREIGN KEY ("biz_id","to_subject_type","to_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subjects" ADD CONSTRAINT "subjects_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subjects" ADD CONSTRAINT "subjects_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subjects" ADD CONSTRAINT "subjects_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "subjects" ADD CONSTRAINT "subjects_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_seat_types" ADD CONSTRAINT "offer_component_seat_types_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_seat_types" ADD CONSTRAINT "offer_component_seat_types_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_seat_types" ADD CONSTRAINT "offer_component_seat_types_component_id_offer_components_id_fk" FOREIGN KEY ("component_id") REFERENCES "offer_components"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_seat_types" ADD CONSTRAINT "offer_component_seat_types_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_seat_types" ADD CONSTRAINT "offer_component_seat_types_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_seat_types" ADD CONSTRAINT "offer_component_seat_types_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_seat_types" ADD CONSTRAINT "offer_component_seat_types_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_seat_types" ADD CONSTRAINT "offer_component_seat_types_biz_component_fk" FOREIGN KEY ("biz_id","component_id") REFERENCES "offer_components"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_component_id_offer_components_id_fk" FOREIGN KEY ("component_id") REFERENCES "offer_components"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_capability_template_id_resource_capability_templates_id_fk" FOREIGN KEY ("capability_template_id") REFERENCES "resource_capability_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_biz_component_fk" FOREIGN KEY ("biz_id","component_id") REFERENCES "offer_components"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_biz_capability_template_fk" FOREIGN KEY ("biz_id","capability_template_id") REFERENCES "resource_capability_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_component_selectors" ADD CONSTRAINT "offer_component_selectors_biz_subject_fk" FOREIGN KEY ("biz_id","subject_type","subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_components" ADD CONSTRAINT "offer_components_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_components" ADD CONSTRAINT "offer_components_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_components" ADD CONSTRAINT "offer_components_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_components" ADD CONSTRAINT "offer_components_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_components" ADD CONSTRAINT "offer_components_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_components" ADD CONSTRAINT "offer_components_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_version_admission_modes" ADD CONSTRAINT "offer_version_admission_modes_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_version_admission_modes" ADD CONSTRAINT "offer_version_admission_modes_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_version_admission_modes" ADD CONSTRAINT "offer_version_admission_modes_mode_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("mode_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_version_admission_modes" ADD CONSTRAINT "offer_version_admission_modes_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_version_admission_modes" ADD CONSTRAINT "offer_version_admission_modes_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_version_admission_modes" ADD CONSTRAINT "offer_version_admission_modes_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_version_admission_modes" ADD CONSTRAINT "offer_version_admission_modes_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_version_admission_modes" ADD CONSTRAINT "offer_version_admission_modes_biz_mode_config_fk" FOREIGN KEY ("biz_id","mode_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_versions" ADD CONSTRAINT "offer_versions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_versions" ADD CONSTRAINT "offer_versions_offer_id_offers_id_fk" FOREIGN KEY ("offer_id") REFERENCES "offers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_versions" ADD CONSTRAINT "offer_versions_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_versions" ADD CONSTRAINT "offer_versions_duration_mode_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("duration_mode_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_versions" ADD CONSTRAINT "offer_versions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_versions" ADD CONSTRAINT "offer_versions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_versions" ADD CONSTRAINT "offer_versions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_versions" ADD CONSTRAINT "offer_versions_biz_offer_fk" FOREIGN KEY ("biz_id","offer_id") REFERENCES "offers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_versions" ADD CONSTRAINT "offer_versions_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offer_versions" ADD CONSTRAINT "offer_versions_biz_duration_mode_config_fk" FOREIGN KEY ("biz_id","duration_mode_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offers" ADD CONSTRAINT "offers_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offers" ADD CONSTRAINT "offers_execution_mode_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("execution_mode_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offers" ADD CONSTRAINT "offers_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offers" ADD CONSTRAINT "offers_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offers" ADD CONSTRAINT "offers_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offers" ADD CONSTRAINT "offers_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offers" ADD CONSTRAINT "offers_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offers" ADD CONSTRAINT "offers_biz_execution_mode_config_fk" FOREIGN KEY ("biz_id","execution_mode_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_assignments" ADD CONSTRAINT "resource_capability_assignments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_assignments" ADD CONSTRAINT "resource_capability_assignments_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_assignments" ADD CONSTRAINT "resource_capability_assignments_capability_template_id_resource_capability_templates_id_fk" FOREIGN KEY ("capability_template_id") REFERENCES "resource_capability_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_assignments" ADD CONSTRAINT "resource_capability_assignments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_assignments" ADD CONSTRAINT "resource_capability_assignments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_assignments" ADD CONSTRAINT "resource_capability_assignments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_assignments" ADD CONSTRAINT "resource_capability_assignments_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_assignments" ADD CONSTRAINT "resource_capability_assignments_biz_capability_fk" FOREIGN KEY ("biz_id","capability_template_id") REFERENCES "resource_capability_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_templates" ADD CONSTRAINT "resource_capability_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_templates" ADD CONSTRAINT "resource_capability_templates_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_templates" ADD CONSTRAINT "resource_capability_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_templates" ADD CONSTRAINT "resource_capability_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_templates" ADD CONSTRAINT "resource_capability_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_capability_templates" ADD CONSTRAINT "resource_capability_templates_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_condition_reports" ADD CONSTRAINT "resource_condition_reports_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_condition_reports" ADD CONSTRAINT "resource_condition_reports_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_condition_reports" ADD CONSTRAINT "resource_condition_reports_reporter_user_id_users_id_fk" FOREIGN KEY ("reporter_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_condition_reports" ADD CONSTRAINT "resource_condition_reports_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_condition_reports" ADD CONSTRAINT "resource_condition_reports_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_condition_reports" ADD CONSTRAINT "resource_condition_reports_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_condition_reports" ADD CONSTRAINT "resource_condition_reports_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_condition_reports" ADD CONSTRAINT "resource_condition_reports_reporter_fk" FOREIGN KEY ("reporter_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_policies" ADD CONSTRAINT "resource_maintenance_policies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_policies" ADD CONSTRAINT "resource_maintenance_policies_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_policies" ADD CONSTRAINT "resource_maintenance_policies_capability_template_id_resource_capability_templates_id_fk" FOREIGN KEY ("capability_template_id") REFERENCES "resource_capability_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_policies" ADD CONSTRAINT "resource_maintenance_policies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_policies" ADD CONSTRAINT "resource_maintenance_policies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_policies" ADD CONSTRAINT "resource_maintenance_policies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_policies" ADD CONSTRAINT "resource_maintenance_policies_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_policies" ADD CONSTRAINT "resource_maintenance_policies_biz_capability_fk" FOREIGN KEY ("biz_id","capability_template_id") REFERENCES "resource_capability_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_policy_id_resource_maintenance_policies_id_fk" FOREIGN KEY ("policy_id") REFERENCES "resource_maintenance_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_calendar_id_calendars_id_fk" FOREIGN KEY ("calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_calendar_timeline_event_id_calendar_timeline_events_id_fk" FOREIGN KEY ("calendar_timeline_event_id") REFERENCES "calendar_timeline_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_biz_policy_fk" FOREIGN KEY ("biz_id","policy_id") REFERENCES "resource_maintenance_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_biz_calendar_fk" FOREIGN KEY ("biz_id","calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_maintenance_work_orders" ADD CONSTRAINT "resource_maintenance_work_orders_biz_timeline_event_fk" FOREIGN KEY ("biz_id","calendar_timeline_event_id") REFERENCES "calendar_timeline_events"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_usage_counters" ADD CONSTRAINT "resource_usage_counters_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_usage_counters" ADD CONSTRAINT "resource_usage_counters_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_usage_counters" ADD CONSTRAINT "resource_usage_counters_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_usage_counters" ADD CONSTRAINT "resource_usage_counters_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_usage_counters" ADD CONSTRAINT "resource_usage_counters_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "resource_usage_counters" ADD CONSTRAINT "resource_usage_counters_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rule_targets" ADD CONSTRAINT "availability_dependency_rule_targets_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rule_targets" ADD CONSTRAINT "availability_dependency_rule_targets_availability_dependency_rule_id_availability_dependency_rules_id_fk" FOREIGN KEY ("availability_dependency_rule_id") REFERENCES "availability_dependency_rules"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rule_targets" ADD CONSTRAINT "availability_dependency_rule_targets_required_calendar_id_calendars_id_fk" FOREIGN KEY ("required_calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rule_targets" ADD CONSTRAINT "availability_dependency_rule_targets_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rule_targets" ADD CONSTRAINT "availability_dependency_rule_targets_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rule_targets" ADD CONSTRAINT "availability_dependency_rule_targets_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rule_targets" ADD CONSTRAINT "availability_dependency_rule_targets_biz_rule_fk" FOREIGN KEY ("biz_id","availability_dependency_rule_id") REFERENCES "availability_dependency_rules"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rule_targets" ADD CONSTRAINT "availability_dependency_rule_targets_biz_calendar_fk" FOREIGN KEY ("biz_id","required_calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rule_targets" ADD CONSTRAINT "availability_dependency_rule_targets_biz_subject_fk" FOREIGN KEY ("biz_id","required_subject_type","required_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rules" ADD CONSTRAINT "availability_dependency_rules_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rules" ADD CONSTRAINT "availability_dependency_rules_dependent_calendar_id_calendars_id_fk" FOREIGN KEY ("dependent_calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rules" ADD CONSTRAINT "availability_dependency_rules_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rules" ADD CONSTRAINT "availability_dependency_rules_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rules" ADD CONSTRAINT "availability_dependency_rules_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_dependency_rules" ADD CONSTRAINT "availability_dependency_rules_biz_calendar_fk" FOREIGN KEY ("biz_id","dependent_calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_gates" ADD CONSTRAINT "availability_gates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_gates" ADD CONSTRAINT "availability_gates_calendar_id_calendars_id_fk" FOREIGN KEY ("calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_gates" ADD CONSTRAINT "availability_gates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_gates" ADD CONSTRAINT "availability_gates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_gates" ADD CONSTRAINT "availability_gates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_gates" ADD CONSTRAINT "availability_gates_biz_calendar_fk" FOREIGN KEY ("biz_id","calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_resolution_runs" ADD CONSTRAINT "availability_resolution_runs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_resolution_runs" ADD CONSTRAINT "availability_resolution_runs_calendar_id_calendars_id_fk" FOREIGN KEY ("calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_resolution_runs" ADD CONSTRAINT "availability_resolution_runs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_resolution_runs" ADD CONSTRAINT "availability_resolution_runs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_resolution_runs" ADD CONSTRAINT "availability_resolution_runs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_resolution_runs" ADD CONSTRAINT "availability_resolution_runs_biz_calendar_fk" FOREIGN KEY ("biz_id","calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_exclusion_dates" ADD CONSTRAINT "availability_rule_exclusion_dates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_exclusion_dates" ADD CONSTRAINT "availability_rule_exclusion_dates_availability_rule_id_availability_rules_id_fk" FOREIGN KEY ("availability_rule_id") REFERENCES "availability_rules"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_exclusion_dates" ADD CONSTRAINT "availability_rule_exclusion_dates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_exclusion_dates" ADD CONSTRAINT "availability_rule_exclusion_dates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_exclusion_dates" ADD CONSTRAINT "availability_rule_exclusion_dates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_exclusion_dates" ADD CONSTRAINT "availability_rule_exclusion_dates_biz_rule_fk" FOREIGN KEY ("biz_id","availability_rule_id") REFERENCES "availability_rules"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_template_items" ADD CONSTRAINT "availability_rule_template_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_template_items" ADD CONSTRAINT "availability_rule_template_items_availability_rule_template_id_availability_rule_templates_id_fk" FOREIGN KEY ("availability_rule_template_id") REFERENCES "availability_rule_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_template_items" ADD CONSTRAINT "availability_rule_template_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_template_items" ADD CONSTRAINT "availability_rule_template_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_template_items" ADD CONSTRAINT "availability_rule_template_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_template_items" ADD CONSTRAINT "availability_rule_template_items_biz_template_fk" FOREIGN KEY ("biz_id","availability_rule_template_id") REFERENCES "availability_rule_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_templates" ADD CONSTRAINT "availability_rule_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_templates" ADD CONSTRAINT "availability_rule_templates_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_templates" ADD CONSTRAINT "availability_rule_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_templates" ADD CONSTRAINT "availability_rule_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_templates" ADD CONSTRAINT "availability_rule_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rule_templates" ADD CONSTRAINT "availability_rule_templates_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rules" ADD CONSTRAINT "availability_rules_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rules" ADD CONSTRAINT "availability_rules_calendar_id_calendars_id_fk" FOREIGN KEY ("calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rules" ADD CONSTRAINT "availability_rules_overlay_id_calendar_overlays_id_fk" FOREIGN KEY ("overlay_id") REFERENCES "calendar_overlays"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rules" ADD CONSTRAINT "availability_rules_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rules" ADD CONSTRAINT "availability_rules_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rules" ADD CONSTRAINT "availability_rules_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rules" ADD CONSTRAINT "availability_rules_biz_calendar_fk" FOREIGN KEY ("biz_id","calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "availability_rules" ADD CONSTRAINT "availability_rules_biz_overlay_fk" FOREIGN KEY ("biz_id","overlay_id") REFERENCES "calendar_overlays"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_calendar_id_calendars_id_fk" FOREIGN KEY ("calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_service_id_services_id_fk" FOREIGN KEY ("service_id") REFERENCES "services"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_offer_id_offers_id_fk" FOREIGN KEY ("offer_id") REFERENCES "offers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_biz_calendar_fk" FOREIGN KEY ("biz_id","calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_biz_service_fk" FOREIGN KEY ("biz_id","service_id") REFERENCES "services"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_biz_offer_fk" FOREIGN KEY ("biz_id","offer_id") REFERENCES "offers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_bindings" ADD CONSTRAINT "calendar_bindings_biz_owner_ref_subject_fk" FOREIGN KEY ("biz_id","owner_ref_type","owner_ref_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_overlays" ADD CONSTRAINT "calendar_overlays_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_overlays" ADD CONSTRAINT "calendar_overlays_calendar_id_calendars_id_fk" FOREIGN KEY ("calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_overlays" ADD CONSTRAINT "calendar_overlays_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_overlays" ADD CONSTRAINT "calendar_overlays_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_overlays" ADD CONSTRAINT "calendar_overlays_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_overlays" ADD CONSTRAINT "calendar_overlays_biz_calendar_fk" FOREIGN KEY ("biz_id","calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_revisions" ADD CONSTRAINT "calendar_revisions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_revisions" ADD CONSTRAINT "calendar_revisions_calendar_id_calendars_id_fk" FOREIGN KEY ("calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_revisions" ADD CONSTRAINT "calendar_revisions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_revisions" ADD CONSTRAINT "calendar_revisions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_revisions" ADD CONSTRAINT "calendar_revisions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_revisions" ADD CONSTRAINT "calendar_revisions_biz_calendar_fk" FOREIGN KEY ("biz_id","calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_binding_exclusion_dates" ADD CONSTRAINT "calendar_rule_template_binding_exclusion_dates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_binding_exclusion_dates" ADD CONSTRAINT "calendar_rule_template_binding_exclusion_dates_calendar_rule_template_binding_id_calendar_rule_template_bindings_id_fk" FOREIGN KEY ("calendar_rule_template_binding_id") REFERENCES "calendar_rule_template_bindings"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_binding_exclusion_dates" ADD CONSTRAINT "calendar_rule_template_binding_exclusion_dates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_binding_exclusion_dates" ADD CONSTRAINT "calendar_rule_template_binding_exclusion_dates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_binding_exclusion_dates" ADD CONSTRAINT "calendar_rule_template_binding_exclusion_dates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_binding_exclusion_dates" ADD CONSTRAINT "calendar_rule_template_binding_excl_dates_biz_binding_fk" FOREIGN KEY ("biz_id","calendar_rule_template_binding_id") REFERENCES "calendar_rule_template_bindings"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_bindings" ADD CONSTRAINT "calendar_rule_template_bindings_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_bindings" ADD CONSTRAINT "calendar_rule_template_bindings_calendar_id_calendars_id_fk" FOREIGN KEY ("calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_bindings" ADD CONSTRAINT "calendar_rule_template_bindings_availability_rule_template_id_availability_rule_templates_id_fk" FOREIGN KEY ("availability_rule_template_id") REFERENCES "availability_rule_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_bindings" ADD CONSTRAINT "calendar_rule_template_bindings_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_bindings" ADD CONSTRAINT "calendar_rule_template_bindings_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_bindings" ADD CONSTRAINT "calendar_rule_template_bindings_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_bindings" ADD CONSTRAINT "calendar_rule_template_bindings_biz_calendar_fk" FOREIGN KEY ("biz_id","calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_rule_template_bindings" ADD CONSTRAINT "calendar_rule_template_bindings_biz_template_fk" FOREIGN KEY ("biz_id","availability_rule_template_id") REFERENCES "availability_rule_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_timeline_events" ADD CONSTRAINT "calendar_timeline_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_timeline_events" ADD CONSTRAINT "calendar_timeline_events_calendar_id_calendars_id_fk" FOREIGN KEY ("calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_timeline_events" ADD CONSTRAINT "calendar_timeline_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_timeline_events" ADD CONSTRAINT "calendar_timeline_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_timeline_events" ADD CONSTRAINT "calendar_timeline_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_timeline_events" ADD CONSTRAINT "calendar_timeline_events_biz_calendar_fk" FOREIGN KEY ("biz_id","calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendars" ADD CONSTRAINT "calendars_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendars" ADD CONSTRAINT "calendars_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendars" ADD CONSTRAINT "calendars_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendars" ADD CONSTRAINT "calendars_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_calendar_id_calendars_id_fk" FOREIGN KEY ("calendar_id") REFERENCES "calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_capacity_pool_id_capacity_pools_id_fk" FOREIGN KEY ("capacity_pool_id") REFERENCES "capacity_pools"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_biz_calendar_fk" FOREIGN KEY ("biz_id","calendar_id") REFERENCES "calendars"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_biz_pool_fk" FOREIGN KEY ("biz_id","capacity_pool_id") REFERENCES "capacity_pools"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_holds" ADD CONSTRAINT "capacity_holds_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_capacity_pool_id_capacity_pools_id_fk" FOREIGN KEY ("capacity_pool_id") REFERENCES "capacity_pools"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_biz_pool_fk" FOREIGN KEY ("biz_id","capacity_pool_id") REFERENCES "capacity_pools"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pool_members" ADD CONSTRAINT "capacity_pool_members_biz_member_ref_subject_fk" FOREIGN KEY ("biz_id","member_ref_type","member_ref_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pools" ADD CONSTRAINT "capacity_pools_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pools" ADD CONSTRAINT "capacity_pools_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pools" ADD CONSTRAINT "capacity_pools_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "capacity_pools" ADD CONSTRAINT "capacity_pools_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_grantee_biz_id_bizes_id_fk" FOREIGN KEY ("grantee_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_calendar_access_grant_id_calendar_access_grants_id_fk" FOREIGN KEY ("calendar_access_grant_id") REFERENCES "calendar_access_grants"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_external_calendar_id_external_calendars_id_fk" FOREIGN KEY ("external_calendar_id") REFERENCES "external_calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_source_biz_id_bizes_id_fk" FOREIGN KEY ("source_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_calendar_binding_id_calendar_bindings_id_fk" FOREIGN KEY ("calendar_binding_id") REFERENCES "calendar_bindings"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_owner_grant_fk" FOREIGN KEY ("owner_user_id","calendar_access_grant_id") REFERENCES "calendar_access_grants"("owner_user_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_biz_grant_fk" FOREIGN KEY ("grantee_biz_id","calendar_access_grant_id") REFERENCES "calendar_access_grants"("grantee_biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_owner_external_calendar_fk" FOREIGN KEY ("owner_user_id","external_calendar_id") REFERENCES "external_calendars"("owner_user_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_source_biz_binding_fk" FOREIGN KEY ("source_biz_id","calendar_binding_id") REFERENCES "calendar_bindings"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grant_sources" ADD CONSTRAINT "calendar_access_grant_sources_owner_binding_fk" FOREIGN KEY ("source_biz_id","calendar_binding_id","owner_user_id") REFERENCES "calendar_bindings"("biz_id","id","owner_user_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grants" ADD CONSTRAINT "calendar_access_grants_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grants" ADD CONSTRAINT "calendar_access_grants_grantee_biz_id_bizes_id_fk" FOREIGN KEY ("grantee_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grants" ADD CONSTRAINT "calendar_access_grants_granted_by_user_id_users_id_fk" FOREIGN KEY ("granted_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grants" ADD CONSTRAINT "calendar_access_grants_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grants" ADD CONSTRAINT "calendar_access_grants_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_access_grants" ADD CONSTRAINT "calendar_access_grants_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_sync_connections" ADD CONSTRAINT "calendar_sync_connections_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_sync_connections" ADD CONSTRAINT "calendar_sync_connections_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_sync_connections" ADD CONSTRAINT "calendar_sync_connections_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "calendar_sync_connections" ADD CONSTRAINT "calendar_sync_connections_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendar_events" ADD CONSTRAINT "external_calendar_events_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendar_events" ADD CONSTRAINT "external_calendar_events_external_calendar_id_external_calendars_id_fk" FOREIGN KEY ("external_calendar_id") REFERENCES "external_calendars"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendar_events" ADD CONSTRAINT "external_calendar_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendar_events" ADD CONSTRAINT "external_calendar_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendar_events" ADD CONSTRAINT "external_calendar_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendar_events" ADD CONSTRAINT "external_calendar_events_owner_external_calendar_fk" FOREIGN KEY ("owner_user_id","external_calendar_id") REFERENCES "external_calendars"("owner_user_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendars" ADD CONSTRAINT "external_calendars_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendars" ADD CONSTRAINT "external_calendars_calendar_sync_connection_id_calendar_sync_connections_id_fk" FOREIGN KEY ("calendar_sync_connection_id") REFERENCES "calendar_sync_connections"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendars" ADD CONSTRAINT "external_calendars_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendars" ADD CONSTRAINT "external_calendars_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendars" ADD CONSTRAINT "external_calendars_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "external_calendars" ADD CONSTRAINT "external_calendars_owner_connection_fk" FOREIGN KEY ("owner_user_id","calendar_sync_connection_id") REFERENCES "calendar_sync_connections"("owner_user_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_lines" ADD CONSTRAINT "booking_order_lines_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_lines" ADD CONSTRAINT "booking_order_lines_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_lines" ADD CONSTRAINT "booking_order_lines_offer_component_id_offer_components_id_fk" FOREIGN KEY ("offer_component_id") REFERENCES "offer_components"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_lines" ADD CONSTRAINT "booking_order_lines_seat_type_id_offer_component_seat_types_id_fk" FOREIGN KEY ("seat_type_id") REFERENCES "offer_component_seat_types"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_lines" ADD CONSTRAINT "booking_order_lines_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_lines" ADD CONSTRAINT "booking_order_lines_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_lines" ADD CONSTRAINT "booking_order_lines_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_lines" ADD CONSTRAINT "booking_order_lines_biz_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_lines" ADD CONSTRAINT "booking_order_lines_biz_component_fk" FOREIGN KEY ("biz_id","offer_component_id") REFERENCES "offer_components"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_order_lines" ADD CONSTRAINT "booking_order_lines_biz_seat_type_fk" FOREIGN KEY ("biz_id","seat_type_id") REFERENCES "offer_component_seat_types"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_offer_id_offers_id_fk" FOREIGN KEY ("offer_id") REFERENCES "offers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_customer_user_id_users_id_fk" FOREIGN KEY ("customer_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_customer_group_account_id_group_accounts_id_fk" FOREIGN KEY ("customer_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_biz_offer_fk" FOREIGN KEY ("biz_id","offer_id") REFERENCES "offers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_orders" ADD CONSTRAINT "booking_orders_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_assignments" ADD CONSTRAINT "fulfillment_assignments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_assignments" ADD CONSTRAINT "fulfillment_assignments_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_assignments" ADD CONSTRAINT "fulfillment_assignments_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_assignments" ADD CONSTRAINT "fulfillment_assignments_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_assignments" ADD CONSTRAINT "fulfillment_assignments_assigned_by_user_id_users_id_fk" FOREIGN KEY ("assigned_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_assignments" ADD CONSTRAINT "fulfillment_assignments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_assignments" ADD CONSTRAINT "fulfillment_assignments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_assignments" ADD CONSTRAINT "fulfillment_assignments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_assignments" ADD CONSTRAINT "fulfillment_assignments_biz_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_assignments" ADD CONSTRAINT "fulfillment_assignments_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_assignments" ADD CONSTRAINT "fulfillment_assignments_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_checkpoints" ADD CONSTRAINT "fulfillment_checkpoints_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_checkpoints" ADD CONSTRAINT "fulfillment_checkpoints_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_checkpoints" ADD CONSTRAINT "fulfillment_checkpoints_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_checkpoints" ADD CONSTRAINT "fulfillment_checkpoints_recorded_by_user_id_users_id_fk" FOREIGN KEY ("recorded_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_checkpoints" ADD CONSTRAINT "fulfillment_checkpoints_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_checkpoints" ADD CONSTRAINT "fulfillment_checkpoints_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_checkpoints" ADD CONSTRAINT "fulfillment_checkpoints_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_checkpoints" ADD CONSTRAINT "fulfillment_checkpoints_biz_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_checkpoints" ADD CONSTRAINT "fulfillment_checkpoints_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_dependencies" ADD CONSTRAINT "fulfillment_dependencies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_dependencies" ADD CONSTRAINT "fulfillment_dependencies_predecessor_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("predecessor_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_dependencies" ADD CONSTRAINT "fulfillment_dependencies_successor_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("successor_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_dependencies" ADD CONSTRAINT "fulfillment_dependencies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_dependencies" ADD CONSTRAINT "fulfillment_dependencies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_dependencies" ADD CONSTRAINT "fulfillment_dependencies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_dependencies" ADD CONSTRAINT "fulfillment_dependencies_biz_predecessor_fk" FOREIGN KEY ("biz_id","predecessor_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_dependencies" ADD CONSTRAINT "fulfillment_dependencies_biz_successor_fk" FOREIGN KEY ("biz_id","successor_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_offer_component_id_offer_components_id_fk" FOREIGN KEY ("offer_component_id") REFERENCES "offer_components"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_calendar_binding_id_calendar_bindings_id_fk" FOREIGN KEY ("calendar_binding_id") REFERENCES "calendar_bindings"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_biz_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_biz_component_fk" FOREIGN KEY ("biz_id","offer_component_id") REFERENCES "offer_components"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_biz_calendar_binding_fk" FOREIGN KEY ("biz_id","calendar_binding_id") REFERENCES "calendar_bindings"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fulfillment_units" ADD CONSTRAINT "fulfillment_units_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_offer_id_offers_id_fk" FOREIGN KEY ("offer_id") REFERENCES "offers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_customer_user_id_users_id_fk" FOREIGN KEY ("customer_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_customer_group_account_id_group_accounts_id_fk" FOREIGN KEY ("customer_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_biz_offer_fk" FOREIGN KEY ("biz_id","offer_id") REFERENCES "offers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_contracts" ADD CONSTRAINT "standing_reservation_contracts_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_exceptions" ADD CONSTRAINT "standing_reservation_exceptions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_exceptions" ADD CONSTRAINT "standing_reservation_exceptions_standing_reservation_contract_id_standing_reservation_contracts_id_fk" FOREIGN KEY ("standing_reservation_contract_id") REFERENCES "standing_reservation_contracts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_exceptions" ADD CONSTRAINT "standing_reservation_exceptions_override_location_id_locations_id_fk" FOREIGN KEY ("override_location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_exceptions" ADD CONSTRAINT "standing_reservation_exceptions_override_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("override_offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_exceptions" ADD CONSTRAINT "standing_reservation_exceptions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_exceptions" ADD CONSTRAINT "standing_reservation_exceptions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_exceptions" ADD CONSTRAINT "standing_reservation_exceptions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_exceptions" ADD CONSTRAINT "standing_reservation_exceptions_biz_contract_fk" FOREIGN KEY ("biz_id","standing_reservation_contract_id") REFERENCES "standing_reservation_contracts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_exceptions" ADD CONSTRAINT "standing_reservation_exceptions_biz_location_fk" FOREIGN KEY ("biz_id","override_location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_exceptions" ADD CONSTRAINT "standing_reservation_exceptions_biz_offer_version_fk" FOREIGN KEY ("biz_id","override_offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_occurrences" ADD CONSTRAINT "standing_reservation_occurrences_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_occurrences" ADD CONSTRAINT "standing_reservation_occurrences_standing_reservation_contract_id_standing_reservation_contracts_id_fk" FOREIGN KEY ("standing_reservation_contract_id") REFERENCES "standing_reservation_contracts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_occurrences" ADD CONSTRAINT "standing_reservation_occurrences_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_occurrences" ADD CONSTRAINT "standing_reservation_occurrences_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_occurrences" ADD CONSTRAINT "standing_reservation_occurrences_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_occurrences" ADD CONSTRAINT "standing_reservation_occurrences_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_occurrences" ADD CONSTRAINT "standing_reservation_occurrences_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_occurrences" ADD CONSTRAINT "standing_reservation_occurrences_biz_contract_fk" FOREIGN KEY ("biz_id","standing_reservation_contract_id") REFERENCES "standing_reservation_contracts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_occurrences" ADD CONSTRAINT "standing_reservation_occurrences_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "standing_reservation_occurrences" ADD CONSTRAINT "standing_reservation_occurrences_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_disputes" ADD CONSTRAINT "payment_disputes_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_disputes" ADD CONSTRAINT "payment_disputes_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_disputes" ADD CONSTRAINT "payment_disputes_payment_intent_id_payment_intents_id_fk" FOREIGN KEY ("payment_intent_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_disputes" ADD CONSTRAINT "payment_disputes_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_disputes" ADD CONSTRAINT "payment_disputes_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_disputes" ADD CONSTRAINT "payment_disputes_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_disputes" ADD CONSTRAINT "payment_disputes_biz_transaction_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_disputes" ADD CONSTRAINT "payment_disputes_biz_intent_fk" FOREIGN KEY ("biz_id","payment_intent_id") REFERENCES "payment_intents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_payment_intent_id_payment_intents_id_fk" FOREIGN KEY ("payment_intent_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_payment_intent_tender_id_payment_intent_tenders_id_fk" FOREIGN KEY ("payment_intent_tender_id") REFERENCES "payment_intent_tenders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_biz_intent_fk" FOREIGN KEY ("biz_id","payment_intent_id") REFERENCES "payment_intents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_biz_tender_intent_fk" FOREIGN KEY ("biz_id","payment_intent_id","payment_intent_tender_id") REFERENCES "payment_intent_tenders"("biz_id","payment_intent_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_biz_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_line_allocations" ADD CONSTRAINT "payment_intent_line_allocations_biz_order_line_fk" FOREIGN KEY ("biz_id","booking_order_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","booking_order_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_tenders" ADD CONSTRAINT "payment_intent_tenders_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_tenders" ADD CONSTRAINT "payment_intent_tenders_payment_intent_id_payment_intents_id_fk" FOREIGN KEY ("payment_intent_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_tenders" ADD CONSTRAINT "payment_intent_tenders_payment_method_id_payment_methods_id_fk" FOREIGN KEY ("payment_method_id") REFERENCES "payment_methods"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_tenders" ADD CONSTRAINT "payment_intent_tenders_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_tenders" ADD CONSTRAINT "payment_intent_tenders_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_tenders" ADD CONSTRAINT "payment_intent_tenders_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_tenders" ADD CONSTRAINT "payment_intent_tenders_biz_intent_fk" FOREIGN KEY ("biz_id","payment_intent_id") REFERENCES "payment_intents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intent_tenders" ADD CONSTRAINT "payment_intent_tenders_biz_method_fk" FOREIGN KEY ("biz_id","payment_method_id") REFERENCES "payment_methods"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intents" ADD CONSTRAINT "payment_intents_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intents" ADD CONSTRAINT "payment_intents_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intents" ADD CONSTRAINT "payment_intents_cross_biz_order_id_cross_biz_orders_id_fk" FOREIGN KEY ("cross_biz_order_id") REFERENCES "cross_biz_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intents" ADD CONSTRAINT "payment_intents_payment_processor_account_id_payment_processor_accounts_id_fk" FOREIGN KEY ("payment_processor_account_id") REFERENCES "payment_processor_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intents" ADD CONSTRAINT "payment_intents_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intents" ADD CONSTRAINT "payment_intents_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intents" ADD CONSTRAINT "payment_intents_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intents" ADD CONSTRAINT "payment_intents_biz_processor_account_fk" FOREIGN KEY ("biz_id","payment_processor_account_id") REFERENCES "payment_processor_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intents" ADD CONSTRAINT "payment_intents_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_intents" ADD CONSTRAINT "payment_intents_biz_cross_biz_order_fk" FOREIGN KEY ("biz_id","cross_biz_order_id") REFERENCES "cross_biz_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_methods" ADD CONSTRAINT "payment_methods_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_methods" ADD CONSTRAINT "payment_methods_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_methods" ADD CONSTRAINT "payment_methods_payment_processor_account_id_payment_processor_accounts_id_fk" FOREIGN KEY ("payment_processor_account_id") REFERENCES "payment_processor_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_methods" ADD CONSTRAINT "payment_methods_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_methods" ADD CONSTRAINT "payment_methods_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_methods" ADD CONSTRAINT "payment_methods_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_methods" ADD CONSTRAINT "payment_methods_biz_processor_account_fk" FOREIGN KEY ("biz_id","payment_processor_account_id") REFERENCES "payment_processor_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_processor_accounts" ADD CONSTRAINT "payment_processor_accounts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_processor_accounts" ADD CONSTRAINT "payment_processor_accounts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_processor_accounts" ADD CONSTRAINT "payment_processor_accounts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_processor_accounts" ADD CONSTRAINT "payment_processor_accounts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_payment_intent_id_payment_intents_id_fk" FOREIGN KEY ("payment_intent_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_payment_intent_tender_id_payment_intent_tenders_id_fk" FOREIGN KEY ("payment_intent_tender_id") REFERENCES "payment_intent_tenders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_payment_intent_line_allocation_id_payment_intent_line_allocations_id_fk" FOREIGN KEY ("payment_intent_line_allocation_id") REFERENCES "payment_intent_line_allocations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_biz_txn_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_biz_intent_fk" FOREIGN KEY ("biz_id","payment_intent_id") REFERENCES "payment_intents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_biz_tender_intent_fk" FOREIGN KEY ("biz_id","payment_intent_id","payment_intent_tender_id") REFERENCES "payment_intent_tenders"("biz_id","payment_intent_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_biz_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_biz_order_line_fk" FOREIGN KEY ("biz_id","booking_order_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","booking_order_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transaction_line_allocations" ADD CONSTRAINT "payment_transaction_line_allocations_biz_intent_line_alloc_fk" FOREIGN KEY ("biz_id","payment_intent_line_allocation_id") REFERENCES "payment_intent_line_allocations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_payment_intent_id_payment_intents_id_fk" FOREIGN KEY ("payment_intent_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_cross_biz_order_id_cross_biz_orders_id_fk" FOREIGN KEY ("cross_biz_order_id") REFERENCES "cross_biz_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_payment_intent_tender_id_payment_intent_tenders_id_fk" FOREIGN KEY ("payment_intent_tender_id") REFERENCES "payment_intent_tenders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_payment_method_id_payment_methods_id_fk" FOREIGN KEY ("payment_method_id") REFERENCES "payment_methods"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_payment_processor_account_id_payment_processor_accounts_id_fk" FOREIGN KEY ("payment_processor_account_id") REFERENCES "payment_processor_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_biz_intent_fk" FOREIGN KEY ("biz_id","payment_intent_id") REFERENCES "payment_intents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_biz_cross_biz_order_fk" FOREIGN KEY ("biz_id","cross_biz_order_id") REFERENCES "cross_biz_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_biz_tender_fk" FOREIGN KEY ("biz_id","payment_intent_tender_id") REFERENCES "payment_intent_tenders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_biz_method_fk" FOREIGN KEY ("biz_id","payment_method_id") REFERENCES "payment_methods"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payment_transactions" ADD CONSTRAINT "payment_transactions_biz_processor_account_fk" FOREIGN KEY ("biz_id","payment_processor_account_id") REFERENCES "payment_processor_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payout_ledger_entries" ADD CONSTRAINT "payout_ledger_entries_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payout_ledger_entries" ADD CONSTRAINT "payout_ledger_entries_payout_id_payouts_id_fk" FOREIGN KEY ("payout_id") REFERENCES "payouts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payout_ledger_entries" ADD CONSTRAINT "payout_ledger_entries_settlement_entry_id_settlement_entries_id_fk" FOREIGN KEY ("settlement_entry_id") REFERENCES "settlement_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payout_ledger_entries" ADD CONSTRAINT "payout_ledger_entries_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payout_ledger_entries" ADD CONSTRAINT "payout_ledger_entries_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payout_ledger_entries" ADD CONSTRAINT "payout_ledger_entries_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payout_ledger_entries" ADD CONSTRAINT "payout_ledger_entries_biz_payout_fk" FOREIGN KEY ("biz_id","payout_id") REFERENCES "payouts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payout_ledger_entries" ADD CONSTRAINT "payout_ledger_entries_biz_settlement_entry_fk" FOREIGN KEY ("biz_id","settlement_entry_id") REFERENCES "settlement_entries"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payouts" ADD CONSTRAINT "payouts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payouts" ADD CONSTRAINT "payouts_settlement_batch_id_settlement_batches_id_fk" FOREIGN KEY ("settlement_batch_id") REFERENCES "settlement_batches"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payouts" ADD CONSTRAINT "payouts_payment_processor_account_id_payment_processor_accounts_id_fk" FOREIGN KEY ("payment_processor_account_id") REFERENCES "payment_processor_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payouts" ADD CONSTRAINT "payouts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payouts" ADD CONSTRAINT "payouts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payouts" ADD CONSTRAINT "payouts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payouts" ADD CONSTRAINT "payouts_biz_settlement_batch_fk" FOREIGN KEY ("biz_id","settlement_batch_id") REFERENCES "settlement_batches"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "payouts" ADD CONSTRAINT "payouts_biz_processor_account_fk" FOREIGN KEY ("biz_id","payment_processor_account_id") REFERENCES "payment_processor_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_batches" ADD CONSTRAINT "settlement_batches_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_batches" ADD CONSTRAINT "settlement_batches_payment_processor_account_id_payment_processor_accounts_id_fk" FOREIGN KEY ("payment_processor_account_id") REFERENCES "payment_processor_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_batches" ADD CONSTRAINT "settlement_batches_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_batches" ADD CONSTRAINT "settlement_batches_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_batches" ADD CONSTRAINT "settlement_batches_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_batches" ADD CONSTRAINT "settlement_batches_biz_processor_account_fk" FOREIGN KEY ("biz_id","payment_processor_account_id") REFERENCES "payment_processor_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_settlement_batch_id_settlement_batches_id_fk" FOREIGN KEY ("settlement_batch_id") REFERENCES "settlement_batches"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_cross_biz_order_id_cross_biz_orders_id_fk" FOREIGN KEY ("cross_biz_order_id") REFERENCES "cross_biz_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_biz_batch_fk" FOREIGN KEY ("biz_id","settlement_batch_id") REFERENCES "settlement_batches"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_biz_transaction_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "settlement_entries" ADD CONSTRAINT "settlement_entries_biz_cross_biz_order_fk" FOREIGN KEY ("biz_id","cross_biz_order_id") REFERENCES "cross_biz_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_assignment_roles" ADD CONSTRAINT "compensation_assignment_roles_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_assignment_roles" ADD CONSTRAINT "compensation_assignment_roles_fulfillment_assignment_id_fulfillment_assignments_id_fk" FOREIGN KEY ("fulfillment_assignment_id") REFERENCES "fulfillment_assignments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_assignment_roles" ADD CONSTRAINT "compensation_assignment_roles_role_template_id_compensation_role_templates_id_fk" FOREIGN KEY ("role_template_id") REFERENCES "compensation_role_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_assignment_roles" ADD CONSTRAINT "compensation_assignment_roles_assigned_by_user_id_users_id_fk" FOREIGN KEY ("assigned_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_assignment_roles" ADD CONSTRAINT "compensation_assignment_roles_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_assignment_roles" ADD CONSTRAINT "compensation_assignment_roles_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_assignment_roles" ADD CONSTRAINT "compensation_assignment_roles_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_assignment_roles" ADD CONSTRAINT "compensation_assignment_roles_biz_assignment_fk" FOREIGN KEY ("biz_id","fulfillment_assignment_id") REFERENCES "fulfillment_assignments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_assignment_roles" ADD CONSTRAINT "compensation_assignment_roles_biz_role_template_fk" FOREIGN KEY ("biz_id","role_template_id") REFERENCES "compensation_role_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_payee_resource_id_resources_id_fk" FOREIGN KEY ("payee_resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_role_template_id_compensation_role_templates_id_fk" FOREIGN KEY ("role_template_id") REFERENCES "compensation_role_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_compensation_assignment_role_id_compensation_assignment_roles_id_fk" FOREIGN KEY ("compensation_assignment_role_id") REFERENCES "compensation_assignment_roles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_compensation_plan_version_id_compensation_plan_versions_id_fk" FOREIGN KEY ("compensation_plan_version_id") REFERENCES "compensation_plan_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_compensation_plan_rule_id_compensation_plan_rules_id_fk" FOREIGN KEY ("compensation_plan_rule_id") REFERENCES "compensation_plan_rules"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_fulfillment_assignment_id_fulfillment_assignments_id_fk" FOREIGN KEY ("fulfillment_assignment_id") REFERENCES "fulfillment_assignments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_staffing_assignment_id_staffing_assignments_id_fk" FOREIGN KEY ("staffing_assignment_id") REFERENCES "staffing_assignments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_work_time_segment_id_work_time_segments_id_fk" FOREIGN KEY ("work_time_segment_id") REFERENCES "work_time_segments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_cross_biz_order_id_cross_biz_orders_id_fk" FOREIGN KEY ("cross_biz_order_id") REFERENCES "cross_biz_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_payee_fk" FOREIGN KEY ("biz_id","payee_resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_role_template_fk" FOREIGN KEY ("biz_id","role_template_id") REFERENCES "compensation_role_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_assignment_role_fk" FOREIGN KEY ("biz_id","compensation_assignment_role_id") REFERENCES "compensation_assignment_roles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_plan_version_fk" FOREIGN KEY ("biz_id","compensation_plan_version_id") REFERENCES "compensation_plan_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_plan_rule_fk" FOREIGN KEY ("biz_id","compensation_plan_rule_id") REFERENCES "compensation_plan_rules"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_booking_order_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_fulfillment_assignment_fk" FOREIGN KEY ("biz_id","fulfillment_assignment_id") REFERENCES "fulfillment_assignments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_staffing_assignment_fk" FOREIGN KEY ("biz_id","staffing_assignment_id") REFERENCES "staffing_assignments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_work_time_segment_fk" FOREIGN KEY ("biz_id","work_time_segment_id") REFERENCES "work_time_segments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_payment_transaction_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_ledger_entries" ADD CONSTRAINT "compensation_ledger_entries_biz_cross_biz_order_fk" FOREIGN KEY ("biz_id","cross_biz_order_id") REFERENCES "cross_biz_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_item_entries" ADD CONSTRAINT "compensation_pay_run_item_entries_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_item_entries" ADD CONSTRAINT "compensation_pay_run_item_entries_compensation_pay_run_item_id_compensation_pay_run_items_id_fk" FOREIGN KEY ("compensation_pay_run_item_id") REFERENCES "compensation_pay_run_items"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_item_entries" ADD CONSTRAINT "compensation_pay_run_item_entries_compensation_ledger_entry_id_compensation_ledger_entries_id_fk" FOREIGN KEY ("compensation_ledger_entry_id") REFERENCES "compensation_ledger_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_item_entries" ADD CONSTRAINT "compensation_pay_run_item_entries_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_item_entries" ADD CONSTRAINT "compensation_pay_run_item_entries_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_item_entries" ADD CONSTRAINT "compensation_pay_run_item_entries_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_item_entries" ADD CONSTRAINT "compensation_pay_run_item_entries_biz_item_fk" FOREIGN KEY ("biz_id","compensation_pay_run_item_id") REFERENCES "compensation_pay_run_items"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_item_entries" ADD CONSTRAINT "compensation_pay_run_item_entries_biz_ledger_fk" FOREIGN KEY ("biz_id","compensation_ledger_entry_id") REFERENCES "compensation_ledger_entries"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_items" ADD CONSTRAINT "compensation_pay_run_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_items" ADD CONSTRAINT "compensation_pay_run_items_compensation_pay_run_id_compensation_pay_runs_id_fk" FOREIGN KEY ("compensation_pay_run_id") REFERENCES "compensation_pay_runs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_items" ADD CONSTRAINT "compensation_pay_run_items_payee_resource_id_resources_id_fk" FOREIGN KEY ("payee_resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_items" ADD CONSTRAINT "compensation_pay_run_items_payout_id_payouts_id_fk" FOREIGN KEY ("payout_id") REFERENCES "payouts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_items" ADD CONSTRAINT "compensation_pay_run_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_items" ADD CONSTRAINT "compensation_pay_run_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_items" ADD CONSTRAINT "compensation_pay_run_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_items" ADD CONSTRAINT "compensation_pay_run_items_biz_pay_run_fk" FOREIGN KEY ("biz_id","compensation_pay_run_id") REFERENCES "compensation_pay_runs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_items" ADD CONSTRAINT "compensation_pay_run_items_biz_payee_fk" FOREIGN KEY ("biz_id","payee_resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_run_items" ADD CONSTRAINT "compensation_pay_run_items_biz_payout_fk" FOREIGN KEY ("biz_id","payout_id") REFERENCES "payouts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_runs" ADD CONSTRAINT "compensation_pay_runs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_runs" ADD CONSTRAINT "compensation_pay_runs_approved_by_user_id_users_id_fk" FOREIGN KEY ("approved_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_runs" ADD CONSTRAINT "compensation_pay_runs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_runs" ADD CONSTRAINT "compensation_pay_runs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_pay_runs" ADD CONSTRAINT "compensation_pay_runs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_compensation_plan_version_id_compensation_plan_versions_id_fk" FOREIGN KEY ("compensation_plan_version_id") REFERENCES "compensation_plan_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_role_template_id_compensation_role_templates_id_fk" FOREIGN KEY ("role_template_id") REFERENCES "compensation_role_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_capability_template_id_resource_capability_templates_id_fk" FOREIGN KEY ("capability_template_id") REFERENCES "resource_capability_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_service_id_services_id_fk" FOREIGN KEY ("service_id") REFERENCES "services"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_offer_component_id_offer_components_id_fk" FOREIGN KEY ("offer_component_id") REFERENCES "offer_components"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_biz_plan_version_fk" FOREIGN KEY ("biz_id","compensation_plan_version_id") REFERENCES "compensation_plan_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_biz_role_template_fk" FOREIGN KEY ("biz_id","role_template_id") REFERENCES "compensation_role_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_biz_capability_template_fk" FOREIGN KEY ("biz_id","capability_template_id") REFERENCES "resource_capability_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_biz_service_fk" FOREIGN KEY ("biz_id","service_id") REFERENCES "services"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_rules" ADD CONSTRAINT "compensation_plan_rules_biz_offer_component_fk" FOREIGN KEY ("biz_id","offer_component_id") REFERENCES "offer_components"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_versions" ADD CONSTRAINT "compensation_plan_versions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_versions" ADD CONSTRAINT "compensation_plan_versions_compensation_plan_id_compensation_plans_id_fk" FOREIGN KEY ("compensation_plan_id") REFERENCES "compensation_plans"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_versions" ADD CONSTRAINT "compensation_plan_versions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_versions" ADD CONSTRAINT "compensation_plan_versions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_versions" ADD CONSTRAINT "compensation_plan_versions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plan_versions" ADD CONSTRAINT "compensation_plan_versions_biz_plan_fk" FOREIGN KEY ("biz_id","compensation_plan_id") REFERENCES "compensation_plans"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plans" ADD CONSTRAINT "compensation_plans_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plans" ADD CONSTRAINT "compensation_plans_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plans" ADD CONSTRAINT "compensation_plans_service_id_services_id_fk" FOREIGN KEY ("service_id") REFERENCES "services"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plans" ADD CONSTRAINT "compensation_plans_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plans" ADD CONSTRAINT "compensation_plans_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plans" ADD CONSTRAINT "compensation_plans_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plans" ADD CONSTRAINT "compensation_plans_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plans" ADD CONSTRAINT "compensation_plans_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plans" ADD CONSTRAINT "compensation_plans_biz_service_fk" FOREIGN KEY ("biz_id","service_id") REFERENCES "services"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_plans" ADD CONSTRAINT "compensation_plans_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_role_templates" ADD CONSTRAINT "compensation_role_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_role_templates" ADD CONSTRAINT "compensation_role_templates_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_role_templates" ADD CONSTRAINT "compensation_role_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_role_templates" ADD CONSTRAINT "compensation_role_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_role_templates" ADD CONSTRAINT "compensation_role_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "compensation_role_templates" ADD CONSTRAINT "compensation_role_templates_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_applications" ADD CONSTRAINT "demand_pricing_applications_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_applications" ADD CONSTRAINT "demand_pricing_applications_demand_pricing_evaluation_id_demand_pricing_evaluations_id_fk" FOREIGN KEY ("demand_pricing_evaluation_id") REFERENCES "demand_pricing_evaluations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_applications" ADD CONSTRAINT "demand_pricing_applications_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_applications" ADD CONSTRAINT "demand_pricing_applications_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_applications" ADD CONSTRAINT "demand_pricing_applications_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_applications" ADD CONSTRAINT "demand_pricing_applications_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_applications" ADD CONSTRAINT "demand_pricing_applications_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_applications" ADD CONSTRAINT "demand_pricing_applications_biz_evaluation_fk" FOREIGN KEY ("biz_id","demand_pricing_evaluation_id") REFERENCES "demand_pricing_evaluations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_applications" ADD CONSTRAINT "demand_pricing_applications_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_applications" ADD CONSTRAINT "demand_pricing_applications_biz_booking_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_applications" ADD CONSTRAINT "demand_pricing_applications_biz_reversal_fk" FOREIGN KEY ("biz_id","reversal_of_application_id") REFERENCES "demand_pricing_applications"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_demand_pricing_policy_id_demand_pricing_policies_id_fk" FOREIGN KEY ("demand_pricing_policy_id") REFERENCES "demand_pricing_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_demand_pricing_policy_tier_id_demand_pricing_policy_tiers_id_fk" FOREIGN KEY ("demand_pricing_policy_tier_id") REFERENCES "demand_pricing_policy_tiers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_biz_policy_fk" FOREIGN KEY ("biz_id","demand_pricing_policy_id") REFERENCES "demand_pricing_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_biz_tier_fk" FOREIGN KEY ("biz_id","demand_pricing_policy_tier_id") REFERENCES "demand_pricing_policy_tiers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_evaluations" ADD CONSTRAINT "demand_pricing_evaluations_biz_booking_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_service_id_services_id_fk" FOREIGN KEY ("service_id") REFERENCES "services"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_offer_id_offers_id_fk" FOREIGN KEY ("offer_id") REFERENCES "offers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_biz_service_fk" FOREIGN KEY ("biz_id","service_id") REFERENCES "services"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_biz_offer_fk" FOREIGN KEY ("biz_id","offer_id") REFERENCES "offers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policies" ADD CONSTRAINT "demand_pricing_policies_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_signals" ADD CONSTRAINT "demand_pricing_policy_signals_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_signals" ADD CONSTRAINT "demand_pricing_policy_signals_demand_pricing_policy_id_demand_pricing_policies_id_fk" FOREIGN KEY ("demand_pricing_policy_id") REFERENCES "demand_pricing_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_signals" ADD CONSTRAINT "demand_pricing_policy_signals_demand_signal_definition_id_demand_signal_definitions_id_fk" FOREIGN KEY ("demand_signal_definition_id") REFERENCES "demand_signal_definitions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_signals" ADD CONSTRAINT "demand_pricing_policy_signals_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_signals" ADD CONSTRAINT "demand_pricing_policy_signals_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_signals" ADD CONSTRAINT "demand_pricing_policy_signals_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_signals" ADD CONSTRAINT "demand_pricing_policy_signals_biz_policy_fk" FOREIGN KEY ("biz_id","demand_pricing_policy_id") REFERENCES "demand_pricing_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_signals" ADD CONSTRAINT "demand_pricing_policy_signals_biz_signal_fk" FOREIGN KEY ("biz_id","demand_signal_definition_id") REFERENCES "demand_signal_definitions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_tiers" ADD CONSTRAINT "demand_pricing_policy_tiers_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_tiers" ADD CONSTRAINT "demand_pricing_policy_tiers_demand_pricing_policy_id_demand_pricing_policies_id_fk" FOREIGN KEY ("demand_pricing_policy_id") REFERENCES "demand_pricing_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_tiers" ADD CONSTRAINT "demand_pricing_policy_tiers_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_tiers" ADD CONSTRAINT "demand_pricing_policy_tiers_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_tiers" ADD CONSTRAINT "demand_pricing_policy_tiers_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_pricing_policy_tiers" ADD CONSTRAINT "demand_pricing_policy_tiers_biz_policy_fk" FOREIGN KEY ("biz_id","demand_pricing_policy_id") REFERENCES "demand_pricing_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_service_id_services_id_fk" FOREIGN KEY ("service_id") REFERENCES "services"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_offer_id_offers_id_fk" FOREIGN KEY ("offer_id") REFERENCES "offers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_biz_service_fk" FOREIGN KEY ("biz_id","service_id") REFERENCES "services"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_biz_offer_fk" FOREIGN KEY ("biz_id","offer_id") REFERENCES "offers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_definitions" ADD CONSTRAINT "demand_signal_definitions_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_observations" ADD CONSTRAINT "demand_signal_observations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_observations" ADD CONSTRAINT "demand_signal_observations_demand_signal_definition_id_demand_signal_definitions_id_fk" FOREIGN KEY ("demand_signal_definition_id") REFERENCES "demand_signal_definitions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_observations" ADD CONSTRAINT "demand_signal_observations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_observations" ADD CONSTRAINT "demand_signal_observations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_observations" ADD CONSTRAINT "demand_signal_observations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "demand_signal_observations" ADD CONSTRAINT "demand_signal_observations_biz_definition_fk" FOREIGN KEY ("biz_id","demand_signal_definition_id") REFERENCES "demand_signal_definitions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_grants" ADD CONSTRAINT "entitlement_grants_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_grants" ADD CONSTRAINT "entitlement_grants_wallet_id_entitlement_wallets_id_fk" FOREIGN KEY ("wallet_id") REFERENCES "entitlement_wallets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_grants" ADD CONSTRAINT "entitlement_grants_membership_id_memberships_id_fk" FOREIGN KEY ("membership_id") REFERENCES "memberships"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_grants" ADD CONSTRAINT "entitlement_grants_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_grants" ADD CONSTRAINT "entitlement_grants_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_grants" ADD CONSTRAINT "entitlement_grants_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_grants" ADD CONSTRAINT "entitlement_grants_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_grants" ADD CONSTRAINT "entitlement_grants_biz_wallet_fk" FOREIGN KEY ("biz_id","wallet_id") REFERENCES "entitlement_wallets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_grants" ADD CONSTRAINT "entitlement_grants_biz_membership_fk" FOREIGN KEY ("biz_id","membership_id") REFERENCES "memberships"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_grants" ADD CONSTRAINT "entitlement_grants_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_wallet_id_entitlement_wallets_id_fk" FOREIGN KEY ("wallet_id") REFERENCES "entitlement_wallets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_grant_id_entitlement_grants_id_fk" FOREIGN KEY ("grant_id") REFERENCES "entitlement_grants"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_transfer_id_entitlement_transfers_id_fk" FOREIGN KEY ("transfer_id") REFERENCES "entitlement_transfers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_biz_wallet_fk" FOREIGN KEY ("biz_id","wallet_id") REFERENCES "entitlement_wallets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_biz_grant_fk" FOREIGN KEY ("biz_id","grant_id") REFERENCES "entitlement_grants"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_biz_transfer_fk" FOREIGN KEY ("biz_id","transfer_id") REFERENCES "entitlement_transfers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_ledger_entries" ADD CONSTRAINT "entitlement_ledger_entries_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_transfers" ADD CONSTRAINT "entitlement_transfers_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_transfers" ADD CONSTRAINT "entitlement_transfers_from_wallet_id_entitlement_wallets_id_fk" FOREIGN KEY ("from_wallet_id") REFERENCES "entitlement_wallets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_transfers" ADD CONSTRAINT "entitlement_transfers_to_wallet_id_entitlement_wallets_id_fk" FOREIGN KEY ("to_wallet_id") REFERENCES "entitlement_wallets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_transfers" ADD CONSTRAINT "entitlement_transfers_requested_by_user_id_users_id_fk" FOREIGN KEY ("requested_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_transfers" ADD CONSTRAINT "entitlement_transfers_reviewed_by_user_id_users_id_fk" FOREIGN KEY ("reviewed_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_transfers" ADD CONSTRAINT "entitlement_transfers_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_transfers" ADD CONSTRAINT "entitlement_transfers_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_transfers" ADD CONSTRAINT "entitlement_transfers_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_transfers" ADD CONSTRAINT "entitlement_transfers_biz_from_wallet_fk" FOREIGN KEY ("biz_id","from_wallet_id") REFERENCES "entitlement_wallets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_transfers" ADD CONSTRAINT "entitlement_transfers_biz_to_wallet_fk" FOREIGN KEY ("biz_id","to_wallet_id") REFERENCES "entitlement_wallets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_wallets" ADD CONSTRAINT "entitlement_wallets_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_wallets" ADD CONSTRAINT "entitlement_wallets_membership_id_memberships_id_fk" FOREIGN KEY ("membership_id") REFERENCES "memberships"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_wallets" ADD CONSTRAINT "entitlement_wallets_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_wallets" ADD CONSTRAINT "entitlement_wallets_owner_group_account_id_group_accounts_id_fk" FOREIGN KEY ("owner_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_wallets" ADD CONSTRAINT "entitlement_wallets_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_wallets" ADD CONSTRAINT "entitlement_wallets_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_wallets" ADD CONSTRAINT "entitlement_wallets_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "entitlement_wallets" ADD CONSTRAINT "entitlement_wallets_biz_membership_fk" FOREIGN KEY ("biz_id","membership_id") REFERENCES "memberships"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "membership_plans" ADD CONSTRAINT "membership_plans_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "membership_plans" ADD CONSTRAINT "membership_plans_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "membership_plans" ADD CONSTRAINT "membership_plans_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "membership_plans" ADD CONSTRAINT "membership_plans_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "memberships" ADD CONSTRAINT "memberships_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "memberships" ADD CONSTRAINT "memberships_membership_plan_id_membership_plans_id_fk" FOREIGN KEY ("membership_plan_id") REFERENCES "membership_plans"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "memberships" ADD CONSTRAINT "memberships_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "memberships" ADD CONSTRAINT "memberships_owner_group_account_id_group_accounts_id_fk" FOREIGN KEY ("owner_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "memberships" ADD CONSTRAINT "memberships_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "memberships" ADD CONSTRAINT "memberships_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "memberships" ADD CONSTRAINT "memberships_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "memberships" ADD CONSTRAINT "memberships_biz_plan_fk" FOREIGN KEY ("biz_id","membership_plan_id") REFERENCES "membership_plans"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "rollover_runs" ADD CONSTRAINT "rollover_runs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "rollover_runs" ADD CONSTRAINT "rollover_runs_membership_plan_id_membership_plans_id_fk" FOREIGN KEY ("membership_plan_id") REFERENCES "membership_plans"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "rollover_runs" ADD CONSTRAINT "rollover_runs_membership_id_memberships_id_fk" FOREIGN KEY ("membership_id") REFERENCES "memberships"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "rollover_runs" ADD CONSTRAINT "rollover_runs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "rollover_runs" ADD CONSTRAINT "rollover_runs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "rollover_runs" ADD CONSTRAINT "rollover_runs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "rollover_runs" ADD CONSTRAINT "rollover_runs_biz_plan_fk" FOREIGN KEY ("biz_id","membership_plan_id") REFERENCES "membership_plans"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "rollover_runs" ADD CONSTRAINT "rollover_runs_biz_membership_fk" FOREIGN KEY ("biz_id","membership_id") REFERENCES "memberships"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_accounts" ADD CONSTRAINT "channel_accounts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_accounts" ADD CONSTRAINT "channel_accounts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_accounts" ADD CONSTRAINT "channel_accounts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_accounts" ADD CONSTRAINT "channel_accounts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_channel_account_id_channel_accounts_id_fk" FOREIGN KEY ("channel_account_id") REFERENCES "channel_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_customer_user_id_users_id_fk" FOREIGN KEY ("customer_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_biz_account_fk" FOREIGN KEY ("biz_id","channel_account_id") REFERENCES "channel_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_entity_links" ADD CONSTRAINT "channel_entity_links_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_items" ADD CONSTRAINT "channel_sync_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_items" ADD CONSTRAINT "channel_sync_items_channel_sync_job_id_channel_sync_jobs_id_fk" FOREIGN KEY ("channel_sync_job_id") REFERENCES "channel_sync_jobs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_items" ADD CONSTRAINT "channel_sync_items_channel_entity_link_id_channel_entity_links_id_fk" FOREIGN KEY ("channel_entity_link_id") REFERENCES "channel_entity_links"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_items" ADD CONSTRAINT "channel_sync_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_items" ADD CONSTRAINT "channel_sync_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_items" ADD CONSTRAINT "channel_sync_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_items" ADD CONSTRAINT "channel_sync_items_biz_job_fk" FOREIGN KEY ("biz_id","channel_sync_job_id") REFERENCES "channel_sync_jobs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_items" ADD CONSTRAINT "channel_sync_items_biz_entity_link_fk" FOREIGN KEY ("biz_id","channel_entity_link_id") REFERENCES "channel_entity_links"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_jobs" ADD CONSTRAINT "channel_sync_jobs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_jobs" ADD CONSTRAINT "channel_sync_jobs_channel_account_id_channel_accounts_id_fk" FOREIGN KEY ("channel_account_id") REFERENCES "channel_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_jobs" ADD CONSTRAINT "channel_sync_jobs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_jobs" ADD CONSTRAINT "channel_sync_jobs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_jobs" ADD CONSTRAINT "channel_sync_jobs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_jobs" ADD CONSTRAINT "channel_sync_jobs_biz_account_fk" FOREIGN KEY ("biz_id","channel_account_id") REFERENCES "channel_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_states" ADD CONSTRAINT "channel_sync_states_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_states" ADD CONSTRAINT "channel_sync_states_channel_account_id_channel_accounts_id_fk" FOREIGN KEY ("channel_account_id") REFERENCES "channel_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_states" ADD CONSTRAINT "channel_sync_states_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_states" ADD CONSTRAINT "channel_sync_states_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_states" ADD CONSTRAINT "channel_sync_states_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_sync_states" ADD CONSTRAINT "channel_sync_states_biz_account_fk" FOREIGN KEY ("biz_id","channel_account_id") REFERENCES "channel_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_webhook_events" ADD CONSTRAINT "channel_webhook_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_webhook_events" ADD CONSTRAINT "channel_webhook_events_channel_account_id_channel_accounts_id_fk" FOREIGN KEY ("channel_account_id") REFERENCES "channel_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_webhook_events" ADD CONSTRAINT "channel_webhook_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_webhook_events" ADD CONSTRAINT "channel_webhook_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_webhook_events" ADD CONSTRAINT "channel_webhook_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "channel_webhook_events" ADD CONSTRAINT "channel_webhook_events_biz_account_fk" FOREIGN KEY ("biz_id","channel_account_id") REFERENCES "channel_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_forecasts" ADD CONSTRAINT "overtime_forecasts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_forecasts" ADD CONSTRAINT "overtime_forecasts_overtime_policy_id_overtime_policies_id_fk" FOREIGN KEY ("overtime_policy_id") REFERENCES "overtime_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_forecasts" ADD CONSTRAINT "overtime_forecasts_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_forecasts" ADD CONSTRAINT "overtime_forecasts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_forecasts" ADD CONSTRAINT "overtime_forecasts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_forecasts" ADD CONSTRAINT "overtime_forecasts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_forecasts" ADD CONSTRAINT "overtime_forecasts_biz_policy_fk" FOREIGN KEY ("biz_id","overtime_policy_id") REFERENCES "overtime_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_forecasts" ADD CONSTRAINT "overtime_forecasts_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_policies" ADD CONSTRAINT "overtime_policies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_policies" ADD CONSTRAINT "overtime_policies_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_policies" ADD CONSTRAINT "overtime_policies_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_policies" ADD CONSTRAINT "overtime_policies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_policies" ADD CONSTRAINT "overtime_policies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_policies" ADD CONSTRAINT "overtime_policies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_policies" ADD CONSTRAINT "overtime_policies_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "overtime_policies" ADD CONSTRAINT "overtime_policies_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_events" ADD CONSTRAINT "ranking_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_events" ADD CONSTRAINT "ranking_events_ranking_profile_id_ranking_profiles_id_fk" FOREIGN KEY ("ranking_profile_id") REFERENCES "ranking_profiles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_events" ADD CONSTRAINT "ranking_events_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_events" ADD CONSTRAINT "ranking_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_events" ADD CONSTRAINT "ranking_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_events" ADD CONSTRAINT "ranking_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_events" ADD CONSTRAINT "ranking_events_biz_profile_fk" FOREIGN KEY ("biz_id","ranking_profile_id") REFERENCES "ranking_profiles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_events" ADD CONSTRAINT "ranking_events_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_profiles" ADD CONSTRAINT "ranking_profiles_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_profiles" ADD CONSTRAINT "ranking_profiles_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_profiles" ADD CONSTRAINT "ranking_profiles_service_id_services_id_fk" FOREIGN KEY ("service_id") REFERENCES "services"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_profiles" ADD CONSTRAINT "ranking_profiles_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_profiles" ADD CONSTRAINT "ranking_profiles_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_profiles" ADD CONSTRAINT "ranking_profiles_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_profiles" ADD CONSTRAINT "ranking_profiles_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_profiles" ADD CONSTRAINT "ranking_profiles_biz_service_fk" FOREIGN KEY ("biz_id","service_id") REFERENCES "services"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_scores" ADD CONSTRAINT "ranking_scores_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_scores" ADD CONSTRAINT "ranking_scores_ranking_profile_id_ranking_profiles_id_fk" FOREIGN KEY ("ranking_profile_id") REFERENCES "ranking_profiles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_scores" ADD CONSTRAINT "ranking_scores_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_scores" ADD CONSTRAINT "ranking_scores_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_scores" ADD CONSTRAINT "ranking_scores_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_scores" ADD CONSTRAINT "ranking_scores_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_scores" ADD CONSTRAINT "ranking_scores_biz_profile_fk" FOREIGN KEY ("biz_id","ranking_profile_id") REFERENCES "ranking_profiles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ranking_scores" ADD CONSTRAINT "ranking_scores_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_staffing_demand_id_staffing_demands_id_fk" FOREIGN KEY ("staffing_demand_id") REFERENCES "staffing_demands"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_staffing_response_id_staffing_responses_id_fk" FOREIGN KEY ("staffing_response_id") REFERENCES "staffing_responses"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_fulfillment_assignment_id_fulfillment_assignments_id_fk" FOREIGN KEY ("fulfillment_assignment_id") REFERENCES "fulfillment_assignments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_assigned_by_user_id_users_id_fk" FOREIGN KEY ("assigned_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_biz_demand_fk" FOREIGN KEY ("biz_id","staffing_demand_id") REFERENCES "staffing_demands"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_biz_response_fk" FOREIGN KEY ("biz_id","staffing_response_id") REFERENCES "staffing_responses"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_biz_fulfillment_assignment_fk" FOREIGN KEY ("biz_id","fulfillment_assignment_id") REFERENCES "fulfillment_assignments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_assignments" ADD CONSTRAINT "staffing_assignments_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_requirements" ADD CONSTRAINT "staffing_demand_requirements_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_requirements" ADD CONSTRAINT "staffing_demand_requirements_staffing_demand_id_staffing_demands_id_fk" FOREIGN KEY ("staffing_demand_id") REFERENCES "staffing_demands"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_requirements" ADD CONSTRAINT "staffing_demand_requirements_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_requirements" ADD CONSTRAINT "staffing_demand_requirements_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_requirements" ADD CONSTRAINT "staffing_demand_requirements_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_requirements" ADD CONSTRAINT "staffing_demand_requirements_biz_demand_fk" FOREIGN KEY ("biz_id","staffing_demand_id") REFERENCES "staffing_demands"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_staffing_demand_requirement_id_staffing_demand_requirements_id_fk" FOREIGN KEY ("staffing_demand_requirement_id") REFERENCES "staffing_demand_requirements"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_capability_template_id_resource_capability_templates_id_fk" FOREIGN KEY ("capability_template_id") REFERENCES "resource_capability_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_biz_requirement_fk" FOREIGN KEY ("biz_id","staffing_demand_requirement_id") REFERENCES "staffing_demand_requirements"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_biz_capability_fk" FOREIGN KEY ("biz_id","capability_template_id") REFERENCES "resource_capability_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demand_selectors" ADD CONSTRAINT "staffing_demand_selectors_biz_subject_fk" FOREIGN KEY ("biz_id","subject_type","subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_staffing_pool_id_staffing_pools_id_fk" FOREIGN KEY ("staffing_pool_id") REFERENCES "staffing_pools"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_auction_id_auctions_id_fk" FOREIGN KEY ("auction_id") REFERENCES "auctions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_fulfillment_assignment_id_fulfillment_assignments_id_fk" FOREIGN KEY ("fulfillment_assignment_id") REFERENCES "fulfillment_assignments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_from_resource_id_resources_id_fk" FOREIGN KEY ("from_resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_assigned_resource_id_resources_id_fk" FOREIGN KEY ("assigned_resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_requested_by_user_id_users_id_fk" FOREIGN KEY ("requested_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_biz_pool_fk" FOREIGN KEY ("biz_id","staffing_pool_id") REFERENCES "staffing_pools"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_biz_assignment_fk" FOREIGN KEY ("biz_id","fulfillment_assignment_id") REFERENCES "fulfillment_assignments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_biz_auction_fk" FOREIGN KEY ("biz_id","auction_id") REFERENCES "auctions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_biz_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_biz_from_resource_fk" FOREIGN KEY ("biz_id","from_resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_demands" ADD CONSTRAINT "staffing_demands_biz_assigned_resource_fk" FOREIGN KEY ("biz_id","assigned_resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_fairness_counters" ADD CONSTRAINT "staffing_fairness_counters_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_fairness_counters" ADD CONSTRAINT "staffing_fairness_counters_staffing_pool_id_staffing_pools_id_fk" FOREIGN KEY ("staffing_pool_id") REFERENCES "staffing_pools"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_fairness_counters" ADD CONSTRAINT "staffing_fairness_counters_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_fairness_counters" ADD CONSTRAINT "staffing_fairness_counters_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_fairness_counters" ADD CONSTRAINT "staffing_fairness_counters_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_fairness_counters" ADD CONSTRAINT "staffing_fairness_counters_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_fairness_counters" ADD CONSTRAINT "staffing_fairness_counters_biz_pool_fk" FOREIGN KEY ("biz_id","staffing_pool_id") REFERENCES "staffing_pools"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_fairness_counters" ADD CONSTRAINT "staffing_fairness_counters_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pool_members" ADD CONSTRAINT "staffing_pool_members_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pool_members" ADD CONSTRAINT "staffing_pool_members_staffing_pool_id_staffing_pools_id_fk" FOREIGN KEY ("staffing_pool_id") REFERENCES "staffing_pools"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pool_members" ADD CONSTRAINT "staffing_pool_members_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pool_members" ADD CONSTRAINT "staffing_pool_members_capability_template_id_resource_capability_templates_id_fk" FOREIGN KEY ("capability_template_id") REFERENCES "resource_capability_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pool_members" ADD CONSTRAINT "staffing_pool_members_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pool_members" ADD CONSTRAINT "staffing_pool_members_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pool_members" ADD CONSTRAINT "staffing_pool_members_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pool_members" ADD CONSTRAINT "staffing_pool_members_biz_pool_fk" FOREIGN KEY ("biz_id","staffing_pool_id") REFERENCES "staffing_pools"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pool_members" ADD CONSTRAINT "staffing_pool_members_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pool_members" ADD CONSTRAINT "staffing_pool_members_biz_capability_fk" FOREIGN KEY ("biz_id","capability_template_id") REFERENCES "resource_capability_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pools" ADD CONSTRAINT "staffing_pools_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pools" ADD CONSTRAINT "staffing_pools_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pools" ADD CONSTRAINT "staffing_pools_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pools" ADD CONSTRAINT "staffing_pools_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pools" ADD CONSTRAINT "staffing_pools_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_pools" ADD CONSTRAINT "staffing_pools_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_responses" ADD CONSTRAINT "staffing_responses_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_responses" ADD CONSTRAINT "staffing_responses_staffing_demand_id_staffing_demands_id_fk" FOREIGN KEY ("staffing_demand_id") REFERENCES "staffing_demands"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_responses" ADD CONSTRAINT "staffing_responses_candidate_resource_id_resources_id_fk" FOREIGN KEY ("candidate_resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_responses" ADD CONSTRAINT "staffing_responses_responded_by_user_id_users_id_fk" FOREIGN KEY ("responded_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_responses" ADD CONSTRAINT "staffing_responses_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_responses" ADD CONSTRAINT "staffing_responses_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_responses" ADD CONSTRAINT "staffing_responses_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_responses" ADD CONSTRAINT "staffing_responses_biz_demand_fk" FOREIGN KEY ("biz_id","staffing_demand_id") REFERENCES "staffing_demands"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "staffing_responses" ADD CONSTRAINT "staffing_responses_biz_candidate_fk" FOREIGN KEY ("biz_id","candidate_resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_awards" ADD CONSTRAINT "certification_awards_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_awards" ADD CONSTRAINT "certification_awards_certification_template_id_certification_templates_id_fk" FOREIGN KEY ("certification_template_id") REFERENCES "certification_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_awards" ADD CONSTRAINT "certification_awards_enrollment_id_cohort_enrollments_id_fk" FOREIGN KEY ("enrollment_id") REFERENCES "cohort_enrollments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_awards" ADD CONSTRAINT "certification_awards_learner_user_id_users_id_fk" FOREIGN KEY ("learner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_awards" ADD CONSTRAINT "certification_awards_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_awards" ADD CONSTRAINT "certification_awards_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_awards" ADD CONSTRAINT "certification_awards_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_awards" ADD CONSTRAINT "certification_awards_biz_template_fk" FOREIGN KEY ("biz_id","certification_template_id") REFERENCES "certification_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_awards" ADD CONSTRAINT "certification_awards_biz_enrollment_fk" FOREIGN KEY ("biz_id","enrollment_id") REFERENCES "cohort_enrollments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_templates" ADD CONSTRAINT "certification_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_templates" ADD CONSTRAINT "certification_templates_program_id_programs_id_fk" FOREIGN KEY ("program_id") REFERENCES "programs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_templates" ADD CONSTRAINT "certification_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_templates" ADD CONSTRAINT "certification_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_templates" ADD CONSTRAINT "certification_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "certification_templates" ADD CONSTRAINT "certification_templates_biz_program_fk" FOREIGN KEY ("biz_id","program_id") REFERENCES "programs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cohort_enrollments" ADD CONSTRAINT "cohort_enrollments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cohort_enrollments" ADD CONSTRAINT "cohort_enrollments_cohort_id_program_cohorts_id_fk" FOREIGN KEY ("cohort_id") REFERENCES "program_cohorts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cohort_enrollments" ADD CONSTRAINT "cohort_enrollments_learner_user_id_users_id_fk" FOREIGN KEY ("learner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cohort_enrollments" ADD CONSTRAINT "cohort_enrollments_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cohort_enrollments" ADD CONSTRAINT "cohort_enrollments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cohort_enrollments" ADD CONSTRAINT "cohort_enrollments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cohort_enrollments" ADD CONSTRAINT "cohort_enrollments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cohort_enrollments" ADD CONSTRAINT "cohort_enrollments_biz_cohort_fk" FOREIGN KEY ("biz_id","cohort_id") REFERENCES "program_cohorts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cohort_enrollments" ADD CONSTRAINT "cohort_enrollments_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_cohort_id_program_cohorts_id_fk" FOREIGN KEY ("cohort_id") REFERENCES "program_cohorts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_instructor_resource_id_resources_id_fk" FOREIGN KEY ("instructor_resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_biz_cohort_fk" FOREIGN KEY ("biz_id","cohort_id") REFERENCES "program_cohorts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_biz_instructor_fk" FOREIGN KEY ("biz_id","instructor_resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohort_sessions" ADD CONSTRAINT "program_cohort_sessions_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohorts" ADD CONSTRAINT "program_cohorts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohorts" ADD CONSTRAINT "program_cohorts_program_id_programs_id_fk" FOREIGN KEY ("program_id") REFERENCES "programs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohorts" ADD CONSTRAINT "program_cohorts_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohorts" ADD CONSTRAINT "program_cohorts_lead_resource_id_resources_id_fk" FOREIGN KEY ("lead_resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohorts" ADD CONSTRAINT "program_cohorts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohorts" ADD CONSTRAINT "program_cohorts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohorts" ADD CONSTRAINT "program_cohorts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohorts" ADD CONSTRAINT "program_cohorts_biz_program_fk" FOREIGN KEY ("biz_id","program_id") REFERENCES "programs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohorts" ADD CONSTRAINT "program_cohorts_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "program_cohorts" ADD CONSTRAINT "program_cohorts_biz_lead_resource_fk" FOREIGN KEY ("biz_id","lead_resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "programs" ADD CONSTRAINT "programs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "programs" ADD CONSTRAINT "programs_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "programs" ADD CONSTRAINT "programs_calendar_binding_id_calendar_bindings_id_fk" FOREIGN KEY ("calendar_binding_id") REFERENCES "calendar_bindings"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "programs" ADD CONSTRAINT "programs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "programs" ADD CONSTRAINT "programs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "programs" ADD CONSTRAINT "programs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "programs" ADD CONSTRAINT "programs_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "programs" ADD CONSTRAINT "programs_biz_calendar_binding_fk" FOREIGN KEY ("biz_id","calendar_binding_id") REFERENCES "calendar_bindings"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_attendance_records" ADD CONSTRAINT "session_attendance_records_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_attendance_records" ADD CONSTRAINT "session_attendance_records_session_id_program_cohort_sessions_id_fk" FOREIGN KEY ("session_id") REFERENCES "program_cohort_sessions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_attendance_records" ADD CONSTRAINT "session_attendance_records_enrollment_id_cohort_enrollments_id_fk" FOREIGN KEY ("enrollment_id") REFERENCES "cohort_enrollments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_attendance_records" ADD CONSTRAINT "session_attendance_records_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_attendance_records" ADD CONSTRAINT "session_attendance_records_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_attendance_records" ADD CONSTRAINT "session_attendance_records_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_attendance_records" ADD CONSTRAINT "session_attendance_records_biz_session_fk" FOREIGN KEY ("biz_id","session_id") REFERENCES "program_cohort_sessions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_attendance_records" ADD CONSTRAINT "session_attendance_records_biz_enrollment_fk" FOREIGN KEY ("biz_id","enrollment_id") REFERENCES "cohort_enrollments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_edges" ADD CONSTRAINT "requirement_edges_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_edges" ADD CONSTRAINT "requirement_edges_requirement_set_id_requirement_sets_id_fk" FOREIGN KEY ("requirement_set_id") REFERENCES "requirement_sets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_edges" ADD CONSTRAINT "requirement_edges_from_node_id_requirement_nodes_id_fk" FOREIGN KEY ("from_node_id") REFERENCES "requirement_nodes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_edges" ADD CONSTRAINT "requirement_edges_to_node_id_requirement_nodes_id_fk" FOREIGN KEY ("to_node_id") REFERENCES "requirement_nodes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_edges" ADD CONSTRAINT "requirement_edges_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_edges" ADD CONSTRAINT "requirement_edges_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_edges" ADD CONSTRAINT "requirement_edges_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_edges" ADD CONSTRAINT "requirement_edges_biz_set_fk" FOREIGN KEY ("biz_id","requirement_set_id") REFERENCES "requirement_sets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_edges" ADD CONSTRAINT "requirement_edges_biz_set_from_node_fk" FOREIGN KEY ("biz_id","requirement_set_id","from_node_id") REFERENCES "requirement_nodes"("biz_id","requirement_set_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_edges" ADD CONSTRAINT "requirement_edges_biz_set_to_node_fk" FOREIGN KEY ("biz_id","requirement_set_id","to_node_id") REFERENCES "requirement_nodes"("biz_id","requirement_set_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evaluations" ADD CONSTRAINT "requirement_evaluations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evaluations" ADD CONSTRAINT "requirement_evaluations_requirement_set_id_requirement_sets_id_fk" FOREIGN KEY ("requirement_set_id") REFERENCES "requirement_sets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evaluations" ADD CONSTRAINT "requirement_evaluations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evaluations" ADD CONSTRAINT "requirement_evaluations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evaluations" ADD CONSTRAINT "requirement_evaluations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evaluations" ADD CONSTRAINT "requirement_evaluations_biz_set_fk" FOREIGN KEY ("biz_id","requirement_set_id") REFERENCES "requirement_sets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evaluations" ADD CONSTRAINT "requirement_evaluations_biz_evaluated_subject_fk" FOREIGN KEY ("biz_id","evaluated_subject_type","evaluated_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evaluations" ADD CONSTRAINT "requirement_evaluations_biz_context_subject_fk" FOREIGN KEY ("biz_id","context_subject_type","context_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evidence_links" ADD CONSTRAINT "requirement_evidence_links_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evidence_links" ADD CONSTRAINT "requirement_evidence_links_requirement_evaluation_id_requirement_evaluations_id_fk" FOREIGN KEY ("requirement_evaluation_id") REFERENCES "requirement_evaluations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evidence_links" ADD CONSTRAINT "requirement_evidence_links_requirement_node_id_requirement_nodes_id_fk" FOREIGN KEY ("requirement_node_id") REFERENCES "requirement_nodes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evidence_links" ADD CONSTRAINT "requirement_evidence_links_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evidence_links" ADD CONSTRAINT "requirement_evidence_links_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evidence_links" ADD CONSTRAINT "requirement_evidence_links_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evidence_links" ADD CONSTRAINT "requirement_evidence_links_biz_evaluation_fk" FOREIGN KEY ("biz_id","requirement_evaluation_id") REFERENCES "requirement_evaluations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evidence_links" ADD CONSTRAINT "requirement_evidence_links_biz_node_fk" FOREIGN KEY ("biz_id","requirement_node_id") REFERENCES "requirement_nodes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_evidence_links" ADD CONSTRAINT "requirement_evidence_links_biz_subject_fk" FOREIGN KEY ("biz_id","subject_type","subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_nodes" ADD CONSTRAINT "requirement_nodes_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_nodes" ADD CONSTRAINT "requirement_nodes_requirement_set_id_requirement_sets_id_fk" FOREIGN KEY ("requirement_set_id") REFERENCES "requirement_sets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_nodes" ADD CONSTRAINT "requirement_nodes_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_nodes" ADD CONSTRAINT "requirement_nodes_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_nodes" ADD CONSTRAINT "requirement_nodes_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_nodes" ADD CONSTRAINT "requirement_nodes_biz_set_fk" FOREIGN KEY ("biz_id","requirement_set_id") REFERENCES "requirement_sets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_nodes" ADD CONSTRAINT "requirement_nodes_biz_target_subject_fk" FOREIGN KEY ("biz_id","target_subject_type","target_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_sets" ADD CONSTRAINT "requirement_sets_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_sets" ADD CONSTRAINT "requirement_sets_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_sets" ADD CONSTRAINT "requirement_sets_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_sets" ADD CONSTRAINT "requirement_sets_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_attempts" ADD CONSTRAINT "assessment_attempts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_attempts" ADD CONSTRAINT "assessment_attempts_assessment_template_id_assessment_templates_id_fk" FOREIGN KEY ("assessment_template_id") REFERENCES "assessment_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_attempts" ADD CONSTRAINT "assessment_attempts_requirement_evaluation_id_requirement_evaluations_id_fk" FOREIGN KEY ("requirement_evaluation_id") REFERENCES "requirement_evaluations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_attempts" ADD CONSTRAINT "assessment_attempts_reviewer_user_id_users_id_fk" FOREIGN KEY ("reviewer_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_attempts" ADD CONSTRAINT "assessment_attempts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_attempts" ADD CONSTRAINT "assessment_attempts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_attempts" ADD CONSTRAINT "assessment_attempts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_attempts" ADD CONSTRAINT "assessment_attempts_biz_template_fk" FOREIGN KEY ("biz_id","assessment_template_id") REFERENCES "assessment_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_attempts" ADD CONSTRAINT "assessment_attempts_biz_candidate_fk" FOREIGN KEY ("biz_id","candidate_subject_type","candidate_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_attempts" ADD CONSTRAINT "assessment_attempts_biz_context_fk" FOREIGN KEY ("biz_id","context_subject_type","context_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_attempts" ADD CONSTRAINT "assessment_attempts_biz_requirement_eval_fk" FOREIGN KEY ("biz_id","requirement_evaluation_id") REFERENCES "requirement_evaluations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_items" ADD CONSTRAINT "assessment_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_items" ADD CONSTRAINT "assessment_items_assessment_template_id_assessment_templates_id_fk" FOREIGN KEY ("assessment_template_id") REFERENCES "assessment_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_items" ADD CONSTRAINT "assessment_items_requirement_node_id_requirement_nodes_id_fk" FOREIGN KEY ("requirement_node_id") REFERENCES "requirement_nodes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_items" ADD CONSTRAINT "assessment_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_items" ADD CONSTRAINT "assessment_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_items" ADD CONSTRAINT "assessment_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_items" ADD CONSTRAINT "assessment_items_biz_template_fk" FOREIGN KEY ("biz_id","assessment_template_id") REFERENCES "assessment_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_items" ADD CONSTRAINT "assessment_items_biz_requirement_node_fk" FOREIGN KEY ("biz_id","requirement_node_id") REFERENCES "requirement_nodes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_responses" ADD CONSTRAINT "assessment_responses_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_responses" ADD CONSTRAINT "assessment_responses_assessment_attempt_id_assessment_attempts_id_fk" FOREIGN KEY ("assessment_attempt_id") REFERENCES "assessment_attempts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_responses" ADD CONSTRAINT "assessment_responses_assessment_template_id_assessment_templates_id_fk" FOREIGN KEY ("assessment_template_id") REFERENCES "assessment_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_responses" ADD CONSTRAINT "assessment_responses_assessment_item_id_assessment_items_id_fk" FOREIGN KEY ("assessment_item_id") REFERENCES "assessment_items"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_responses" ADD CONSTRAINT "assessment_responses_scored_by_user_id_users_id_fk" FOREIGN KEY ("scored_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_responses" ADD CONSTRAINT "assessment_responses_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_responses" ADD CONSTRAINT "assessment_responses_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_responses" ADD CONSTRAINT "assessment_responses_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_responses" ADD CONSTRAINT "assessment_responses_biz_template_fk" FOREIGN KEY ("biz_id","assessment_template_id") REFERENCES "assessment_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_responses" ADD CONSTRAINT "assessment_responses_biz_attempt_template_fk" FOREIGN KEY ("biz_id","assessment_attempt_id","assessment_template_id") REFERENCES "assessment_attempts"("biz_id","id","assessment_template_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_responses" ADD CONSTRAINT "assessment_responses_biz_item_template_fk" FOREIGN KEY ("biz_id","assessment_item_id","assessment_template_id") REFERENCES "assessment_items"("biz_id","id","assessment_template_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_results" ADD CONSTRAINT "assessment_results_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_results" ADD CONSTRAINT "assessment_results_assessment_attempt_id_assessment_attempts_id_fk" FOREIGN KEY ("assessment_attempt_id") REFERENCES "assessment_attempts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_results" ADD CONSTRAINT "assessment_results_assessment_template_id_assessment_templates_id_fk" FOREIGN KEY ("assessment_template_id") REFERENCES "assessment_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_results" ADD CONSTRAINT "assessment_results_requirement_evaluation_id_requirement_evaluations_id_fk" FOREIGN KEY ("requirement_evaluation_id") REFERENCES "requirement_evaluations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_results" ADD CONSTRAINT "assessment_results_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_results" ADD CONSTRAINT "assessment_results_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_results" ADD CONSTRAINT "assessment_results_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_results" ADD CONSTRAINT "assessment_results_biz_attempt_template_fk" FOREIGN KEY ("biz_id","assessment_attempt_id","assessment_template_id") REFERENCES "assessment_attempts"("biz_id","id","assessment_template_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_results" ADD CONSTRAINT "assessment_results_biz_template_fk" FOREIGN KEY ("biz_id","assessment_template_id") REFERENCES "assessment_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_results" ADD CONSTRAINT "assessment_results_biz_candidate_fk" FOREIGN KEY ("biz_id","candidate_subject_type","candidate_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_results" ADD CONSTRAINT "assessment_results_biz_requirement_eval_fk" FOREIGN KEY ("biz_id","requirement_evaluation_id") REFERENCES "requirement_evaluations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_templates" ADD CONSTRAINT "assessment_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_templates" ADD CONSTRAINT "assessment_templates_requirement_set_id_requirement_sets_id_fk" FOREIGN KEY ("requirement_set_id") REFERENCES "requirement_sets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_templates" ADD CONSTRAINT "assessment_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_templates" ADD CONSTRAINT "assessment_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_templates" ADD CONSTRAINT "assessment_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "assessment_templates" ADD CONSTRAINT "assessment_templates_biz_requirement_set_fk" FOREIGN KEY ("biz_id","requirement_set_id") REFERENCES "requirement_sets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "grading_events" ADD CONSTRAINT "grading_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "grading_events" ADD CONSTRAINT "grading_events_assessment_attempt_id_assessment_attempts_id_fk" FOREIGN KEY ("assessment_attempt_id") REFERENCES "assessment_attempts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "grading_events" ADD CONSTRAINT "grading_events_assessment_template_id_assessment_templates_id_fk" FOREIGN KEY ("assessment_template_id") REFERENCES "assessment_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "grading_events" ADD CONSTRAINT "grading_events_assessment_response_id_assessment_responses_id_fk" FOREIGN KEY ("assessment_response_id") REFERENCES "assessment_responses"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "grading_events" ADD CONSTRAINT "grading_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "grading_events" ADD CONSTRAINT "grading_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "grading_events" ADD CONSTRAINT "grading_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "grading_events" ADD CONSTRAINT "grading_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "grading_events" ADD CONSTRAINT "grading_events_biz_attempt_template_fk" FOREIGN KEY ("biz_id","assessment_attempt_id","assessment_template_id") REFERENCES "assessment_attempts"("biz_id","id","assessment_template_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "grading_events" ADD CONSTRAINT "grading_events_biz_response_fk" FOREIGN KEY ("biz_id","assessment_response_id") REFERENCES "assessment_responses"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "grading_events" ADD CONSTRAINT "grading_events_biz_actor_subject_fk" FOREIGN KEY ("biz_id","actor_subject_type","actor_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_events" ADD CONSTRAINT "audit_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_events" ADD CONSTRAINT "audit_events_stream_id_audit_streams_id_fk" FOREIGN KEY ("stream_id") REFERENCES "audit_streams"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_events" ADD CONSTRAINT "audit_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_events" ADD CONSTRAINT "audit_events_biz_stream_fk" FOREIGN KEY ("biz_id","stream_id") REFERENCES "audit_streams"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_integrity_runs" ADD CONSTRAINT "audit_integrity_runs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_integrity_runs" ADD CONSTRAINT "audit_integrity_runs_stream_id_audit_streams_id_fk" FOREIGN KEY ("stream_id") REFERENCES "audit_streams"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_integrity_runs" ADD CONSTRAINT "audit_integrity_runs_first_broken_event_id_audit_events_id_fk" FOREIGN KEY ("first_broken_event_id") REFERENCES "audit_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_integrity_runs" ADD CONSTRAINT "audit_integrity_runs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_integrity_runs" ADD CONSTRAINT "audit_integrity_runs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_integrity_runs" ADD CONSTRAINT "audit_integrity_runs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_integrity_runs" ADD CONSTRAINT "audit_integrity_runs_biz_stream_fk" FOREIGN KEY ("biz_id","stream_id") REFERENCES "audit_streams"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_integrity_runs" ADD CONSTRAINT "audit_integrity_runs_biz_first_broken_event_fk" FOREIGN KEY ("biz_id","first_broken_event_id") REFERENCES "audit_events"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_streams" ADD CONSTRAINT "audit_streams_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_streams" ADD CONSTRAINT "audit_streams_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_streams" ADD CONSTRAINT "audit_streams_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "audit_streams" ADD CONSTRAINT "audit_streams_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_installs" ADD CONSTRAINT "biz_extension_installs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_installs" ADD CONSTRAINT "biz_extension_installs_extension_definition_id_extension_definitions_id_fk" FOREIGN KEY ("extension_definition_id") REFERENCES "extension_definitions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_installs" ADD CONSTRAINT "biz_extension_installs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_installs" ADD CONSTRAINT "biz_extension_installs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_installs" ADD CONSTRAINT "biz_extension_installs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_permission_grants" ADD CONSTRAINT "biz_extension_permission_grants_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_permission_grants" ADD CONSTRAINT "biz_extension_permission_grants_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_permission_grants" ADD CONSTRAINT "biz_extension_permission_grants_extension_permission_definition_id_extension_permission_definitions_id_fk" FOREIGN KEY ("extension_permission_definition_id") REFERENCES "extension_permission_definitions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_permission_grants" ADD CONSTRAINT "biz_extension_permission_grants_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_permission_grants" ADD CONSTRAINT "biz_extension_permission_grants_granted_by_user_id_users_id_fk" FOREIGN KEY ("granted_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_permission_grants" ADD CONSTRAINT "biz_extension_permission_grants_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_permission_grants" ADD CONSTRAINT "biz_extension_permission_grants_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_permission_grants" ADD CONSTRAINT "biz_extension_permission_grants_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_permission_grants" ADD CONSTRAINT "biz_extension_permission_grants_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_permission_grants" ADD CONSTRAINT "biz_extension_permission_grants_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "biz_extension_permission_grants" ADD CONSTRAINT "biz_extension_permission_grants_biz_subject_fk" FOREIGN KEY ("biz_id","subject_ref_type","subject_ref_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definition_options" ADD CONSTRAINT "custom_field_definition_options_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definition_options" ADD CONSTRAINT "custom_field_definition_options_custom_field_definition_id_custom_field_definitions_id_fk" FOREIGN KEY ("custom_field_definition_id") REFERENCES "custom_field_definitions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definition_options" ADD CONSTRAINT "custom_field_definition_options_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definition_options" ADD CONSTRAINT "custom_field_definition_options_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definition_options" ADD CONSTRAINT "custom_field_definition_options_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definition_options" ADD CONSTRAINT "custom_field_definition_options_biz_definition_fk" FOREIGN KEY ("biz_id","custom_field_definition_id") REFERENCES "custom_field_definitions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definitions" ADD CONSTRAINT "custom_field_definitions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definitions" ADD CONSTRAINT "custom_field_definitions_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definitions" ADD CONSTRAINT "custom_field_definitions_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definitions" ADD CONSTRAINT "custom_field_definitions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definitions" ADD CONSTRAINT "custom_field_definitions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definitions" ADD CONSTRAINT "custom_field_definitions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definitions" ADD CONSTRAINT "custom_field_definitions_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_definitions" ADD CONSTRAINT "custom_field_definitions_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_values" ADD CONSTRAINT "custom_field_values_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_values" ADD CONSTRAINT "custom_field_values_custom_field_definition_id_custom_field_definitions_id_fk" FOREIGN KEY ("custom_field_definition_id") REFERENCES "custom_field_definitions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_values" ADD CONSTRAINT "custom_field_values_set_by_user_id_users_id_fk" FOREIGN KEY ("set_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_values" ADD CONSTRAINT "custom_field_values_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_values" ADD CONSTRAINT "custom_field_values_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_values" ADD CONSTRAINT "custom_field_values_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "custom_field_values" ADD CONSTRAINT "custom_field_values_biz_definition_fk" FOREIGN KEY ("biz_id","custom_field_definition_id") REFERENCES "custom_field_definitions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_api_call_runs" ADD CONSTRAINT "extension_api_call_runs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_api_call_runs" ADD CONSTRAINT "extension_api_call_runs_extension_service_connection_id_extension_service_connections_id_fk" FOREIGN KEY ("extension_service_connection_id") REFERENCES "extension_service_connections"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_api_call_runs" ADD CONSTRAINT "extension_api_call_runs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_api_call_runs" ADD CONSTRAINT "extension_api_call_runs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_api_call_runs" ADD CONSTRAINT "extension_api_call_runs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_api_call_runs" ADD CONSTRAINT "extension_api_call_runs_biz_connection_fk" FOREIGN KEY ("biz_id","extension_service_connection_id") REFERENCES "extension_service_connections"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_definitions" ADD CONSTRAINT "extension_definitions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_definitions" ADD CONSTRAINT "extension_definitions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_definitions" ADD CONSTRAINT "extension_definitions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_permission_definitions" ADD CONSTRAINT "extension_permission_definitions_extension_definition_id_extension_definitions_id_fk" FOREIGN KEY ("extension_definition_id") REFERENCES "extension_definitions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_permission_definitions" ADD CONSTRAINT "extension_permission_definitions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_permission_definitions" ADD CONSTRAINT "extension_permission_definitions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_permission_definitions" ADD CONSTRAINT "extension_permission_definitions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_connections" ADD CONSTRAINT "extension_service_connections_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_connections" ADD CONSTRAINT "extension_service_connections_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_connections" ADD CONSTRAINT "extension_service_connections_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_connections" ADD CONSTRAINT "extension_service_connections_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_connections" ADD CONSTRAINT "extension_service_connections_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_connections" ADD CONSTRAINT "extension_service_connections_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_object_links" ADD CONSTRAINT "extension_service_object_links_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_object_links" ADD CONSTRAINT "extension_service_object_links_extension_service_connection_id_extension_service_connections_id_fk" FOREIGN KEY ("extension_service_connection_id") REFERENCES "extension_service_connections"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_object_links" ADD CONSTRAINT "extension_service_object_links_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_object_links" ADD CONSTRAINT "extension_service_object_links_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_object_links" ADD CONSTRAINT "extension_service_object_links_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_object_links" ADD CONSTRAINT "extension_service_object_links_biz_connection_fk" FOREIGN KEY ("biz_id","extension_service_connection_id") REFERENCES "extension_service_connections"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_object_links" ADD CONSTRAINT "extension_service_object_links_biz_subject_fk" FOREIGN KEY ("biz_id","subject_type","subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_items" ADD CONSTRAINT "extension_service_sync_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_items" ADD CONSTRAINT "extension_service_sync_items_extension_service_sync_job_id_extension_service_sync_jobs_id_fk" FOREIGN KEY ("extension_service_sync_job_id") REFERENCES "extension_service_sync_jobs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_items" ADD CONSTRAINT "extension_service_sync_items_extension_service_object_link_id_extension_service_object_links_id_fk" FOREIGN KEY ("extension_service_object_link_id") REFERENCES "extension_service_object_links"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_items" ADD CONSTRAINT "extension_service_sync_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_items" ADD CONSTRAINT "extension_service_sync_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_items" ADD CONSTRAINT "extension_service_sync_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_items" ADD CONSTRAINT "extension_service_sync_items_biz_job_fk" FOREIGN KEY ("biz_id","extension_service_sync_job_id") REFERENCES "extension_service_sync_jobs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_items" ADD CONSTRAINT "extension_service_sync_items_biz_object_link_fk" FOREIGN KEY ("biz_id","extension_service_object_link_id") REFERENCES "extension_service_object_links"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_jobs" ADD CONSTRAINT "extension_service_sync_jobs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_jobs" ADD CONSTRAINT "extension_service_sync_jobs_extension_service_connection_id_extension_service_connections_id_fk" FOREIGN KEY ("extension_service_connection_id") REFERENCES "extension_service_connections"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_jobs" ADD CONSTRAINT "extension_service_sync_jobs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_jobs" ADD CONSTRAINT "extension_service_sync_jobs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_jobs" ADD CONSTRAINT "extension_service_sync_jobs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_service_sync_jobs" ADD CONSTRAINT "extension_service_sync_jobs_biz_connection_fk" FOREIGN KEY ("biz_id","extension_service_connection_id") REFERENCES "extension_service_connections"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_state_documents" ADD CONSTRAINT "extension_state_documents_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_state_documents" ADD CONSTRAINT "extension_state_documents_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_state_documents" ADD CONSTRAINT "extension_state_documents_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_state_documents" ADD CONSTRAINT "extension_state_documents_last_lifecycle_event_id_lifecycle_events_id_fk" FOREIGN KEY ("last_lifecycle_event_id") REFERENCES "lifecycle_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_state_documents" ADD CONSTRAINT "extension_state_documents_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_state_documents" ADD CONSTRAINT "extension_state_documents_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_state_documents" ADD CONSTRAINT "extension_state_documents_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_state_documents" ADD CONSTRAINT "extension_state_documents_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_state_documents" ADD CONSTRAINT "extension_state_documents_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_state_documents" ADD CONSTRAINT "extension_state_documents_biz_subject_fk" FOREIGN KEY ("biz_id","subject_ref_type","subject_ref_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_state_documents" ADD CONSTRAINT "extension_state_documents_biz_lifecycle_event_fk" FOREIGN KEY ("biz_id","last_lifecycle_event_id") REFERENCES "lifecycle_events"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_webhook_ingress_events" ADD CONSTRAINT "extension_webhook_ingress_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_webhook_ingress_events" ADD CONSTRAINT "extension_webhook_ingress_events_extension_service_connection_id_extension_service_connections_id_fk" FOREIGN KEY ("extension_service_connection_id") REFERENCES "extension_service_connections"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_webhook_ingress_events" ADD CONSTRAINT "extension_webhook_ingress_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_webhook_ingress_events" ADD CONSTRAINT "extension_webhook_ingress_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_webhook_ingress_events" ADD CONSTRAINT "extension_webhook_ingress_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "extension_webhook_ingress_events" ADD CONSTRAINT "extension_webhook_ingress_events_biz_connection_fk" FOREIGN KEY ("biz_id","extension_service_connection_id") REFERENCES "extension_service_connections"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "idempotency_keys" ADD CONSTRAINT "idempotency_keys_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "idempotency_keys" ADD CONSTRAINT "idempotency_keys_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "idempotency_keys" ADD CONSTRAINT "idempotency_keys_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "idempotency_keys" ADD CONSTRAINT "idempotency_keys_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_deliveries" ADD CONSTRAINT "lifecycle_event_deliveries_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_deliveries" ADD CONSTRAINT "lifecycle_event_deliveries_lifecycle_event_id_lifecycle_events_id_fk" FOREIGN KEY ("lifecycle_event_id") REFERENCES "lifecycle_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_deliveries" ADD CONSTRAINT "lifecycle_event_deliveries_lifecycle_event_subscription_id_lifecycle_event_subscriptions_id_fk" FOREIGN KEY ("lifecycle_event_subscription_id") REFERENCES "lifecycle_event_subscriptions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_deliveries" ADD CONSTRAINT "lifecycle_event_deliveries_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_deliveries" ADD CONSTRAINT "lifecycle_event_deliveries_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_deliveries" ADD CONSTRAINT "lifecycle_event_deliveries_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_deliveries" ADD CONSTRAINT "lifecycle_event_deliveries_biz_event_fk" FOREIGN KEY ("biz_id","lifecycle_event_id") REFERENCES "lifecycle_events"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_deliveries" ADD CONSTRAINT "lifecycle_event_deliveries_biz_subscription_fk" FOREIGN KEY ("biz_id","lifecycle_event_subscription_id") REFERENCES "lifecycle_event_subscriptions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_subscriptions" ADD CONSTRAINT "lifecycle_event_subscriptions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_subscriptions" ADD CONSTRAINT "lifecycle_event_subscriptions_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_subscriptions" ADD CONSTRAINT "lifecycle_event_subscriptions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_subscriptions" ADD CONSTRAINT "lifecycle_event_subscriptions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_subscriptions" ADD CONSTRAINT "lifecycle_event_subscriptions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_event_subscriptions" ADD CONSTRAINT "lifecycle_event_subscriptions_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_events" ADD CONSTRAINT "lifecycle_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_events" ADD CONSTRAINT "lifecycle_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "lifecycle_events" ADD CONSTRAINT "lifecycle_events_causation_event_id_lifecycle_events_id_fk" FOREIGN KEY ("causation_event_id") REFERENCES "lifecycle_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_token_events" ADD CONSTRAINT "access_action_token_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_token_events" ADD CONSTRAINT "access_action_token_events_access_action_token_id_access_action_tokens_id_fk" FOREIGN KEY ("access_action_token_id") REFERENCES "access_action_tokens"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_token_events" ADD CONSTRAINT "access_action_token_events_access_activity_log_id_access_activity_logs_id_fk" FOREIGN KEY ("access_activity_log_id") REFERENCES "access_activity_logs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_token_events" ADD CONSTRAINT "access_action_token_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_token_events" ADD CONSTRAINT "access_action_token_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_token_events" ADD CONSTRAINT "access_action_token_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_token_events" ADD CONSTRAINT "access_action_token_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_token_events" ADD CONSTRAINT "access_action_token_events_biz_token_fk" FOREIGN KEY ("biz_id","access_action_token_id") REFERENCES "access_action_tokens"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_token_events" ADD CONSTRAINT "access_action_token_events_biz_activity_log_fk" FOREIGN KEY ("biz_id","access_activity_log_id") REFERENCES "access_activity_logs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_token_events" ADD CONSTRAINT "access_action_token_events_biz_actor_subject_fk" FOREIGN KEY ("biz_id","actor_subject_type","actor_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_tokens" ADD CONSTRAINT "access_action_tokens_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_tokens" ADD CONSTRAINT "access_action_tokens_access_artifact_id_access_artifacts_id_fk" FOREIGN KEY ("access_artifact_id") REFERENCES "access_artifacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_tokens" ADD CONSTRAINT "access_action_tokens_intended_holder_user_id_users_id_fk" FOREIGN KEY ("intended_holder_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_tokens" ADD CONSTRAINT "access_action_tokens_intended_holder_group_account_id_group_accounts_id_fk" FOREIGN KEY ("intended_holder_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_tokens" ADD CONSTRAINT "access_action_tokens_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_tokens" ADD CONSTRAINT "access_action_tokens_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_tokens" ADD CONSTRAINT "access_action_tokens_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_tokens" ADD CONSTRAINT "access_action_tokens_biz_artifact_fk" FOREIGN KEY ("biz_id","access_artifact_id") REFERENCES "access_artifacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_action_tokens" ADD CONSTRAINT "access_action_tokens_biz_intended_subject_fk" FOREIGN KEY ("biz_id","intended_holder_subject_type","intended_holder_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_activity_logs" ADD CONSTRAINT "access_activity_logs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_activity_logs" ADD CONSTRAINT "access_activity_logs_access_artifact_id_access_artifacts_id_fk" FOREIGN KEY ("access_artifact_id") REFERENCES "access_artifacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_activity_logs" ADD CONSTRAINT "access_activity_logs_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_activity_logs" ADD CONSTRAINT "access_activity_logs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_activity_logs" ADD CONSTRAINT "access_activity_logs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_activity_logs" ADD CONSTRAINT "access_activity_logs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_activity_logs" ADD CONSTRAINT "access_activity_logs_biz_artifact_fk" FOREIGN KEY ("biz_id","access_artifact_id") REFERENCES "access_artifacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_activity_logs" ADD CONSTRAINT "access_activity_logs_biz_actor_subject_fk" FOREIGN KEY ("biz_id","actor_subject_type","actor_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_events" ADD CONSTRAINT "access_artifact_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_events" ADD CONSTRAINT "access_artifact_events_access_artifact_id_access_artifacts_id_fk" FOREIGN KEY ("access_artifact_id") REFERENCES "access_artifacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_events" ADD CONSTRAINT "access_artifact_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_events" ADD CONSTRAINT "access_artifact_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_events" ADD CONSTRAINT "access_artifact_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_events" ADD CONSTRAINT "access_artifact_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_events" ADD CONSTRAINT "access_artifact_events_biz_artifact_fk" FOREIGN KEY ("biz_id","access_artifact_id") REFERENCES "access_artifacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_events" ADD CONSTRAINT "access_artifact_events_biz_actor_subject_fk" FOREIGN KEY ("biz_id","actor_subject_type","actor_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_access_artifact_id_access_artifacts_id_fk" FOREIGN KEY ("access_artifact_id") REFERENCES "access_artifacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_membership_id_memberships_id_fk" FOREIGN KEY ("membership_id") REFERENCES "memberships"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_entitlement_grant_id_entitlement_grants_id_fk" FOREIGN KEY ("entitlement_grant_id") REFERENCES "entitlement_grants"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_biz_artifact_fk" FOREIGN KEY ("biz_id","access_artifact_id") REFERENCES "access_artifacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_biz_booking_order_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_biz_membership_fk" FOREIGN KEY ("biz_id","membership_id") REFERENCES "memberships"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_biz_entitlement_grant_fk" FOREIGN KEY ("biz_id","entitlement_grant_id") REFERENCES "entitlement_grants"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_biz_payment_transaction_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifact_links" ADD CONSTRAINT "access_artifact_links_biz_custom_subject_fk" FOREIGN KEY ("biz_id","custom_subject_type","custom_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifacts" ADD CONSTRAINT "access_artifacts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifacts" ADD CONSTRAINT "access_artifacts_holder_user_id_users_id_fk" FOREIGN KEY ("holder_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifacts" ADD CONSTRAINT "access_artifacts_holder_group_account_id_group_accounts_id_fk" FOREIGN KEY ("holder_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifacts" ADD CONSTRAINT "access_artifacts_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifacts" ADD CONSTRAINT "access_artifacts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifacts" ADD CONSTRAINT "access_artifacts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifacts" ADD CONSTRAINT "access_artifacts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifacts" ADD CONSTRAINT "access_artifacts_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_artifacts" ADD CONSTRAINT "access_artifacts_biz_holder_subject_fk" FOREIGN KEY ("biz_id","holder_subject_type","holder_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_delivery_links" ADD CONSTRAINT "access_delivery_links_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_delivery_links" ADD CONSTRAINT "access_delivery_links_access_artifact_id_access_artifacts_id_fk" FOREIGN KEY ("access_artifact_id") REFERENCES "access_artifacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_delivery_links" ADD CONSTRAINT "access_delivery_links_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_delivery_links" ADD CONSTRAINT "access_delivery_links_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_delivery_links" ADD CONSTRAINT "access_delivery_links_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_delivery_links" ADD CONSTRAINT "access_delivery_links_biz_artifact_fk" FOREIGN KEY ("biz_id","access_artifact_id") REFERENCES "access_artifacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_access_artifact_id_access_artifacts_id_fk" FOREIGN KEY ("access_artifact_id") REFERENCES "access_artifacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_access_transfer_policy_id_access_transfer_policies_id_fk" FOREIGN KEY ("access_transfer_policy_id") REFERENCES "access_transfer_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_seller_user_id_users_id_fk" FOREIGN KEY ("seller_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_seller_group_account_id_group_accounts_id_fk" FOREIGN KEY ("seller_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_buyer_user_id_users_id_fk" FOREIGN KEY ("buyer_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_buyer_group_account_id_group_accounts_id_fk" FOREIGN KEY ("buyer_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_completed_transfer_id_access_transfers_id_fk" FOREIGN KEY ("completed_transfer_id") REFERENCES "access_transfers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_biz_artifact_fk" FOREIGN KEY ("biz_id","access_artifact_id") REFERENCES "access_artifacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_biz_policy_fk" FOREIGN KEY ("biz_id","access_transfer_policy_id") REFERENCES "access_transfer_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_biz_transfer_fk" FOREIGN KEY ("biz_id","completed_transfer_id") REFERENCES "access_transfers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_biz_seller_subject_fk" FOREIGN KEY ("biz_id","seller_subject_type","seller_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_resale_listings" ADD CONSTRAINT "access_resale_listings_biz_buyer_subject_fk" FOREIGN KEY ("biz_id","buyer_subject_type","buyer_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_access_security_signal_id_access_security_signals_id_fk" FOREIGN KEY ("access_security_signal_id") REFERENCES "access_security_signals"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_access_artifact_id_access_artifacts_id_fk" FOREIGN KEY ("access_artifact_id") REFERENCES "access_artifacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_access_action_token_id_access_action_tokens_id_fk" FOREIGN KEY ("access_action_token_id") REFERENCES "access_action_tokens"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_access_activity_log_id_access_activity_logs_id_fk" FOREIGN KEY ("access_activity_log_id") REFERENCES "access_activity_logs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_decided_by_user_id_users_id_fk" FOREIGN KEY ("decided_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_biz_signal_fk" FOREIGN KEY ("biz_id","access_security_signal_id") REFERENCES "access_security_signals"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_biz_artifact_fk" FOREIGN KEY ("biz_id","access_artifact_id") REFERENCES "access_artifacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_biz_token_fk" FOREIGN KEY ("biz_id","access_action_token_id") REFERENCES "access_action_tokens"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_biz_activity_log_fk" FOREIGN KEY ("biz_id","access_activity_log_id") REFERENCES "access_activity_logs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_decisions" ADD CONSTRAINT "access_security_decisions_biz_actor_subject_fk" FOREIGN KEY ("biz_id","decided_by_subject_type","decided_by_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_signals" ADD CONSTRAINT "access_security_signals_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_signals" ADD CONSTRAINT "access_security_signals_access_artifact_id_access_artifacts_id_fk" FOREIGN KEY ("access_artifact_id") REFERENCES "access_artifacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_signals" ADD CONSTRAINT "access_security_signals_access_action_token_id_access_action_tokens_id_fk" FOREIGN KEY ("access_action_token_id") REFERENCES "access_action_tokens"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_signals" ADD CONSTRAINT "access_security_signals_access_activity_log_id_access_activity_logs_id_fk" FOREIGN KEY ("access_activity_log_id") REFERENCES "access_activity_logs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_signals" ADD CONSTRAINT "access_security_signals_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_signals" ADD CONSTRAINT "access_security_signals_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_signals" ADD CONSTRAINT "access_security_signals_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_signals" ADD CONSTRAINT "access_security_signals_biz_artifact_fk" FOREIGN KEY ("biz_id","access_artifact_id") REFERENCES "access_artifacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_signals" ADD CONSTRAINT "access_security_signals_biz_token_fk" FOREIGN KEY ("biz_id","access_action_token_id") REFERENCES "access_action_tokens"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_signals" ADD CONSTRAINT "access_security_signals_biz_activity_log_fk" FOREIGN KEY ("biz_id","access_activity_log_id") REFERENCES "access_activity_logs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_security_signals" ADD CONSTRAINT "access_security_signals_biz_source_subject_fk" FOREIGN KEY ("biz_id","source_subject_type","source_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfer_policies" ADD CONSTRAINT "access_transfer_policies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfer_policies" ADD CONSTRAINT "access_transfer_policies_applies_to_sellable_id_sellables_id_fk" FOREIGN KEY ("applies_to_sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfer_policies" ADD CONSTRAINT "access_transfer_policies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfer_policies" ADD CONSTRAINT "access_transfer_policies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfer_policies" ADD CONSTRAINT "access_transfer_policies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfer_policies" ADD CONSTRAINT "access_transfer_policies_biz_sellable_fk" FOREIGN KEY ("biz_id","applies_to_sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_source_access_artifact_id_access_artifacts_id_fk" FOREIGN KEY ("source_access_artifact_id") REFERENCES "access_artifacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_target_access_artifact_id_access_artifacts_id_fk" FOREIGN KEY ("target_access_artifact_id") REFERENCES "access_artifacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_access_transfer_policy_id_access_transfer_policies_id_fk" FOREIGN KEY ("access_transfer_policy_id") REFERENCES "access_transfer_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_requested_by_user_id_users_id_fk" FOREIGN KEY ("requested_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_approved_by_user_id_users_id_fk" FOREIGN KEY ("approved_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_target_holder_user_id_users_id_fk" FOREIGN KEY ("target_holder_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_target_holder_group_account_id_group_accounts_id_fk" FOREIGN KEY ("target_holder_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_biz_source_artifact_fk" FOREIGN KEY ("biz_id","source_access_artifact_id") REFERENCES "access_artifacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_biz_target_artifact_fk" FOREIGN KEY ("biz_id","target_access_artifact_id") REFERENCES "access_artifacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_biz_policy_fk" FOREIGN KEY ("biz_id","access_transfer_policy_id") REFERENCES "access_transfer_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_transfers" ADD CONSTRAINT "access_transfers_biz_target_subject_fk" FOREIGN KEY ("biz_id","target_holder_subject_type","target_holder_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_usage_windows" ADD CONSTRAINT "access_usage_windows_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_usage_windows" ADD CONSTRAINT "access_usage_windows_access_artifact_id_access_artifacts_id_fk" FOREIGN KEY ("access_artifact_id") REFERENCES "access_artifacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_usage_windows" ADD CONSTRAINT "access_usage_windows_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_usage_windows" ADD CONSTRAINT "access_usage_windows_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_usage_windows" ADD CONSTRAINT "access_usage_windows_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "access_usage_windows" ADD CONSTRAINT "access_usage_windows_biz_artifact_fk" FOREIGN KEY ("biz_id","access_artifact_id") REFERENCES "access_artifacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_recovery_links" ADD CONSTRAINT "checkout_recovery_links_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_recovery_links" ADD CONSTRAINT "checkout_recovery_links_checkout_session_id_checkout_sessions_id_fk" FOREIGN KEY ("checkout_session_id") REFERENCES "checkout_sessions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_recovery_links" ADD CONSTRAINT "checkout_recovery_links_discount_campaign_id_discount_campaigns_id_fk" FOREIGN KEY ("discount_campaign_id") REFERENCES "discount_campaigns"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_recovery_links" ADD CONSTRAINT "checkout_recovery_links_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_recovery_links" ADD CONSTRAINT "checkout_recovery_links_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_recovery_links" ADD CONSTRAINT "checkout_recovery_links_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_recovery_links" ADD CONSTRAINT "checkout_recovery_links_biz_session_fk" FOREIGN KEY ("biz_id","checkout_session_id") REFERENCES "checkout_sessions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_recovery_links" ADD CONSTRAINT "checkout_recovery_links_biz_discount_campaign_fk" FOREIGN KEY ("biz_id","discount_campaign_id") REFERENCES "discount_campaigns"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_events" ADD CONSTRAINT "checkout_session_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_events" ADD CONSTRAINT "checkout_session_events_checkout_session_id_checkout_sessions_id_fk" FOREIGN KEY ("checkout_session_id") REFERENCES "checkout_sessions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_events" ADD CONSTRAINT "checkout_session_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_events" ADD CONSTRAINT "checkout_session_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_events" ADD CONSTRAINT "checkout_session_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_events" ADD CONSTRAINT "checkout_session_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_events" ADD CONSTRAINT "checkout_session_events_biz_session_fk" FOREIGN KEY ("biz_id","checkout_session_id") REFERENCES "checkout_sessions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_events" ADD CONSTRAINT "checkout_session_events_biz_actor_subject_fk" FOREIGN KEY ("biz_id","actor_subject_type","actor_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_items" ADD CONSTRAINT "checkout_session_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_items" ADD CONSTRAINT "checkout_session_items_checkout_session_id_checkout_sessions_id_fk" FOREIGN KEY ("checkout_session_id") REFERENCES "checkout_sessions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_items" ADD CONSTRAINT "checkout_session_items_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_items" ADD CONSTRAINT "checkout_session_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_items" ADD CONSTRAINT "checkout_session_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_items" ADD CONSTRAINT "checkout_session_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_items" ADD CONSTRAINT "checkout_session_items_biz_session_fk" FOREIGN KEY ("biz_id","checkout_session_id") REFERENCES "checkout_sessions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_items" ADD CONSTRAINT "checkout_session_items_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_session_items" ADD CONSTRAINT "checkout_session_items_biz_custom_subject_fk" FOREIGN KEY ("biz_id","custom_subject_type","custom_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_sessions" ADD CONSTRAINT "checkout_sessions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_sessions" ADD CONSTRAINT "checkout_sessions_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_sessions" ADD CONSTRAINT "checkout_sessions_owner_group_account_id_group_accounts_id_fk" FOREIGN KEY ("owner_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_sessions" ADD CONSTRAINT "checkout_sessions_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_sessions" ADD CONSTRAINT "checkout_sessions_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_sessions" ADD CONSTRAINT "checkout_sessions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_sessions" ADD CONSTRAINT "checkout_sessions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_sessions" ADD CONSTRAINT "checkout_sessions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_sessions" ADD CONSTRAINT "checkout_sessions_biz_recovered_from_fk" FOREIGN KEY ("biz_id","recovered_from_checkout_session_id") REFERENCES "checkout_sessions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_sessions" ADD CONSTRAINT "checkout_sessions_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "checkout_sessions" ADD CONSTRAINT "checkout_sessions_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlist_items" ADD CONSTRAINT "wishlist_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlist_items" ADD CONSTRAINT "wishlist_items_wishlist_id_wishlists_id_fk" FOREIGN KEY ("wishlist_id") REFERENCES "wishlists"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlist_items" ADD CONSTRAINT "wishlist_items_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlist_items" ADD CONSTRAINT "wishlist_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlist_items" ADD CONSTRAINT "wishlist_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlist_items" ADD CONSTRAINT "wishlist_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlist_items" ADD CONSTRAINT "wishlist_items_biz_wishlist_fk" FOREIGN KEY ("biz_id","wishlist_id") REFERENCES "wishlists"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlist_items" ADD CONSTRAINT "wishlist_items_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlists" ADD CONSTRAINT "wishlists_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlists" ADD CONSTRAINT "wishlists_crm_contact_id_crm_contacts_id_fk" FOREIGN KEY ("crm_contact_id") REFERENCES "crm_contacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlists" ADD CONSTRAINT "wishlists_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlists" ADD CONSTRAINT "wishlists_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlists" ADD CONSTRAINT "wishlists_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wishlists" ADD CONSTRAINT "wishlists_biz_contact_fk" FOREIGN KEY ("biz_id","crm_contact_id") REFERENCES "crm_contacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_sales_quote_version_id_sales_quote_versions_id_fk" FOREIGN KEY ("sales_quote_version_id") REFERENCES "sales_quote_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_decided_by_crm_contact_id_crm_contacts_id_fk" FOREIGN KEY ("decided_by_crm_contact_id") REFERENCES "crm_contacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_interaction_submission_id_interaction_submissions_id_fk" FOREIGN KEY ("interaction_submission_id") REFERENCES "interaction_submissions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_biz_version_fk" FOREIGN KEY ("biz_id","sales_quote_version_id") REFERENCES "sales_quote_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_biz_submission_fk" FOREIGN KEY ("biz_id","interaction_submission_id") REFERENCES "interaction_submissions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_biz_actor_contact_fk" FOREIGN KEY ("biz_id","decided_by_crm_contact_id") REFERENCES "crm_contacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_acceptances" ADD CONSTRAINT "sales_quote_acceptances_biz_actor_subject_fk" FOREIGN KEY ("biz_id","decided_by_subject_type","decided_by_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_lines" ADD CONSTRAINT "sales_quote_lines_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_lines" ADD CONSTRAINT "sales_quote_lines_sales_quote_version_id_sales_quote_versions_id_fk" FOREIGN KEY ("sales_quote_version_id") REFERENCES "sales_quote_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_lines" ADD CONSTRAINT "sales_quote_lines_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_lines" ADD CONSTRAINT "sales_quote_lines_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_lines" ADD CONSTRAINT "sales_quote_lines_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_lines" ADD CONSTRAINT "sales_quote_lines_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_lines" ADD CONSTRAINT "sales_quote_lines_biz_version_fk" FOREIGN KEY ("biz_id","sales_quote_version_id") REFERENCES "sales_quote_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_lines" ADD CONSTRAINT "sales_quote_lines_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_versions" ADD CONSTRAINT "sales_quote_versions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_versions" ADD CONSTRAINT "sales_quote_versions_sales_quote_id_sales_quotes_id_fk" FOREIGN KEY ("sales_quote_id") REFERENCES "sales_quotes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_versions" ADD CONSTRAINT "sales_quote_versions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_versions" ADD CONSTRAINT "sales_quote_versions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_versions" ADD CONSTRAINT "sales_quote_versions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quote_versions" ADD CONSTRAINT "sales_quote_versions_biz_quote_fk" FOREIGN KEY ("biz_id","sales_quote_id") REFERENCES "sales_quotes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quotes" ADD CONSTRAINT "sales_quotes_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quotes" ADD CONSTRAINT "sales_quotes_crm_contact_id_crm_contacts_id_fk" FOREIGN KEY ("crm_contact_id") REFERENCES "crm_contacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quotes" ADD CONSTRAINT "sales_quotes_source_checkout_session_id_checkout_sessions_id_fk" FOREIGN KEY ("source_checkout_session_id") REFERENCES "checkout_sessions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quotes" ADD CONSTRAINT "sales_quotes_converted_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("converted_booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quotes" ADD CONSTRAINT "sales_quotes_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quotes" ADD CONSTRAINT "sales_quotes_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quotes" ADD CONSTRAINT "sales_quotes_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quotes" ADD CONSTRAINT "sales_quotes_biz_checkout_session_fk" FOREIGN KEY ("biz_id","source_checkout_session_id") REFERENCES "checkout_sessions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quotes" ADD CONSTRAINT "sales_quotes_biz_booking_order_fk" FOREIGN KEY ("biz_id","converted_booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sales_quotes" ADD CONSTRAINT "sales_quotes_biz_contact_fk" FOREIGN KEY ("biz_id","crm_contact_id") REFERENCES "crm_contacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_aggregates" ADD CONSTRAINT "session_interaction_aggregates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_aggregates" ADD CONSTRAINT "session_interaction_aggregates_program_session_id_program_cohort_sessions_id_fk" FOREIGN KEY ("program_session_id") REFERENCES "program_cohort_sessions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_aggregates" ADD CONSTRAINT "session_interaction_aggregates_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_aggregates" ADD CONSTRAINT "session_interaction_aggregates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_aggregates" ADD CONSTRAINT "session_interaction_aggregates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_aggregates" ADD CONSTRAINT "session_interaction_aggregates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_aggregates" ADD CONSTRAINT "session_interaction_aggregates_biz_program_session_fk" FOREIGN KEY ("biz_id","program_session_id") REFERENCES "program_cohort_sessions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_aggregates" ADD CONSTRAINT "session_interaction_aggregates_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_aggregates" ADD CONSTRAINT "session_interaction_aggregates_biz_custom_session_subject_fk" FOREIGN KEY ("biz_id","custom_session_subject_type","custom_session_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_program_session_id_program_cohort_sessions_id_fk" FOREIGN KEY ("program_session_id") REFERENCES "program_cohort_sessions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_participant_user_id_users_id_fk" FOREIGN KEY ("participant_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_participant_enrollment_id_cohort_enrollments_id_fk" FOREIGN KEY ("participant_enrollment_id") REFERENCES "cohort_enrollments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_biz_program_session_fk" FOREIGN KEY ("biz_id","program_session_id") REFERENCES "program_cohort_sessions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_biz_custom_session_subject_fk" FOREIGN KEY ("biz_id","custom_session_subject_type","custom_session_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_biz_enrollment_fk" FOREIGN KEY ("biz_id","participant_enrollment_id") REFERENCES "cohort_enrollments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "session_interaction_events" ADD CONSTRAINT "session_interaction_events_biz_participant_subject_fk" FOREIGN KEY ("biz_id","participant_subject_type","participant_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_assignments" ADD CONSTRAINT "interaction_assignments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_assignments" ADD CONSTRAINT "interaction_assignments_interaction_template_id_interaction_templates_id_fk" FOREIGN KEY ("interaction_template_id") REFERENCES "interaction_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_assignments" ADD CONSTRAINT "interaction_assignments_subject_user_id_users_id_fk" FOREIGN KEY ("subject_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_assignments" ADD CONSTRAINT "interaction_assignments_subject_group_account_id_group_accounts_id_fk" FOREIGN KEY ("subject_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_assignments" ADD CONSTRAINT "interaction_assignments_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_assignments" ADD CONSTRAINT "interaction_assignments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_assignments" ADD CONSTRAINT "interaction_assignments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_assignments" ADD CONSTRAINT "interaction_assignments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_assignments" ADD CONSTRAINT "interaction_assignments_biz_template_fk" FOREIGN KEY ("biz_id","interaction_template_id") REFERENCES "interaction_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_assignments" ADD CONSTRAINT "interaction_assignments_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_artifacts" ADD CONSTRAINT "interaction_submission_artifacts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_artifacts" ADD CONSTRAINT "interaction_submission_artifacts_interaction_submission_id_interaction_submissions_id_fk" FOREIGN KEY ("interaction_submission_id") REFERENCES "interaction_submissions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_artifacts" ADD CONSTRAINT "interaction_submission_artifacts_captured_by_user_id_users_id_fk" FOREIGN KEY ("captured_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_artifacts" ADD CONSTRAINT "interaction_submission_artifacts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_artifacts" ADD CONSTRAINT "interaction_submission_artifacts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_artifacts" ADD CONSTRAINT "interaction_submission_artifacts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_artifacts" ADD CONSTRAINT "interaction_submission_artifacts_biz_submission_fk" FOREIGN KEY ("biz_id","interaction_submission_id") REFERENCES "interaction_submissions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_signatures" ADD CONSTRAINT "interaction_submission_signatures_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_signatures" ADD CONSTRAINT "interaction_submission_signatures_interaction_submission_id_interaction_submissions_id_fk" FOREIGN KEY ("interaction_submission_id") REFERENCES "interaction_submissions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_signatures" ADD CONSTRAINT "interaction_submission_signatures_signer_user_id_users_id_fk" FOREIGN KEY ("signer_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_signatures" ADD CONSTRAINT "interaction_submission_signatures_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_signatures" ADD CONSTRAINT "interaction_submission_signatures_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_signatures" ADD CONSTRAINT "interaction_submission_signatures_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_signatures" ADD CONSTRAINT "interaction_submission_signatures_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_signatures" ADD CONSTRAINT "interaction_submission_signatures_biz_submission_fk" FOREIGN KEY ("biz_id","interaction_submission_id") REFERENCES "interaction_submissions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submission_signatures" ADD CONSTRAINT "interaction_submission_signatures_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submissions" ADD CONSTRAINT "interaction_submissions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submissions" ADD CONSTRAINT "interaction_submissions_interaction_assignment_id_interaction_assignments_id_fk" FOREIGN KEY ("interaction_assignment_id") REFERENCES "interaction_assignments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submissions" ADD CONSTRAINT "interaction_submissions_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submissions" ADD CONSTRAINT "interaction_submissions_reviewed_by_user_id_users_id_fk" FOREIGN KEY ("reviewed_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submissions" ADD CONSTRAINT "interaction_submissions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submissions" ADD CONSTRAINT "interaction_submissions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submissions" ADD CONSTRAINT "interaction_submissions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submissions" ADD CONSTRAINT "interaction_submissions_biz_assignment_fk" FOREIGN KEY ("biz_id","interaction_assignment_id") REFERENCES "interaction_assignments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_submissions" ADD CONSTRAINT "interaction_submissions_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_interaction_template_id_interaction_templates_id_fk" FOREIGN KEY ("interaction_template_id") REFERENCES "interaction_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_service_id_services_id_fk" FOREIGN KEY ("service_id") REFERENCES "services"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_offer_id_offers_id_fk" FOREIGN KEY ("offer_id") REFERENCES "offers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_biz_template_fk" FOREIGN KEY ("biz_id","interaction_template_id") REFERENCES "interaction_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_biz_service_fk" FOREIGN KEY ("biz_id","service_id") REFERENCES "services"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_biz_offer_fk" FOREIGN KEY ("biz_id","offer_id") REFERENCES "offers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_template_bindings" ADD CONSTRAINT "interaction_template_bindings_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_templates" ADD CONSTRAINT "interaction_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_templates" ADD CONSTRAINT "interaction_templates_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_templates" ADD CONSTRAINT "interaction_templates_template_type_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("template_type_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_templates" ADD CONSTRAINT "interaction_templates_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_templates" ADD CONSTRAINT "interaction_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_templates" ADD CONSTRAINT "interaction_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_templates" ADD CONSTRAINT "interaction_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_templates" ADD CONSTRAINT "interaction_templates_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_templates" ADD CONSTRAINT "interaction_templates_biz_template_type_config_fk" FOREIGN KEY ("biz_id","template_type_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "interaction_templates" ADD CONSTRAINT "interaction_templates_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignment_items" ADD CONSTRAINT "requirement_list_assignment_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignment_items" ADD CONSTRAINT "requirement_list_assignment_items_requirement_list_assignment_id_requirement_list_assignments_id_fk" FOREIGN KEY ("requirement_list_assignment_id") REFERENCES "requirement_list_assignments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignment_items" ADD CONSTRAINT "requirement_list_assignment_items_template_item_id_requirement_list_template_items_id_fk" FOREIGN KEY ("template_item_id") REFERENCES "requirement_list_template_items"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignment_items" ADD CONSTRAINT "requirement_list_assignment_items_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignment_items" ADD CONSTRAINT "requirement_list_assignment_items_completed_by_user_id_users_id_fk" FOREIGN KEY ("completed_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignment_items" ADD CONSTRAINT "requirement_list_assignment_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignment_items" ADD CONSTRAINT "requirement_list_assignment_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignment_items" ADD CONSTRAINT "requirement_list_assignment_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignment_items" ADD CONSTRAINT "requirement_list_assignment_items_biz_assignment_fk" FOREIGN KEY ("biz_id","requirement_list_assignment_id") REFERENCES "requirement_list_assignments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignment_items" ADD CONSTRAINT "requirement_list_assignment_items_biz_template_item_fk" FOREIGN KEY ("biz_id","template_item_id") REFERENCES "requirement_list_template_items"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignment_items" ADD CONSTRAINT "requirement_list_assignment_items_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignments" ADD CONSTRAINT "requirement_list_assignments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignments" ADD CONSTRAINT "requirement_list_assignments_requirement_list_template_id_requirement_list_templates_id_fk" FOREIGN KEY ("requirement_list_template_id") REFERENCES "requirement_list_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignments" ADD CONSTRAINT "requirement_list_assignments_subject_user_id_users_id_fk" FOREIGN KEY ("subject_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignments" ADD CONSTRAINT "requirement_list_assignments_subject_group_account_id_group_accounts_id_fk" FOREIGN KEY ("subject_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignments" ADD CONSTRAINT "requirement_list_assignments_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignments" ADD CONSTRAINT "requirement_list_assignments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignments" ADD CONSTRAINT "requirement_list_assignments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignments" ADD CONSTRAINT "requirement_list_assignments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignments" ADD CONSTRAINT "requirement_list_assignments_biz_template_fk" FOREIGN KEY ("biz_id","requirement_list_template_id") REFERENCES "requirement_list_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_assignments" ADD CONSTRAINT "requirement_list_assignments_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_template_items" ADD CONSTRAINT "requirement_list_template_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_template_items" ADD CONSTRAINT "requirement_list_template_items_requirement_list_template_id_requirement_list_templates_id_fk" FOREIGN KEY ("requirement_list_template_id") REFERENCES "requirement_list_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_template_items" ADD CONSTRAINT "requirement_list_template_items_item_type_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("item_type_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_template_items" ADD CONSTRAINT "requirement_list_template_items_depends_on_template_item_id_requirement_list_template_items_id_fk" FOREIGN KEY ("depends_on_template_item_id") REFERENCES "requirement_list_template_items"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_template_items" ADD CONSTRAINT "requirement_list_template_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_template_items" ADD CONSTRAINT "requirement_list_template_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_template_items" ADD CONSTRAINT "requirement_list_template_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_template_items" ADD CONSTRAINT "requirement_list_template_items_biz_template_fk" FOREIGN KEY ("biz_id","requirement_list_template_id") REFERENCES "requirement_list_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_template_items" ADD CONSTRAINT "requirement_list_template_items_biz_item_type_config_fk" FOREIGN KEY ("biz_id","item_type_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_templates" ADD CONSTRAINT "requirement_list_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_templates" ADD CONSTRAINT "requirement_list_templates_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_templates" ADD CONSTRAINT "requirement_list_templates_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_templates" ADD CONSTRAINT "requirement_list_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_templates" ADD CONSTRAINT "requirement_list_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_templates" ADD CONSTRAINT "requirement_list_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_templates" ADD CONSTRAINT "requirement_list_templates_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "requirement_list_templates" ADD CONSTRAINT "requirement_list_templates_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "communication_consents" ADD CONSTRAINT "communication_consents_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "communication_consents" ADD CONSTRAINT "communication_consents_subject_user_id_users_id_fk" FOREIGN KEY ("subject_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "communication_consents" ADD CONSTRAINT "communication_consents_subject_group_account_id_group_accounts_id_fk" FOREIGN KEY ("subject_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "communication_consents" ADD CONSTRAINT "communication_consents_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "communication_consents" ADD CONSTRAINT "communication_consents_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "communication_consents" ADD CONSTRAINT "communication_consents_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_enrollments" ADD CONSTRAINT "marketing_campaign_enrollments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_enrollments" ADD CONSTRAINT "marketing_campaign_enrollments_marketing_campaign_id_marketing_campaigns_id_fk" FOREIGN KEY ("marketing_campaign_id") REFERENCES "marketing_campaigns"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_enrollments" ADD CONSTRAINT "marketing_campaign_enrollments_subject_user_id_users_id_fk" FOREIGN KEY ("subject_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_enrollments" ADD CONSTRAINT "marketing_campaign_enrollments_subject_group_account_id_group_accounts_id_fk" FOREIGN KEY ("subject_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_enrollments" ADD CONSTRAINT "marketing_campaign_enrollments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_enrollments" ADD CONSTRAINT "marketing_campaign_enrollments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_enrollments" ADD CONSTRAINT "marketing_campaign_enrollments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_enrollments" ADD CONSTRAINT "marketing_campaign_enrollments_biz_campaign_fk" FOREIGN KEY ("biz_id","marketing_campaign_id") REFERENCES "marketing_campaigns"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_steps" ADD CONSTRAINT "marketing_campaign_steps_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_steps" ADD CONSTRAINT "marketing_campaign_steps_marketing_campaign_id_marketing_campaigns_id_fk" FOREIGN KEY ("marketing_campaign_id") REFERENCES "marketing_campaigns"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_steps" ADD CONSTRAINT "marketing_campaign_steps_message_template_id_message_templates_id_fk" FOREIGN KEY ("message_template_id") REFERENCES "message_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_steps" ADD CONSTRAINT "marketing_campaign_steps_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_steps" ADD CONSTRAINT "marketing_campaign_steps_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_steps" ADD CONSTRAINT "marketing_campaign_steps_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_steps" ADD CONSTRAINT "marketing_campaign_steps_biz_campaign_fk" FOREIGN KEY ("biz_id","marketing_campaign_id") REFERENCES "marketing_campaigns"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaign_steps" ADD CONSTRAINT "marketing_campaign_steps_biz_template_fk" FOREIGN KEY ("biz_id","message_template_id") REFERENCES "message_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaigns" ADD CONSTRAINT "marketing_campaigns_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaigns" ADD CONSTRAINT "marketing_campaigns_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaigns" ADD CONSTRAINT "marketing_campaigns_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaigns" ADD CONSTRAINT "marketing_campaigns_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaigns" ADD CONSTRAINT "marketing_campaigns_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_campaigns" ADD CONSTRAINT "marketing_campaigns_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_template_bindings" ADD CONSTRAINT "message_template_bindings_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_template_bindings" ADD CONSTRAINT "message_template_bindings_message_template_id_message_templates_id_fk" FOREIGN KEY ("message_template_id") REFERENCES "message_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_template_bindings" ADD CONSTRAINT "message_template_bindings_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_template_bindings" ADD CONSTRAINT "message_template_bindings_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_template_bindings" ADD CONSTRAINT "message_template_bindings_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_template_bindings" ADD CONSTRAINT "message_template_bindings_biz_template_fk" FOREIGN KEY ("biz_id","message_template_id") REFERENCES "message_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_templates" ADD CONSTRAINT "message_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_templates" ADD CONSTRAINT "message_templates_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_templates" ADD CONSTRAINT "message_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_templates" ADD CONSTRAINT "message_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_templates" ADD CONSTRAINT "message_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "message_templates" ADD CONSTRAINT "message_templates_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_message_events" ADD CONSTRAINT "outbound_message_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_message_events" ADD CONSTRAINT "outbound_message_events_outbound_message_id_outbound_messages_id_fk" FOREIGN KEY ("outbound_message_id") REFERENCES "outbound_messages"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_message_events" ADD CONSTRAINT "outbound_message_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_message_events" ADD CONSTRAINT "outbound_message_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_message_events" ADD CONSTRAINT "outbound_message_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_message_events" ADD CONSTRAINT "outbound_message_events_biz_message_fk" FOREIGN KEY ("biz_id","outbound_message_id") REFERENCES "outbound_messages"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_message_template_id_message_templates_id_fk" FOREIGN KEY ("message_template_id") REFERENCES "message_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_lifecycle_event_id_lifecycle_events_id_fk" FOREIGN KEY ("lifecycle_event_id") REFERENCES "lifecycle_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_marketing_campaign_id_marketing_campaigns_id_fk" FOREIGN KEY ("marketing_campaign_id") REFERENCES "marketing_campaigns"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_marketing_campaign_step_id_marketing_campaign_steps_id_fk" FOREIGN KEY ("marketing_campaign_step_id") REFERENCES "marketing_campaign_steps"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_recipient_user_id_users_id_fk" FOREIGN KEY ("recipient_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_recipient_group_account_id_group_accounts_id_fk" FOREIGN KEY ("recipient_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_biz_template_fk" FOREIGN KEY ("biz_id","message_template_id") REFERENCES "message_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_biz_lifecycle_event_fk" FOREIGN KEY ("biz_id","lifecycle_event_id") REFERENCES "lifecycle_events"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_biz_campaign_fk" FOREIGN KEY ("biz_id","marketing_campaign_id") REFERENCES "marketing_campaigns"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "outbound_messages" ADD CONSTRAINT "outbound_messages_biz_campaign_step_fk" FOREIGN KEY ("biz_id","marketing_campaign_step_id") REFERENCES "marketing_campaign_steps"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "quiet_hour_policies" ADD CONSTRAINT "quiet_hour_policies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "quiet_hour_policies" ADD CONSTRAINT "quiet_hour_policies_target_user_id_users_id_fk" FOREIGN KEY ("target_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "quiet_hour_policies" ADD CONSTRAINT "quiet_hour_policies_target_group_account_id_group_accounts_id_fk" FOREIGN KEY ("target_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "quiet_hour_policies" ADD CONSTRAINT "quiet_hour_policies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "quiet_hour_policies" ADD CONSTRAINT "quiet_hour_policies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "quiet_hour_policies" ADD CONSTRAINT "quiet_hour_policies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_invitations" ADD CONSTRAINT "survey_invitations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_invitations" ADD CONSTRAINT "survey_invitations_survey_template_id_survey_templates_id_fk" FOREIGN KEY ("survey_template_id") REFERENCES "survey_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_invitations" ADD CONSTRAINT "survey_invitations_recipient_user_id_users_id_fk" FOREIGN KEY ("recipient_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_invitations" ADD CONSTRAINT "survey_invitations_recipient_group_account_id_group_accounts_id_fk" FOREIGN KEY ("recipient_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_invitations" ADD CONSTRAINT "survey_invitations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_invitations" ADD CONSTRAINT "survey_invitations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_invitations" ADD CONSTRAINT "survey_invitations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_invitations" ADD CONSTRAINT "survey_invitations_biz_template_fk" FOREIGN KEY ("biz_id","survey_template_id") REFERENCES "survey_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_questions" ADD CONSTRAINT "survey_questions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_questions" ADD CONSTRAINT "survey_questions_survey_template_id_survey_templates_id_fk" FOREIGN KEY ("survey_template_id") REFERENCES "survey_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_questions" ADD CONSTRAINT "survey_questions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_questions" ADD CONSTRAINT "survey_questions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_questions" ADD CONSTRAINT "survey_questions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_questions" ADD CONSTRAINT "survey_questions_biz_template_fk" FOREIGN KEY ("biz_id","survey_template_id") REFERENCES "survey_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_response_answers" ADD CONSTRAINT "survey_response_answers_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_response_answers" ADD CONSTRAINT "survey_response_answers_survey_response_id_survey_responses_id_fk" FOREIGN KEY ("survey_response_id") REFERENCES "survey_responses"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_response_answers" ADD CONSTRAINT "survey_response_answers_survey_question_id_survey_questions_id_fk" FOREIGN KEY ("survey_question_id") REFERENCES "survey_questions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_response_answers" ADD CONSTRAINT "survey_response_answers_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_response_answers" ADD CONSTRAINT "survey_response_answers_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_response_answers" ADD CONSTRAINT "survey_response_answers_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_response_answers" ADD CONSTRAINT "survey_response_answers_biz_response_fk" FOREIGN KEY ("biz_id","survey_response_id") REFERENCES "survey_responses"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_response_answers" ADD CONSTRAINT "survey_response_answers_biz_question_fk" FOREIGN KEY ("biz_id","survey_question_id") REFERENCES "survey_questions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_responses" ADD CONSTRAINT "survey_responses_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_responses" ADD CONSTRAINT "survey_responses_survey_invitation_id_survey_invitations_id_fk" FOREIGN KEY ("survey_invitation_id") REFERENCES "survey_invitations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_responses" ADD CONSTRAINT "survey_responses_respondent_user_id_users_id_fk" FOREIGN KEY ("respondent_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_responses" ADD CONSTRAINT "survey_responses_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_responses" ADD CONSTRAINT "survey_responses_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_responses" ADD CONSTRAINT "survey_responses_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_responses" ADD CONSTRAINT "survey_responses_biz_invitation_fk" FOREIGN KEY ("biz_id","survey_invitation_id") REFERENCES "survey_invitations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_templates" ADD CONSTRAINT "survey_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_templates" ADD CONSTRAINT "survey_templates_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_templates" ADD CONSTRAINT "survey_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_templates" ADD CONSTRAINT "survey_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_templates" ADD CONSTRAINT "survey_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "survey_templates" ADD CONSTRAINT "survey_templates_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_campaigns" ADD CONSTRAINT "discount_campaigns_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_campaigns" ADD CONSTRAINT "discount_campaigns_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_campaigns" ADD CONSTRAINT "discount_campaigns_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_campaigns" ADD CONSTRAINT "discount_campaigns_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_campaigns" ADD CONSTRAINT "discount_campaigns_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_campaigns" ADD CONSTRAINT "discount_campaigns_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_codes" ADD CONSTRAINT "discount_codes_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_codes" ADD CONSTRAINT "discount_codes_discount_campaign_id_discount_campaigns_id_fk" FOREIGN KEY ("discount_campaign_id") REFERENCES "discount_campaigns"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_codes" ADD CONSTRAINT "discount_codes_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_codes" ADD CONSTRAINT "discount_codes_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_codes" ADD CONSTRAINT "discount_codes_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_codes" ADD CONSTRAINT "discount_codes_biz_campaign_fk" FOREIGN KEY ("biz_id","discount_campaign_id") REFERENCES "discount_campaigns"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_discount_campaign_id_discount_campaigns_id_fk" FOREIGN KEY ("discount_campaign_id") REFERENCES "discount_campaigns"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_discount_code_id_discount_codes_id_fk" FOREIGN KEY ("discount_code_id") REFERENCES "discount_codes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_customer_user_id_users_id_fk" FOREIGN KEY ("customer_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_biz_campaign_fk" FOREIGN KEY ("biz_id","discount_campaign_id") REFERENCES "discount_campaigns"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_biz_code_fk" FOREIGN KEY ("biz_id","discount_code_id") REFERENCES "discount_codes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_biz_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "discount_redemptions" ADD CONSTRAINT "discount_redemptions_biz_order_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_approvals" ADD CONSTRAINT "work_approvals_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_approvals" ADD CONSTRAINT "work_approvals_work_run_id_work_runs_id_fk" FOREIGN KEY ("work_run_id") REFERENCES "work_runs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_approvals" ADD CONSTRAINT "work_approvals_approver_user_id_users_id_fk" FOREIGN KEY ("approver_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_approvals" ADD CONSTRAINT "work_approvals_approver_group_account_id_group_accounts_id_fk" FOREIGN KEY ("approver_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_approvals" ADD CONSTRAINT "work_approvals_decided_by_user_id_users_id_fk" FOREIGN KEY ("decided_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_approvals" ADD CONSTRAINT "work_approvals_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_approvals" ADD CONSTRAINT "work_approvals_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_approvals" ADD CONSTRAINT "work_approvals_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_approvals" ADD CONSTRAINT "work_approvals_biz_run_fk" FOREIGN KEY ("biz_id","work_run_id") REFERENCES "work_runs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_artifacts" ADD CONSTRAINT "work_artifacts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_artifacts" ADD CONSTRAINT "work_artifacts_work_run_id_work_runs_id_fk" FOREIGN KEY ("work_run_id") REFERENCES "work_runs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_artifacts" ADD CONSTRAINT "work_artifacts_work_entry_id_work_entries_id_fk" FOREIGN KEY ("work_entry_id") REFERENCES "work_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_artifacts" ADD CONSTRAINT "work_artifacts_captured_by_user_id_users_id_fk" FOREIGN KEY ("captured_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_artifacts" ADD CONSTRAINT "work_artifacts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_artifacts" ADD CONSTRAINT "work_artifacts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_artifacts" ADD CONSTRAINT "work_artifacts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_artifacts" ADD CONSTRAINT "work_artifacts_biz_run_fk" FOREIGN KEY ("biz_id","work_run_id") REFERENCES "work_runs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_artifacts" ADD CONSTRAINT "work_artifacts_biz_entry_fk" FOREIGN KEY ("biz_id","work_entry_id") REFERENCES "work_entries"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_entries" ADD CONSTRAINT "work_entries_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_entries" ADD CONSTRAINT "work_entries_work_run_id_work_runs_id_fk" FOREIGN KEY ("work_run_id") REFERENCES "work_runs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_entries" ADD CONSTRAINT "work_entries_work_run_step_id_work_run_steps_id_fk" FOREIGN KEY ("work_run_step_id") REFERENCES "work_run_steps"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_entries" ADD CONSTRAINT "work_entries_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_entries" ADD CONSTRAINT "work_entries_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_entries" ADD CONSTRAINT "work_entries_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_entries" ADD CONSTRAINT "work_entries_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_entries" ADD CONSTRAINT "work_entries_biz_run_fk" FOREIGN KEY ("biz_id","work_run_id") REFERENCES "work_runs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_entries" ADD CONSTRAINT "work_entries_biz_run_step_fk" FOREIGN KEY ("biz_id","work_run_step_id") REFERENCES "work_run_steps"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_entries" ADD CONSTRAINT "work_entries_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_run_steps" ADD CONSTRAINT "work_run_steps_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_run_steps" ADD CONSTRAINT "work_run_steps_work_run_id_work_runs_id_fk" FOREIGN KEY ("work_run_id") REFERENCES "work_runs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_run_steps" ADD CONSTRAINT "work_run_steps_work_template_step_id_work_template_steps_id_fk" FOREIGN KEY ("work_template_step_id") REFERENCES "work_template_steps"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_run_steps" ADD CONSTRAINT "work_run_steps_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_run_steps" ADD CONSTRAINT "work_run_steps_completed_by_user_id_users_id_fk" FOREIGN KEY ("completed_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_run_steps" ADD CONSTRAINT "work_run_steps_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_run_steps" ADD CONSTRAINT "work_run_steps_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_run_steps" ADD CONSTRAINT "work_run_steps_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_run_steps" ADD CONSTRAINT "work_run_steps_biz_run_fk" FOREIGN KEY ("biz_id","work_run_id") REFERENCES "work_runs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_run_steps" ADD CONSTRAINT "work_run_steps_biz_template_step_fk" FOREIGN KEY ("biz_id","work_template_step_id") REFERENCES "work_template_steps"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_run_steps" ADD CONSTRAINT "work_run_steps_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_work_template_id_work_templates_id_fk" FOREIGN KEY ("work_template_id") REFERENCES "work_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_parent_work_run_id_work_runs_id_fk" FOREIGN KEY ("parent_work_run_id") REFERENCES "work_runs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_assignee_user_id_users_id_fk" FOREIGN KEY ("assignee_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_assignee_group_account_id_group_accounts_id_fk" FOREIGN KEY ("assignee_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_idempotency_key_id_idempotency_keys_id_fk" FOREIGN KEY ("idempotency_key_id") REFERENCES "idempotency_keys"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_biz_template_fk" FOREIGN KEY ("biz_id","work_template_id") REFERENCES "work_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_biz_idempotency_key_fk" FOREIGN KEY ("biz_id","idempotency_key_id") REFERENCES "idempotency_keys"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_runs" ADD CONSTRAINT "work_runs_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_template_steps" ADD CONSTRAINT "work_template_steps_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_template_steps" ADD CONSTRAINT "work_template_steps_work_template_id_work_templates_id_fk" FOREIGN KEY ("work_template_id") REFERENCES "work_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_template_steps" ADD CONSTRAINT "work_template_steps_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_template_steps" ADD CONSTRAINT "work_template_steps_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_template_steps" ADD CONSTRAINT "work_template_steps_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_template_steps" ADD CONSTRAINT "work_template_steps_biz_template_fk" FOREIGN KEY ("biz_id","work_template_id") REFERENCES "work_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_templates" ADD CONSTRAINT "work_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_templates" ADD CONSTRAINT "work_templates_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_templates" ADD CONSTRAINT "work_templates_kind_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("kind_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_templates" ADD CONSTRAINT "work_templates_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_templates" ADD CONSTRAINT "work_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_templates" ADD CONSTRAINT "work_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_templates" ADD CONSTRAINT "work_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_templates" ADD CONSTRAINT "work_templates_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_templates" ADD CONSTRAINT "work_templates_biz_kind_config_fk" FOREIGN KEY ("biz_id","kind_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_templates" ADD CONSTRAINT "work_templates_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segment_allocations" ADD CONSTRAINT "work_time_segment_allocations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segment_allocations" ADD CONSTRAINT "work_time_segment_allocations_work_time_segment_id_work_time_segments_id_fk" FOREIGN KEY ("work_time_segment_id") REFERENCES "work_time_segments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segment_allocations" ADD CONSTRAINT "work_time_segment_allocations_staffing_assignment_id_staffing_assignments_id_fk" FOREIGN KEY ("staffing_assignment_id") REFERENCES "staffing_assignments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segment_allocations" ADD CONSTRAINT "work_time_segment_allocations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segment_allocations" ADD CONSTRAINT "work_time_segment_allocations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segment_allocations" ADD CONSTRAINT "work_time_segment_allocations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segment_allocations" ADD CONSTRAINT "work_time_segment_allocations_biz_segment_fk" FOREIGN KEY ("biz_id","work_time_segment_id") REFERENCES "work_time_segments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segment_allocations" ADD CONSTRAINT "work_time_segment_allocations_biz_assignment_fk" FOREIGN KEY ("biz_id","staffing_assignment_id") REFERENCES "staffing_assignments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segments" ADD CONSTRAINT "work_time_segments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segments" ADD CONSTRAINT "work_time_segments_work_run_id_work_runs_id_fk" FOREIGN KEY ("work_run_id") REFERENCES "work_runs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segments" ADD CONSTRAINT "work_time_segments_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segments" ADD CONSTRAINT "work_time_segments_approved_by_user_id_users_id_fk" FOREIGN KEY ("approved_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segments" ADD CONSTRAINT "work_time_segments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segments" ADD CONSTRAINT "work_time_segments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segments" ADD CONSTRAINT "work_time_segments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "work_time_segments" ADD CONSTRAINT "work_time_segments_biz_run_fk" FOREIGN KEY ("biz_id","work_run_id") REFERENCES "work_runs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_access_overrides" ADD CONSTRAINT "note_access_overrides_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_access_overrides" ADD CONSTRAINT "note_access_overrides_note_id_notes_id_fk" FOREIGN KEY ("note_id") REFERENCES "notes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_access_overrides" ADD CONSTRAINT "note_access_overrides_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_access_overrides" ADD CONSTRAINT "note_access_overrides_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_access_overrides" ADD CONSTRAINT "note_access_overrides_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_access_overrides" ADD CONSTRAINT "note_access_overrides_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_access_overrides" ADD CONSTRAINT "note_access_overrides_biz_note_fk" FOREIGN KEY ("biz_id","note_id") REFERENCES "notes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_revisions" ADD CONSTRAINT "note_revisions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_revisions" ADD CONSTRAINT "note_revisions_note_id_notes_id_fk" FOREIGN KEY ("note_id") REFERENCES "notes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_revisions" ADD CONSTRAINT "note_revisions_edited_by_user_id_users_id_fk" FOREIGN KEY ("edited_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_revisions" ADD CONSTRAINT "note_revisions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_revisions" ADD CONSTRAINT "note_revisions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_revisions" ADD CONSTRAINT "note_revisions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "note_revisions" ADD CONSTRAINT "note_revisions_biz_note_fk" FOREIGN KEY ("biz_id","note_id") REFERENCES "notes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_offer_id_offers_id_fk" FOREIGN KEY ("offer_id") REFERENCES "offers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_customer_user_id_users_id_fk" FOREIGN KEY ("customer_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_queue_entry_id_queue_entries_id_fk" FOREIGN KEY ("queue_entry_id") REFERENCES "queue_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_trip_id_transport_trips_id_fk" FOREIGN KEY ("trip_id") REFERENCES "transport_trips"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_created_by_user_id_users_id_fk" FOREIGN KEY ("created_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_edited_by_user_id_users_id_fk" FOREIGN KEY ("edited_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_biz_offer_fk" FOREIGN KEY ("biz_id","offer_id") REFERENCES "offers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_biz_queue_entry_fk" FOREIGN KEY ("biz_id","queue_entry_id") REFERENCES "queue_entries"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "notes" ADD CONSTRAINT "notes_biz_trip_fk" FOREIGN KEY ("biz_id","trip_id") REFERENCES "transport_trips"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_queue_id_queues_id_fk" FOREIGN KEY ("queue_id") REFERENCES "queues"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_customer_user_id_users_id_fk" FOREIGN KEY ("customer_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_customer_group_account_id_group_accounts_id_fk" FOREIGN KEY ("customer_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_requested_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("requested_offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_biz_queue_fk" FOREIGN KEY ("biz_id","queue_id") REFERENCES "queues"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_biz_offer_version_fk" FOREIGN KEY ("biz_id","requested_offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_entries" ADD CONSTRAINT "queue_entries_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_events" ADD CONSTRAINT "queue_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_events" ADD CONSTRAINT "queue_events_queue_entry_id_queue_entries_id_fk" FOREIGN KEY ("queue_entry_id") REFERENCES "queue_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_events" ADD CONSTRAINT "queue_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_events" ADD CONSTRAINT "queue_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_events" ADD CONSTRAINT "queue_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_events" ADD CONSTRAINT "queue_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_events" ADD CONSTRAINT "queue_events_biz_queue_entry_fk" FOREIGN KEY ("biz_id","queue_entry_id") REFERENCES "queue_entries"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_tickets" ADD CONSTRAINT "queue_tickets_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_tickets" ADD CONSTRAINT "queue_tickets_queue_entry_id_queue_entries_id_fk" FOREIGN KEY ("queue_entry_id") REFERENCES "queue_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_tickets" ADD CONSTRAINT "queue_tickets_queue_id_queues_id_fk" FOREIGN KEY ("queue_id") REFERENCES "queues"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_tickets" ADD CONSTRAINT "queue_tickets_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_tickets" ADD CONSTRAINT "queue_tickets_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_tickets" ADD CONSTRAINT "queue_tickets_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_tickets" ADD CONSTRAINT "queue_tickets_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_tickets" ADD CONSTRAINT "queue_tickets_biz_queue_fk" FOREIGN KEY ("biz_id","queue_id") REFERENCES "queues"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_tickets" ADD CONSTRAINT "queue_tickets_biz_queue_entry_fk" FOREIGN KEY ("biz_id","queue_entry_id","queue_id") REFERENCES "queue_entries"("biz_id","id","queue_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queue_tickets" ADD CONSTRAINT "queue_tickets_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_strategy_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("strategy_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_status_config_value_id_biz_config_values_id_fk" FOREIGN KEY ("status_config_value_id") REFERENCES "biz_config_values"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_calendar_binding_id_calendar_bindings_id_fk" FOREIGN KEY ("calendar_binding_id") REFERENCES "calendar_bindings"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_biz_calendar_binding_fk" FOREIGN KEY ("biz_id","calendar_binding_id") REFERENCES "calendar_bindings"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_biz_strategy_config_fk" FOREIGN KEY ("biz_id","strategy_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "queues" ADD CONSTRAINT "queues_biz_status_config_fk" FOREIGN KEY ("biz_id","status_config_value_id") REFERENCES "biz_config_values"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_queue_id_queues_id_fk" FOREIGN KEY ("queue_id") REFERENCES "queues"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_biz_queue_fk" FOREIGN KEY ("biz_id","queue_id") REFERENCES "queues"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "service_time_observations" ADD CONSTRAINT "service_time_observations_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wait_time_predictions" ADD CONSTRAINT "wait_time_predictions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wait_time_predictions" ADD CONSTRAINT "wait_time_predictions_queue_id_queues_id_fk" FOREIGN KEY ("queue_id") REFERENCES "queues"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wait_time_predictions" ADD CONSTRAINT "wait_time_predictions_queue_entry_id_queue_entries_id_fk" FOREIGN KEY ("queue_entry_id") REFERENCES "queue_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wait_time_predictions" ADD CONSTRAINT "wait_time_predictions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wait_time_predictions" ADD CONSTRAINT "wait_time_predictions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wait_time_predictions" ADD CONSTRAINT "wait_time_predictions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wait_time_predictions" ADD CONSTRAINT "wait_time_predictions_biz_queue_fk" FOREIGN KEY ("biz_id","queue_id") REFERENCES "queues"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "wait_time_predictions" ADD CONSTRAINT "wait_time_predictions_biz_queue_entry_fk" FOREIGN KEY ("biz_id","queue_entry_id") REFERENCES "queue_entries"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "dispatch_tasks" ADD CONSTRAINT "dispatch_tasks_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "dispatch_tasks" ADD CONSTRAINT "dispatch_tasks_trip_id_transport_trips_id_fk" FOREIGN KEY ("trip_id") REFERENCES "transport_trips"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "dispatch_tasks" ADD CONSTRAINT "dispatch_tasks_assigned_resource_id_resources_id_fk" FOREIGN KEY ("assigned_resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "dispatch_tasks" ADD CONSTRAINT "dispatch_tasks_created_by_user_id_users_id_fk" FOREIGN KEY ("created_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "dispatch_tasks" ADD CONSTRAINT "dispatch_tasks_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "dispatch_tasks" ADD CONSTRAINT "dispatch_tasks_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "dispatch_tasks" ADD CONSTRAINT "dispatch_tasks_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "dispatch_tasks" ADD CONSTRAINT "dispatch_tasks_biz_trip_fk" FOREIGN KEY ("biz_id","trip_id") REFERENCES "transport_trips"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "dispatch_tasks" ADD CONSTRAINT "dispatch_tasks_biz_assigned_resource_fk" FOREIGN KEY ("biz_id","assigned_resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "eta_events" ADD CONSTRAINT "eta_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "eta_events" ADD CONSTRAINT "eta_events_trip_id_transport_trips_id_fk" FOREIGN KEY ("trip_id") REFERENCES "transport_trips"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "eta_events" ADD CONSTRAINT "eta_events_route_stop_id_transport_route_stops_id_fk" FOREIGN KEY ("route_stop_id") REFERENCES "transport_route_stops"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "eta_events" ADD CONSTRAINT "eta_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "eta_events" ADD CONSTRAINT "eta_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "eta_events" ADD CONSTRAINT "eta_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "eta_events" ADD CONSTRAINT "eta_events_biz_trip_fk" FOREIGN KEY ("biz_id","trip_id") REFERENCES "transport_trips"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "eta_events" ADD CONSTRAINT "eta_events_biz_route_stop_fk" FOREIGN KEY ("biz_id","route_stop_id") REFERENCES "transport_route_stops"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fleet_vehicles" ADD CONSTRAINT "fleet_vehicles_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fleet_vehicles" ADD CONSTRAINT "fleet_vehicles_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fleet_vehicles" ADD CONSTRAINT "fleet_vehicles_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fleet_vehicles" ADD CONSTRAINT "fleet_vehicles_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fleet_vehicles" ADD CONSTRAINT "fleet_vehicles_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fleet_vehicles" ADD CONSTRAINT "fleet_vehicles_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_route_stops" ADD CONSTRAINT "transport_route_stops_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_route_stops" ADD CONSTRAINT "transport_route_stops_route_id_transport_routes_id_fk" FOREIGN KEY ("route_id") REFERENCES "transport_routes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_route_stops" ADD CONSTRAINT "transport_route_stops_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_route_stops" ADD CONSTRAINT "transport_route_stops_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_route_stops" ADD CONSTRAINT "transport_route_stops_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_route_stops" ADD CONSTRAINT "transport_route_stops_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_route_stops" ADD CONSTRAINT "transport_route_stops_biz_route_fk" FOREIGN KEY ("biz_id","route_id") REFERENCES "transport_routes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_route_stops" ADD CONSTRAINT "transport_route_stops_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_routes" ADD CONSTRAINT "transport_routes_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_routes" ADD CONSTRAINT "transport_routes_origin_location_id_locations_id_fk" FOREIGN KEY ("origin_location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_routes" ADD CONSTRAINT "transport_routes_destination_location_id_locations_id_fk" FOREIGN KEY ("destination_location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_routes" ADD CONSTRAINT "transport_routes_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_routes" ADD CONSTRAINT "transport_routes_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_routes" ADD CONSTRAINT "transport_routes_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_routes" ADD CONSTRAINT "transport_routes_biz_origin_location_fk" FOREIGN KEY ("biz_id","origin_location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_routes" ADD CONSTRAINT "transport_routes_biz_destination_location_fk" FOREIGN KEY ("biz_id","destination_location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_route_id_transport_routes_id_fk" FOREIGN KEY ("route_id") REFERENCES "transport_routes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_fleet_vehicle_id_fleet_vehicles_id_fk" FOREIGN KEY ("fleet_vehicle_id") REFERENCES "fleet_vehicles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_driver_resource_id_resources_id_fk" FOREIGN KEY ("driver_resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_calendar_binding_id_calendar_bindings_id_fk" FOREIGN KEY ("calendar_binding_id") REFERENCES "calendar_bindings"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_biz_route_fk" FOREIGN KEY ("biz_id","route_id") REFERENCES "transport_routes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_biz_fleet_vehicle_fk" FOREIGN KEY ("biz_id","fleet_vehicle_id") REFERENCES "fleet_vehicles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_biz_driver_resource_fk" FOREIGN KEY ("biz_id","driver_resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "transport_trips" ADD CONSTRAINT "transport_trips_biz_calendar_binding_fk" FOREIGN KEY ("biz_id","calendar_binding_id") REFERENCES "calendar_bindings"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_trip_id_transport_trips_id_fk" FOREIGN KEY ("trip_id") REFERENCES "transport_trips"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_queue_entry_id_queue_entries_id_fk" FOREIGN KEY ("queue_entry_id") REFERENCES "queue_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_passenger_user_id_users_id_fk" FOREIGN KEY ("passenger_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_passenger_group_account_id_group_accounts_id_fk" FOREIGN KEY ("passenger_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_biz_trip_fk" FOREIGN KEY ("biz_id","trip_id") REFERENCES "transport_trips"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_manifests" ADD CONSTRAINT "trip_manifests_biz_queue_entry_fk" FOREIGN KEY ("biz_id","queue_entry_id") REFERENCES "queue_entries"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_stop_inventory" ADD CONSTRAINT "trip_stop_inventory_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_stop_inventory" ADD CONSTRAINT "trip_stop_inventory_trip_id_transport_trips_id_fk" FOREIGN KEY ("trip_id") REFERENCES "transport_trips"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_stop_inventory" ADD CONSTRAINT "trip_stop_inventory_route_stop_id_transport_route_stops_id_fk" FOREIGN KEY ("route_stop_id") REFERENCES "transport_route_stops"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_stop_inventory" ADD CONSTRAINT "trip_stop_inventory_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_stop_inventory" ADD CONSTRAINT "trip_stop_inventory_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_stop_inventory" ADD CONSTRAINT "trip_stop_inventory_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_stop_inventory" ADD CONSTRAINT "trip_stop_inventory_biz_trip_fk" FOREIGN KEY ("biz_id","trip_id") REFERENCES "transport_trips"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "trip_stop_inventory" ADD CONSTRAINT "trip_stop_inventory_biz_route_stop_fk" FOREIGN KEY ("biz_id","route_stop_id") REFERENCES "transport_route_stops"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "auctions" ADD CONSTRAINT "auctions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "auctions" ADD CONSTRAINT "auctions_marketplace_listing_id_marketplace_listings_id_fk" FOREIGN KEY ("marketplace_listing_id") REFERENCES "marketplace_listings"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "auctions" ADD CONSTRAINT "auctions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "auctions" ADD CONSTRAINT "auctions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "auctions" ADD CONSTRAINT "auctions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "auctions" ADD CONSTRAINT "auctions_biz_marketplace_listing_fk" FOREIGN KEY ("biz_id","marketplace_listing_id") REFERENCES "marketplace_listings"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "auctions" ADD CONSTRAINT "auctions_biz_target_subject_fk" FOREIGN KEY ("biz_id","target_subject_type","target_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "bids" ADD CONSTRAINT "bids_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "bids" ADD CONSTRAINT "bids_auction_id_auctions_id_fk" FOREIGN KEY ("auction_id") REFERENCES "auctions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "bids" ADD CONSTRAINT "bids_bidder_biz_id_bizes_id_fk" FOREIGN KEY ("bidder_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "bids" ADD CONSTRAINT "bids_bidder_user_id_users_id_fk" FOREIGN KEY ("bidder_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "bids" ADD CONSTRAINT "bids_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "bids" ADD CONSTRAINT "bids_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "bids" ADD CONSTRAINT "bids_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "bids" ADD CONSTRAINT "bids_biz_auction_fk" FOREIGN KEY ("biz_id","auction_id") REFERENCES "auctions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_contracts" ADD CONSTRAINT "cross_biz_contracts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_contracts" ADD CONSTRAINT "cross_biz_contracts_counterparty_biz_id_bizes_id_fk" FOREIGN KEY ("counterparty_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_contracts" ADD CONSTRAINT "cross_biz_contracts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_contracts" ADD CONSTRAINT "cross_biz_contracts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_contracts" ADD CONSTRAINT "cross_biz_contracts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_buyer_biz_id_bizes_id_fk" FOREIGN KEY ("buyer_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_seller_biz_id_bizes_id_fk" FOREIGN KEY ("seller_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_contract_id_cross_biz_contracts_id_fk" FOREIGN KEY ("contract_id") REFERENCES "cross_biz_contracts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_biz_contract_fk" FOREIGN KEY ("biz_id","contract_id") REFERENCES "cross_biz_contracts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "cross_biz_orders" ADD CONSTRAINT "cross_biz_orders_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketplace_listings" ADD CONSTRAINT "marketplace_listings_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketplace_listings" ADD CONSTRAINT "marketplace_listings_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketplace_listings" ADD CONSTRAINT "marketplace_listings_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketplace_listings" ADD CONSTRAINT "marketplace_listings_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketplace_listings" ADD CONSTRAINT "marketplace_listings_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketplace_listings" ADD CONSTRAINT "marketplace_listings_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketplace_listings" ADD CONSTRAINT "marketplace_listings_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketplace_listings" ADD CONSTRAINT "marketplace_listings_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_referral_program_id_referral_programs_id_fk" FOREIGN KEY ("referral_program_id") REFERENCES "referral_programs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_referrer_user_id_users_id_fk" FOREIGN KEY ("referrer_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_referred_user_id_users_id_fk" FOREIGN KEY ("referred_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_cross_biz_order_id_cross_biz_orders_id_fk" FOREIGN KEY ("cross_biz_order_id") REFERENCES "cross_biz_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_biz_program_fk" FOREIGN KEY ("biz_id","referral_program_id") REFERENCES "referral_programs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_events" ADD CONSTRAINT "referral_events_biz_cross_biz_order_fk" FOREIGN KEY ("biz_id","cross_biz_order_id") REFERENCES "cross_biz_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_programs" ADD CONSTRAINT "referral_programs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_programs" ADD CONSTRAINT "referral_programs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_programs" ADD CONSTRAINT "referral_programs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "referral_programs" ADD CONSTRAINT "referral_programs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "revenue_share_rules" ADD CONSTRAINT "revenue_share_rules_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "revenue_share_rules" ADD CONSTRAINT "revenue_share_rules_contract_id_cross_biz_contracts_id_fk" FOREIGN KEY ("contract_id") REFERENCES "cross_biz_contracts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "revenue_share_rules" ADD CONSTRAINT "revenue_share_rules_marketplace_listing_id_marketplace_listings_id_fk" FOREIGN KEY ("marketplace_listing_id") REFERENCES "marketplace_listings"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "revenue_share_rules" ADD CONSTRAINT "revenue_share_rules_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "revenue_share_rules" ADD CONSTRAINT "revenue_share_rules_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "revenue_share_rules" ADD CONSTRAINT "revenue_share_rules_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "revenue_share_rules" ADD CONSTRAINT "revenue_share_rules_biz_contract_fk" FOREIGN KEY ("biz_id","contract_id") REFERENCES "cross_biz_contracts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "revenue_share_rules" ADD CONSTRAINT "revenue_share_rules_biz_marketplace_listing_fk" FOREIGN KEY ("biz_id","marketplace_listing_id") REFERENCES "marketplace_listings"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "reward_grants" ADD CONSTRAINT "reward_grants_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "reward_grants" ADD CONSTRAINT "reward_grants_referral_program_id_referral_programs_id_fk" FOREIGN KEY ("referral_program_id") REFERENCES "referral_programs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "reward_grants" ADD CONSTRAINT "reward_grants_referral_event_id_referral_events_id_fk" FOREIGN KEY ("referral_event_id") REFERENCES "referral_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "reward_grants" ADD CONSTRAINT "reward_grants_recipient_user_id_users_id_fk" FOREIGN KEY ("recipient_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "reward_grants" ADD CONSTRAINT "reward_grants_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "reward_grants" ADD CONSTRAINT "reward_grants_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "reward_grants" ADD CONSTRAINT "reward_grants_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "reward_grants" ADD CONSTRAINT "reward_grants_biz_program_fk" FOREIGN KEY ("biz_id","referral_program_id") REFERENCES "referral_programs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "reward_grants" ADD CONSTRAINT "reward_grants_biz_event_fk" FOREIGN KEY ("biz_id","referral_event_id") REFERENCES "referral_events"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_operational_demand_id_operational_demands_id_fk" FOREIGN KEY ("operational_demand_id") REFERENCES "operational_demands"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_fulfillment_assignment_id_fulfillment_assignments_id_fk" FOREIGN KEY ("fulfillment_assignment_id") REFERENCES "fulfillment_assignments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_staffing_assignment_id_staffing_assignments_id_fk" FOREIGN KEY ("staffing_assignment_id") REFERENCES "staffing_assignments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_biz_demand_fk" FOREIGN KEY ("biz_id","operational_demand_id") REFERENCES "operational_demands"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_biz_fulfillment_assignment_fk" FOREIGN KEY ("biz_id","fulfillment_assignment_id") REFERENCES "fulfillment_assignments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_biz_staffing_assignment_fk" FOREIGN KEY ("biz_id","staffing_assignment_id") REFERENCES "staffing_assignments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_assignments" ADD CONSTRAINT "operational_assignments_biz_custom_subject_fk" FOREIGN KEY ("biz_id","custom_subject_type","custom_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_demands" ADD CONSTRAINT "operational_demands_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_demands" ADD CONSTRAINT "operational_demands_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_demands" ADD CONSTRAINT "operational_demands_staffing_demand_id_staffing_demands_id_fk" FOREIGN KEY ("staffing_demand_id") REFERENCES "staffing_demands"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_demands" ADD CONSTRAINT "operational_demands_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_demands" ADD CONSTRAINT "operational_demands_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_demands" ADD CONSTRAINT "operational_demands_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_demands" ADD CONSTRAINT "operational_demands_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_demands" ADD CONSTRAINT "operational_demands_biz_staffing_demand_fk" FOREIGN KEY ("biz_id","staffing_demand_id") REFERENCES "staffing_demands"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "operational_demands" ADD CONSTRAINT "operational_demands_biz_custom_subject_fk" FOREIGN KEY ("biz_id","custom_subject_type","custom_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_admin_delegations" ADD CONSTRAINT "enterprise_admin_delegations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_admin_delegations" ADD CONSTRAINT "enterprise_admin_delegations_delegator_user_id_users_id_fk" FOREIGN KEY ("delegator_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_admin_delegations" ADD CONSTRAINT "enterprise_admin_delegations_delegate_user_id_users_id_fk" FOREIGN KEY ("delegate_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_admin_delegations" ADD CONSTRAINT "enterprise_admin_delegations_scope_id_enterprise_scopes_id_fk" FOREIGN KEY ("scope_id") REFERENCES "enterprise_scopes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_admin_delegations" ADD CONSTRAINT "enterprise_admin_delegations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_admin_delegations" ADD CONSTRAINT "enterprise_admin_delegations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_admin_delegations" ADD CONSTRAINT "enterprise_admin_delegations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_admin_delegations" ADD CONSTRAINT "enterprise_admin_delegations_biz_scope_fk" FOREIGN KEY ("biz_id","scope_id") REFERENCES "enterprise_scopes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_approval_authority_limits" ADD CONSTRAINT "enterprise_approval_authority_limits_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_approval_authority_limits" ADD CONSTRAINT "enterprise_approval_authority_limits_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_approval_authority_limits" ADD CONSTRAINT "enterprise_approval_authority_limits_scope_id_enterprise_scopes_id_fk" FOREIGN KEY ("scope_id") REFERENCES "enterprise_scopes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_approval_authority_limits" ADD CONSTRAINT "enterprise_approval_authority_limits_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_approval_authority_limits" ADD CONSTRAINT "enterprise_approval_authority_limits_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_approval_authority_limits" ADD CONSTRAINT "enterprise_approval_authority_limits_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_approval_authority_limits" ADD CONSTRAINT "enterprise_approval_authority_limits_biz_scope_fk" FOREIGN KEY ("biz_id","scope_id") REFERENCES "enterprise_scopes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_results" ADD CONSTRAINT "enterprise_change_rollout_results_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_results" ADD CONSTRAINT "enterprise_change_rollout_results_rollout_target_id_enterprise_change_rollout_targets_id_fk" FOREIGN KEY ("rollout_target_id") REFERENCES "enterprise_change_rollout_targets"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_results" ADD CONSTRAINT "enterprise_change_rollout_results_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_results" ADD CONSTRAINT "enterprise_change_rollout_results_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_results" ADD CONSTRAINT "enterprise_change_rollout_results_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_results" ADD CONSTRAINT "enterprise_change_rollout_results_biz_target_fk" FOREIGN KEY ("biz_id","rollout_target_id") REFERENCES "enterprise_change_rollout_targets"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_runs" ADD CONSTRAINT "enterprise_change_rollout_runs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_runs" ADD CONSTRAINT "enterprise_change_rollout_runs_requested_by_user_id_users_id_fk" FOREIGN KEY ("requested_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_runs" ADD CONSTRAINT "enterprise_change_rollout_runs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_runs" ADD CONSTRAINT "enterprise_change_rollout_runs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_runs" ADD CONSTRAINT "enterprise_change_rollout_runs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_targets" ADD CONSTRAINT "enterprise_change_rollout_targets_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_targets" ADD CONSTRAINT "enterprise_change_rollout_targets_rollout_run_id_enterprise_change_rollout_runs_id_fk" FOREIGN KEY ("rollout_run_id") REFERENCES "enterprise_change_rollout_runs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_targets" ADD CONSTRAINT "enterprise_change_rollout_targets_scope_id_enterprise_scopes_id_fk" FOREIGN KEY ("scope_id") REFERENCES "enterprise_scopes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_targets" ADD CONSTRAINT "enterprise_change_rollout_targets_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_targets" ADD CONSTRAINT "enterprise_change_rollout_targets_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_targets" ADD CONSTRAINT "enterprise_change_rollout_targets_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_targets" ADD CONSTRAINT "enterprise_change_rollout_targets_biz_run_fk" FOREIGN KEY ("biz_id","rollout_run_id") REFERENCES "enterprise_change_rollout_runs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_change_rollout_targets" ADD CONSTRAINT "enterprise_change_rollout_targets_biz_scope_fk" FOREIGN KEY ("biz_id","scope_id") REFERENCES "enterprise_scopes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_bindings" ADD CONSTRAINT "enterprise_contract_pack_bindings_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_bindings" ADD CONSTRAINT "enterprise_contract_pack_bindings_contract_pack_version_id_enterprise_contract_pack_versions_id_fk" FOREIGN KEY ("contract_pack_version_id") REFERENCES "enterprise_contract_pack_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_bindings" ADD CONSTRAINT "enterprise_contract_pack_bindings_scope_id_enterprise_scopes_id_fk" FOREIGN KEY ("scope_id") REFERENCES "enterprise_scopes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_bindings" ADD CONSTRAINT "enterprise_contract_pack_bindings_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_bindings" ADD CONSTRAINT "enterprise_contract_pack_bindings_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_bindings" ADD CONSTRAINT "enterprise_contract_pack_bindings_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_bindings" ADD CONSTRAINT "enterprise_contract_pack_bindings_biz_pack_version_fk" FOREIGN KEY ("biz_id","contract_pack_version_id") REFERENCES "enterprise_contract_pack_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_bindings" ADD CONSTRAINT "enterprise_contract_pack_bindings_biz_scope_fk" FOREIGN KEY ("biz_id","scope_id") REFERENCES "enterprise_scopes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_templates" ADD CONSTRAINT "enterprise_contract_pack_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_templates" ADD CONSTRAINT "enterprise_contract_pack_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_templates" ADD CONSTRAINT "enterprise_contract_pack_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_templates" ADD CONSTRAINT "enterprise_contract_pack_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_versions" ADD CONSTRAINT "enterprise_contract_pack_versions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_versions" ADD CONSTRAINT "enterprise_contract_pack_versions_contract_pack_template_id_enterprise_contract_pack_templates_id_fk" FOREIGN KEY ("contract_pack_template_id") REFERENCES "enterprise_contract_pack_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_versions" ADD CONSTRAINT "enterprise_contract_pack_versions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_versions" ADD CONSTRAINT "enterprise_contract_pack_versions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_versions" ADD CONSTRAINT "enterprise_contract_pack_versions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_contract_pack_versions" ADD CONSTRAINT "enterprise_contract_pack_versions_biz_template_fk" FOREIGN KEY ("biz_id","contract_pack_template_id") REFERENCES "enterprise_contract_pack_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_external_directory_links" ADD CONSTRAINT "enterprise_external_directory_links_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_external_directory_links" ADD CONSTRAINT "enterprise_external_directory_links_identity_provider_id_enterprise_identity_providers_id_fk" FOREIGN KEY ("identity_provider_id") REFERENCES "enterprise_identity_providers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_external_directory_links" ADD CONSTRAINT "enterprise_external_directory_links_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_external_directory_links" ADD CONSTRAINT "enterprise_external_directory_links_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_external_directory_links" ADD CONSTRAINT "enterprise_external_directory_links_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_external_directory_links" ADD CONSTRAINT "enterprise_external_directory_links_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_external_directory_links" ADD CONSTRAINT "enterprise_external_directory_links_biz_provider_fk" FOREIGN KEY ("biz_id","identity_provider_id") REFERENCES "enterprise_identity_providers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_external_directory_links" ADD CONSTRAINT "enterprise_external_directory_links_subject_fk" FOREIGN KEY ("biz_id","subject_type","subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_identity_providers" ADD CONSTRAINT "enterprise_identity_providers_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_identity_providers" ADD CONSTRAINT "enterprise_identity_providers_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_identity_providers" ADD CONSTRAINT "enterprise_identity_providers_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_identity_providers" ADD CONSTRAINT "enterprise_identity_providers_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_resolutions" ADD CONSTRAINT "enterprise_inheritance_resolutions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_resolutions" ADD CONSTRAINT "enterprise_inheritance_resolutions_strategy_id_enterprise_inheritance_strategies_id_fk" FOREIGN KEY ("strategy_id") REFERENCES "enterprise_inheritance_strategies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_resolutions" ADD CONSTRAINT "enterprise_inheritance_resolutions_scope_id_enterprise_scopes_id_fk" FOREIGN KEY ("scope_id") REFERENCES "enterprise_scopes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_resolutions" ADD CONSTRAINT "enterprise_inheritance_resolutions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_resolutions" ADD CONSTRAINT "enterprise_inheritance_resolutions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_resolutions" ADD CONSTRAINT "enterprise_inheritance_resolutions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_resolutions" ADD CONSTRAINT "enterprise_inheritance_resolutions_biz_strategy_fk" FOREIGN KEY ("biz_id","strategy_id") REFERENCES "enterprise_inheritance_strategies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_resolutions" ADD CONSTRAINT "enterprise_inheritance_resolutions_biz_scope_fk" FOREIGN KEY ("biz_id","scope_id") REFERENCES "enterprise_scopes"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_strategies" ADD CONSTRAINT "enterprise_inheritance_strategies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_strategies" ADD CONSTRAINT "enterprise_inheritance_strategies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_strategies" ADD CONSTRAINT "enterprise_inheritance_strategies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_inheritance_strategies" ADD CONSTRAINT "enterprise_inheritance_strategies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_accounts" ADD CONSTRAINT "enterprise_intercompany_accounts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_accounts" ADD CONSTRAINT "enterprise_intercompany_accounts_source_biz_id_bizes_id_fk" FOREIGN KEY ("source_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_accounts" ADD CONSTRAINT "enterprise_intercompany_accounts_counterparty_biz_id_bizes_id_fk" FOREIGN KEY ("counterparty_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_accounts" ADD CONSTRAINT "enterprise_intercompany_accounts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_accounts" ADD CONSTRAINT "enterprise_intercompany_accounts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_accounts" ADD CONSTRAINT "enterprise_intercompany_accounts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_intercompany_account_id_enterprise_intercompany_accounts_id_fk" FOREIGN KEY ("intercompany_account_id") REFERENCES "enterprise_intercompany_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_settlement_run_id_enterprise_intercompany_settlement_runs_id_fk" FOREIGN KEY ("settlement_run_id") REFERENCES "enterprise_intercompany_settlement_runs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_source_cross_biz_order_id_cross_biz_orders_id_fk" FOREIGN KEY ("source_cross_biz_order_id") REFERENCES "cross_biz_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_source_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("source_payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_biz_account_fk" FOREIGN KEY ("biz_id","intercompany_account_id") REFERENCES "enterprise_intercompany_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_biz_settlement_run_fk" FOREIGN KEY ("biz_id","settlement_run_id") REFERENCES "enterprise_intercompany_settlement_runs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_biz_cross_biz_order_fk" FOREIGN KEY ("biz_id","source_cross_biz_order_id") REFERENCES "cross_biz_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_entries" ADD CONSTRAINT "enterprise_intercompany_entries_biz_payment_transaction_fk" FOREIGN KEY ("biz_id","source_payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_settlement_runs" ADD CONSTRAINT "enterprise_intercompany_settlement_runs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_settlement_runs" ADD CONSTRAINT "enterprise_intercompany_settlement_runs_intercompany_account_id_enterprise_intercompany_accounts_id_fk" FOREIGN KEY ("intercompany_account_id") REFERENCES "enterprise_intercompany_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_settlement_runs" ADD CONSTRAINT "enterprise_intercompany_settlement_runs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_settlement_runs" ADD CONSTRAINT "enterprise_intercompany_settlement_runs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_settlement_runs" ADD CONSTRAINT "enterprise_intercompany_settlement_runs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_intercompany_settlement_runs" ADD CONSTRAINT "enterprise_intercompany_settlement_runs_biz_account_fk" FOREIGN KEY ("biz_id","intercompany_account_id") REFERENCES "enterprise_intercompany_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationship_templates" ADD CONSTRAINT "enterprise_relationship_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationship_templates" ADD CONSTRAINT "enterprise_relationship_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationship_templates" ADD CONSTRAINT "enterprise_relationship_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationship_templates" ADD CONSTRAINT "enterprise_relationship_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationships" ADD CONSTRAINT "enterprise_relationships_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationships" ADD CONSTRAINT "enterprise_relationships_relationship_template_id_enterprise_relationship_templates_id_fk" FOREIGN KEY ("relationship_template_id") REFERENCES "enterprise_relationship_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationships" ADD CONSTRAINT "enterprise_relationships_from_biz_id_bizes_id_fk" FOREIGN KEY ("from_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationships" ADD CONSTRAINT "enterprise_relationships_to_biz_id_bizes_id_fk" FOREIGN KEY ("to_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationships" ADD CONSTRAINT "enterprise_relationships_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationships" ADD CONSTRAINT "enterprise_relationships_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationships" ADD CONSTRAINT "enterprise_relationships_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_relationships" ADD CONSTRAINT "enterprise_relationships_biz_template_fk" FOREIGN KEY ("biz_id","relationship_template_id") REFERENCES "enterprise_relationship_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scim_sync_states" ADD CONSTRAINT "enterprise_scim_sync_states_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scim_sync_states" ADD CONSTRAINT "enterprise_scim_sync_states_identity_provider_id_enterprise_identity_providers_id_fk" FOREIGN KEY ("identity_provider_id") REFERENCES "enterprise_identity_providers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scim_sync_states" ADD CONSTRAINT "enterprise_scim_sync_states_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scim_sync_states" ADD CONSTRAINT "enterprise_scim_sync_states_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scim_sync_states" ADD CONSTRAINT "enterprise_scim_sync_states_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scim_sync_states" ADD CONSTRAINT "enterprise_scim_sync_states_biz_provider_fk" FOREIGN KEY ("biz_id","identity_provider_id") REFERENCES "enterprise_identity_providers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scopes" ADD CONSTRAINT "enterprise_scopes_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scopes" ADD CONSTRAINT "enterprise_scopes_target_biz_id_bizes_id_fk" FOREIGN KEY ("target_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scopes" ADD CONSTRAINT "enterprise_scopes_target_location_id_locations_id_fk" FOREIGN KEY ("target_location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scopes" ADD CONSTRAINT "enterprise_scopes_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scopes" ADD CONSTRAINT "enterprise_scopes_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scopes" ADD CONSTRAINT "enterprise_scopes_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scopes" ADD CONSTRAINT "enterprise_scopes_target_location_fk" FOREIGN KEY ("target_biz_id","target_location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "enterprise_scopes" ADD CONSTRAINT "enterprise_scopes_target_subject_fk" FOREIGN KEY ("target_biz_id","target_subject_type","target_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_compliance_daily" ADD CONSTRAINT "fact_enterprise_compliance_daily_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_compliance_daily" ADD CONSTRAINT "fact_enterprise_compliance_daily_member_biz_id_bizes_id_fk" FOREIGN KEY ("member_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_compliance_daily" ADD CONSTRAINT "fact_enterprise_compliance_daily_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_compliance_daily" ADD CONSTRAINT "fact_enterprise_compliance_daily_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_compliance_daily" ADD CONSTRAINT "fact_enterprise_compliance_daily_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_revenue_daily" ADD CONSTRAINT "fact_enterprise_revenue_daily_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_revenue_daily" ADD CONSTRAINT "fact_enterprise_revenue_daily_member_biz_id_bizes_id_fk" FOREIGN KEY ("member_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_revenue_daily" ADD CONSTRAINT "fact_enterprise_revenue_daily_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_revenue_daily" ADD CONSTRAINT "fact_enterprise_revenue_daily_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_revenue_daily" ADD CONSTRAINT "fact_enterprise_revenue_daily_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_utilization_daily" ADD CONSTRAINT "fact_enterprise_utilization_daily_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_utilization_daily" ADD CONSTRAINT "fact_enterprise_utilization_daily_member_biz_id_bizes_id_fk" FOREIGN KEY ("member_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_utilization_daily" ADD CONSTRAINT "fact_enterprise_utilization_daily_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_utilization_daily" ADD CONSTRAINT "fact_enterprise_utilization_daily_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_enterprise_utilization_daily" ADD CONSTRAINT "fact_enterprise_utilization_daily_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_residency_policies" ADD CONSTRAINT "data_residency_policies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_residency_policies" ADD CONSTRAINT "data_residency_policies_compliance_profile_id_tenant_compliance_profiles_id_fk" FOREIGN KEY ("compliance_profile_id") REFERENCES "tenant_compliance_profiles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_residency_policies" ADD CONSTRAINT "data_residency_policies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_residency_policies" ADD CONSTRAINT "data_residency_policies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_residency_policies" ADD CONSTRAINT "data_residency_policies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_residency_policies" ADD CONSTRAINT "data_residency_policies_biz_compliance_profile_fk" FOREIGN KEY ("biz_id","compliance_profile_id") REFERENCES "tenant_compliance_profiles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_subject_requests" ADD CONSTRAINT "data_subject_requests_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_subject_requests" ADD CONSTRAINT "data_subject_requests_subject_user_id_users_id_fk" FOREIGN KEY ("subject_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_subject_requests" ADD CONSTRAINT "data_subject_requests_submitted_by_user_id_users_id_fk" FOREIGN KEY ("submitted_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_subject_requests" ADD CONSTRAINT "data_subject_requests_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_subject_requests" ADD CONSTRAINT "data_subject_requests_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "data_subject_requests" ADD CONSTRAINT "data_subject_requests_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "legal_holds" ADD CONSTRAINT "legal_holds_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "legal_holds" ADD CONSTRAINT "legal_holds_issued_by_user_id_users_id_fk" FOREIGN KEY ("issued_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "legal_holds" ADD CONSTRAINT "legal_holds_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "legal_holds" ADD CONSTRAINT "legal_holds_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "legal_holds" ADD CONSTRAINT "legal_holds_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_policy_template_id_policy_templates_id_fk" FOREIGN KEY ("policy_template_id") REFERENCES "policy_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_service_id_services_id_fk" FOREIGN KEY ("service_id") REFERENCES "services"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_offer_id_offers_id_fk" FOREIGN KEY ("offer_id") REFERENCES "offers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_queue_id_queues_id_fk" FOREIGN KEY ("queue_id") REFERENCES "queues"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_biz_template_fk" FOREIGN KEY ("biz_id","policy_template_id") REFERENCES "policy_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_biz_service_fk" FOREIGN KEY ("biz_id","service_id") REFERENCES "services"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_biz_service_product_fk" FOREIGN KEY ("biz_id","service_product_id") REFERENCES "service_products"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_biz_offer_fk" FOREIGN KEY ("biz_id","offer_id") REFERENCES "offers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_biz_queue_fk" FOREIGN KEY ("biz_id","queue_id") REFERENCES "queues"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_bindings" ADD CONSTRAINT "policy_bindings_biz_subject_fk" FOREIGN KEY ("biz_id","target_subject_type","target_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_breach_events" ADD CONSTRAINT "policy_breach_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_breach_events" ADD CONSTRAINT "policy_breach_events_policy_template_id_policy_templates_id_fk" FOREIGN KEY ("policy_template_id") REFERENCES "policy_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_breach_events" ADD CONSTRAINT "policy_breach_events_policy_rule_id_policy_rules_id_fk" FOREIGN KEY ("policy_rule_id") REFERENCES "policy_rules"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_breach_events" ADD CONSTRAINT "policy_breach_events_policy_binding_id_policy_bindings_id_fk" FOREIGN KEY ("policy_binding_id") REFERENCES "policy_bindings"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_breach_events" ADD CONSTRAINT "policy_breach_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_breach_events" ADD CONSTRAINT "policy_breach_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_breach_events" ADD CONSTRAINT "policy_breach_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_breach_events" ADD CONSTRAINT "policy_breach_events_biz_template_fk" FOREIGN KEY ("biz_id","policy_template_id") REFERENCES "policy_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_breach_events" ADD CONSTRAINT "policy_breach_events_biz_template_rule_fk" FOREIGN KEY ("biz_id","policy_template_id","policy_rule_id") REFERENCES "policy_rules"("biz_id","policy_template_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_breach_events" ADD CONSTRAINT "policy_breach_events_biz_template_binding_fk" FOREIGN KEY ("biz_id","policy_template_id","policy_binding_id") REFERENCES "policy_bindings"("biz_id","policy_template_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_breach_events" ADD CONSTRAINT "policy_breach_events_biz_target_subject_fk" FOREIGN KEY ("biz_id","target_subject_type","target_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_policy_breach_event_id_policy_breach_events_id_fk" FOREIGN KEY ("policy_breach_event_id") REFERENCES "policy_breach_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_compensation_ledger_entry_id_compensation_ledger_entries_id_fk" FOREIGN KEY ("compensation_ledger_entry_id") REFERENCES "compensation_ledger_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_settlement_entry_id_settlement_entries_id_fk" FOREIGN KEY ("settlement_entry_id") REFERENCES "settlement_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_workflow_instance_id_workflow_instances_id_fk" FOREIGN KEY ("workflow_instance_id") REFERENCES "workflow_instances"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_review_queue_item_id_review_queue_items_id_fk" FOREIGN KEY ("review_queue_item_id") REFERENCES "review_queue_items"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_biz_breach_fk" FOREIGN KEY ("biz_id","policy_breach_event_id") REFERENCES "policy_breach_events"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_biz_compensation_ledger_fk" FOREIGN KEY ("biz_id","compensation_ledger_entry_id") REFERENCES "compensation_ledger_entries"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_biz_payment_transaction_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_biz_settlement_entry_fk" FOREIGN KEY ("biz_id","settlement_entry_id") REFERENCES "settlement_entries"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_biz_workflow_instance_fk" FOREIGN KEY ("biz_id","workflow_instance_id") REFERENCES "workflow_instances"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_consequence_events" ADD CONSTRAINT "policy_consequence_events_biz_review_queue_item_fk" FOREIGN KEY ("biz_id","review_queue_item_id") REFERENCES "review_queue_items"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_rules" ADD CONSTRAINT "policy_rules_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_rules" ADD CONSTRAINT "policy_rules_policy_template_id_policy_templates_id_fk" FOREIGN KEY ("policy_template_id") REFERENCES "policy_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_rules" ADD CONSTRAINT "policy_rules_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_rules" ADD CONSTRAINT "policy_rules_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_rules" ADD CONSTRAINT "policy_rules_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_rules" ADD CONSTRAINT "policy_rules_biz_template_fk" FOREIGN KEY ("biz_id","policy_template_id") REFERENCES "policy_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_templates" ADD CONSTRAINT "policy_templates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_templates" ADD CONSTRAINT "policy_templates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_templates" ADD CONSTRAINT "policy_templates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "policy_templates" ADD CONSTRAINT "policy_templates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "privacy_identity_modes" ADD CONSTRAINT "privacy_identity_modes_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "privacy_identity_modes" ADD CONSTRAINT "privacy_identity_modes_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "privacy_identity_modes" ADD CONSTRAINT "privacy_identity_modes_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "privacy_identity_modes" ADD CONSTRAINT "privacy_identity_modes_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "redaction_jobs" ADD CONSTRAINT "redaction_jobs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "redaction_jobs" ADD CONSTRAINT "redaction_jobs_data_subject_request_id_data_subject_requests_id_fk" FOREIGN KEY ("data_subject_request_id") REFERENCES "data_subject_requests"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "redaction_jobs" ADD CONSTRAINT "redaction_jobs_legal_hold_id_legal_holds_id_fk" FOREIGN KEY ("legal_hold_id") REFERENCES "legal_holds"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "redaction_jobs" ADD CONSTRAINT "redaction_jobs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "redaction_jobs" ADD CONSTRAINT "redaction_jobs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "redaction_jobs" ADD CONSTRAINT "redaction_jobs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "redaction_jobs" ADD CONSTRAINT "redaction_jobs_biz_data_subject_request_fk" FOREIGN KEY ("biz_id","data_subject_request_id") REFERENCES "data_subject_requests"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "redaction_jobs" ADD CONSTRAINT "redaction_jobs_biz_legal_hold_fk" FOREIGN KEY ("biz_id","legal_hold_id") REFERENCES "legal_holds"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "retention_policies" ADD CONSTRAINT "retention_policies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "retention_policies" ADD CONSTRAINT "retention_policies_compliance_profile_id_tenant_compliance_profiles_id_fk" FOREIGN KEY ("compliance_profile_id") REFERENCES "tenant_compliance_profiles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "retention_policies" ADD CONSTRAINT "retention_policies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "retention_policies" ADD CONSTRAINT "retention_policies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "retention_policies" ADD CONSTRAINT "retention_policies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "retention_policies" ADD CONSTRAINT "retention_policies_biz_compliance_profile_fk" FOREIGN KEY ("biz_id","compliance_profile_id") REFERENCES "tenant_compliance_profiles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tenant_compliance_profiles" ADD CONSTRAINT "tenant_compliance_profiles_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tenant_compliance_profiles" ADD CONSTRAINT "tenant_compliance_profiles_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tenant_compliance_profiles" ADD CONSTRAINT "tenant_compliance_profiles_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tenant_compliance_profiles" ADD CONSTRAINT "tenant_compliance_profiles_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "breach_notifications" ADD CONSTRAINT "breach_notifications_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "breach_notifications" ADD CONSTRAINT "breach_notifications_security_incident_id_security_incidents_id_fk" FOREIGN KEY ("security_incident_id") REFERENCES "security_incidents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "breach_notifications" ADD CONSTRAINT "breach_notifications_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "breach_notifications" ADD CONSTRAINT "breach_notifications_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "breach_notifications" ADD CONSTRAINT "breach_notifications_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "breach_notifications" ADD CONSTRAINT "breach_notifications_biz_incident_fk" FOREIGN KEY ("biz_id","security_incident_id") REFERENCES "security_incidents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "break_glass_reviews" ADD CONSTRAINT "break_glass_reviews_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "break_glass_reviews" ADD CONSTRAINT "break_glass_reviews_phi_access_event_id_phi_access_events_id_fk" FOREIGN KEY ("phi_access_event_id") REFERENCES "phi_access_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "break_glass_reviews" ADD CONSTRAINT "break_glass_reviews_reviewer_user_id_users_id_fk" FOREIGN KEY ("reviewer_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "break_glass_reviews" ADD CONSTRAINT "break_glass_reviews_security_incident_id_security_incidents_id_fk" FOREIGN KEY ("security_incident_id") REFERENCES "security_incidents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "break_glass_reviews" ADD CONSTRAINT "break_glass_reviews_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "break_glass_reviews" ADD CONSTRAINT "break_glass_reviews_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "break_glass_reviews" ADD CONSTRAINT "break_glass_reviews_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "break_glass_reviews" ADD CONSTRAINT "break_glass_reviews_biz_access_event_fk" FOREIGN KEY ("biz_id","phi_access_event_id") REFERENCES "phi_access_events"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "break_glass_reviews" ADD CONSTRAINT "break_glass_reviews_biz_incident_fk" FOREIGN KEY ("biz_id","security_incident_id") REFERENCES "security_incidents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "business_associate_agreements" ADD CONSTRAINT "business_associate_agreements_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "business_associate_agreements" ADD CONSTRAINT "business_associate_agreements_compliance_profile_id_tenant_compliance_profiles_id_fk" FOREIGN KEY ("compliance_profile_id") REFERENCES "tenant_compliance_profiles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "business_associate_agreements" ADD CONSTRAINT "business_associate_agreements_biz_extension_install_id_biz_extension_installs_id_fk" FOREIGN KEY ("biz_extension_install_id") REFERENCES "biz_extension_installs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "business_associate_agreements" ADD CONSTRAINT "business_associate_agreements_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "business_associate_agreements" ADD CONSTRAINT "business_associate_agreements_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "business_associate_agreements" ADD CONSTRAINT "business_associate_agreements_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "business_associate_agreements" ADD CONSTRAINT "business_associate_agreements_biz_compliance_profile_fk" FOREIGN KEY ("biz_id","compliance_profile_id") REFERENCES "tenant_compliance_profiles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "business_associate_agreements" ADD CONSTRAINT "business_associate_agreements_biz_install_fk" FOREIGN KEY ("biz_id","biz_extension_install_id") REFERENCES "biz_extension_installs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "hipaa_authorizations" ADD CONSTRAINT "hipaa_authorizations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "hipaa_authorizations" ADD CONSTRAINT "hipaa_authorizations_compliance_profile_id_tenant_compliance_profiles_id_fk" FOREIGN KEY ("compliance_profile_id") REFERENCES "tenant_compliance_profiles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "hipaa_authorizations" ADD CONSTRAINT "hipaa_authorizations_subject_user_id_users_id_fk" FOREIGN KEY ("subject_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "hipaa_authorizations" ADD CONSTRAINT "hipaa_authorizations_subject_group_account_id_group_accounts_id_fk" FOREIGN KEY ("subject_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "hipaa_authorizations" ADD CONSTRAINT "hipaa_authorizations_granted_by_user_id_users_id_fk" FOREIGN KEY ("granted_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "hipaa_authorizations" ADD CONSTRAINT "hipaa_authorizations_witnessed_by_user_id_users_id_fk" FOREIGN KEY ("witnessed_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "hipaa_authorizations" ADD CONSTRAINT "hipaa_authorizations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "hipaa_authorizations" ADD CONSTRAINT "hipaa_authorizations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "hipaa_authorizations" ADD CONSTRAINT "hipaa_authorizations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "hipaa_authorizations" ADD CONSTRAINT "hipaa_authorizations_biz_compliance_profile_fk" FOREIGN KEY ("biz_id","compliance_profile_id") REFERENCES "tenant_compliance_profiles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_events" ADD CONSTRAINT "phi_access_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_events" ADD CONSTRAINT "phi_access_events_phi_access_policy_id_phi_access_policies_id_fk" FOREIGN KEY ("phi_access_policy_id") REFERENCES "phi_access_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_events" ADD CONSTRAINT "phi_access_events_hipaa_authorization_id_hipaa_authorizations_id_fk" FOREIGN KEY ("hipaa_authorization_id") REFERENCES "hipaa_authorizations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_events" ADD CONSTRAINT "phi_access_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_events" ADD CONSTRAINT "phi_access_events_subject_user_id_users_id_fk" FOREIGN KEY ("subject_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_events" ADD CONSTRAINT "phi_access_events_subject_group_account_id_group_accounts_id_fk" FOREIGN KEY ("subject_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_events" ADD CONSTRAINT "phi_access_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_events" ADD CONSTRAINT "phi_access_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_events" ADD CONSTRAINT "phi_access_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_events" ADD CONSTRAINT "phi_access_events_biz_policy_fk" FOREIGN KEY ("biz_id","phi_access_policy_id") REFERENCES "phi_access_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_events" ADD CONSTRAINT "phi_access_events_biz_authorization_fk" FOREIGN KEY ("biz_id","hipaa_authorization_id") REFERENCES "hipaa_authorizations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_policies" ADD CONSTRAINT "phi_access_policies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_policies" ADD CONSTRAINT "phi_access_policies_compliance_profile_id_tenant_compliance_profiles_id_fk" FOREIGN KEY ("compliance_profile_id") REFERENCES "tenant_compliance_profiles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_policies" ADD CONSTRAINT "phi_access_policies_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_policies" ADD CONSTRAINT "phi_access_policies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_policies" ADD CONSTRAINT "phi_access_policies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_policies" ADD CONSTRAINT "phi_access_policies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_policies" ADD CONSTRAINT "phi_access_policies_biz_compliance_profile_fk" FOREIGN KEY ("biz_id","compliance_profile_id") REFERENCES "tenant_compliance_profiles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_policies" ADD CONSTRAINT "phi_access_policies_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_access_policies" ADD CONSTRAINT "phi_access_policies_biz_subject_fk" FOREIGN KEY ("biz_id","subject_ref_type","subject_ref_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_compliance_profile_id_tenant_compliance_profiles_id_fk" FOREIGN KEY ("compliance_profile_id") REFERENCES "tenant_compliance_profiles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_subject_user_id_users_id_fk" FOREIGN KEY ("subject_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_subject_group_account_id_group_accounts_id_fk" FOREIGN KEY ("subject_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_disclosed_by_user_id_users_id_fk" FOREIGN KEY ("disclosed_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_hipaa_authorization_id_hipaa_authorizations_id_fk" FOREIGN KEY ("hipaa_authorization_id") REFERENCES "hipaa_authorizations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_business_associate_agreement_id_business_associate_agreements_id_fk" FOREIGN KEY ("business_associate_agreement_id") REFERENCES "business_associate_agreements"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_biz_compliance_profile_fk" FOREIGN KEY ("biz_id","compliance_profile_id") REFERENCES "tenant_compliance_profiles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_biz_authorization_fk" FOREIGN KEY ("biz_id","hipaa_authorization_id") REFERENCES "hipaa_authorizations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "phi_disclosure_events" ADD CONSTRAINT "phi_disclosure_events_biz_baa_fk" FOREIGN KEY ("biz_id","business_associate_agreement_id") REFERENCES "business_associate_agreements"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "security_incidents" ADD CONSTRAINT "security_incidents_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "security_incidents" ADD CONSTRAINT "security_incidents_compliance_profile_id_tenant_compliance_profiles_id_fk" FOREIGN KEY ("compliance_profile_id") REFERENCES "tenant_compliance_profiles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "security_incidents" ADD CONSTRAINT "security_incidents_reported_by_user_id_users_id_fk" FOREIGN KEY ("reported_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "security_incidents" ADD CONSTRAINT "security_incidents_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "security_incidents" ADD CONSTRAINT "security_incidents_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "security_incidents" ADD CONSTRAINT "security_incidents_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "security_incidents" ADD CONSTRAINT "security_incidents_biz_compliance_profile_fk" FOREIGN KEY ("biz_id","compliance_profile_id") REFERENCES "tenant_compliance_profiles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "async_deliverables" ADD CONSTRAINT "async_deliverables_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "async_deliverables" ADD CONSTRAINT "async_deliverables_workflow_instance_id_workflow_instances_id_fk" FOREIGN KEY ("workflow_instance_id") REFERENCES "workflow_instances"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "async_deliverables" ADD CONSTRAINT "async_deliverables_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "async_deliverables" ADD CONSTRAINT "async_deliverables_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "async_deliverables" ADD CONSTRAINT "async_deliverables_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "async_deliverables" ADD CONSTRAINT "async_deliverables_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "async_deliverables" ADD CONSTRAINT "async_deliverables_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "async_deliverables" ADD CONSTRAINT "async_deliverables_biz_workflow_instance_fk" FOREIGN KEY ("biz_id","workflow_instance_id") REFERENCES "workflow_instances"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "async_deliverables" ADD CONSTRAINT "async_deliverables_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "async_deliverables" ADD CONSTRAINT "async_deliverables_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queue_items" ADD CONSTRAINT "review_queue_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queue_items" ADD CONSTRAINT "review_queue_items_review_queue_id_review_queues_id_fk" FOREIGN KEY ("review_queue_id") REFERENCES "review_queues"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queue_items" ADD CONSTRAINT "review_queue_items_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queue_items" ADD CONSTRAINT "review_queue_items_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queue_items" ADD CONSTRAINT "review_queue_items_assigned_to_user_id_users_id_fk" FOREIGN KEY ("assigned_to_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queue_items" ADD CONSTRAINT "review_queue_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queue_items" ADD CONSTRAINT "review_queue_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queue_items" ADD CONSTRAINT "review_queue_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queue_items" ADD CONSTRAINT "review_queue_items_biz_review_queue_fk" FOREIGN KEY ("biz_id","review_queue_id") REFERENCES "review_queues"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queue_items" ADD CONSTRAINT "review_queue_items_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queue_items" ADD CONSTRAINT "review_queue_items_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queues" ADD CONSTRAINT "review_queues_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queues" ADD CONSTRAINT "review_queues_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queues" ADD CONSTRAINT "review_queues_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "review_queues" ADD CONSTRAINT "review_queues_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_decisions" ADD CONSTRAINT "workflow_decisions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_decisions" ADD CONSTRAINT "workflow_decisions_workflow_instance_id_workflow_instances_id_fk" FOREIGN KEY ("workflow_instance_id") REFERENCES "workflow_instances"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_decisions" ADD CONSTRAINT "workflow_decisions_workflow_step_id_workflow_steps_id_fk" FOREIGN KEY ("workflow_step_id") REFERENCES "workflow_steps"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_decisions" ADD CONSTRAINT "workflow_decisions_decider_user_id_users_id_fk" FOREIGN KEY ("decider_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_decisions" ADD CONSTRAINT "workflow_decisions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_decisions" ADD CONSTRAINT "workflow_decisions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_decisions" ADD CONSTRAINT "workflow_decisions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_decisions" ADD CONSTRAINT "workflow_decisions_biz_instance_fk" FOREIGN KEY ("biz_id","workflow_instance_id") REFERENCES "workflow_instances"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_decisions" ADD CONSTRAINT "workflow_decisions_biz_step_fk" FOREIGN KEY ("biz_id","workflow_step_id") REFERENCES "workflow_steps"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_instances" ADD CONSTRAINT "workflow_instances_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_instances" ADD CONSTRAINT "workflow_instances_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_instances" ADD CONSTRAINT "workflow_instances_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_instances" ADD CONSTRAINT "workflow_instances_review_queue_item_id_review_queue_items_id_fk" FOREIGN KEY ("review_queue_item_id") REFERENCES "review_queue_items"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_instances" ADD CONSTRAINT "workflow_instances_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_instances" ADD CONSTRAINT "workflow_instances_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_instances" ADD CONSTRAINT "workflow_instances_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_instances" ADD CONSTRAINT "workflow_instances_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_instances" ADD CONSTRAINT "workflow_instances_biz_fulfillment_unit_fk" FOREIGN KEY ("biz_id","fulfillment_unit_id") REFERENCES "fulfillment_units"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_instances" ADD CONSTRAINT "workflow_instances_biz_review_queue_item_fk" FOREIGN KEY ("biz_id","review_queue_item_id") REFERENCES "review_queue_items"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_steps" ADD CONSTRAINT "workflow_steps_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_steps" ADD CONSTRAINT "workflow_steps_workflow_instance_id_workflow_instances_id_fk" FOREIGN KEY ("workflow_instance_id") REFERENCES "workflow_instances"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_steps" ADD CONSTRAINT "workflow_steps_assigned_to_user_id_users_id_fk" FOREIGN KEY ("assigned_to_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_steps" ADD CONSTRAINT "workflow_steps_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_steps" ADD CONSTRAINT "workflow_steps_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_steps" ADD CONSTRAINT "workflow_steps_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "workflow_steps" ADD CONSTRAINT "workflow_steps_biz_instance_fk" FOREIGN KEY ("biz_id","workflow_instance_id") REFERENCES "workflow_instances"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_expiration_events" ADD CONSTRAINT "gift_expiration_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_expiration_events" ADD CONSTRAINT "gift_expiration_events_gift_instrument_id_gift_instruments_id_fk" FOREIGN KEY ("gift_instrument_id") REFERENCES "gift_instruments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_expiration_events" ADD CONSTRAINT "gift_expiration_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_expiration_events" ADD CONSTRAINT "gift_expiration_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_expiration_events" ADD CONSTRAINT "gift_expiration_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_expiration_events" ADD CONSTRAINT "gift_expiration_events_biz_gift_fk" FOREIGN KEY ("biz_id","gift_instrument_id") REFERENCES "gift_instruments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_gift_instrument_id_gift_instruments_id_fk" FOREIGN KEY ("gift_instrument_id") REFERENCES "gift_instruments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_gift_redemption_id_gift_redemptions_id_fk" FOREIGN KEY ("gift_redemption_id") REFERENCES "gift_redemptions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_gift_transfer_id_gift_transfers_id_fk" FOREIGN KEY ("gift_transfer_id") REFERENCES "gift_transfers"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_gift_expiration_event_id_gift_expiration_events_id_fk" FOREIGN KEY ("gift_expiration_event_id") REFERENCES "gift_expiration_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_payment_intent_id_payment_intents_id_fk" FOREIGN KEY ("payment_intent_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_payment_intent_tender_id_payment_intent_tenders_id_fk" FOREIGN KEY ("payment_intent_tender_id") REFERENCES "payment_intent_tenders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_biz_gift_fk" FOREIGN KEY ("biz_id","gift_instrument_id") REFERENCES "gift_instruments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_biz_redemption_fk" FOREIGN KEY ("biz_id","gift_redemption_id") REFERENCES "gift_redemptions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_biz_transfer_fk" FOREIGN KEY ("biz_id","gift_transfer_id") REFERENCES "gift_transfers"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_biz_expiration_event_fk" FOREIGN KEY ("biz_id","gift_expiration_event_id") REFERENCES "gift_expiration_events"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_biz_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_biz_order_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_biz_payment_intent_fk" FOREIGN KEY ("biz_id","payment_intent_id") REFERENCES "payment_intents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_biz_payment_tender_fk" FOREIGN KEY ("biz_id","payment_intent_tender_id") REFERENCES "payment_intent_tenders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instrument_ledger_entries" ADD CONSTRAINT "gift_instrument_ledger_entries_biz_payment_transaction_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_issued_from_sellable_id_sellables_id_fk" FOREIGN KEY ("issued_from_sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_issued_from_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("issued_from_booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_issued_from_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("issued_from_booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_issued_from_payment_intent_id_payment_intents_id_fk" FOREIGN KEY ("issued_from_payment_intent_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_issued_from_payment_intent_tender_id_payment_intent_tenders_id_fk" FOREIGN KEY ("issued_from_payment_intent_tender_id") REFERENCES "payment_intent_tenders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_issued_from_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("issued_from_payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_owner_group_account_id_group_accounts_id_fk" FOREIGN KEY ("owner_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_biz_source_gift_fk" FOREIGN KEY ("biz_id","source_gift_instrument_id") REFERENCES "gift_instruments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_biz_issued_sellable_fk" FOREIGN KEY ("biz_id","issued_from_sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_biz_issued_order_fk" FOREIGN KEY ("biz_id","issued_from_booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_biz_issued_order_line_fk" FOREIGN KEY ("biz_id","issued_from_booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_biz_issued_payment_intent_fk" FOREIGN KEY ("biz_id","issued_from_payment_intent_id") REFERENCES "payment_intents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_biz_issued_payment_tender_fk" FOREIGN KEY ("biz_id","issued_from_payment_intent_tender_id") REFERENCES "payment_intent_tenders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_instruments" ADD CONSTRAINT "gift_instruments_biz_issued_payment_transaction_fk" FOREIGN KEY ("biz_id","issued_from_payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_gift_instrument_id_gift_instruments_id_fk" FOREIGN KEY ("gift_instrument_id") REFERENCES "gift_instruments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_payment_intent_id_payment_intents_id_fk" FOREIGN KEY ("payment_intent_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_payment_intent_tender_id_payment_intent_tenders_id_fk" FOREIGN KEY ("payment_intent_tender_id") REFERENCES "payment_intent_tenders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_biz_gift_fk" FOREIGN KEY ("biz_id","gift_instrument_id") REFERENCES "gift_instruments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_biz_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_biz_order_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_biz_payment_intent_fk" FOREIGN KEY ("biz_id","payment_intent_id") REFERENCES "payment_intents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_biz_payment_tender_fk" FOREIGN KEY ("biz_id","payment_intent_tender_id") REFERENCES "payment_intent_tenders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_redemptions" ADD CONSTRAINT "gift_redemptions_biz_payment_transaction_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_gift_instrument_id_gift_instruments_id_fk" FOREIGN KEY ("gift_instrument_id") REFERENCES "gift_instruments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_target_gift_instrument_id_gift_instruments_id_fk" FOREIGN KEY ("target_gift_instrument_id") REFERENCES "gift_instruments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_from_user_id_users_id_fk" FOREIGN KEY ("from_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_from_group_account_id_group_accounts_id_fk" FOREIGN KEY ("from_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_to_user_id_users_id_fk" FOREIGN KEY ("to_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_to_group_account_id_group_accounts_id_fk" FOREIGN KEY ("to_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_biz_gift_fk" FOREIGN KEY ("biz_id","gift_instrument_id") REFERENCES "gift_instruments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_transfers" ADD CONSTRAINT "gift_transfers_biz_target_gift_fk" FOREIGN KEY ("biz_id","target_gift_instrument_id") REFERENCES "gift_instruments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_participant_obligations" ADD CONSTRAINT "booking_participant_obligations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_participant_obligations" ADD CONSTRAINT "booking_participant_obligations_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_participant_obligations" ADD CONSTRAINT "booking_participant_obligations_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_participant_obligations" ADD CONSTRAINT "booking_participant_obligations_participant_user_id_users_id_fk" FOREIGN KEY ("participant_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_participant_obligations" ADD CONSTRAINT "booking_participant_obligations_participant_group_account_id_group_accounts_id_fk" FOREIGN KEY ("participant_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_participant_obligations" ADD CONSTRAINT "booking_participant_obligations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_participant_obligations" ADD CONSTRAINT "booking_participant_obligations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_participant_obligations" ADD CONSTRAINT "booking_participant_obligations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_participant_obligations" ADD CONSTRAINT "booking_participant_obligations_biz_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "booking_participant_obligations" ADD CONSTRAINT "booking_participant_obligations_biz_order_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "participant_obligation_events" ADD CONSTRAINT "participant_obligation_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "participant_obligation_events" ADD CONSTRAINT "participant_obligation_events_booking_participant_obligation_id_booking_participant_obligations_id_fk" FOREIGN KEY ("booking_participant_obligation_id") REFERENCES "booking_participant_obligations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "participant_obligation_events" ADD CONSTRAINT "participant_obligation_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "participant_obligation_events" ADD CONSTRAINT "participant_obligation_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "participant_obligation_events" ADD CONSTRAINT "participant_obligation_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "participant_obligation_events" ADD CONSTRAINT "participant_obligation_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "participant_obligation_events" ADD CONSTRAINT "participant_obligation_events_biz_obligation_fk" FOREIGN KEY ("biz_id","booking_participant_obligation_id") REFERENCES "booking_participant_obligations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ar_invoices" ADD CONSTRAINT "ar_invoices_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ar_invoices" ADD CONSTRAINT "ar_invoices_billing_account_id_billing_accounts_id_fk" FOREIGN KEY ("billing_account_id") REFERENCES "billing_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ar_invoices" ADD CONSTRAINT "ar_invoices_purchase_order_id_purchase_orders_id_fk" FOREIGN KEY ("purchase_order_id") REFERENCES "purchase_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ar_invoices" ADD CONSTRAINT "ar_invoices_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ar_invoices" ADD CONSTRAINT "ar_invoices_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ar_invoices" ADD CONSTRAINT "ar_invoices_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ar_invoices" ADD CONSTRAINT "ar_invoices_biz_billing_account_fk" FOREIGN KEY ("biz_id","billing_account_id") REFERENCES "billing_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ar_invoices" ADD CONSTRAINT "ar_invoices_biz_purchase_order_fk" FOREIGN KEY ("biz_id","purchase_order_id") REFERENCES "purchase_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_accounts" ADD CONSTRAINT "billing_accounts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_accounts" ADD CONSTRAINT "billing_accounts_counterparty_biz_id_bizes_id_fk" FOREIGN KEY ("counterparty_biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_accounts" ADD CONSTRAINT "billing_accounts_counterparty_user_id_users_id_fk" FOREIGN KEY ("counterparty_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_accounts" ADD CONSTRAINT "billing_accounts_counterparty_group_account_id_group_accounts_id_fk" FOREIGN KEY ("counterparty_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_accounts" ADD CONSTRAINT "billing_accounts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_accounts" ADD CONSTRAINT "billing_accounts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_accounts" ADD CONSTRAINT "billing_accounts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "invoice_events" ADD CONSTRAINT "invoice_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "invoice_events" ADD CONSTRAINT "invoice_events_ar_invoice_id_ar_invoices_id_fk" FOREIGN KEY ("ar_invoice_id") REFERENCES "ar_invoices"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "invoice_events" ADD CONSTRAINT "invoice_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "invoice_events" ADD CONSTRAINT "invoice_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "invoice_events" ADD CONSTRAINT "invoice_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "invoice_events" ADD CONSTRAINT "invoice_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "invoice_events" ADD CONSTRAINT "invoice_events_biz_invoice_fk" FOREIGN KEY ("biz_id","ar_invoice_id") REFERENCES "ar_invoices"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "purchase_orders" ADD CONSTRAINT "purchase_orders_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "purchase_orders" ADD CONSTRAINT "purchase_orders_billing_account_id_billing_accounts_id_fk" FOREIGN KEY ("billing_account_id") REFERENCES "billing_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "purchase_orders" ADD CONSTRAINT "purchase_orders_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "purchase_orders" ADD CONSTRAINT "purchase_orders_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "purchase_orders" ADD CONSTRAINT "purchase_orders_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "purchase_orders" ADD CONSTRAINT "purchase_orders_biz_billing_account_fk" FOREIGN KEY ("biz_id","billing_account_id") REFERENCES "billing_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_billing_account_autopay_rule_id_billing_account_autopay_rules_id_fk" FOREIGN KEY ("billing_account_autopay_rule_id") REFERENCES "billing_account_autopay_rules"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_billing_account_id_billing_accounts_id_fk" FOREIGN KEY ("billing_account_id") REFERENCES "billing_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_ar_invoice_id_ar_invoices_id_fk" FOREIGN KEY ("ar_invoice_id") REFERENCES "ar_invoices"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_installment_schedule_item_id_installment_schedule_items_id_fk" FOREIGN KEY ("installment_schedule_item_id") REFERENCES "installment_schedule_items"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_payment_intent_id_payment_intents_id_fk" FOREIGN KEY ("payment_intent_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_biz_rule_fk" FOREIGN KEY ("biz_id","billing_account_autopay_rule_id") REFERENCES "billing_account_autopay_rules"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_biz_billing_account_fk" FOREIGN KEY ("biz_id","billing_account_id") REFERENCES "billing_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_biz_invoice_fk" FOREIGN KEY ("biz_id","ar_invoice_id") REFERENCES "ar_invoices"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_biz_installment_item_fk" FOREIGN KEY ("biz_id","installment_schedule_item_id") REFERENCES "installment_schedule_items"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_biz_intent_fk" FOREIGN KEY ("biz_id","payment_intent_id") REFERENCES "payment_intents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "autocollection_attempts" ADD CONSTRAINT "autocollection_attempts_biz_transaction_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_account_autopay_rules" ADD CONSTRAINT "billing_account_autopay_rules_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_account_autopay_rules" ADD CONSTRAINT "billing_account_autopay_rules_billing_account_id_billing_accounts_id_fk" FOREIGN KEY ("billing_account_id") REFERENCES "billing_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_account_autopay_rules" ADD CONSTRAINT "billing_account_autopay_rules_payment_method_id_payment_methods_id_fk" FOREIGN KEY ("payment_method_id") REFERENCES "payment_methods"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_account_autopay_rules" ADD CONSTRAINT "billing_account_autopay_rules_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_account_autopay_rules" ADD CONSTRAINT "billing_account_autopay_rules_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_account_autopay_rules" ADD CONSTRAINT "billing_account_autopay_rules_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_account_autopay_rules" ADD CONSTRAINT "billing_account_autopay_rules_biz_billing_account_fk" FOREIGN KEY ("biz_id","billing_account_id") REFERENCES "billing_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "billing_account_autopay_rules" ADD CONSTRAINT "billing_account_autopay_rules_biz_method_fk" FOREIGN KEY ("biz_id","payment_method_id") REFERENCES "payment_methods"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_plans" ADD CONSTRAINT "installment_plans_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_plans" ADD CONSTRAINT "installment_plans_ar_invoice_id_ar_invoices_id_fk" FOREIGN KEY ("ar_invoice_id") REFERENCES "ar_invoices"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_plans" ADD CONSTRAINT "installment_plans_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_plans" ADD CONSTRAINT "installment_plans_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_plans" ADD CONSTRAINT "installment_plans_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_plans" ADD CONSTRAINT "installment_plans_biz_invoice_fk" FOREIGN KEY ("biz_id","ar_invoice_id") REFERENCES "ar_invoices"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_schedule_items" ADD CONSTRAINT "installment_schedule_items_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_schedule_items" ADD CONSTRAINT "installment_schedule_items_installment_plan_id_installment_plans_id_fk" FOREIGN KEY ("installment_plan_id") REFERENCES "installment_plans"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_schedule_items" ADD CONSTRAINT "installment_schedule_items_payment_intent_id_payment_intents_id_fk" FOREIGN KEY ("payment_intent_id") REFERENCES "payment_intents"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_schedule_items" ADD CONSTRAINT "installment_schedule_items_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_schedule_items" ADD CONSTRAINT "installment_schedule_items_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_schedule_items" ADD CONSTRAINT "installment_schedule_items_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_schedule_items" ADD CONSTRAINT "installment_schedule_items_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_schedule_items" ADD CONSTRAINT "installment_schedule_items_biz_plan_fk" FOREIGN KEY ("biz_id","installment_plan_id") REFERENCES "installment_plans"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_schedule_items" ADD CONSTRAINT "installment_schedule_items_biz_intent_fk" FOREIGN KEY ("biz_id","payment_intent_id") REFERENCES "payment_intents"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "installment_schedule_items" ADD CONSTRAINT "installment_schedule_items_biz_transaction_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claim_events" ADD CONSTRAINT "commitment_claim_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claim_events" ADD CONSTRAINT "commitment_claim_events_commitment_claim_id_commitment_claims_id_fk" FOREIGN KEY ("commitment_claim_id") REFERENCES "commitment_claims"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claim_events" ADD CONSTRAINT "commitment_claim_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claim_events" ADD CONSTRAINT "commitment_claim_events_secured_balance_ledger_entry_id_secured_balance_ledger_entries_id_fk" FOREIGN KEY ("secured_balance_ledger_entry_id") REFERENCES "secured_balance_ledger_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claim_events" ADD CONSTRAINT "commitment_claim_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claim_events" ADD CONSTRAINT "commitment_claim_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claim_events" ADD CONSTRAINT "commitment_claim_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claim_events" ADD CONSTRAINT "commitment_claim_events_biz_claim_fk" FOREIGN KEY ("biz_id","commitment_claim_id") REFERENCES "commitment_claims"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claim_events" ADD CONSTRAINT "commitment_claim_events_biz_actor_subject_fk" FOREIGN KEY ("biz_id","actor_subject_type","actor_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claim_events" ADD CONSTRAINT "commitment_claim_events_biz_ledger_entry_fk" FOREIGN KEY ("biz_id","secured_balance_ledger_entry_id") REFERENCES "secured_balance_ledger_entries"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claims" ADD CONSTRAINT "commitment_claims_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claims" ADD CONSTRAINT "commitment_claims_commitment_contract_id_commitment_contracts_id_fk" FOREIGN KEY ("commitment_contract_id") REFERENCES "commitment_contracts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claims" ADD CONSTRAINT "commitment_claims_resolved_by_user_id_users_id_fk" FOREIGN KEY ("resolved_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claims" ADD CONSTRAINT "commitment_claims_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claims" ADD CONSTRAINT "commitment_claims_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claims" ADD CONSTRAINT "commitment_claims_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claims" ADD CONSTRAINT "commitment_claims_biz_contract_fk" FOREIGN KEY ("biz_id","commitment_contract_id") REFERENCES "commitment_contracts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claims" ADD CONSTRAINT "commitment_claims_biz_raised_by_subject_fk" FOREIGN KEY ("biz_id","raised_by_subject_type","raised_by_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_claims" ADD CONSTRAINT "commitment_claims_biz_against_subject_fk" FOREIGN KEY ("biz_id","against_subject_type","against_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_ar_invoice_id_ar_invoices_id_fk" FOREIGN KEY ("ar_invoice_id") REFERENCES "ar_invoices"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_biz_anchor_subject_fk" FOREIGN KEY ("biz_id","anchor_subject_type","anchor_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_biz_counterparty_subject_fk" FOREIGN KEY ("biz_id","counterparty_subject_type","counterparty_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_biz_offer_version_fk" FOREIGN KEY ("biz_id","offer_version_id") REFERENCES "offer_versions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_contracts" ADD CONSTRAINT "commitment_contracts_biz_ar_invoice_fk" FOREIGN KEY ("biz_id","ar_invoice_id") REFERENCES "ar_invoices"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestone_obligations" ADD CONSTRAINT "commitment_milestone_obligations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestone_obligations" ADD CONSTRAINT "commitment_milestone_obligations_commitment_contract_id_commitment_contracts_id_fk" FOREIGN KEY ("commitment_contract_id") REFERENCES "commitment_contracts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestone_obligations" ADD CONSTRAINT "commitment_milestone_obligations_commitment_milestone_id_commitment_milestones_id_fk" FOREIGN KEY ("commitment_milestone_id") REFERENCES "commitment_milestones"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestone_obligations" ADD CONSTRAINT "commitment_milestone_obligations_commitment_obligation_id_commitment_obligations_id_fk" FOREIGN KEY ("commitment_obligation_id") REFERENCES "commitment_obligations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestone_obligations" ADD CONSTRAINT "commitment_milestone_obligations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestone_obligations" ADD CONSTRAINT "commitment_milestone_obligations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestone_obligations" ADD CONSTRAINT "commitment_milestone_obligations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestone_obligations" ADD CONSTRAINT "commitment_milestone_obligations_biz_contract_fk" FOREIGN KEY ("biz_id","commitment_contract_id") REFERENCES "commitment_contracts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestone_obligations" ADD CONSTRAINT "commitment_milestone_obligations_biz_milestone_fk" FOREIGN KEY ("biz_id","commitment_contract_id","commitment_milestone_id") REFERENCES "commitment_milestones"("biz_id","commitment_contract_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestone_obligations" ADD CONSTRAINT "commitment_milestone_obligations_biz_obligation_fk" FOREIGN KEY ("biz_id","commitment_contract_id","commitment_obligation_id") REFERENCES "commitment_obligations"("biz_id","commitment_contract_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestones" ADD CONSTRAINT "commitment_milestones_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestones" ADD CONSTRAINT "commitment_milestones_commitment_contract_id_commitment_contracts_id_fk" FOREIGN KEY ("commitment_contract_id") REFERENCES "commitment_contracts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestones" ADD CONSTRAINT "commitment_milestones_released_by_user_id_users_id_fk" FOREIGN KEY ("released_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestones" ADD CONSTRAINT "commitment_milestones_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestones" ADD CONSTRAINT "commitment_milestones_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestones" ADD CONSTRAINT "commitment_milestones_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_milestones" ADD CONSTRAINT "commitment_milestones_biz_contract_fk" FOREIGN KEY ("biz_id","commitment_contract_id") REFERENCES "commitment_contracts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_obligations" ADD CONSTRAINT "commitment_obligations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_obligations" ADD CONSTRAINT "commitment_obligations_commitment_contract_id_commitment_contracts_id_fk" FOREIGN KEY ("commitment_contract_id") REFERENCES "commitment_contracts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_obligations" ADD CONSTRAINT "commitment_obligations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_obligations" ADD CONSTRAINT "commitment_obligations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_obligations" ADD CONSTRAINT "commitment_obligations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_obligations" ADD CONSTRAINT "commitment_obligations_biz_contract_fk" FOREIGN KEY ("biz_id","commitment_contract_id") REFERENCES "commitment_contracts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_obligations" ADD CONSTRAINT "commitment_obligations_biz_obligor_subject_fk" FOREIGN KEY ("biz_id","obligor_subject_type","obligor_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_obligations" ADD CONSTRAINT "commitment_obligations_biz_beneficiary_subject_fk" FOREIGN KEY ("biz_id","beneficiary_subject_type","beneficiary_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "commitment_obligations" ADD CONSTRAINT "commitment_obligations_biz_source_subject_fk" FOREIGN KEY ("biz_id","source_subject_type","source_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_accounts" ADD CONSTRAINT "secured_balance_accounts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_accounts" ADD CONSTRAINT "secured_balance_accounts_commitment_contract_id_commitment_contracts_id_fk" FOREIGN KEY ("commitment_contract_id") REFERENCES "commitment_contracts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_accounts" ADD CONSTRAINT "secured_balance_accounts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_accounts" ADD CONSTRAINT "secured_balance_accounts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_accounts" ADD CONSTRAINT "secured_balance_accounts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_accounts" ADD CONSTRAINT "secured_balance_accounts_biz_contract_fk" FOREIGN KEY ("biz_id","commitment_contract_id") REFERENCES "commitment_contracts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_accounts" ADD CONSTRAINT "secured_balance_accounts_biz_owner_subject_fk" FOREIGN KEY ("biz_id","owner_subject_type","owner_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_accounts" ADD CONSTRAINT "secured_balance_accounts_biz_counterparty_subject_fk" FOREIGN KEY ("biz_id","counterparty_subject_type","counterparty_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_secured_balance_ledger_entry_id_secured_balance_ledger_entries_id_fk" FOREIGN KEY ("secured_balance_ledger_entry_id") REFERENCES "secured_balance_ledger_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_commitment_obligation_id_commitment_obligations_id_fk" FOREIGN KEY ("commitment_obligation_id") REFERENCES "commitment_obligations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_commitment_milestone_id_commitment_milestones_id_fk" FOREIGN KEY ("commitment_milestone_id") REFERENCES "commitment_milestones"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_ar_invoice_id_ar_invoices_id_fk" FOREIGN KEY ("ar_invoice_id") REFERENCES "ar_invoices"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_payment_transaction_line_allocation_id_payment_transaction_line_allocations_id_fk" FOREIGN KEY ("payment_transaction_line_allocation_id") REFERENCES "payment_transaction_line_allocations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_biz_ledger_fk" FOREIGN KEY ("biz_id","secured_balance_ledger_entry_id") REFERENCES "secured_balance_ledger_entries"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_biz_obligation_fk" FOREIGN KEY ("biz_id","commitment_obligation_id") REFERENCES "commitment_obligations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_biz_milestone_fk" FOREIGN KEY ("biz_id","commitment_milestone_id") REFERENCES "commitment_milestones"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_biz_booking_order_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_biz_ar_invoice_fk" FOREIGN KEY ("biz_id","ar_invoice_id") REFERENCES "ar_invoices"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_biz_payment_line_alloc_fk" FOREIGN KEY ("biz_id","payment_transaction_line_allocation_id") REFERENCES "payment_transaction_line_allocations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_allocations" ADD CONSTRAINT "secured_balance_allocations_biz_target_subject_fk" FOREIGN KEY ("biz_id","target_subject_type","target_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_secured_balance_account_id_secured_balance_accounts_id_fk" FOREIGN KEY ("secured_balance_account_id") REFERENCES "secured_balance_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_commitment_contract_id_commitment_contracts_id_fk" FOREIGN KEY ("commitment_contract_id") REFERENCES "commitment_contracts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_commitment_milestone_id_commitment_milestones_id_fk" FOREIGN KEY ("commitment_milestone_id") REFERENCES "commitment_milestones"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_commitment_obligation_id_commitment_obligations_id_fk" FOREIGN KEY ("commitment_obligation_id") REFERENCES "commitment_obligations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_ar_invoice_id_ar_invoices_id_fk" FOREIGN KEY ("ar_invoice_id") REFERENCES "ar_invoices"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_booking_order_line_id_booking_order_lines_id_fk" FOREIGN KEY ("booking_order_line_id") REFERENCES "booking_order_lines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_biz_account_fk" FOREIGN KEY ("biz_id","secured_balance_account_id") REFERENCES "secured_balance_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_biz_contract_fk" FOREIGN KEY ("biz_id","commitment_contract_id") REFERENCES "commitment_contracts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_biz_milestone_fk" FOREIGN KEY ("biz_id","commitment_milestone_id") REFERENCES "commitment_milestones"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_biz_obligation_fk" FOREIGN KEY ("biz_id","commitment_obligation_id") REFERENCES "commitment_obligations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_biz_payment_transaction_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_biz_ar_invoice_fk" FOREIGN KEY ("biz_id","ar_invoice_id") REFERENCES "ar_invoices"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_biz_booking_order_line_fk" FOREIGN KEY ("biz_id","booking_order_line_id") REFERENCES "booking_order_lines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "secured_balance_ledger_entries" ADD CONSTRAINT "secured_balance_ledger_entries_biz_source_subject_fk" FOREIGN KEY ("biz_id","source_subject_type","source_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_sla_policy_id_sla_policies_id_fk" FOREIGN KEY ("sla_policy_id") REFERENCES "sla_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_fulfillment_unit_id_fulfillment_units_id_fk" FOREIGN KEY ("fulfillment_unit_id") REFERENCES "fulfillment_units"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_queue_entry_id_queue_entries_id_fk" FOREIGN KEY ("queue_entry_id") REFERENCES "queue_entries"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_work_run_id_work_runs_id_fk" FOREIGN KEY ("work_run_id") REFERENCES "work_runs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_biz_policy_fk" FOREIGN KEY ("biz_id","sla_policy_id") REFERENCES "sla_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_breach_events" ADD CONSTRAINT "sla_breach_events_biz_target_ref_subject_fk" FOREIGN KEY ("biz_id","target_ref_type","target_ref_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_compensation_events" ADD CONSTRAINT "sla_compensation_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_compensation_events" ADD CONSTRAINT "sla_compensation_events_sla_breach_event_id_sla_breach_events_id_fk" FOREIGN KEY ("sla_breach_event_id") REFERENCES "sla_breach_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_compensation_events" ADD CONSTRAINT "sla_compensation_events_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_compensation_events" ADD CONSTRAINT "sla_compensation_events_ar_invoice_id_ar_invoices_id_fk" FOREIGN KEY ("ar_invoice_id") REFERENCES "ar_invoices"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_compensation_events" ADD CONSTRAINT "sla_compensation_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_compensation_events" ADD CONSTRAINT "sla_compensation_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_compensation_events" ADD CONSTRAINT "sla_compensation_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_compensation_events" ADD CONSTRAINT "sla_compensation_events_biz_breach_fk" FOREIGN KEY ("biz_id","sla_breach_event_id") REFERENCES "sla_breach_events"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_compensation_events" ADD CONSTRAINT "sla_compensation_events_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_compensation_events" ADD CONSTRAINT "sla_compensation_events_biz_ar_invoice_fk" FOREIGN KEY ("biz_id","ar_invoice_id") REFERENCES "ar_invoices"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_policies" ADD CONSTRAINT "sla_policies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_policies" ADD CONSTRAINT "sla_policies_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_policies" ADD CONSTRAINT "sla_policies_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_policies" ADD CONSTRAINT "sla_policies_offer_version_id_offer_versions_id_fk" FOREIGN KEY ("offer_version_id") REFERENCES "offer_versions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_policies" ADD CONSTRAINT "sla_policies_service_product_id_service_products_id_fk" FOREIGN KEY ("service_product_id") REFERENCES "service_products"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_policies" ADD CONSTRAINT "sla_policies_queue_id_queues_id_fk" FOREIGN KEY ("queue_id") REFERENCES "queues"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_policies" ADD CONSTRAINT "sla_policies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_policies" ADD CONSTRAINT "sla_policies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_policies" ADD CONSTRAINT "sla_policies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "sla_policies" ADD CONSTRAINT "sla_policies_biz_scope_ref_subject_fk" FOREIGN KEY ("biz_id","scope_ref_type","scope_ref_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fx_rate_snapshots" ADD CONSTRAINT "fx_rate_snapshots_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fx_rate_snapshots" ADD CONSTRAINT "fx_rate_snapshots_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fx_rate_snapshots" ADD CONSTRAINT "fx_rate_snapshots_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fx_rate_snapshots" ADD CONSTRAINT "fx_rate_snapshots_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_tax_profile_id_tax_profiles_id_fk" FOREIGN KEY ("tax_profile_id") REFERENCES "tax_profiles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_tax_rule_ref_id_tax_rule_refs_id_fk" FOREIGN KEY ("tax_rule_ref_id") REFERENCES "tax_rule_refs"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_fx_rate_snapshot_id_fx_rate_snapshots_id_fk" FOREIGN KEY ("fx_rate_snapshot_id") REFERENCES "fx_rate_snapshots"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_ar_invoice_id_ar_invoices_id_fk" FOREIGN KEY ("ar_invoice_id") REFERENCES "ar_invoices"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_biz_profile_fk" FOREIGN KEY ("biz_id","tax_profile_id") REFERENCES "tax_profiles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_biz_rule_fk" FOREIGN KEY ("biz_id","tax_rule_ref_id") REFERENCES "tax_rule_refs"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_biz_fx_rate_fk" FOREIGN KEY ("biz_id","fx_rate_snapshot_id") REFERENCES "fx_rate_snapshots"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_calculations" ADD CONSTRAINT "tax_calculations_biz_ar_invoice_fk" FOREIGN KEY ("biz_id","ar_invoice_id") REFERENCES "ar_invoices"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_profiles" ADD CONSTRAINT "tax_profiles_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_profiles" ADD CONSTRAINT "tax_profiles_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_profiles" ADD CONSTRAINT "tax_profiles_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_profiles" ADD CONSTRAINT "tax_profiles_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_rule_refs" ADD CONSTRAINT "tax_rule_refs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_rule_refs" ADD CONSTRAINT "tax_rule_refs_tax_profile_id_tax_profiles_id_fk" FOREIGN KEY ("tax_profile_id") REFERENCES "tax_profiles"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_rule_refs" ADD CONSTRAINT "tax_rule_refs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_rule_refs" ADD CONSTRAINT "tax_rule_refs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_rule_refs" ADD CONSTRAINT "tax_rule_refs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "tax_rule_refs" ADD CONSTRAINT "tax_rule_refs_biz_profile_fk" FOREIGN KEY ("biz_id","tax_profile_id") REFERENCES "tax_profiles"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_balances" ADD CONSTRAINT "leave_balances_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_balances" ADD CONSTRAINT "leave_balances_leave_policy_id_leave_policies_id_fk" FOREIGN KEY ("leave_policy_id") REFERENCES "leave_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_balances" ADD CONSTRAINT "leave_balances_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_balances" ADD CONSTRAINT "leave_balances_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_balances" ADD CONSTRAINT "leave_balances_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_balances" ADD CONSTRAINT "leave_balances_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_balances" ADD CONSTRAINT "leave_balances_biz_policy_fk" FOREIGN KEY ("biz_id","leave_policy_id") REFERENCES "leave_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_balances" ADD CONSTRAINT "leave_balances_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_events" ADD CONSTRAINT "leave_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_events" ADD CONSTRAINT "leave_events_leave_policy_id_leave_policies_id_fk" FOREIGN KEY ("leave_policy_id") REFERENCES "leave_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_events" ADD CONSTRAINT "leave_events_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_events" ADD CONSTRAINT "leave_events_leave_request_id_leave_requests_id_fk" FOREIGN KEY ("leave_request_id") REFERENCES "leave_requests"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_events" ADD CONSTRAINT "leave_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_events" ADD CONSTRAINT "leave_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_events" ADD CONSTRAINT "leave_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_events" ADD CONSTRAINT "leave_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_events" ADD CONSTRAINT "leave_events_biz_policy_fk" FOREIGN KEY ("biz_id","leave_policy_id") REFERENCES "leave_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_events" ADD CONSTRAINT "leave_events_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_events" ADD CONSTRAINT "leave_events_biz_request_fk" FOREIGN KEY ("biz_id","leave_request_id") REFERENCES "leave_requests"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_policies" ADD CONSTRAINT "leave_policies_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_policies" ADD CONSTRAINT "leave_policies_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_policies" ADD CONSTRAINT "leave_policies_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_policies" ADD CONSTRAINT "leave_policies_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_policies" ADD CONSTRAINT "leave_policies_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_policies" ADD CONSTRAINT "leave_policies_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_requests" ADD CONSTRAINT "leave_requests_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_requests" ADD CONSTRAINT "leave_requests_leave_policy_id_leave_policies_id_fk" FOREIGN KEY ("leave_policy_id") REFERENCES "leave_policies"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_requests" ADD CONSTRAINT "leave_requests_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_requests" ADD CONSTRAINT "leave_requests_requester_user_id_users_id_fk" FOREIGN KEY ("requester_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_requests" ADD CONSTRAINT "leave_requests_approver_user_id_users_id_fk" FOREIGN KEY ("approver_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_requests" ADD CONSTRAINT "leave_requests_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_requests" ADD CONSTRAINT "leave_requests_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_requests" ADD CONSTRAINT "leave_requests_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_requests" ADD CONSTRAINT "leave_requests_biz_policy_fk" FOREIGN KEY ("biz_id","leave_policy_id") REFERENCES "leave_policies"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "leave_requests" ADD CONSTRAINT "leave_requests_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_merge_conflicts" ADD CONSTRAINT "offline_merge_conflicts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_merge_conflicts" ADD CONSTRAINT "offline_merge_conflicts_offline_op_journal_id_offline_ops_journal_id_fk" FOREIGN KEY ("offline_op_journal_id") REFERENCES "offline_ops_journal"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_merge_conflicts" ADD CONSTRAINT "offline_merge_conflicts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_merge_conflicts" ADD CONSTRAINT "offline_merge_conflicts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_merge_conflicts" ADD CONSTRAINT "offline_merge_conflicts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_merge_conflicts" ADD CONSTRAINT "offline_merge_conflicts_biz_journal_fk" FOREIGN KEY ("biz_id","offline_op_journal_id") REFERENCES "offline_ops_journal"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_ops_journal" ADD CONSTRAINT "offline_ops_journal_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_ops_journal" ADD CONSTRAINT "offline_ops_journal_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_ops_journal" ADD CONSTRAINT "offline_ops_journal_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_ops_journal" ADD CONSTRAINT "offline_ops_journal_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_ops_journal" ADD CONSTRAINT "offline_ops_journal_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_resolution_events" ADD CONSTRAINT "offline_resolution_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_resolution_events" ADD CONSTRAINT "offline_resolution_events_offline_merge_conflict_id_offline_merge_conflicts_id_fk" FOREIGN KEY ("offline_merge_conflict_id") REFERENCES "offline_merge_conflicts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_resolution_events" ADD CONSTRAINT "offline_resolution_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_resolution_events" ADD CONSTRAINT "offline_resolution_events_resulting_offline_op_journal_id_offline_ops_journal_id_fk" FOREIGN KEY ("resulting_offline_op_journal_id") REFERENCES "offline_ops_journal"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_resolution_events" ADD CONSTRAINT "offline_resolution_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_resolution_events" ADD CONSTRAINT "offline_resolution_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_resolution_events" ADD CONSTRAINT "offline_resolution_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_resolution_events" ADD CONSTRAINT "offline_resolution_events_biz_conflict_fk" FOREIGN KEY ("biz_id","offline_merge_conflict_id") REFERENCES "offline_merge_conflicts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_resolution_events" ADD CONSTRAINT "offline_resolution_events_biz_resulting_op_fk" FOREIGN KEY ("biz_id","resulting_offline_op_journal_id") REFERENCES "offline_ops_journal"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_operational_daily" ADD CONSTRAINT "fact_operational_daily_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_operational_daily" ADD CONSTRAINT "fact_operational_daily_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_operational_daily" ADD CONSTRAINT "fact_operational_daily_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_operational_daily" ADD CONSTRAINT "fact_operational_daily_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_operational_daily" ADD CONSTRAINT "fact_operational_daily_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_operational_daily" ADD CONSTRAINT "fact_operational_daily_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_refresh_runs" ADD CONSTRAINT "fact_refresh_runs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_refresh_runs" ADD CONSTRAINT "fact_refresh_runs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_refresh_runs" ADD CONSTRAINT "fact_refresh_runs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_refresh_runs" ADD CONSTRAINT "fact_refresh_runs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_resource_utilization_daily" ADD CONSTRAINT "fact_resource_utilization_daily_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_resource_utilization_daily" ADD CONSTRAINT "fact_resource_utilization_daily_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_resource_utilization_daily" ADD CONSTRAINT "fact_resource_utilization_daily_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_resource_utilization_daily" ADD CONSTRAINT "fact_resource_utilization_daily_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_resource_utilization_daily" ADD CONSTRAINT "fact_resource_utilization_daily_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_resource_utilization_daily" ADD CONSTRAINT "fact_resource_utilization_daily_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_daily" ADD CONSTRAINT "fact_revenue_daily_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_daily" ADD CONSTRAINT "fact_revenue_daily_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_daily" ADD CONSTRAINT "fact_revenue_daily_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_daily" ADD CONSTRAINT "fact_revenue_daily_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_daily" ADD CONSTRAINT "fact_revenue_daily_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_daily" ADD CONSTRAINT "fact_revenue_daily_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_monthly" ADD CONSTRAINT "fact_revenue_monthly_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_monthly" ADD CONSTRAINT "fact_revenue_monthly_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_monthly" ADD CONSTRAINT "fact_revenue_monthly_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_monthly" ADD CONSTRAINT "fact_revenue_monthly_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_monthly" ADD CONSTRAINT "fact_revenue_monthly_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_revenue_monthly" ADD CONSTRAINT "fact_revenue_monthly_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_sellable_daily" ADD CONSTRAINT "fact_sellable_daily_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_sellable_daily" ADD CONSTRAINT "fact_sellable_daily_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_sellable_daily" ADD CONSTRAINT "fact_sellable_daily_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_sellable_daily" ADD CONSTRAINT "fact_sellable_daily_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_sellable_daily" ADD CONSTRAINT "fact_sellable_daily_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "fact_sellable_daily" ADD CONSTRAINT "fact_sellable_daily_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_resource_id_resources_id_fk" FOREIGN KEY ("resource_id") REFERENCES "resources"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_last_lifecycle_event_id_lifecycle_events_id_fk" FOREIGN KEY ("last_lifecycle_event_id") REFERENCES "lifecycle_events"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_biz_resource_fk" FOREIGN KEY ("biz_id","resource_id") REFERENCES "resources"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_biz_subject_fk" FOREIGN KEY ("biz_id","subject_type","subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "projection_checkpoints" ADD CONSTRAINT "projection_checkpoints_biz_lifecycle_event_fk" FOREIGN KEY ("biz_id","last_lifecycle_event_id") REFERENCES "lifecycle_events"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_attempts" ADD CONSTRAINT "gift_delivery_attempts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_attempts" ADD CONSTRAINT "gift_delivery_attempts_gift_delivery_schedule_id_gift_delivery_schedules_id_fk" FOREIGN KEY ("gift_delivery_schedule_id") REFERENCES "gift_delivery_schedules"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_attempts" ADD CONSTRAINT "gift_delivery_attempts_outbound_message_id_outbound_messages_id_fk" FOREIGN KEY ("outbound_message_id") REFERENCES "outbound_messages"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_attempts" ADD CONSTRAINT "gift_delivery_attempts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_attempts" ADD CONSTRAINT "gift_delivery_attempts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_attempts" ADD CONSTRAINT "gift_delivery_attempts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_attempts" ADD CONSTRAINT "gift_delivery_attempts_biz_schedule_fk" FOREIGN KEY ("biz_id","gift_delivery_schedule_id") REFERENCES "gift_delivery_schedules"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_attempts" ADD CONSTRAINT "gift_delivery_attempts_biz_outbound_message_fk" FOREIGN KEY ("biz_id","outbound_message_id") REFERENCES "outbound_messages"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_schedules" ADD CONSTRAINT "gift_delivery_schedules_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_schedules" ADD CONSTRAINT "gift_delivery_schedules_gift_instrument_id_gift_instruments_id_fk" FOREIGN KEY ("gift_instrument_id") REFERENCES "gift_instruments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_schedules" ADD CONSTRAINT "gift_delivery_schedules_message_template_id_message_templates_id_fk" FOREIGN KEY ("message_template_id") REFERENCES "message_templates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_schedules" ADD CONSTRAINT "gift_delivery_schedules_outbound_message_id_outbound_messages_id_fk" FOREIGN KEY ("outbound_message_id") REFERENCES "outbound_messages"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_schedules" ADD CONSTRAINT "gift_delivery_schedules_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_schedules" ADD CONSTRAINT "gift_delivery_schedules_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_schedules" ADD CONSTRAINT "gift_delivery_schedules_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_schedules" ADD CONSTRAINT "gift_delivery_schedules_biz_gift_fk" FOREIGN KEY ("biz_id","gift_instrument_id") REFERENCES "gift_instruments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_schedules" ADD CONSTRAINT "gift_delivery_schedules_biz_template_fk" FOREIGN KEY ("biz_id","message_template_id") REFERENCES "message_templates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "gift_delivery_schedules" ADD CONSTRAINT "gift_delivery_schedules_biz_outbound_message_fk" FOREIGN KEY ("biz_id","outbound_message_id") REFERENCES "outbound_messages"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ad_spend_daily_facts" ADD CONSTRAINT "ad_spend_daily_facts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ad_spend_daily_facts" ADD CONSTRAINT "ad_spend_daily_facts_channel_account_id_channel_accounts_id_fk" FOREIGN KEY ("channel_account_id") REFERENCES "channel_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ad_spend_daily_facts" ADD CONSTRAINT "ad_spend_daily_facts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ad_spend_daily_facts" ADD CONSTRAINT "ad_spend_daily_facts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ad_spend_daily_facts" ADD CONSTRAINT "ad_spend_daily_facts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "ad_spend_daily_facts" ADD CONSTRAINT "ad_spend_daily_facts_biz_channel_account_fk" FOREIGN KEY ("biz_id","channel_account_id") REFERENCES "channel_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segment_memberships" ADD CONSTRAINT "marketing_audience_segment_memberships_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segment_memberships" ADD CONSTRAINT "marketing_audience_segment_memberships_marketing_audience_segment_id_marketing_audience_segments_id_fk" FOREIGN KEY ("marketing_audience_segment_id") REFERENCES "marketing_audience_segments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segment_memberships" ADD CONSTRAINT "marketing_audience_segment_memberships_member_crm_contact_id_crm_contacts_id_fk" FOREIGN KEY ("member_crm_contact_id") REFERENCES "crm_contacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segment_memberships" ADD CONSTRAINT "marketing_audience_segment_memberships_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segment_memberships" ADD CONSTRAINT "marketing_audience_segment_memberships_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segment_memberships" ADD CONSTRAINT "marketing_audience_segment_memberships_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segment_memberships" ADD CONSTRAINT "marketing_audience_segment_memberships_biz_segment_fk" FOREIGN KEY ("biz_id","marketing_audience_segment_id") REFERENCES "marketing_audience_segments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segment_memberships" ADD CONSTRAINT "marketing_audience_segment_memberships_biz_contact_fk" FOREIGN KEY ("biz_id","member_crm_contact_id") REFERENCES "crm_contacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segment_memberships" ADD CONSTRAINT "marketing_audience_segment_memberships_biz_subject_fk" FOREIGN KEY ("biz_id","member_subject_type","member_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segments" ADD CONSTRAINT "marketing_audience_segments_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segments" ADD CONSTRAINT "marketing_audience_segments_graph_audience_segment_id_graph_audience_segments_id_fk" FOREIGN KEY ("graph_audience_segment_id") REFERENCES "graph_audience_segments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segments" ADD CONSTRAINT "marketing_audience_segments_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segments" ADD CONSTRAINT "marketing_audience_segments_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_segments" ADD CONSTRAINT "marketing_audience_segments_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_sync_runs" ADD CONSTRAINT "marketing_audience_sync_runs_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_sync_runs" ADD CONSTRAINT "marketing_audience_sync_runs_marketing_audience_segment_id_marketing_audience_segments_id_fk" FOREIGN KEY ("marketing_audience_segment_id") REFERENCES "marketing_audience_segments"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_sync_runs" ADD CONSTRAINT "marketing_audience_sync_runs_channel_account_id_channel_accounts_id_fk" FOREIGN KEY ("channel_account_id") REFERENCES "channel_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_sync_runs" ADD CONSTRAINT "marketing_audience_sync_runs_requested_by_user_id_users_id_fk" FOREIGN KEY ("requested_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_sync_runs" ADD CONSTRAINT "marketing_audience_sync_runs_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_sync_runs" ADD CONSTRAINT "marketing_audience_sync_runs_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_sync_runs" ADD CONSTRAINT "marketing_audience_sync_runs_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_sync_runs" ADD CONSTRAINT "marketing_audience_sync_runs_biz_segment_fk" FOREIGN KEY ("biz_id","marketing_audience_segment_id") REFERENCES "marketing_audience_segments"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "marketing_audience_sync_runs" ADD CONSTRAINT "marketing_audience_sync_runs_biz_channel_account_fk" FOREIGN KEY ("biz_id","channel_account_id") REFERENCES "channel_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_conversion_pushes" ADD CONSTRAINT "offline_conversion_pushes_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_conversion_pushes" ADD CONSTRAINT "offline_conversion_pushes_channel_account_id_channel_accounts_id_fk" FOREIGN KEY ("channel_account_id") REFERENCES "channel_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_conversion_pushes" ADD CONSTRAINT "offline_conversion_pushes_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_conversion_pushes" ADD CONSTRAINT "offline_conversion_pushes_payment_transaction_id_payment_transactions_id_fk" FOREIGN KEY ("payment_transaction_id") REFERENCES "payment_transactions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_conversion_pushes" ADD CONSTRAINT "offline_conversion_pushes_referral_attribution_id_referral_attributions_id_fk" FOREIGN KEY ("referral_attribution_id") REFERENCES "referral_attributions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_conversion_pushes" ADD CONSTRAINT "offline_conversion_pushes_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_conversion_pushes" ADD CONSTRAINT "offline_conversion_pushes_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_conversion_pushes" ADD CONSTRAINT "offline_conversion_pushes_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_conversion_pushes" ADD CONSTRAINT "offline_conversion_pushes_biz_channel_account_fk" FOREIGN KEY ("biz_id","channel_account_id") REFERENCES "channel_accounts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_conversion_pushes" ADD CONSTRAINT "offline_conversion_pushes_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "offline_conversion_pushes" ADD CONSTRAINT "offline_conversion_pushes_biz_payment_transaction_fk" FOREIGN KEY ("biz_id","payment_transaction_id") REFERENCES "payment_transactions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contact_channels" ADD CONSTRAINT "crm_contact_channels_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contact_channels" ADD CONSTRAINT "crm_contact_channels_crm_contact_id_crm_contacts_id_fk" FOREIGN KEY ("crm_contact_id") REFERENCES "crm_contacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contact_channels" ADD CONSTRAINT "crm_contact_channels_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contact_channels" ADD CONSTRAINT "crm_contact_channels_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contact_channels" ADD CONSTRAINT "crm_contact_channels_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contact_channels" ADD CONSTRAINT "crm_contact_channels_biz_contact_fk" FOREIGN KEY ("biz_id","crm_contact_id") REFERENCES "crm_contacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contacts" ADD CONSTRAINT "crm_contacts_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contacts" ADD CONSTRAINT "crm_contacts_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contacts" ADD CONSTRAINT "crm_contacts_group_account_id_group_accounts_id_fk" FOREIGN KEY ("group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contacts" ADD CONSTRAINT "crm_contacts_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contacts" ADD CONSTRAINT "crm_contacts_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_contacts" ADD CONSTRAINT "crm_contacts_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_messages" ADD CONSTRAINT "crm_conversation_messages_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_messages" ADD CONSTRAINT "crm_conversation_messages_crm_conversation_id_crm_conversations_id_fk" FOREIGN KEY ("crm_conversation_id") REFERENCES "crm_conversations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_messages" ADD CONSTRAINT "crm_conversation_messages_sender_crm_contact_id_crm_contacts_id_fk" FOREIGN KEY ("sender_crm_contact_id") REFERENCES "crm_contacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_messages" ADD CONSTRAINT "crm_conversation_messages_outbound_message_id_outbound_messages_id_fk" FOREIGN KEY ("outbound_message_id") REFERENCES "outbound_messages"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_messages" ADD CONSTRAINT "crm_conversation_messages_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_messages" ADD CONSTRAINT "crm_conversation_messages_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_messages" ADD CONSTRAINT "crm_conversation_messages_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_messages" ADD CONSTRAINT "crm_conversation_messages_biz_conversation_fk" FOREIGN KEY ("biz_id","crm_conversation_id") REFERENCES "crm_conversations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_messages" ADD CONSTRAINT "crm_conversation_messages_biz_outbound_message_fk" FOREIGN KEY ("biz_id","outbound_message_id") REFERENCES "outbound_messages"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_messages" ADD CONSTRAINT "crm_conversation_messages_biz_sender_contact_fk" FOREIGN KEY ("biz_id","sender_crm_contact_id") REFERENCES "crm_contacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_messages" ADD CONSTRAINT "crm_conversation_messages_biz_sender_subject_fk" FOREIGN KEY ("biz_id","sender_subject_type","sender_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_participants" ADD CONSTRAINT "crm_conversation_participants_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_participants" ADD CONSTRAINT "crm_conversation_participants_crm_conversation_id_crm_conversations_id_fk" FOREIGN KEY ("crm_conversation_id") REFERENCES "crm_conversations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_participants" ADD CONSTRAINT "crm_conversation_participants_participant_crm_contact_id_crm_contacts_id_fk" FOREIGN KEY ("participant_crm_contact_id") REFERENCES "crm_contacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_participants" ADD CONSTRAINT "crm_conversation_participants_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_participants" ADD CONSTRAINT "crm_conversation_participants_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_participants" ADD CONSTRAINT "crm_conversation_participants_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_participants" ADD CONSTRAINT "crm_conversation_participants_biz_conversation_fk" FOREIGN KEY ("biz_id","crm_conversation_id") REFERENCES "crm_conversations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_participants" ADD CONSTRAINT "crm_conversation_participants_biz_contact_fk" FOREIGN KEY ("biz_id","participant_crm_contact_id") REFERENCES "crm_contacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversation_participants" ADD CONSTRAINT "crm_conversation_participants_biz_subject_fk" FOREIGN KEY ("biz_id","participant_subject_type","participant_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_crm_lead_id_crm_leads_id_fk" FOREIGN KEY ("crm_lead_id") REFERENCES "crm_leads"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_crm_opportunity_id_crm_opportunities_id_fk" FOREIGN KEY ("crm_opportunity_id") REFERENCES "crm_opportunities"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_crm_contact_id_crm_contacts_id_fk" FOREIGN KEY ("crm_contact_id") REFERENCES "crm_contacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_assigned_user_id_users_id_fk" FOREIGN KEY ("assigned_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_biz_lead_fk" FOREIGN KEY ("biz_id","crm_lead_id") REFERENCES "crm_leads"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_biz_opportunity_fk" FOREIGN KEY ("biz_id","crm_opportunity_id") REFERENCES "crm_opportunities"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_conversations" ADD CONSTRAINT "crm_conversations_biz_contact_fk" FOREIGN KEY ("biz_id","crm_contact_id") REFERENCES "crm_contacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_lead_events" ADD CONSTRAINT "crm_lead_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_lead_events" ADD CONSTRAINT "crm_lead_events_crm_lead_id_crm_leads_id_fk" FOREIGN KEY ("crm_lead_id") REFERENCES "crm_leads"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_lead_events" ADD CONSTRAINT "crm_lead_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_lead_events" ADD CONSTRAINT "crm_lead_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_lead_events" ADD CONSTRAINT "crm_lead_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_lead_events" ADD CONSTRAINT "crm_lead_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_lead_events" ADD CONSTRAINT "crm_lead_events_biz_lead_fk" FOREIGN KEY ("biz_id","crm_lead_id") REFERENCES "crm_leads"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_crm_contact_id_crm_contacts_id_fk" FOREIGN KEY ("crm_contact_id") REFERENCES "crm_contacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_crm_pipeline_id_crm_pipelines_id_fk" FOREIGN KEY ("crm_pipeline_id") REFERENCES "crm_pipelines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_crm_pipeline_stage_id_crm_pipeline_stages_id_fk" FOREIGN KEY ("crm_pipeline_stage_id") REFERENCES "crm_pipeline_stages"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_biz_pipeline_fk" FOREIGN KEY ("biz_id","crm_pipeline_id") REFERENCES "crm_pipelines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_biz_stage_fk" FOREIGN KEY ("biz_id","crm_pipeline_stage_id") REFERENCES "crm_pipeline_stages"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_leads" ADD CONSTRAINT "crm_leads_biz_contact_fk" FOREIGN KEY ("biz_id","crm_contact_id") REFERENCES "crm_contacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_candidates" ADD CONSTRAINT "crm_merge_candidates_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_candidates" ADD CONSTRAINT "crm_merge_candidates_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_candidates" ADD CONSTRAINT "crm_merge_candidates_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_candidates" ADD CONSTRAINT "crm_merge_candidates_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_candidates" ADD CONSTRAINT "crm_merge_candidates_left_subject_fk" FOREIGN KEY ("biz_id","left_subject_type","left_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_candidates" ADD CONSTRAINT "crm_merge_candidates_right_subject_fk" FOREIGN KEY ("biz_id","right_subject_type","right_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_decisions" ADD CONSTRAINT "crm_merge_decisions_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_decisions" ADD CONSTRAINT "crm_merge_decisions_crm_merge_candidate_id_crm_merge_candidates_id_fk" FOREIGN KEY ("crm_merge_candidate_id") REFERENCES "crm_merge_candidates"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_decisions" ADD CONSTRAINT "crm_merge_decisions_decided_by_user_id_users_id_fk" FOREIGN KEY ("decided_by_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_decisions" ADD CONSTRAINT "crm_merge_decisions_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_decisions" ADD CONSTRAINT "crm_merge_decisions_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_decisions" ADD CONSTRAINT "crm_merge_decisions_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_decisions" ADD CONSTRAINT "crm_merge_decisions_biz_candidate_fk" FOREIGN KEY ("biz_id","crm_merge_candidate_id") REFERENCES "crm_merge_candidates"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_decisions" ADD CONSTRAINT "crm_merge_decisions_winner_subject_fk" FOREIGN KEY ("biz_id","winner_subject_type","winner_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_merge_decisions" ADD CONSTRAINT "crm_merge_decisions_loser_subject_fk" FOREIGN KEY ("biz_id","loser_subject_type","loser_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_crm_pipeline_id_crm_pipelines_id_fk" FOREIGN KEY ("crm_pipeline_id") REFERENCES "crm_pipelines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_crm_pipeline_stage_id_crm_pipeline_stages_id_fk" FOREIGN KEY ("crm_pipeline_stage_id") REFERENCES "crm_pipeline_stages"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_primary_crm_lead_id_crm_leads_id_fk" FOREIGN KEY ("primary_crm_lead_id") REFERENCES "crm_leads"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_crm_contact_id_crm_contacts_id_fk" FOREIGN KEY ("crm_contact_id") REFERENCES "crm_contacts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_biz_pipeline_fk" FOREIGN KEY ("biz_id","crm_pipeline_id") REFERENCES "crm_pipelines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_biz_stage_fk" FOREIGN KEY ("biz_id","crm_pipeline_stage_id") REFERENCES "crm_pipeline_stages"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_biz_lead_fk" FOREIGN KEY ("biz_id","primary_crm_lead_id") REFERENCES "crm_leads"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunities" ADD CONSTRAINT "crm_opportunities_biz_contact_fk" FOREIGN KEY ("biz_id","crm_contact_id") REFERENCES "crm_contacts"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunity_stage_events" ADD CONSTRAINT "crm_opportunity_stage_events_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunity_stage_events" ADD CONSTRAINT "crm_opportunity_stage_events_crm_opportunity_id_crm_opportunities_id_fk" FOREIGN KEY ("crm_opportunity_id") REFERENCES "crm_opportunities"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunity_stage_events" ADD CONSTRAINT "crm_opportunity_stage_events_from_crm_pipeline_stage_id_crm_pipeline_stages_id_fk" FOREIGN KEY ("from_crm_pipeline_stage_id") REFERENCES "crm_pipeline_stages"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunity_stage_events" ADD CONSTRAINT "crm_opportunity_stage_events_to_crm_pipeline_stage_id_crm_pipeline_stages_id_fk" FOREIGN KEY ("to_crm_pipeline_stage_id") REFERENCES "crm_pipeline_stages"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunity_stage_events" ADD CONSTRAINT "crm_opportunity_stage_events_actor_user_id_users_id_fk" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunity_stage_events" ADD CONSTRAINT "crm_opportunity_stage_events_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunity_stage_events" ADD CONSTRAINT "crm_opportunity_stage_events_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunity_stage_events" ADD CONSTRAINT "crm_opportunity_stage_events_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_opportunity_stage_events" ADD CONSTRAINT "crm_opportunity_stage_events_biz_opportunity_fk" FOREIGN KEY ("biz_id","crm_opportunity_id") REFERENCES "crm_opportunities"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_pipeline_stages" ADD CONSTRAINT "crm_pipeline_stages_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_pipeline_stages" ADD CONSTRAINT "crm_pipeline_stages_crm_pipeline_id_crm_pipelines_id_fk" FOREIGN KEY ("crm_pipeline_id") REFERENCES "crm_pipelines"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_pipeline_stages" ADD CONSTRAINT "crm_pipeline_stages_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_pipeline_stages" ADD CONSTRAINT "crm_pipeline_stages_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_pipeline_stages" ADD CONSTRAINT "crm_pipeline_stages_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_pipeline_stages" ADD CONSTRAINT "crm_pipeline_stages_biz_pipeline_fk" FOREIGN KEY ("biz_id","crm_pipeline_id") REFERENCES "crm_pipelines"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_pipelines" ADD CONSTRAINT "crm_pipelines_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_pipelines" ADD CONSTRAINT "crm_pipelines_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_pipelines" ADD CONSTRAINT "crm_pipelines_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_pipelines" ADD CONSTRAINT "crm_pipelines_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_subject_redirects" ADD CONSTRAINT "crm_subject_redirects_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_subject_redirects" ADD CONSTRAINT "crm_subject_redirects_crm_merge_decision_id_crm_merge_decisions_id_fk" FOREIGN KEY ("crm_merge_decision_id") REFERENCES "crm_merge_decisions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_subject_redirects" ADD CONSTRAINT "crm_subject_redirects_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_subject_redirects" ADD CONSTRAINT "crm_subject_redirects_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_subject_redirects" ADD CONSTRAINT "crm_subject_redirects_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_subject_redirects" ADD CONSTRAINT "crm_subject_redirects_from_subject_fk" FOREIGN KEY ("biz_id","subject_type","from_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_subject_redirects" ADD CONSTRAINT "crm_subject_redirects_to_subject_fk" FOREIGN KEY ("biz_id","subject_type","to_subject_id") REFERENCES "subjects"("biz_id","subject_type","subject_id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "crm_subject_redirects" ADD CONSTRAINT "crm_subject_redirects_biz_merge_decision_fk" FOREIGN KEY ("biz_id","crm_merge_decision_id") REFERENCES "crm_merge_decisions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_production_batch_id_production_batches_id_fk" FOREIGN KEY ("production_batch_id") REFERENCES "production_batches"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_owner_user_id_users_id_fk" FOREIGN KEY ("owner_user_id") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_owner_group_account_id_group_accounts_id_fk" FOREIGN KEY ("owner_group_account_id") REFERENCES "group_accounts"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_source_checkout_session_id_checkout_sessions_id_fk" FOREIGN KEY ("source_checkout_session_id") REFERENCES "checkout_sessions"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_booking_order_id_booking_orders_id_fk" FOREIGN KEY ("booking_order_id") REFERENCES "booking_orders"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_biz_batch_fk" FOREIGN KEY ("biz_id","production_batch_id") REFERENCES "production_batches"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_biz_checkout_session_fk" FOREIGN KEY ("biz_id","source_checkout_session_id") REFERENCES "checkout_sessions"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batch_reservations" ADD CONSTRAINT "production_batch_reservations_biz_booking_order_fk" FOREIGN KEY ("biz_id","booking_order_id") REFERENCES "booking_orders"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batches" ADD CONSTRAINT "production_batches_biz_id_bizes_id_fk" FOREIGN KEY ("biz_id") REFERENCES "bizes"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batches" ADD CONSTRAINT "production_batches_location_id_locations_id_fk" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batches" ADD CONSTRAINT "production_batches_sellable_id_sellables_id_fk" FOREIGN KEY ("sellable_id") REFERENCES "sellables"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batches" ADD CONSTRAINT "production_batches_created_by_users_id_fk" FOREIGN KEY ("created_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batches" ADD CONSTRAINT "production_batches_updated_by_users_id_fk" FOREIGN KEY ("updated_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batches" ADD CONSTRAINT "production_batches_deleted_by_users_id_fk" FOREIGN KEY ("deleted_by") REFERENCES "users"("id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batches" ADD CONSTRAINT "production_batches_biz_location_fk" FOREIGN KEY ("biz_id","location_id") REFERENCES "locations"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
--> statement-breakpoint
DO $$ BEGIN
 ALTER TABLE "production_batches" ADD CONSTRAINT "production_batches_biz_sellable_fk" FOREIGN KEY ("biz_id","sellable_id") REFERENCES "sellables"("biz_id","id") ON DELETE no action ON UPDATE no action;
EXCEPTION
 WHEN duplicate_object THEN null;
END $$;
